**程式名稱:進貨待檢驗查詢
set excl off
close all
clear 
AREA1='H01'
FLG='0'
FCH=''
CHK=''
IF !USED('A01')
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK sys_oper+'H02'      
IF !USED ('A14')
   SELE 0
   USE A14 
ELSE 
   SELE A14
ENDIF
SET ORDER TO 1         
IF !USED ('D01')
   SELE 0
   USE D01 
ELSE 
   SELE D01
ENDIF
SET ORDER TO 1       
IF !USED('H01')
   SELE 0
   USE H01 
ELSE
   SELE H01
ENDIF
SET ORDER TO 1
set filter to F06+F07>0
GO TOP
SET RELA TO F04 INTO D01 
SET RELA TO F19 INTO A14 ADDI
H02form=createobject("tkH02")
H02form.show  
define class tkH02 as form
  caption='H02.查詢進貨待驗資料'
*!*	  autocenter=.t.
  controlbox=.F.
  BORDERSTYLE=1 
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  controlcount=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  showtips=.t.
  showwindow=1
  WIDTH=INT_015*789
  windowtype=1
  ADD OBJECT REC_COUNT AS REC_COUNT  with;
      caption=str(reccount()),;
      TOP=INT_015*5
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      columncount=10,;            
      RECORDSOURCE='H01',; 
      HEIGHT=INT_015*500,;     
      WIDTH=INT_015*780,;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',; 
      COLUMN4.NAME='COLUMN4',; 
      COLUMN5.NAME='COLUMN5',;             
      COLUMN6.NAME='COLUMN6',;       
      COLUMN7.NAME='COLUMN7',;       
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10'         
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;      
      TOP=INT_015*0,;
      LEFT=INT_015*350              
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=INT_015*0,;
      LEFT=INT_015*250,;
      ENABLED=.T.,;
      VISIBLE=.T.                    
  PROCEDURE INIT
       THISFORM.ORPGROUP.NEW_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.DEL_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.PNT_BOTT.VISIBLE=.F.    
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')                                  
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*65
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*149
       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*85
       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*85
       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70       
       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*149
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='送驗日期'
	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='進貨單號'	          
  	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='料品編號'	   
	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='進貨廠商'	   	   
	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='待驗數量'
  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='待退數量'  	   
  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='備品數量'
  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='採購單號' 
  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='存放部門'   	   
  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='採購用途'   	   
	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='H01.F10'
	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='H01.F03'
	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='H01.F01'
	   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D01.F04'
	   THISFORM.GRID1.COLUMN5.CONTROLSOURCE='H01.F06'
	   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='H01.F07'
	   THISFORM.GRID1.COLUMN7.CONTROLSOURCE='H01.F13'
	   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='H01.F11'	   
	   THISFORM.GRID1.COLUMN9.CONTROLSOURCE='A14.F02'	   
	   THISFORM.GRID1.COLUMN10.CONTROLSOURCE='H01.F12'	   
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS       
       JK='送驗日期'
  ENDPROC     
  PROC KEY_LIST.INIT 
       with this 
           .additem('依送驗日期排列')
           .additem('依進貨廠商排列')
           .additem('依進貨單號排列')           
           .additem('依料品編號排列')           
       endwith      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE H01
       DO CASE
          CASE THIS.DISPLAYVALUE='依送驗日期排列'
               SET ORDER TO H011 
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='送驗日期'
	           THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='進貨單號'	          
        	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='料品編號'	   
	           THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='進貨廠商'	   	   
        	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='待驗數量'
        	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='待退數量'  	   
  	           THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='備品數量'
        	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='採購單號' 
  	           THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='存放部門'   	   
        	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='H01.F10'
	           THISFORM.GRID1.COLUMN2.CONTROLSOURCE='H01.F03'
        	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='H01.F01'
	           THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D01.F04'
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE='H01.F06'
        	   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='H01.F07'
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE='H01.F13'
        	   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='H01.F11'	   
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE='A14.F02'	     	   
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*65
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*149
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN6.WIDTH=INT_015*85
               THISFORM.GRID1.COLUMN7.WIDTH=INT_015*85
               THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70
          CASE THIS.DISPLAYVALUE='依進貨廠商排列'
               SET ORDER TO H012          
	           THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='進貨廠商'	   	                  
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='送驗日期'
	           THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='進貨單號'	          
        	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料品編號'	   
        	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='待驗數量'
        	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='待退數量'  	   
  	           THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='備品數量'
        	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='採購單號' 
  	           THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='存放部門'   	   
	           THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D01.F04'  	           
        	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='H01.F10'
	           THISFORM.GRID1.COLUMN3.CONTROLSOURCE='H01.F03'
        	   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='H01.F01'
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE='H01.F06'
        	   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='H01.F07'
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE='H01.F13'
        	   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='H01.F11'	   
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE='A14.F02'	     	   
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*70	           
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*65
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*149
               THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN6.WIDTH=INT_015*85
               THISFORM.GRID1.COLUMN7.WIDTH=INT_015*85
               THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70                 
          CASE THIS.DISPLAYVALUE='依進貨單號排列'
               SET ORDER TO H013                                
	           THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='進貨單號'	                              	                                       
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='送驗日期'
        	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='料品編號'	   
	           THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='進貨廠商'	   	   
        	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='待驗數量'
        	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='待退數量'  	   
  	           THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='備品數量'
        	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='採購單號' 
  	           THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='存放部門'   	   
	           THISFORM.GRID1.COLUMN1.CONTROLSOURCE='H01.F03'  	           
        	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='H01.F10'
        	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='H01.F01'
	           THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D01.F04'
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE='H01.F06'
        	   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='H01.F07'
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE='H01.F13'
        	   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='H01.F11'	   
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE='A14.F02'	     	   
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*80	           
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*65
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*149
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN6.WIDTH=INT_015*85
               THISFORM.GRID1.COLUMN7.WIDTH=INT_015*85
               THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70                 
          CASE THIS.DISPLAYVALUE='依料品編號排列'
               SET ORDER TO H014          
        	   THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料品編號'	                  
	           THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='進貨單號'	                  	   
        	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='採購單號' 	           
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='送驗日期'
	           THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='進貨廠商'	   	   
        	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='待驗數量'
        	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='待退數量'  	   
  	           THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='備品數量'
  	           THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='存放部門'   	   
        	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='H01.F01'  	           
	           THISFORM.GRID1.COLUMN2.CONTROLSOURCE='H01.F03'        	   
        	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='H01.F11'	   	           
        	   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='H01.F10'
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D01.F04'
	           THISFORM.GRID1.COLUMN6.CONTROLSOURCE='H01.F06'
        	   THISFORM.GRID1.COLUMN7.CONTROLSOURCE='H01.F07'
	           THISFORM.GRID1.COLUMN8.CONTROLSOURCE='H01.F13'
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE='A14.F02'	     	   
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*149	           
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*80               
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80               
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*65
               THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN6.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN7.WIDTH=INT_015*85
               THISFORM.GRID1.COLUMN8.WIDTH=INT_015*85
               THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70                     	                  
       ENDCASE 
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC                
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       thisform.refresh
  ENDPROC       
enddefine        

