***程式名稱:C99D.業務員B別年度出貨分析
C99DFORM=CREATEOBJECT("TKC99D")
C99DFORM.SHOW  
************************
DEFINE CLASS TKC99D AS FORM
*!*	  AUTOCENTER=.T.  
  MOVABLE=.F.
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  WIDTH=INT_015*792
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=1
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='C99DFORM'
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
     WIDTH=INT_015*180
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;            
      TOP=0,;
      LEFT=INT_015*413                  
 ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=0,;
      ENABLED=.T.,;
      LEFT=INT_015*195
   ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*410,;
      TOP=INT_015*5,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*65,; 
      FONTSIZE=INT_015*9,;
      CAPTION='\<T.ABC分類',;
      TOOLTIPTEXT='列印ABC分類'    
   ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*477,;
      TOP=INT_015*5,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*65,; 
      FONTSIZE=INT_015*9,;
      CAPTION='\<E.轉EXCEL',;
      TOOLTIPTEXT='將資料轉成EXCEL'          
 ADD OBJECT REC_COUNT1 AS REC_COUNT WITH;
      TOP=INT_015*1,;
      LEFT=INT_015*635,;  
      BACKCOLOR=RGB(255,255,0),;
      CAPTION=''
 ADD OBJECT REC_COUNT2 AS REC_COUNT WITH;
      TOP=INT_015*14,;
      LEFT=INT_015*635,;  
      BACKCOLOR=RGB(255,255,0),;
      CAPTION=''      
  ADD OBJECT GRID1 AS GRID1 WITH;       
      AUTOCENTER=.T.,;
      TOP=INT_015*30,;
      WIDTH=INT_015*780,;      
      HEIGHT=INT_015*500,;  
      ROWHEIGHT=INT_015*18,;
      HEADERHEIGHT=INT_015*18,;          
      DELETEMARK=.F.,;
      READONLY=.T.,;
      RECORDSOURCETYPE=1,;
      COLUMNCOUNT=15,;         
      NAME='GRID1',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;      
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10',;
      COLUMN11.NAME='COLUMN11',;
      COLUMN12.NAME='COLUMN12',;
      COLUMN13.NAME='COLUMN13',;
      COLUMN14.NAME='COLUMN14',;
      COLUMN15.NAME='COLUMN15'         
*********************************************      
  PROCEDURE INIT
  	 SELECT  YCO
  	 CALC SUM(YCO.SUM_TOL),SUM(YCO.SUM_TO_AOT) TO TOLMOY,TOLMOY_AOT
  	 GO TOP
  	 THISFORM.REC_COUNT1.CAPTION='年度總金額：'+ALLTRIM(TRANSFORM(ROUND(TOLMOY,2),'@R 999,999,999,999.99'))
  	 THISFORM.REC_COUNT2.CAPTION='年度總數量：'+ALLTRIM(TRANSFORM(TOLMOY_AOT,'@R 999,999,999,999'))	 
  	 THISFORM.KEY_LIST.DISPLAYVALUE='依業務編號(出貨金額)排列'
         THISFORM.CAPTION='C99C.業務員B別年度出貨分析'+IIF(ALLTRIM(UKEF)='YN' ,'(全部)',IIF(ALLTRIM(UKEF)='Y','(製品)','(部品)'))+'         資料年度:'+YEAR_STR+'年'  
         THISFORM.GRID1.RECORDSOURCE='YCO' 
         THISFORM.GRID1.READONLY=.T. 
         THISFORM.CMND1.ENABLED=.F.        
         THISFORM.ORPGROUP.NEW_BOTT.VISIBLE=.F.
         THISFORM.ORPGROUP.EDIT_BOTT.VISIBLE=.F.
         THISFORM.ORPGROUP.DEL_BOTT.VISIBLE=.F.
         THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
         THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
         THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')
         THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限    
         THISFORM.CMND2.ENABLED=IIF(A02.F07='*',.T.,.F.)           
         THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='業務編號'
         THISFORM.GRID1.COLUMN1.CONTROLSOURCE='YCO.F18'
         THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
         THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業務姓名'
         THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
         THISFORM.GRID1.COLUMN2.CONTROLSOURCE='YCO.F033'
         THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='一月'
         THISFORM.GRID1.COLUMN3.CONTROLSOURCE="IIF(YCO.JAN=0,'',ROUND(YCO.JAN,2))"
         THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70                   
         THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='二月'
         THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(YCO.FEB=0,'',ROUND(YCO.FEB,2))"
         THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='三月'
         THISFORM.GRID1.COLUMN5.CONTROLSOURCE="IIF(YCO.MAR=0,'',ROUND(YCO.MAR,2))"
         THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='四月'
         THISFORM.GRID1.COLUMN6.CONTROLSOURCE="IIF(YCO.APR=0,'',ROUND(YCO.APR,2))"
         THISFORM.GRID1.COLUMN6.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='五月'
         THISFORM.GRID1.COLUMN7.CONTROLSOURCE="IIF(YCO.MAY=0,'',ROUND(YCO.MAY,2))"
         THISFORM.GRID1.COLUMN7.WIDTH=INT_015*70               
         THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='六月'
         THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(YCO.JUN=0,'',ROUND(YCO.JUN,2))"
         THISFORM.GRID1.COLUMN8.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='七月'
         THISFORM.GRID1.COLUMN9.CONTROLSOURCE="IIF(YCO.JUL=0,'',ROUND(YCO.JUL,2))"
         THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='八月'
         THISFORM.GRID1.COLUMN10.CONTROLSOURCE="IIF(YCO.AUG=0,'',ROUND(YCO.AUG,2))"
         THISFORM.GRID1.COLUMN10.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='九月'
         THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(YCO.SEP=0,'',ROUND(YCO.SEP,2))"
         THISFORM.GRID1.COLUMN11.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='十月'
         THISFORM.GRID1.COLUMN12.CONTROLSOURCE="IIF(YCO.OCT=0,'',ROUND(YCO.OCT,2))"
         THISFORM.GRID1.COLUMN12.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='十一月'
         THISFORM.GRID1.COLUMN13.CONTROLSOURCE="IIF(YCO.NOV=0,'',ROUND(YCO.NOV,2))"
         THISFORM.GRID1.COLUMN13.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='十二月'
         THISFORM.GRID1.COLUMN14.CONTROLSOURCE="IIF(YCO.DEC=0,'',ROUND(YCO.DEC,2))"
         THISFORM.GRID1.COLUMN14.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='出貨總金額'
         THISFORM.GRID1.COLUMN15.CONTROLSOURCE="IIF(YCO.SUM_TOL=0,'',ROUND(YCO.SUM_TOL,2))"
         THISFORM.GRID1.COLUMN15.WIDTH=INT_015*100  
         THISFORM.GRID1.COLUMN15.BACKCOLOR=RGB(255,255,0)
         JK='業務編號'         
         THISFORM.GRID1.SETFOCUS          
  ENDPROC
***************************************      
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依業務編號(出貨金額)排列')
           .ADDITEM('依出貨金額(由大到小)排列')
           .ADDITEM('依業務編號(出貨數量)排列')
           .ADDITEM('依出貨數量(由大到小)排列')           
       ENDWITH      
  ENDPROC
*************搜尋排列************************** 
PROC KEY_LIST.INTERACTIVECHANGE   
   SELECT  YCO         
   DO CASE
        CASE THIS.DISPLAYVALUE='依業務編號(出貨金額)排列' 
                   KEY_CK=1
                   SET ORDER TO YCO_1
                   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
                   THISFORM.CMND2.ENABLED=IIF(A02.F07='*',.T.,.F.)
                   THISFORM.CMND1.ENABLED=.F.
                   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
	           THISFORM.GRID1.COLUMN3.CONTROLSOURCE="IIF(YCO.JAN=0,'',ROUND(YCO.JAN,2))"
	           THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(YCO.FEB=0,'',ROUND(YCO.FEB,2))"
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE="IIF(YCO.MAR=0,'',ROUND(YCO.MAR,2))"
	           THISFORM.GRID1.COLUMN6.CONTROLSOURCE="IIF(YCO.APR=0,'',ROUND(YCO.APR,2))"
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE="IIF(YCO.MAY=0,'',ROUND(YCO.MAY,2))"
	           THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(YCO.JUN=0,'',ROUND(YCO.JUN,2))"
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE="IIF(YCO.JUL=0,'',ROUND(YCO.JUL,2))"
	           THISFORM.GRID1.COLUMN10.CONTROLSOURCE="IIF(YCO.AUG=0,'',ROUND(YCO.AUG,2))"
	           THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(YCO.SEP=0,'',ROUND(YCO.SEP,2))"
	           THISFORM.GRID1.COLUMN12.CONTROLSOURCE="IIF(YCO.OCT=0,'',ROUND(YCO.OCT,2))"
	           THISFORM.GRID1.COLUMN13.CONTROLSOURCE="IIF(YCO.NOV=0,'',ROUND(YCO.NOV,2))"
	           THISFORM.GRID1.COLUMN14.CONTROLSOURCE="IIF(YCO.DEC=0,'',ROUND(YCO.DEC,2))"
	           THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='出貨總金額'
	           THISFORM.GRID1.COLUMN15.CONTROLSOURCE="IIF(YCO.SUM_TOL=0,'',ROUND(YCO.SUM_TOL,2))"                    
        CASE THIS.DISPLAYVALUE='依出貨金額(由大到小)排列'  
	            SET ORDER TO YCO_2
      	           THISFORM.CMND1.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無ABC分類的權限 
      	           THISFORM.CMND2.ENABLED=IIF(A02.F08='*',.T.,.F.) 
      	           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
      	           THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	           THISFORM.GRID1.COLUMN3.CONTROLSOURCE="IIF(YCO.JAN=0,'',ROUND(YCO.JAN,2))"
	           THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(YCO.FEB=0,'',ROUND(YCO.FEB,2))"
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE="IIF(YCO.MAR=0,'',ROUND(YCO.MAR,2))"
	           THISFORM.GRID1.COLUMN6.CONTROLSOURCE="IIF(YCO.APR=0,'',ROUND(YCO.APR,2))"
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE="IIF(YCO.MAY=0,'',ROUND(YCO.MAY,2))"
	           THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(YCO.JUN=0,'',ROUND(YCO.JUN,2))"
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE="IIF(YCO.JUL=0,'',ROUND(YCO.JUL,2))"
	           THISFORM.GRID1.COLUMN10.CONTROLSOURCE="IIF(YCO.AUG=0,'',ROUND(YCO.AUG,2))"
	           THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(YCO.SEP=0,'',ROUND(YCO.SEP,2))"
	           THISFORM.GRID1.COLUMN12.CONTROLSOURCE="IIF(YCO.OCT=0,'',ROUND(YCO.OCT,2))"
	           THISFORM.GRID1.COLUMN13.CONTROLSOURCE="IIF(YCO.NOV=0,'',ROUND(YCO.NOV,2))"
	           THISFORM.GRID1.COLUMN14.CONTROLSOURCE="IIF(YCO.DEC=0,'',ROUND(YCO.DEC,2))"
	           THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='出貨總金額'
	           THISFORM.GRID1.COLUMN15.CONTROLSOURCE="IIF(YCO.SUM_TOL=0,'',ROUND(YCO.SUM_TOL,2))"           	           
        CASE THIS.DISPLAYVALUE='依業務編號(出貨數量)排列' 
                   KEY_CK=2
                   SET ORDER TO YCO_1
                   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
                   THISFORM.CMND2.ENABLED=IIF(A02.F07='*',.T.,.F.)
                   THISFORM.CMND1.ENABLED=.F.
                   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.  
	           THISFORM.GRID1.COLUMN3.CONTROLSOURCE="IIF(YCO.JAN_AOT=0,'',YCO.JAN_AOT)"
	           THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(YCO.FEB_AOT=0,'',YCO.FEB_AOT)"
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE="IIF(YCO.MAR_AOT=0,'',YCO.MAR_AOT)"
	           THISFORM.GRID1.COLUMN6.CONTROLSOURCE="IIF(YCO.APR_AOT=0,'',YCO.APR_AOT)"
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE="IIF(YCO.MAY_AOT=0,'',YCO.MAY_AOT)"
	           THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(YCO.JUN_AOT=0,'',YCO.JUN_AOT)"
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE="IIF(YCO.JUL_AOT=0,'',YCO.JUL_AOT)"
	           THISFORM.GRID1.COLUMN10.CONTROLSOURCE="IIF(YCO.AUG_AOT=0,'',YCO.AUG_AOT)"
	           THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(YCO.SEP_AOT=0,'',YCO.SEP_AOT)"
	           THISFORM.GRID1.COLUMN12.CONTROLSOURCE="IIF(YCO.OCT_AOT=0,'',YCO.OCT_AOT)"
	           THISFORM.GRID1.COLUMN13.CONTROLSOURCE="IIF(YCO.NOV_AOT=0,'',YCO.NOV_AOT)"
	           THISFORM.GRID1.COLUMN14.CONTROLSOURCE="IIF(YCO.DEC_AOT=0,'',YCO.DEC_AOT)"
	           THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='出貨總數量'
	           THISFORM.GRID1.COLUMN15.CONTROLSOURCE="IIF(YCO.SUM_TO_AOT=0,'',YCO.SUM_TO_AOT)"                           
        CASE THIS.DISPLAYVALUE='依出貨數量(由大到小)排列'       
	            SET ORDER TO YCO_3
      	           THISFORM.CMND1.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無ABC分類的權限 
      	           THISFORM.CMND2.ENABLED=IIF(A02.F08='*',.T.,.F.) 
      	           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
      	           THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.           
	           THISFORM.GRID1.COLUMN3.CONTROLSOURCE="IIF(YCO.JAN_AOT=0,'',YCO.JAN_AOT)"
	           THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(YCO.FEB_AOT=0,'',YCO.FEB_AOT)"
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE="IIF(YCO.MAR_AOT=0,'',YCO.MAR_AOT)"
	           THISFORM.GRID1.COLUMN6.CONTROLSOURCE="IIF(YCO.APR_AOT=0,'',YCO.APR_AOT)"
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE="IIF(YCO.MAY_AOT=0,'',YCO.MAY_AOT)"
	           THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(YCO.JUN_AOT=0,'',YCO.JUN_AOT)"
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE="IIF(YCO.JUL_AOT=0,'',YCO.JUL_AOT)"
	           THISFORM.GRID1.COLUMN10.CONTROLSOURCE="IIF(YCO.AUG_AOT=0,'',YCO.AUG_AOT)"
	           THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(YCO.SEP_AOT=0,'',YCO.SEP_AOT)"
	           THISFORM.GRID1.COLUMN12.CONTROLSOURCE="IIF(YCO.OCT_AOT=0,'',YCO.OCT_AOT)"
	           THISFORM.GRID1.COLUMN13.CONTROLSOURCE="IIF(YCO.NOV_AOT=0,'',YCO.NOV_AOT)"
	           THISFORM.GRID1.COLUMN14.CONTROLSOURCE="IIF(YCO.DEC_AOT=0,'',YCO.DEC_AOT)"
	           THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='出貨總數量'
	           THISFORM.GRID1.COLUMN15.CONTROLSOURCE="IIF(YCO.SUM_TO_AOT=0,'',YCO.SUM_TO_AOT)"          	                	      
   ENDCASE
   JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
   THISFORM.GRID1.REFRESH
   THISFORM.GRID1.SETFOCUS
  ENDPROC
**********************************************************                      
    PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS XCOLINDEX 
         FCH=THISFORM.ACTIVECONTROL.NAME  
         CHK=''         
         THISFORM.REFRESH
    ENDPROC
**********************列印ABC分類
PROCEDURE CMND1.CLICK
NOW_POINT=YCO.F18
              IF  THISFORM.KEY_LIST.DISPLAYVALUE='依出貨金額(由大到小)排列'   
		    SELECT * FROM YCO ORDER BY SUM_TOL DESC INTO CURSOR YCO_TEMP
		    CALC SUM(YCO_TEMP.SUM_TOL) TO TOLMOY  &&出貨總金額	    
		    N=RECCOUNT('YCO_TEMP')
		    SELECT YCO_TEMP
		    GO TOP
		    ACC=YCO_TEMP.SUM_TOL
		    CREATE CURSOR ABC;
		    (F18 C(5),F033 C(8),JAN N(17,6),FEB N(17,6),MAR N(17,6),APR N(17,6),MAY N(17,6),JUN N(17,6),JUL N(17,6),AUG N(17,6),SEP N(17,6),OCT N(17,6),NOV N(17,6),DEC N(17,6),MONEY N(20,6),PER B(4),ACCMOY N(20,6),ACCPER B(4),CLA C(1),SUM_TOL N(17,6))		    
		    INDE ON SUM_TOL  DESC  TAG ABC_1
		    SELECT  ABC 
		    APPEND BLANK
		    REPLACE F18 WITH YCO_TEMP.F18
		    REPLACE F033 WITH YCO_TEMP.F033
		    REPLACE JAN WITH YCO_TEMP.JAN 
		    REPLACE FEB WITH YCO_TEMP.FEB 
		    REPLACE MAR WITH YCO_TEMP.MAR
		    REPLACE APR WITH YCO_TEMP.APR 
		    REPLACE MAY WITH YCO_TEMP.MAY 
		    REPLACE JUN WITH YCO_TEMP.JUN 
		    REPLACE JUL WITH YCO_TEMP.JUL 
		    REPLACE AUG WITH YCO_TEMP.AUG
		    REPLACE SEP WITH YCO_TEMP.SEP 
		    REPLACE OCT WITH YCO_TEMP.OCT 
		    REPLACE NOV WITH YCO_TEMP.NOV
		    REPLACE DEC WITH YCO_TEMP.DEC
		    REPLACE MONEY WITH YCO_TEMP.SUM_TOL  &&出貨金額
		    REPLACE PER WITH (YCO_TEMP.SUM_TOL/TOLMOY)*100   &&金額百分比
		    REPLACE ACCMOY WITH ACC					&&累計出貨金額
		    REPLACE ACCPER WITH (ACC/TOLMOY)*100		&&累計百分比
		    REPLACE SUM_TOL WITH YCO_TEMP.SUM_TOL
		    REPLACE CLA WITH IIF(ABC.ACCPER<=INT_191,'A',IIF(ABC.ACCPER>INT_192,'C','B')) &&類別
		    SELECT  YCO_TEMP
		    SKIP 1
		    FOR I=1 TO N-1
			    ACC=ACC+YCO_TEMP.SUM_TOL
			    SELECT ABC
			    APPEND BLANK
			    REPLACE F18 WITH YCO_TEMP.F18
		    	    REPLACE F033 WITH YCO_TEMP.F033
			    REPLACE JAN WITH YCO_TEMP.JAN 
			    REPLACE FEB WITH YCO_TEMP.FEB 
			    REPLACE MAR WITH YCO_TEMP.MAR
			    REPLACE APR WITH YCO_TEMP.APR 
			    REPLACE MAY WITH YCO_TEMP.MAY 
			    REPLACE JUN WITH YCO_TEMP.JUN 
			    REPLACE JUL WITH YCO_TEMP.JUL 
			    REPLACE AUG WITH YCO_TEMP.AUG
			    REPLACE SEP WITH YCO_TEMP.SEP 
			    REPLACE OCT WITH YCO_TEMP.OCT 
			    REPLACE NOV WITH YCO_TEMP.NOV
			    REPLACE DEC WITH YCO_TEMP.DEC
			    REPLACE MONEY WITH YCO_TEMP.SUM_TOL
			    REPLACE PER WITH (YCO_TEMP.SUM_TOL/TOLMOY)*100
			    REPLACE ACCMOY WITH ACC
			    REPLACE ACCPER WITH (ACC/TOLMOY)*100
			    REPLACE SUM_TOL WITH YCO_TEMP.SUM_TOL
			    REPLACE CLA WITH IIF(ABC.ACCPER<=INT_191,'A',IIF(ABC.ACCPER>INT_192,'C','B')) &&類別
			    SELECT YCO_TEMP
			    SKIP
		    ENDFOR
		    SELECT YCO_TEMP
		    USE
		    SELECT ABC
		    SET ORDER TO ABC_1
		    REPORT FORM ALLTRIM(INT_116)+'C99DD_1' PREVIEW
		    CLEAR
		    SELECT ABC
		    USE
		    SELECT  YCO
		    SET ORDER TO YCO_1	       
		    SEEK NOW_POINT
		    SET ORDER TO YCO_2   
	ELSE	    
		    SELECT * FROM YCO ORDER BY SUM_TO_AOT DESC INTO CURSOR YCO_TEMP
		    CALC SUM(YCO_TEMP.SUM_TO_AOT) TO TOLMOY  &&出貨總數量	    
		    N=RECCOUNT('YCO_TEMP')
		    SELECT YCO_TEMP
		    GO TOP
		    ACC=YCO_TEMP.SUM_TO_AOT
		    CREATE CURSOR ABC;
		    (F18 C(5),F033 C(8),JAN N(11),FEB N(11),MAR N(11),APR N(11),MAY N(11),JUN N(11),JUL N(11),AUG N(11),SEP N(11),OCT N(11),NOV N(11),DEC N(11),MONEY N(20),PER B(4),ACCMOY N(20),ACCPER B(4),CLA C(1),SUM_TOL N(17))
		    INDE ON SUM_TOL  DESC TAG ABC_1
		    SELECT  ABC 
		    APPEND BLANK
		    REPLACE F18 WITH YCO_TEMP.F18
		    REPLACE F033 WITH YCO_TEMP.F033
		    REPLACE JAN WITH YCO_TEMP.JAN_AOT 
		    REPLACE FEB WITH YCO_TEMP.FEB_AOT 
		    REPLACE MAR WITH YCO_TEMP.MAR_AOT
		    REPLACE APR WITH YCO_TEMP.APR_AOT 
		    REPLACE MAY WITH YCO_TEMP.MAY_AOT 
		    REPLACE JUN WITH YCO_TEMP.JUN_AOT 
		    REPLACE JUL WITH YCO_TEMP.JUL_AOT 
		    REPLACE AUG WITH YCO_TEMP.AUG_AOT
		    REPLACE SEP WITH YCO_TEMP.SEP_AOT 
		    REPLACE OCT WITH YCO_TEMP.OCT_AOT 
		    REPLACE NOV WITH YCO_TEMP.NOV_AOT
		    REPLACE DEC WITH YCO_TEMP.DEC_AOT 
		    REPLACE MONEY WITH YCO_TEMP.SUM_TO_AOT				&&出貨數量
		    REPLACE  PER WITH (YCO_TEMP.SUM_TO_AOT/TOLMOY)*100   &&數量百分比
		    REPLACE  ACCMOY WITH ACC					&&累計出貨數量
		    REPLACE  ACCPER WITH (ACC/TOLMOY)*100   &&累計百分比
		    REPLACE  SUM_TOL WITH YCO_TEMP.SUM_TO_AOT
		    REPLACE CLA WITH IIF(ABC.ACCPER<=INT_191,'A',IIF(ABC.ACCPER>INT_192,'C','B')) &&類別
		    SELECT  YCO_TEMP
		    SKIP 1
		    FOR I=1 TO N-1
			    ACC=ACC+YCO_TEMP.SUM_TO_AOT
			    SELECT ABC
			    APPEND BLANK
			    REPLACE F18 WITH YCO_TEMP.F18
			    REPLACE F033 WITH YCO_TEMP.F033
			    REPLACE JAN WITH YCO_TEMP.JAN_AOT 
			    REPLACE FEB WITH YCO_TEMP.FEB_AOT 
			    REPLACE MAR WITH YCO_TEMP.MAR_AOT
			    REPLACE APR WITH YCO_TEMP.APR_AOT 
			    REPLACE MAY WITH YCO_TEMP.MAY_AOT 
			    REPLACE JUN WITH YCO_TEMP.JUN_AOT 
			    REPLACE JUL WITH YCO_TEMP.JUL_AOT 
			    REPLACE AUG WITH YCO_TEMP.AUG_AOT
			    REPLACE SEP WITH YCO_TEMP.SEP_AOT 
			    REPLACE OCT WITH YCO_TEMP.OCT_AOT 
			    REPLACE NOV WITH YCO_TEMP.NOV_AOT
			    REPLACE DEC WITH YCO_TEMP.DEC_AOT
			    REPLACE MONEY WITH YCO_TEMP.SUM_TO_AOT
			    REPLACE  PER WITH (YCO_TEMP.SUM_TO_AOT/TOLMOY)*100
			    REPLACE  ACCMOY WITH ACC
			    REPLACE  ACCPER WITH (ACC/TOLMOY)*100
			    REPLACE  SUM_TOL WITH YCO_TEMP.SUM_TO_AOT
			    REPLACE CLA WITH IIF(ABC.ACCPER<=INT_191,'A',IIF(ABC.ACCPER>INT_192,'C','B')) &&類別
			    SELECT YCO_TEMP
			    SKIP
		    ENDFOR
		    SELECT YCO_TEMP
		    USE
		    SELECT ABC
		    SET ORDER TO ABC_1
		    REPORT FORM ALLTRIM(INT_116)+'C99DD_2' PREVIEW
		    CLEAR
		    SELECT ABC
		    USE
		    SELECT  YCO
		    SET ORDER TO YCO_1	       
		    SEEK NOW_POINT
		    SET ORDER TO YCO_3	
	ENDIF
	THISFORM.GRID1.SETFOCUS 			    
 ENDPROC    
**********************轉EXCEL
PROCEDURE CMND2.CLICK 
NOW_POINT=YCO.F18
            IF THISFORM.KEY_LIST.DISPLAYVALUE='依業務編號(出貨金額)排列'    .OR. THISFORM.KEY_LIST.DISPLAYVALUE='依業務編號(出貨數量)排列'	
	     	 CREATE CURSOR YCO_SUM;
	    	 (JAN N(17,6),FEB N(17,6),MAR N(17,6),APR N(17,6),MAY N(17,6),JUN N(17,6),JUL N(17,6),AUG N(17,6),SEP N(17,6),OCT N(17,6),NOV N(17,6),DEC N(17,6),SUM_TOL N(17,6),;
	    	  JAN_AOT N(11),FEB_AOT N(11),MAR_AOT N(11),APR_AOT N(11),MAY_AOT N(11),JUN_AOT N(11),JUL_AOT N(11),AUG_AOT N(11),SEP_AOT N(11),OCT_AOT N(11),NOV_AOT N(11),DEC_AOT N(11),SUM_TO_AOT N(17))
	    	 SELECT YCO_SUM
	    	 APPEND BLANK 
     		 SELECT YCO
     		 GO TOP
     		 DO WHILE !EOF()
     		       SELECT YCO_SUM
     		       REPLACE JAN WITH  YCO.JAN+YCO_SUM.JAN
     		       REPLACE FEB WITH  YCO.FEB+YCO_SUM.FEB 
     		       REPLACE MAR WITH  YCO.MAR+YCO_SUM.MAR
     		       REPLACE APR WITH  YCO.APR+YCO_SUM.APR 
     		       REPLACE MAY WITH  YCO.MAY+YCO_SUM.MAY 
     		       REPLACE JUN WITH  YCO.JUN+YCO_SUM.JUN 
     		       REPLACE JUL WITH  YCO.JUL+YCO_SUM.JUL 
     		       REPLACE AUG WITH  YCO.AUG+YCO_SUM.AUG 
     		       REPLACE SEP WITH  YCO.SEP+YCO_SUM.SEP 
     		       REPLACE OCT WITH  YCO.OCT+YCO_SUM.OCT 
     		       REPLACE NOV WITH  YCO.NOV+YCO_SUM.NOV 
     		       REPLACE DEC WITH  YCO.DEC+YCO_SUM.DEC 
     		       REPLACE SUM_TOL WITH  YCO.SUM_TOL+YCO_SUM.SUM_TOL 
     		       *****
     		       REPLACE JAN_AOT WITH  YCO.JAN_AOT+YCO_SUM.JAN_AOT
     		       REPLACE FEB_AOT WITH  YCO.FEB_AOT+YCO_SUM.FEB_AOT 
     		       REPLACE MAR_AOT WITH  YCO.MAR_AOT+YCO_SUM.MAR_AOT
     		       REPLACE APR_AOT WITH  YCO.APR_AOT+YCO_SUM.APR_AOT 
     		       REPLACE MAY_AOT WITH  YCO.MAY_AOT+YCO_SUM.MAY_AOT 
     		       REPLACE JUN_AOT WITH  YCO.JUN_AOT+YCO_SUM.JUN_AOT 
     		       REPLACE JUL_AOT WITH  YCO.JUL_AOT+YCO_SUM.JUL_AOT 
     		       REPLACE AUG_AOT WITH  YCO.AUG_AOT+YCO_SUM.AUG_AOT 
     		       REPLACE SEP_AOT WITH  YCO.SEP_AOT+YCO_SUM.SEP_AOT 
     		       REPLACE OCT_AOT WITH  YCO.OCT_AOT+YCO_SUM.OCT_AOT 
     		       REPLACE NOV_AOT WITH  YCO.NOV_AOT+YCO_SUM.NOV_AOT 
     		       REPLACE DEC_AOT WITH  YCO.DEC_AOT+YCO_SUM.DEC_AOT 
     		       REPLACE SUM_TO_AOT WITH  YCO.SUM_TO_AOT+YCO_SUM.SUM_TO_AOT      		       
     		       SELECT YCO
     		       SKIP
     		 ENDDO
     		 IF THISFORM.KEY_LIST.DISPLAYVALUE='依業務編號(出貨金額)排列' 	
		      SELECT F18 業務編號,F033 業務姓名,ROUND(JAN,2) 一月,ROUND(FEB,2) 二月,ROUND(MAR,2) 三月,ROUND(APR,2) 四月,;
		   		  ROUND(MAY,2) 五月,ROUND(JUN,2) 六月,ROUND(JUL,2) 七月,ROUND(AUG,2) 八月,ROUND(SEP,2) 九月,;
		   		  ROUND(OCT,2) 十月,ROUND(NOV,2) 十一月,ROUND(DEC,2) 十二月,ROUND(SUM_TOL,2) 出貨總金額;
			          FROM YCO ORDER BY F18  INTO CURSOR YCO_TEMP READWRITE 
		      SELECT YCO_TEMP
		      APPEND BLANK 
		      REPLACE YCO_TEMP.業務姓名  WITH '月份合計'
		      REPLACE YCO_TEMP.一月  WITH ROUND(YCO_SUM.JAN,2)
		      REPLACE YCO_TEMP.二月  WITH ROUND(YCO_SUM.FEB,2)
		      REPLACE YCO_TEMP.三月  WITH ROUND(YCO_SUM.MAR,2)
		      REPLACE YCO_TEMP.四月  WITH ROUND(YCO_SUM.APR,2)
		      REPLACE YCO_TEMP.五月  WITH ROUND(YCO_SUM.MAY,2)
		      REPLACE YCO_TEMP.六月  WITH ROUND(YCO_SUM.JUN,2)
		      REPLACE YCO_TEMP.七月  WITH ROUND(YCO_SUM.JUL,2)
		      REPLACE YCO_TEMP.八月  WITH ROUND(YCO_SUM.AUG,2)
		      REPLACE YCO_TEMP.九月  WITH ROUND(YCO_SUM.SEP,2)
		      REPLACE YCO_TEMP.十月  WITH ROUND(YCO_SUM.OCT,2)
		      REPLACE YCO_TEMP.十一月  WITH ROUND(YCO_SUM.NOV,2)
		      REPLACE YCO_TEMP.十二月  WITH ROUND(YCO_SUM.DEC,2)
 	              REPLACE YCO_TEMP.出貨總金額  WITH ROUND(YCO_SUM.SUM_TOL,2)
	 	      SAL='業務員別'+YEAR_STR+'年度出貨金額分析'+IIF(ALLTRIM(UKEF)='YN' ,'(全部)',IIF(ALLTRIM(UKEF)='Y','(製品)','(部品)'))
		      GCDELIMFILE=PUTFILE('儲存路徑',SAL,'XLS')
		      IF !EMPTY(GCDELIMFILE) 
		          ON ERROR DO FILE_IMPACT
		          COPY TO (GCDELIMFILE) TYPE XL5     
		          =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
	              ENDIF                    
		  ELSE
		      SELECT F18 業務編號,F033 業務姓名,JAN_AOT 一月,FEB_AOT 二月,MAR_AOT 三月,APR_AOT 四月,;
		   		  MAY_AOT 五月,JUN_AOT 六月,JUL_AOT 七月,AUG_AOT 八月,SEP_AOT 九月,;
		   		  OCT_AOT 十月,NOV_AOT 十一月,DEC_AOT 十二月,SUM_TO_AOT 出貨總數量;
			          FROM YCO ORDER BY F18  INTO CURSOR YCO_TEMP READWRITE 	
		      SELECT YCO_TEMP
		      APPEND BLANK 
		      REPLACE YCO_TEMP.業務姓名  WITH '月份合計'
		      REPLACE YCO_TEMP.一月  WITH YCO_SUM.JAN_AOT
		      REPLACE YCO_TEMP.二月  WITH YCO_SUM.FEB_AOT
		      REPLACE YCO_TEMP.三月  WITH YCO_SUM.MAR_AOT
		      REPLACE YCO_TEMP.四月  WITH YCO_SUM.APR_AOT
		      REPLACE YCO_TEMP.五月  WITH YCO_SUM.MAY_AOT
		      REPLACE YCO_TEMP.六月  WITH YCO_SUM.JUN_AOT
		      REPLACE YCO_TEMP.七月  WITH YCO_SUM.JUL_AOT
		      REPLACE YCO_TEMP.八月  WITH YCO_SUM.AUG_AOT
		      REPLACE YCO_TEMP.九月  WITH YCO_SUM.SEP_AOT
		      REPLACE YCO_TEMP.十月  WITH YCO_SUM.OCT_AOT
		      REPLACE YCO_TEMP.十一月  WITH YCO_SUM.NOV_AOT
		      REPLACE YCO_TEMP.十二月  WITH YCO_SUM.DEC_AOT
 	              REPLACE YCO_TEMP.出貨總數量  WITH YCO_SUM.SUM_TO_AOT
	 	      SAL='業務員別'+YEAR_STR+'年度出貨數量分析'+IIF(ALLTRIM(UKEF)='YN' ,'(全部)',IIF(ALLTRIM(UKEF)='Y','(製品)','(部品)'))
		      GCDELIMFILE=PUTFILE('儲存路徑',SAL,'XLS')
		      IF !EMPTY(GCDELIMFILE) 
		          ON ERROR DO FILE_IMPACT
		          COPY TO (GCDELIMFILE) TYPE XL5     
		          =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
	              ENDIF      
	          ENDIF        
		      SELECT YCO_SUM
		      USE
		      SELECT YCO_TEMP
		      USE
		      SELECT YCO
		      SET ORDER TO YCO_1
		      SEEK NOW_POINT 	  	              		          	   
	   ELSE	  	          
                    IF    THISFORM.KEY_LIST.DISPLAYVALUE='依出貨金額(由大到小)排列' 
			    SELECT * FROM YCO ORDER BY SUM_TOL DESC INTO CURSOR YCO_TEMP
			    CALC SUM(YCO_TEMP.SUM_TOL) TO TOLMOY  &&出貨總金額	    
			    N=RECCOUNT('YCO_TEMP')
			    SELECT YCO_TEMP
			    GO TOP
			    ACC=YCO_TEMP.SUM_TOL
			    CREATE CURSOR ABC;
			    (F18 C(5),F033 C(8),JAN N(17,6),FEB N(17,6),MAR N(17,6),APR N(17,6),MAY N(17,6),JUN N(17,6),JUL N(17,6),AUG N(17,6),SEP N(17,6),OCT N(17,6),NOV N(17,6),DEC N(17,6),;
			            MONEY N(20,6),PER B(4),ACCMOY N(20,6),ACCPER B(4),CLA C(1),SUM_TOL N(17,6))
			    SELECT  ABC 
			    APPEND BLANK
			    REPLACE F18 WITH YCO_TEMP.F18
			    REPLACE F033 WITH YCO_TEMP.F033
			    REPLACE JAN WITH YCO_TEMP.JAN 
			    REPLACE FEB WITH YCO_TEMP.FEB 
			    REPLACE MAR WITH YCO_TEMP.MAR
			    REPLACE APR WITH YCO_TEMP.APR 
			    REPLACE MAY WITH YCO_TEMP.MAY 
			    REPLACE JUN WITH YCO_TEMP.JUN 
			    REPLACE JUL WITH YCO_TEMP.JUL 
			    REPLACE AUG WITH YCO_TEMP.AUG
			    REPLACE SEP WITH YCO_TEMP.SEP 
			    REPLACE OCT WITH YCO_TEMP.OCT 
			    REPLACE NOV WITH YCO_TEMP.NOV
			    REPLACE DEC WITH YCO_TEMP.DEC 
			    REPLACE MONEY WITH YCO_TEMP.SUM_TOL				&&出貨金額
			    REPLACE  PER WITH (YCO_TEMP.SUM_TOL/TOLMOY)*100   &&金額百分比
			    REPLACE  ACCMOY WITH ACC					&&累計出貨金額
			    REPLACE  ACCPER WITH (ACC/TOLMOY)*100   &&累計百分比
			    REPLACE  SUM_TOL WITH YCO_TEMP.SUM_TOL
			    REPLACE CLA WITH IIF(ABC.ACCPER<=INT_191,'A',IIF(ABC.ACCPER>INT_192,'C','B')) &&類別
			    SELECT  YCO_TEMP
			    SKIP 1
			    FOR I=1 TO N-1
				    ACC=ACC+YCO_TEMP.SUM_TOL
				    SELECT ABC
				    APPEND BLANK
				    REPLACE F18 WITH YCO_TEMP.F18
				    REPLACE F033 WITH YCO_TEMP.F033
				    REPLACE JAN WITH YCO_TEMP.JAN 
				    REPLACE FEB WITH YCO_TEMP.FEB 
				    REPLACE MAR WITH YCO_TEMP.MAR
				    REPLACE APR WITH YCO_TEMP.APR 
				    REPLACE MAY WITH YCO_TEMP.MAY 
				    REPLACE JUN WITH YCO_TEMP.JUN 
				    REPLACE JUL WITH YCO_TEMP.JUL 
				    REPLACE AUG WITH YCO_TEMP.AUG
				    REPLACE SEP WITH YCO_TEMP.SEP 
				    REPLACE OCT WITH YCO_TEMP.OCT 
				    REPLACE NOV WITH YCO_TEMP.NOV
				    REPLACE DEC WITH YCO_TEMP.DEC
				    REPLACE MONEY WITH YCO_TEMP.SUM_TOL
				    REPLACE  PER WITH (YCO_TEMP.SUM_TOL/TOLMOY)*100
				    REPLACE  ACCMOY WITH ACC
				    REPLACE  ACCPER WITH (ACC/TOLMOY)*100
				    REPLACE  SUM_TOL WITH YCO_TEMP.SUM_TOL
				    REPLACE CLA WITH IIF(ABC.ACCPER<=INT_191,'A',IIF(ABC.ACCPER>INT_192,'C','B')) &&類別
				    SELECT YCO_TEMP
				    SKIP
			    ENDFOR
			    SELECT YCO_TEMP
			    USE
			    SELECT SUM(JAN),SUM(FEB),SUM(MAR),SUM(APR),SUM(MAY),SUM(JUN),SUM(JUL),;
			                   SUM(AUG),SUM(SEP),SUM(OCT),SUM(NOV),SUM(DEC),SUM(MONEY) FROM ABC INTO CURSOR ABC_1      			    
			    SELECT F18 業務編號,F033 業務姓名,ROUND(JAN,2) 一月,ROUND(FEB,2) 二月,ROUND(MAR,2) 三月,ROUND(APR,2) 四月,;
			                   ROUND(MAY,2) 五月,ROUND(JUN,2) 六月,ROUND(JUL,2) 七月,ROUND(AUG,2) 八月,ROUND(SEP,2) 九月,ROUND(OCT,2) 十月,;
			                   ROUND(NOV,2) 十一月,ROUND(DEC,2) 十二月,ROUND(MONEY,2) 出貨金額,PER 金額百分比,ROUND(ACCMOY,2) 累計出貨金額,;
			                   ACCPER 累計百分比,CLA 類別 FROM ABC ORDER BY SUM_TOL  DESC  INTO CURSOR ABC_TEMP READWRITE  	
			    SELECT ABC_TEMP
			    APPEND BLANK 
			    REPLACE ABC_TEMP.業務姓名  WITH '月份合計'
			    REPLACE ABC_TEMP.一月  WITH ABC_1.SUM_JAN
			    REPLACE ABC_TEMP.二月  WITH ABC_1.SUM_FEB
			    REPLACE ABC_TEMP.三月  WITH ABC_1.SUM_MAR
			    REPLACE ABC_TEMP.四月  WITH ABC_1.SUM_APR
			    REPLACE ABC_TEMP.五月  WITH ABC_1.SUM_MAY
			    REPLACE ABC_TEMP.六月  WITH ABC_1.SUM_JUN
			    REPLACE ABC_TEMP.七月  WITH ABC_1.SUM_JUL
			    REPLACE ABC_TEMP.八月  WITH ABC_1.SUM_AUG
			    REPLACE ABC_TEMP.九月  WITH ABC_1.SUM_SEP
			    REPLACE ABC_TEMP.十月  WITH ABC_1.SUM_OCT
			    REPLACE ABC_TEMP.十一月  WITH ABC_1.SUM_NOV
			    REPLACE ABC_TEMP.十二月  WITH ABC_1.SUM_DEC
	 	            REPLACE ABC_TEMP.出貨金額  WITH ABC_1.SUM_MONEY				                   	                   
			    SAL='業務員別'+YEAR_STR+'年度出貨金額ABC分類'	+IIF(ALLTRIM(UKEF)='YN' ,'(全部)',IIF(ALLTRIM(UKEF)='Y','(製品)','(部品)'))
		            GCDELIMFILE=PUTFILE('儲存路徑',SAL,'XLS')
		            IF !EMPTY(GCDELIMFILE) 
		                ON ERROR DO FILE_IMPACT
		           	COPY TO (GCDELIMFILE) TYPE XL5     
		                =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
			    ENDIF                            
			    SELECT ABC_TEMP
			    USE         
			    SELECT ABC_1
			    USE    
			    SELECT  YCO
			    SET ORDER TO YCO_1	       
			    SEEK NOW_POINT
			    SET ORDER TO YCO_2  
		     ELSE
			    SELECT * FROM YCO ORDER BY SUM_TO_AOT DESC INTO CURSOR YCO_TEMP
			    CALC SUM(YCO_TEMP.SUM_TO_AOT) TO TOLMOY  &&出貨總數量	    
			    N=RECCOUNT('YCO_TEMP')
			    SELECT YCO_TEMP
			    GO TOP
			    ACC=YCO_TEMP.SUM_TO_AOT
			    CREATE CURSOR ABC;
			    (F18 C(5),F033 C(8),JAN N(11),FEB N(11),MAR N(11),APR N(11),MAY N(11),JUN N(11),JUL N(11),AUG N(11),SEP N(11),OCT N(11),NOV N(11),DEC N(11),;
			            MONEY N(20),PER B(4),ACCMOY N(20),ACCPER B(4),CLA C(1),SUM_TOL N(17))	
			    SELECT  ABC 
			    APPEND BLANK
			    REPLACE F18 WITH YCO_TEMP.F18
			    REPLACE F033 WITH YCO_TEMP.F033
			    REPLACE JAN WITH YCO_TEMP.JAN_AOT 
			    REPLACE FEB WITH YCO_TEMP.FEB_AOT 
			    REPLACE MAR WITH YCO_TEMP.MAR_AOT
			    REPLACE APR WITH YCO_TEMP.APR_AOT 
			    REPLACE MAY WITH YCO_TEMP.MAY_AOT 
			    REPLACE JUN WITH YCO_TEMP.JUN_AOT 
			    REPLACE JUL WITH YCO_TEMP.JUL_AOT 
			    REPLACE AUG WITH YCO_TEMP.AUG_AOT
			    REPLACE SEP WITH YCO_TEMP.SEP_AOT 
			    REPLACE OCT WITH YCO_TEMP.OCT_AOT 
			    REPLACE NOV WITH YCO_TEMP.NOV_AOT
			    REPLACE DEC WITH YCO_TEMP.DEC_AOT 
			    REPLACE MONEY WITH YCO_TEMP.SUM_TO_AOT				&&出貨數量
			    REPLACE  PER WITH (YCO_TEMP.SUM_TO_AOT/TOLMOY)*100   &&金額百分比
			    REPLACE  ACCMOY WITH ACC					&&累計出貨數量
			    REPLACE  ACCPER WITH (ACC/TOLMOY)*100   &&累計百分比
			    REPLACE  SUM_TOL WITH YCO_TEMP.SUM_TO_AOT
			    REPLACE CLA WITH IIF(ABC.ACCPER<=INT_191,'A',IIF(ABC.ACCPER>INT_192,'C','B')) &&類別
			    SELECT  YCO_TEMP
			    SKIP 1
			    FOR I=1 TO N-1
				    ACC=ACC+YCO_TEMP.SUM_TO_AOT
				    SELECT ABC
				    APPEND BLANK
				    REPLACE F18 WITH YCO_TEMP.F18
				    REPLACE F033 WITH YCO_TEMP.F033
				    REPLACE JAN WITH YCO_TEMP.JAN_AOT 
				    REPLACE FEB WITH YCO_TEMP.FEB_AOT 
				    REPLACE MAR WITH YCO_TEMP.MAR_AOT
				    REPLACE APR WITH YCO_TEMP.APR_AOT 
				    REPLACE MAY WITH YCO_TEMP.MAY_AOT 
				    REPLACE JUN WITH YCO_TEMP.JUN_AOT 
				    REPLACE JUL WITH YCO_TEMP.JUL_AOT 
				    REPLACE AUG WITH YCO_TEMP.AUG_AOT
				    REPLACE SEP WITH YCO_TEMP.SEP_AOT 
				    REPLACE OCT WITH YCO_TEMP.OCT_AOT 
				    REPLACE NOV WITH YCO_TEMP.NOV_AOT
				    REPLACE DEC WITH YCO_TEMP.DEC_AOT
				    REPLACE MONEY WITH YCO_TEMP.SUM_TO_AOT
				    REPLACE  PER WITH (YCO_TEMP.SUM_TO_AOT/TOLMOY)*100
				    REPLACE  ACCMOY WITH ACC
				    REPLACE  ACCPER WITH (ACC/TOLMOY)*100
				    REPLACE  SUM_TOL WITH YCO_TEMP.SUM_TO_AOT
				    REPLACE CLA WITH IIF(ABC.ACCPER<=INT_191,'A',IIF(ABC.ACCPER>INT_192,'C','B')) &&類別
				    SELECT YCO_TEMP
				    SKIP
			    ENDFOR
			    SELECT YCO_TEMP
			    USE
			    SELECT SUM(JAN),SUM(FEB),SUM(MAR),SUM(APR),SUM(MAY),SUM(JUN),SUM(JUL),;
			                   SUM(AUG),SUM(SEP),SUM(OCT),SUM(NOV),SUM(DEC),SUM(MONEY) FROM ABC INTO CURSOR ABC_1             
			    SELECT F18 業務編號,F033 業務姓名,JAN 一月,FEB 二月,MAR 三月,APR 四月,;
			                   MAY 五月,JUN 六月,JUL 七月,AUG 八月,SEP 九月,OCT 十月,;
			                   NOV 十一月,DEC 十二月,MONEY 出貨數量,PER 數量百分比,ACCMOY 累計出貨數量,;
			                   ACCPER 累計百分比,CLA 類別 FROM ABC ORDER BY SUM_TOL  DESC  INTO CURSOR ABC_TEMP READWRITE  
			    SELECT ABC_TEMP
			    APPEND BLANK 
			    REPLACE ABC_TEMP.業務姓名  WITH '月份合計'
			    REPLACE ABC_TEMP.一月  WITH ABC_1.SUM_JAN
			    REPLACE ABC_TEMP.二月  WITH ABC_1.SUM_FEB
			    REPLACE ABC_TEMP.三月  WITH ABC_1.SUM_MAR
			    REPLACE ABC_TEMP.四月  WITH ABC_1.SUM_APR
			    REPLACE ABC_TEMP.五月  WITH ABC_1.SUM_MAY
			    REPLACE ABC_TEMP.六月  WITH ABC_1.SUM_JUN
			    REPLACE ABC_TEMP.七月  WITH ABC_1.SUM_JUL
			    REPLACE ABC_TEMP.八月  WITH ABC_1.SUM_AUG
			    REPLACE ABC_TEMP.九月  WITH ABC_1.SUM_SEP
			    REPLACE ABC_TEMP.十月  WITH ABC_1.SUM_OCT
			    REPLACE ABC_TEMP.十一月  WITH ABC_1.SUM_NOV
			    REPLACE ABC_TEMP.十二月  WITH ABC_1.SUM_DEC
	 	            REPLACE ABC_TEMP.出貨數量  WITH ABC_1.SUM_MONEY	
			    SAL='業務員別'+YEAR_STR+'年度出貨數量ABC分類'	+IIF(ALLTRIM(UKEF)='YN' ,'(全部)',IIF(ALLTRIM(UKEF)='Y','(製品)','(部品)'))
		            GCDELIMFILE=PUTFILE('儲存路徑',SAL,'XLS')
		            IF !EMPTY(GCDELIMFILE) 
		                ON ERROR DO FILE_IMPACT
		           	COPY TO (GCDELIMFILE) TYPE XL5     
		                =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
			    ENDIF       
			    SELECT ABC_TEMP
			    USE         
			    SELECT ABC_1
			    USE            
			    SELECT ABC
			    USE	    
			    SELECT  YCO
			    SET ORDER TO YCO_1	       
			    SEEK NOW_POINT
			    SET ORDER TO YCO_3			            	     
	             ENDIF      
      ENDIF
     THISFORM.GRID1.SETFOCUS 	
ENDPROC 
ENDDEFINE 
*************************************************************列印
PROCEDURE PNT_PRC
      SELECT  YCO
      NOW_POINT=YCO.F18
      IF KEY_CK=1
   	  REPORT FORM ALLTRIM(INT_116)+'C99D_1' TO PRINT PROMPT PREVIEW
      ELSE
   	  REPORT FORM ALLTRIM(INT_116)+'C99D_2' TO PRINT PROMPT PREVIEW
      ENDIF  
      CLEAR
      SELE YCO
      SET ORDER TO YCO_1
      SEEK NOW_POINT
ENDPROC