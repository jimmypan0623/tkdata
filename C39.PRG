**程式名稱:C39.客戶樣品領用紀錄
SET EXCL OFF
CLOSE ALL
CLEAR 
AREA1='C39_TEMP'
EXBO='' 
FLG='0'
FCH=''
CHK=''
CHK_STR=''
B01F97='N'
IF !USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF
SET ORDER TO A01 
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK sys_oper+'C39'      
IF !USED('A23')
    SELE 0
    USE A23
ELSE 
   SELE A23
ENDIF
SET ORDER TO A231 
IF !USED('A14')
    SELE 0
    USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141
IF !USED ('C01')
   SELE 0
   USE C01 
ELSE 
   SELE C01
ENDIF
SET ORDER TO C011  
IF !USED ('B01')
   SELE 0
   USE B01 
ELSE 
   SELE B01
ENDIF
SET ORDER TO B011              
IF !USED('C39')
   SELE 0
   USE C39
ELSE
   SELE C39
ENDIF
SET ORDER TO C391     
*!*	SELECT C39.*,B01.F02 AS F021,C01.F05 AS F011,B01.F97,A01.F03 AS F061,A01.F03 AS F101 FROM C39,B01,C01,A01;
*!*	      WHERE B01.F97 = B01F97 AND C39.F06 = A01.F01 AND C39.F10 = A01.F01 AND C39.F02 = B01.F01 AND C39.F01 = C01.F01 AND LEFT(DTOS(C39.F03),6) = LEFT(DTOS(DATE()),6) INTO CURSOR C39_TEMP READWRITE
SELECT C39.*,B01.F02 AS F021,C01.F05 AS F011,B01.F97 FROM C39,B01,C01;
      WHERE B01.F97 = B01F97 AND C39.F02 = B01.F01 AND C39.F01 = C01.F01 AND LEFT(DTOS(C39.F03),6) = LEFT(DTOS(DATE()),6) INTO CURSOR C39_TEMP READWRITE
SELECT C39_TEMP
INDEX ON F01+DTOS(F03)+F02 TAG C39_TEMP1       
INDEX ON F02+DTOS(F03)+F01 TAG C39_TEMP2   
INDEX ON F06+DTOS(F03)+F02 TAG C39_TEMP3
INDEX ON F10+DTOS(F03)+F01 TAG C39_TEMP4 
SELECT C39_TEMP
SET ORDER TO C39_TEMP1
GO TOP
C39FORM=CREATEOBJECT("TKC39")
C39FORM.SHOW  
DEFINE CLASS TKC39 AS FORM
  CAPTION='C39.客戶樣品領用紀錄'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*794
  WINDOWTYPE=1
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*240 
  ADD OBJECT KEY_LIST1 AS KEY_LIST WITH;
      LEFT=INT_015*150,;
      TOP=INT_015*32,;
      WIDTH=INT_015*98   
  ADD OBJECT MTH_LIST AS MTH_LIST WITH;
      LEFT=INT_015*8,;
      WIDTH=INT_015*65 ,;
      TOP=INT_015*32  
  ADD OBJECT KEY_LIST2 AS KEY_LIST WITH;
      LEFT=INT_015*75,;
      TOP=INT_015*32,;
      WIDTH=INT_015*73  
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=12,;            
      RECORDSOURCE='C39_TEMP',; 
      TOP=INT_015*61,; 
      HEIGHT=INT_015*465,;     
      WIDTH=INT_015*783,;     
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',; 
      COLUMN4.NAME='COLUMN4',; 
      COLUMN5.NAME='COLUMN5',;             
      COLUMN6.NAME='COLUMN6',;  
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;  
      COLUMN10.NAME='COLUMN10',;    
      COLUMN11.NAME='COLUMN11',;  
      COLUMN12.NAME='COLUMN12'   
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;      
      TOP=INT_015*0,;
      LEFT=INT_015*377             
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=INT_015*0,;
      LEFT=INT_015*250,;
      ENABLED=.T.,;
      VISIBLE=.T.   
  ADD OBJECT REPLY_REMARK AS COMMANDBUTTON WITH;
      TOP=INT_015*5,;
      LEFT=INT_015*465,;
      HEIGHT=INT_015*25,;      
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<E.修改' 
  ADD OBJECT YES AS COMMANDBUTTON WITH;
      TOP=INT_015*33,;
      LEFT=INT_015*660,;
      HEIGHT=INT_015*25,;      
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<Y.確定'
  ADD OBJECT NO AS COMMANDBUTTON WITH;
      TOP=INT_015*33,;
      LEFT=INT_015*702,;
      HEIGHT=INT_015*25,;      
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<N.取消'  
  ADD OBJECT LBLF08 AS LABEL WITH;
      TOP=INT_015*38,;
      LEFT=INT_015*255,;
      HEIGHT=INT_015*23,;      
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      CAPTION='樣品追蹤'     
  ADD OBJECT TXTF08 AS TEXTBOX WITH;
      TOP=INT_015*33,;
      LEFT=INT_015*310,;
      HEIGHT=INT_015*25,;      
      WIDTH=INT_015*330,;
      MAXLENGTH=80,;
      FONTSIZE=INT_015*9   
  ADD OBJECT LBLF99 AS LABEL WITH;
      TOP=INT_015*8,;
      LEFT=INT_015*645,;
      HEIGHT=INT_015*23,;      
      WIDTH=INT_015*60,;
      FONTSIZE=INT_015*9,;
      CAPTION='安全資料'   
  ADD OBJECT LBLF991 AS LABEL WITH;
      TOP=INT_015*8,;
      LEFT=INT_015*697,;
      HEIGHT=INT_015*23,;      
      WIDTH=INT_015*100,;
      FONTSIZE=INT_015*9,;
      CAPTION=''           
  PROCEDURE INIT
       SELE C39_TEMP
       GO TOP
	   CHK_STR = THISFORM.MTH_LIST.DISPLAYVALUE
       THISFORM.ORPGROUP.NEW_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.DEL_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
       THISFORM.YES.VISIBLE=.F.
       THISFORM.NO.VISIBLE=.F. 
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX') 
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)   
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')   
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*62
       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*170
       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*100
       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*75
       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*200
       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*200
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'	          
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶簡稱'	 
  	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='領取日期'               
	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='品    號'
	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='品名規格'	   	   
  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='領用單號'   	   
  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='領用數量' 
	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='發料部門'
  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='業務' + ALLTRIM(INT_209) + '姓名'  
  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='業助姓名'  
  	   THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='樣品追蹤'
  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='備註說明' 	     	   
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C39_TEMP.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C39_TEMP.F011'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C39_TEMP.F03'
       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C39_TEMP.F02'
       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C39_TEMP.F021'
       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C39_TEMP.F04'
       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C39_TEMP.F05'
       THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F09,'A14'),A14.F02,C39_TEMP.F09)"
       THISFORM.GRID1.COLUMN9.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F06,'A01'),A01.F03,C39_TEMP.F06)"
       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F10,'A01'),A01.F03,C39_TEMP.F10)"
       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='C39_TEMP.F08'
       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C39_TEMP.F07'
       THISFORM.GRID1.READONLY=.T.
       THISFORM.GRID1.SETFOCUS  
       IF THISFORM.GRID1.ACTIVEROW=0 
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	        
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F. 
	      THISFORM.REPLY_REMARK.ENABLED=.F.  
          THISFORM.TXTF08.VALUE = ''
          THISFORM.LBLF991.CAPTION = ''
        ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	        
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
	      THISFORM.REPLY_REMARK.ENABLED=IIF(A02.F05='*',.T.,.F.)
          THISFORM.TXTF08.VALUE = C39_TEMP.F08
          THISFORM.LBLF991.CAPTION = C39_TEMP.F99
        ENDIF       
       JK='客戶編號'  
  ENDPROC          
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX       
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.TXTF08.VALUE = C39_TEMP.F08
       THISFORM.LBLF991.CAPTION = C39_TEMP.F99
       THISFORM.REFRESH
  ENDPROC       
  PROC KEY_LIST.INIT
       WITH THIS 
           .ADDITEM('依客戶編號+日期+料號 排列')
           .ADDITEM('依料品編號+日期+料號 排列')
           .ADDITEM('依業務'+ALLTRIM(INT_209)+'編號+日期+料號 排列')
           .ADDITEM('依業助編號+日期+料號 排列')
       ENDWITH     
  ENDPROC
  PROC KEY_LIST1.INIT
       WITH THIS 
           .ADDITEM('部品樣品資料')
           .ADDITEM('線材樣品資料')
       ENDWITH     
  ENDPROC
  PROC KEY_LIST2.INIT
       WITH THIS 
           .ADDITEM('月份資料')
           .ADDITEM('全部資料')
       ENDWITH     
  ENDPROC
  PROC KEY_LIST.INTERACTIVECHANGE
       SELE C39_TEMP
       DO CASE
          CASE THIS.DISPLAYVALUE='依客戶編號+日期+料號 排列'
               SET ORDER TO C39_TEMP1	
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*62
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*170
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*75
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*200
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*200
		       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'	          
		       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶簡稱'	 
		  	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='領取日期'               
			   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料    號'
			   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='品名規格'	   	   
		  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='領用單號'   	   
		  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='領用數量' 
			   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='發料部門'
		  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='業務' + ALLTRIM(INT_209) + '姓名'  
		  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='業助姓名'  
		  	   THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='樣品追蹤'
		  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='備註說明' 	     	   
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C39_TEMP.F01'
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C39_TEMP.F011'
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C39_TEMP.F03'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C39_TEMP.F02'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C39_TEMP.F021'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C39_TEMP.F04'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C39_TEMP.F05'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F09,'A14'),A14.F02,C39_TEMP.F09)"
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F06,'A01'),A01.F03,C39_TEMP.F06)"
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F10,'A01'),A01.F03,C39_TEMP.F10)"
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='C39_TEMP.F08'
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C39_TEMP.F07'
          CASE THIS.DISPLAYVALUE='依料品編號+日期+料號 排列'
               SET ORDER TO C39_TEMP2  
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*170
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*100    	
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*62
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*75
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*200
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*200
			   THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料    號'
			   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='品名規格'	
		  	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='領取日期'               
		       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='客戶編號'	          
		       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='客戶簡稱'	
		  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='領用單號'   	   
		  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='領用數量' 
		  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='發料部門'
		  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='業務' + ALLTRIM(INT_209) + '姓名'  
		  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='業助姓名'  
		  	   THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='樣品追蹤'
		  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='備註說明' 	
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C39_TEMP.F02'
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C39_TEMP.F021'     	   
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C39_TEMP.F03'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C39_TEMP.F01'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C39_TEMP.F011'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C39_TEMP.F04'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C39_TEMP.F05'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F09,'A14'),A14.F02,C39_TEMP.F09)"
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F06,'A01'),A01.F03,C39_TEMP.F06)"
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F10,'A01'),A01.F03,C39_TEMP.F10)"
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='C39_TEMP.F08'
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C39_TEMP.F07'
          CASE THIS.DISPLAYVALUE='依業務'+ALLTRIM(INT_209)+'編號+日期+料號 排列'
               SET ORDER TO C39_TEMP3       	
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*62
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*170
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*75
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*55		       
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*200
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*200
		  	   THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='業務' + ALLTRIM(INT_209) + '姓名'  
		  	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業助姓名' 
		  	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='領取日期'               
			   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料    號'
			   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='品名規格'	   	   
		  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='領用單號'   	   
		  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='領用數量'  
		  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='發料部門'  
		       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='客戶編號'	          
		       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='客戶簡稱'
		       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='樣品追蹤'
		  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='備註說明' 	
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F06,'A01'),A01.F03,C39_TEMP.F06)"
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F10,'A01'),A01.F03,C39_TEMP.F10)"
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C39_TEMP.F03'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C39_TEMP.F02'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C39_TEMP.F021'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C39_TEMP.F04'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C39_TEMP.F05'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F09,'A14'),A14.F02,C39_TEMP.F09)"
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C39_TEMP.F01'
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE='C39_TEMP.F011'
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='C39_TEMP.F08'
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C39_TEMP.F07'
          CASE THIS.DISPLAYVALUE='依業助編號+日期+料號 排列'
               SET ORDER TO C39_TEMP4       	
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*62
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*170
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*75
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*55		       
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*200
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*200
		  	   THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='業助姓名' 
		  	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業務' + ALLTRIM(INT_209) + '姓名' 
		  	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='領取日期'               
			   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料    號'
			   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='品名規格'	   	   
		  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='領用單號'   	   
		  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='領用數量'  
		  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='發料部門'  
		       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='客戶編號'	          
		       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='客戶簡稱'
		       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='樣品追蹤'
		  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='備註說明' 	
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F10,'A01'),A01.F03,C39_TEMP.F10)"
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F06,'A01'),A01.F03,C39_TEMP.F06)"
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C39_TEMP.F03'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C39_TEMP.F02'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C39_TEMP.F021'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C39_TEMP.F04'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C39_TEMP.F05'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE="IIF(SEEK(C39_TEMP.F09,'A14'),A14.F02,C39_TEMP.F09)"
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C39_TEMP.F01'
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE='C39_TEMP.F011'
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='C39_TEMP.F08'
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C39_TEMP.F07' 
       ENDCASE  
       JK=IIF(THIS.VALUE=3,'業務'+ALLTRIM(INT_209)+'編號',THISFORM.GRID1.COLUMN1.HEADER1.CAPTION)   
       THISFORM.GRID1.SETFOCUS      
  ENDPROC
  PROC KEY_LIST1.INTERACTIVECHANGE
       THISFORM.GRID1.RECORDSOURCE=''
       SELE C39_TEMP
       USE
       DO CASE
          CASE THIS.DISPLAYVALUE='部品樣品資料'
               B01F97 ='N'
          CASE THIS.DISPLAYVALUE='線材樣品資料'
               B01F97 ='Y'
       ENDCASE  
	   SELECT C39.*,B01.F02 AS F021,C01.F05 AS F011,B01.F97 FROM C39,B01,C01;
             WHERE B01.F97 = B01F97 AND C39.F02 = B01.F01 AND C39.F01 = C01.F01 AND IIF(CHK_STR = 'Y',.T.,LEFT(DTOS(C39.F03),6) = LEFT(DTOS(CTOD(CHK_STR+'/01')),6)) INTO CURSOR C39_TEMP READWRITE
		INDEX ON F01+DTOS(F03)+F02 TAG C39_TEMP1       
		INDEX ON F02+DTOS(F03)+F01 TAG C39_TEMP2  
		INDEX ON F06+DTOS(F03)+F02 TAG C39_TEMP3
		INDEX ON F10+DTOS(F03)+F02 TAG C39_TEMP4		
		SELECT C39_TEMP 
		THISFORM.GRID1.RECORDSOURCE='C39_TEMP'
        THISFORM.KEY_LIST.INTERACTIVECHANGE
       THISFORM.KEY_LIST1.INTERACTIVECHANGE
	   THISFORM.GRID1.SETFOCUS        
	   THISFORM.REFRESH
       IF  THISFORM.GRID1.ACTIVEROW=0 
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	        
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F. 
	      THISFORM.REPLY_REMARK.ENABLED=.F.  
	      THISFORM.TXTF08.VALUE = ''
          THISFORM.LBLF991.CAPTION = ''
        ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	        
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
	      THISFORM.REPLY_REMARK.ENABLED=IIF(A02.F05='*',.T.,.F.)
          THISFORM.TXTF08.VALUE = C39_TEMP.F08
          THISFORM.LBLF991.CAPTION = C39_TEMP.F99
        ENDIF
        GO TOP 
  ENDPROC
  PROC KEY_LIST2.INTERACTIVECHANGE
       THISFORM.GRID1.RECORDSOURCE=''
       SELE C39_TEMP
       USE
       DO CASE
          CASE THIS.DISPLAYVALUE='月份資料'
               THISFORM.MTH_LIST.ENABLED = .T.
               CHK_STR = ALLTRIM(THISFORM.MTH_LIST.DISPLAYVALUE)
          CASE THIS.DISPLAYVALUE='全部資料'
               THISFORM.MTH_LIST.ENABLED = .F.
               CHK_STR = 'Y'
       ENDCASE  
	   SELECT C39.*,B01.F02 AS F021,C01.F05 AS F011,B01.F97 FROM C39,B01,C01;
             WHERE B01.F97 = B01F97 AND C39.F02 = B01.F01 AND C39.F01 = C01.F01 AND IIF(CHK_STR = 'Y',.T.,LEFT(DTOS(C39.F03),6) = LEFT(DTOS(CTOD(CHK_STR+'/01')),6)) INTO CURSOR C39_TEMP READWRITE
		INDEX ON F01+DTOS(F03)+F02 TAG C39_TEMP1     
		INDEX ON F02+DTOS(F03)+F01 TAG C39_TEMP2 
		INDEX ON F06+DTOS(F03)+F02 TAG C39_TEMP3  
		INDEX ON F10+DTOS(F03)+F02 TAG C39_TEMP4 
		SELECT C39_TEMP 
		GO TOP
		THISFORM.GRID1.RECORDSOURCE='C39_TEMP'
        THISFORM.KEY_LIST.INTERACTIVECHANGE
       THISFORM.KEY_LIST1.INTERACTIVECHANGE
	   THISFORM.GRID1.SETFOCUS        
	   THISFORM.REFRESH
       IF  THISFORM.GRID1.ACTIVEROW=0 
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	        
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F. 
	      THISFORM.REPLY_REMARK.ENABLED=.F.  
	      THISFORM.TXTF08.VALUE = ''
          THISFORM.LBLF991.CAPTION = ''
        ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	        
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
	      THISFORM.REPLY_REMARK.ENABLED=IIF(A02.F05='*',.T.,.F.)
          THISFORM.TXTF08.VALUE = C39_TEMP.F08
          THISFORM.LBLF991.CAPTION = C39_TEMP.F99
        ENDIF 
  ENDPROC
   PROC MTH_LIST.INTERACTIVECHANGE
		CHK_STR = ALLTRIM(THIS.DISPLAYVALUE)
		THISFORM.GRID1.RECORDSOURCE=''
		SELECT C39_TEMP
		USE
		SELECT C39.*,B01.F02 AS F021,C01.F05 AS F011,B01.F97 FROM C39,B01,C01;
		      WHERE B01.F97 = B01F97 AND C39.F02 = B01.F01 AND C39.F01 = C01.F01 AND IIF(CHK_STR = 'Y',.T.,LEFT(DTOS(C39.F03),6) = LEFT(DTOS(CTOD(CHK_STR+'/01')),6)) INTO CURSOR C39_TEMP READWRITE
		SELECT C39_TEMP
		INDEX ON F01+DTOS(F03)+F02 TAG C39_TEMP1       
		INDEX ON F02+DTOS(F03)+F01 TAG C39_TEMP2   
		INDEX ON F06+DTOS(F03)+F02 TAG C39_TEMP3
		INDEX ON F10+DTOS(F03)+F01 TAG C39_TEMP4   
		SELECT C39_TEMP
		THISFORM.GRID1.RECORDSOURCE='C39_TEMP'
       THISFORM.KEY_LIST.INTERACTIVECHANGE
       THISFORM.KEY_LIST1.INTERACTIVECHANGE
	   THISFORM.GRID1.SETFOCUS        
	   THISFORM.REFRESH
       IF  THISFORM.GRID1.ACTIVEROW=0 
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	        
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F. 
	      THISFORM.REPLY_REMARK.ENABLED=.F.  
	      THISFORM.TXTF08.VALUE = ''
          THISFORM.LBLF991.CAPTION = ''
        ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	        
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
	      THISFORM.REPLY_REMARK.ENABLED=IIF(A02.F05='*',.T.,.F.)
          THISFORM.TXTF08.VALUE = C39_TEMP.F08
          THISFORM.LBLF991.CAPTION = C39_TEMP.F99
        ENDIF 
        GO TOP
  ENDPROC
  **********
 PROC REPLY_REMARK.CLICK &&修改回覆交期與備註 
       SELECT C39_TEMP
	   THISFORM.YES.VISIBLE=.T.
	   THISFORM.NO.VISIBLE=.T.	
	   THISFORM.LBLF99.VISIBLE=.F.
	   THISFORM.LBLF991.VISIBLE=.F.
	   THISFORM.KEY_LIST.ENABLED=.F.
	   THISFORM.KEY_LIST1.ENABLED=.F.
	   THISFORM.KEY_LIST2.ENABLED=.F.
	   THISFORM.MTH_LIST.ENABLED=.F.
	   THISFORM.GRID1.ENABLED=.F.
	   THISFORM.REPLY_REMARK.ENABLED=.F.
	   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	   THISFORM.ORPGROUP.ESC_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F. 
	   THISFORM.SETALL('READONLY',.F.,'TEXTBOX') 
	   THISFORM.TXTF08.SETFOCUS
	   LOCK()
	   IF !RLOCK()
		   DO FILE_IMPACT
		   RETURN
	   ENDIF 
 ENDPROC  
  **********   
 PROC YES.CLICK &&修改確認 
      SELECT C39
      SEEK C39_TEMP.F04+C39_TEMP.F01+C39_TEMP.F02+DTOS(C39_TEMP.F03)
	  IF FOUND()
		 REPLACE C39.F08 WITH THISFORM.TXTF08.VALUE
		 REPLACE C39.F99 WITH  DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
		 SELECT C39_TEMP
		 REPLACE C39_TEMP.F08 WITH THISFORM.TXTF08.VALUE
		 REPLACE C39_TEMP.F99 WITH  DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		 
	  ENDIF	 
 	  THISFORM.NO.CLICK	  
 ENDPROC
 *********
 PROC NO.CLICK &&修改取消  
   THISFORM.SETALL('READONLY',.T.,'TEXTBOX') 
   THISFORM.YES.VISIBLE=.F.
   THISFORM.NO.VISIBLE=.F.
   THISFORM.LBLF99.VISIBLE=.T.
   THISFORM.LBLF991.VISIBLE=.T.
   THISFORM.KEY_LIST.ENABLED=.T.
   THISFORM.KEY_LIST1.ENABLED=.T.
   THISFORM.KEY_LIST2.ENABLED=.T.
   THISFORM.MTH_LIST.ENABLED=IIF(CHK_STR = 'Y',.F.,.T.)
   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 
   THISFORM.ORPGROUP.ESC_BOTT.ENABLED=.T.
   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限  
   THISFORM.REPLY_REMARK.ENABLED=IIF(A02.F05='*',.T.,.F.) &&判斷有無修改回覆交期與備註的權限
   THISFORM.GRID1.ENABLED=.T.     
   THISFORM.GRID1.SETFOCUS
   SELECT C39_TEMP
   UNLOCK ALL
   THISFORM.REFRESH 
 ENDPROC   
ENDDEFINE        
***********************************************列印程序
PROCEDURE PNT_PRC     
   FLG='0'
   SELECT  C39_TEMP
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW    
   IF FLG<>'1'
       =MESSAGEBOX('無此範圍資料',0+48,'警示')
   ENDIF   
   FLG='0'   
*!*	   THISFORM.GRID1.SETFOCUS        
ENDPROC
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*130
  WIDTH=INT_015*415
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*5,;
      TOP=INT_015*25,;
      NAME='LABEL1'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      TOP=INT_015*19,;
      LEFT=INT_015*85,;
      HEIGHT=INT_015*25,; 
      MAXLENGTH=5,;
      NAME='TEXT1'
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*5,;
      TOP=INT_015*65,;
      NAME='LABEL2'      
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      TOP=INT_015*59,;
      LEFT=INT_015*85,;
      HEIGHT=INT_015*25,; 
      MAXLENGTH=5,;        
      NAME='TEXT2'    
  ADD OBJECT LABEL3 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*5,;
      TOP=INT_015*100,;
      CAPTION='起始領取日期'
      NAME='LABEL3'  
  ADD OBJECT TEXT3 AS TEXTBOX WITH;
      TOP=INT_015*93,;
      LEFT=INT_015*85,;
      HEIGHT=INT_015*25,;  
	  WIDTH=INT_015*70,;     
      NAME='TEXT3' 
  ADD OBJECT LABEL4 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*160,;
      TOP=INT_015*100,;
      CAPTION='截止領取日期'
      NAME='LABEL4'  
  ADD OBJECT TEXT4 AS TEXTBOX WITH;
      TOP=INT_015*93,;
      LEFT=INT_015*240,;
      HEIGHT=INT_015*25,;  
	  WIDTH=INT_015*70,;     
      NAME='TEXT4'
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*330,;     
      TOP=INT_015*20,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<P.列   印',;
      TOOLTIPTEXT='列印所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*330,;     
      TOP=INT_015*54,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<E.轉EXCEL',;
      TOOLTIPTEXT='資料轉出為EXCEL!快速鍵->ALT+E',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*330,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<C.取   消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'    
  PROCEDURE INIT 
      SELECT C39_TEMP
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')      
      THISFORM.TEXT3.VALUE= C39_TEMP.F03
	  THISFORM.TEXT4.VALUE= C39_TEMP.F03   
      DO CASE
         CASE KEY()='F01+DTOS(F03)+F02'    
              THISFORM.LABEL1.CAPTION='起始客戶編號'
              THISFORM.LABEL2.CAPTION='截止客戶編號'
              THISFORM.TEXT1.WIDTH=INT_015*55
              THISFORM.TEXT2.WIDTH=INT_015*55   
              THISFORM.TEXT1.MAXLENGTH=5           
              THISFORM.TEXT2.MAXLENGTH=5                                       
              THISFORM.TEXT1.VALUE=C39_TEMP.F01
              THISFORM.TEXT2.VALUE=C39_TEMP.F01              
         CASE KEY()='F02+DTOS(F03)+F01' 
              THISFORM.LABEL1.CAPTION='起始料品編號'
              THISFORM.LABEL2.CAPTION='截止料品編號'
              THISFORM.TEXT1.WIDTH=INT_015*225
              THISFORM.TEXT2.WIDTH=INT_015*225
              THISFORM.TEXT1.MAXLENGTH=43
              THISFORM.TEXT2.MAXLENGTH=43
              THISFORM.TEXT1.VALUE=C39_TEMP.F02
              THISFORM.TEXT2.VALUE=C39_TEMP.F02   
         CASE KEY()='F06+DTOS(F03)+F02' 
              THISFORM.LABEL1.CAPTION='起始業務編號'
              THISFORM.LABEL2.CAPTION='截止業務編號'
              THISFORM.TEXT1.WIDTH=INT_015*55
              THISFORM.TEXT2.WIDTH=INT_015*55
              THISFORM.TEXT1.MAXLENGTH=5
              THISFORM.TEXT2.MAXLENGTH=5
              THISFORM.TEXT1.VALUE=C39_TEMP.F06
              THISFORM.TEXT2.VALUE=C39_TEMP.F06  
         CASE KEY()='F10+DTOS(F03)+F02' 
              THISFORM.LABEL1.CAPTION='起始業助編號'
              THISFORM.LABEL2.CAPTION='截止業助編號'
              THISFORM.TEXT1.WIDTH=INT_015*55
              THISFORM.TEXT2.WIDTH=INT_015*55
              THISFORM.TEXT1.MAXLENGTH=5
              THISFORM.TEXT2.MAXLENGTH=5
              THISFORM.TEXT1.VALUE=C39_TEMP.F10
              THISFORM.TEXT2.VALUE=C39_TEMP.F10                                                                                         
      ENDCASE  
      THISFORM.TEXT1.SETFOCUS 
  ENDPROC    
  PROCEDURE CMND1.CLICK      
      FILENAME='C39客戶樣品領用紀錄'
      DO CASE
         CASE KEY()='F01+DTOS(F03)+F02'     
              SELECT C39.F01,C01.F05,C39.F02,B01.F02,C39.F03,C39.F04,C39.F05,C39.F06,C39.F07,C39.F08,C39.F09,C39.F10,C39.F99 FROM C39,C01,B01 WHERE C39.F01=C01.F01 AND C39.f02=B01.F01;
                     AND C39.F01>=THISFORM.TEXT1.VALUE AND C39.F01<=THISFORM.TEXT2.VALUE AND C39.F03>=THISFORM.TEXT3.VALUE AND C39.F03<=THISFORM.TEXT4.VALUE ORDER BY C39.F01 INTO CURSOR C39A
              SELECT C39A
              GO TOP              
              IF _TALLY >0
                 IF EMPTY(EXBO)
                     REPORT FORM ALLTRIM(INT_116)+'C39A' TO PRINT PROMPT PREVIEW 
                 ELSE        
                    SELECT F01 客戶編號,F05_A 客戶簡稱,F02_A 料號,F02_B 品名規格,F03 領用日期,F04 領用單號,F05_B 領用數量,IIF(SEEK(F06,'A01'),A01.F03,F06) 業務姓名,IIF(SEEK(F10,'A01'),A01.F03,F10) 業助姓名,F08 樣品追蹤,F07 備註說明,IIF(SEEK(F09,'A14'),A14.F02,.F09) 發料部門,F99 安全資料 FROM C39A ORDER BY F01 NOWAIT                          
				    GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
				    IF !EMPTY(GCDELIMFILE) 
				       ON ERROR DO FILE_IMPACT
				       COPY TO (GCDELIMFILE) TYPE XL5     
				       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
				    ENDIF                        
                 ENDIF 
                 FLG='1'  
              ENDIF    
		CASE KEY()='F02+DTOS(F03)+F01' 
              SELECT C39.F01,C01.F05,C39.F02,B01.F02,C39.F03,C39.F04,C39.F05,C39.F06,C39.F07,C39.F08,C39.F09,C39.F10,C39.F99 FROM C39,C01,B01 WHERE C39.F01=C01.F01 AND C39.f02=B01.F01;
                     AND C39.F02>=THISFORM.TEXT1.VALUE AND C39.F02<=THISFORM.TEXT2.VALUE AND C39.F03>=THISFORM.TEXT3.VALUE AND C39.F03<=THISFORM.TEXT4.VALUE ORDER BY C39.F01 INTO CURSOR C39A
              SELECT C39A
              GO TOP              
              IF _TALLY >0
                 IF EMPTY(EXBO)
                     REPORT FORM ALLTRIM(INT_116)+'C39C' TO PRINT PROMPT PREVIEW 
                 ELSE        
                    SELECT F02_A 料號,F02_B 品名規格,F01 客戶編號,F05_A 客戶簡稱,F03 領用日期,F04 領用單號,F05_B 領用數量,IIF(SEEK(F06,'A01'),A01.F03,F06) 業務姓名,IIF(SEEK(F10,'A01'),A01.F03,F10) 業助姓名,F08 樣品追蹤,F07 備註說明,IIF(SEEK(F09,'A14'),A14.F02,.F09) 發料部門,F99 安全資料 FROM C39A ORDER BY F01 NOWAIT                          
				    GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
				    IF !EMPTY(GCDELIMFILE) 
				       ON ERROR DO FILE_IMPACT
				       COPY TO (GCDELIMFILE) TYPE XL5     
				       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
				    ENDIF                        
                 ENDIF 
                 FLG='1'  
              ENDIF 
         CASE KEY()='F06+DTOS(F03)+F02' 
              SELECT C39.F01,C01.F05,C39.F02,B01.F02,C39.F03,C39.F04,C39.F05,C39.F06,C39.F07,C39.F08,C39.F09,C39.F10,C39.F99  FROM C39,C01,B01 WHERE C39.F01=C01.F01 AND C39.F02=B01.F01;
                     AND C39.F06>=THISFORM.TEXT1.VALUE AND C39.F06<=THISFORM.TEXT2.VALUE AND C39.F03>=THISFORM.TEXT3.VALUE AND C39.F03<=THISFORM.TEXT4.VALUE ORDER BY C39.F06 INTO CURSOR C39A
              SELECT C39A
              GO TOP                   
              IF _TALLY >0
                 IF EMPTY(EXBO)
                    REPORT FORM ALLTRIM(INT_116)+'C39B' TO PRINT PROMPT PREVIEW 
                 ELSE        
                    SELECT IIF(SEEK(F06,'A01'),A01.F03,F06) 業務姓名,IIF(SEEK(F10,'A01'),A01.F03,F10) 業助姓名,F02_A 料號,F02_B 品名規格,F03 領用日期,F04 領用單號,F05_B 領用數量,F01 客戶編號,F05_A 客戶簡稱,F08 樣品追蹤,F07 備註說明,IIF(SEEK(F09,'A14'),A14.F02,.F09) 發料部門,F99 安全資料 FROM C39A ORDER BY F02_A NOWAIT                                                    
				    GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
				    IF !EMPTY(GCDELIMFILE) 
				       ON ERROR DO FILE_IMPACT
				       COPY TO (GCDELIMFILE) TYPE XL5     
				      =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
				    ENDIF                        
                 ENDIF 
                 FLG='1'  
              ENDIF  
         CASE KEY()='F10+DTOS(F03)+F02' 
              SELECT C39.F01,C01.F05,C39.F02,B01.F02,C39.F03,C39.F04,C39.F05,C39.F06,C39.F07,C39.F08,C39.F09,C39.F10,C39.F99 FROM C39,C01,B01 WHERE C39.F01=C01.F01 AND C39.F02=B01.F01;
                     AND C39.F10>=THISFORM.TEXT1.VALUE AND C39.F10<=THISFORM.TEXT2.VALUE AND C39.F03>=THISFORM.TEXT3.VALUE AND C39.F03<=THISFORM.TEXT4.VALUE ORDER BY C39.F06 INTO CURSOR C39A
              SELECT C39A
              GO TOP                   
              IF _TALLY >0
                 IF EMPTY(EXBO)
                    REPORT FORM ALLTRIM(INT_116)+'C39B' TO PRINT PROMPT PREVIEW 
                 ELSE        
                    SELECT IIF(SEEK(F06,'A01'),A01.F03,F06) 業務姓名,IIF(SEEK(F10,'A01'),A01.F03,F10) 業助姓名,F02_A 料號,F02_B 品名規格,F03 領用日期,F04 領用單號,F05_B 領用數量,F01 客戶編號,F05_A 客戶簡稱,F08 樣品追蹤,F07 備註說明,IIF(SEEK(F09,'A14'),A14.F02,.F09) 發料部門,F99 安全資料 FROM C39A ORDER BY F02_A NOWAIT                                                    
				    GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
				    IF !EMPTY(GCDELIMFILE) 
				       ON ERROR DO FILE_IMPACT
				       COPY TO (GCDELIMFILE) TYPE XL5     
				      =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
				    ENDIF                        
                 ENDIF 
                 FLG='1'  
              ENDIF  
     ENDCASE  
     SELECT C39A
     USE          
     THISFORM.RELEASE  
  ENDPROC
  ****
  PROCEDURE CMND2.CLICK
     EXBO='1'
     THISFORM.CMND1.CLICK
     EXBO='' 
     THISFORM.RELEASE
  ENDPROC       
  PROCEDURE CMND3.CLICK
      FLG='1'   
      THISFORM.RELEASE
  ENDPROC        
ENDDEFINE    
