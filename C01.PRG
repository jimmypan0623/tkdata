CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
RE=0
EXBO=''
AREA1='C01'
IF !USED('A09')
   SELE 0
   USE A09
ELSE
   SELE A09
ENDIF
SET ORDER TO 1
IF !USED('A0I')
   SELE 0
   USE A0I
ELSE
   SELE A0I
ENDIF
SET ORDER TO 1            
IF ! USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'C01'
IF !USED('C00')
   SELE 0
   USE C00
ELSE
   SELE C00
ENDIF
SET ORDER TO C001
IF !USED('C02')
   SELE 0
   USE C02
ELSE
   SELE C02
ENDIF
SET ORDER TO C021
IF !USED('C05')
   SELE 0
   USE C05
ELSE
   SELE C05
ENDIF
SET ORDER TO C053      
IF !USED('C19')
   SELE 0
   USE C19
ELSE
   SELE C19
ENDIF
SET ORDER TO C191      
IF !USED('C01')
   SELE 0
   USE C01 INDE C01
ELSE
   SELE C01
ENDIF
SET ORDER TO C011
*SET RELA TO F18 INTO A01     
C01FORM=CREATEOBJECT("TKC01")
C01FORM.SHOW  
DEFINE CLASS TKC01 AS FORM
CAPTION='C01.客戶基本主檔'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1 
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKC01'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT LBL_REC AS LBL_REC WITH;
      AUTOCENTER =.T.
  ADD OBJECT REC_COUNT AS REC_COUNT  WITH;
      CAPTION=STR(RECCOUNT())      
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      FONTSIZE=INT_015*9,;
      WIDTH=INT_015*65,;
      CAPTION='\<A.報價紀錄',;
      NAME='ANS_BOTT'                        
  ADD OBJECT EXCEL_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*83,;
      HEIGHT=INT_015*25,;
      FONTSIZE=INT_015*9,;
      WIDTH=INT_015*65,;
      CAPTION='\<T.轉EXCEL',;
      NAME='EXCEL_BOTT'           
  ADD OBJECT LBLF01 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*27,;
      WIDTH=INT_015*50,;
      CAPTION='客戶編號'
  ADD OBJECT TXTF01 AS TEXTBOX WITH;      
      LEFT=INT_015*295,;
      TOP=INT_015*23,;
      WIDTH=INT_015*50,;
      MAXLENGTH=5,;
      NAME='TXTF01'       
  ADD OBJECT LBLF03 AS LABEL WITH;
      LEFT=INT_015*355,;
      TOP=INT_015*27,;
      WIDTH=INT_015*50,;
      CAPTION='重要等級'            
  ADD OBJECT TXTF03 AS TEXTBOX WITH;
      LEFT=INT_015*405,;
      TOP=INT_015*23,;
      WIDTH=INT_015*20,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=1,;
      NAME='TXTF03'             
  ADD OBJECT COMBOBOX03 AS COMBOBOX WITH;    
       HEIGHT=INT_015*25,;
       WIDTH=INT_015*35,;
       FONTSIZE=INT_015*9,;
       BOUNDCOLUMN=1,;
       ROWSOURCETYPE=1,;
       STYLE=2,;          
      LEFT=INT_015*405,;
      TOP=INT_015*23              
  ADD OBJECT LBLF02 AS LABEL WITH;      
      LEFT=INT_015*441,;
      TOP=INT_015*27,;
      WIDTH=INT_015*50,;
      CAPTION='索引簡碼'
  ADD OBJECT TXTF02 AS TEXTBOX WITH;
      LEFT=INT_015*492,;
      TOP=INT_015*23,;
      WIDTH=INT_015*40,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=4,;
      NAME='TXTF02'           
   ADD OBJECT LBLF43 AS LABEL WITH;      
      LEFT=INT_015*541,;
      TOP=INT_015*27,;
      WIDTH=INT_015*25,;
      CAPTION='型態'
  ADD OBJECT TXTF43 AS TEXTBOX WITH;
      LEFT=INT_015*568,;
      TOP=INT_015*23,;
      WIDTH=INT_015*75,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=7,;
      NAME='TXTF43'                
 ADD OBJECT CT_TYPE AS COMBOBOX WITH;
      LEFT=INT_015*568,;
      TOP=INT_015*23,;
      WIDTH=INT_015*85,;
      FONTSIZE=INT_015*9,;
      HEIGHT=INT_015*25,;
      ROWSOURCETYPE=1,;
      STYLE=2
      VALUE=8 
      NAME='CT_TYPE'         
  ADD OBJECT LBLF04 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*52,;
      WIDTH=INT_015*50,;
      CAPTION='公司名稱'
  ADD OBJECT TXTF04 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*48,;
      WIDTH=INT_015*320,;
      MAXLENGTH=50,;
      NAME='TXTF04' 
  ADD OBJECT LBLF27 AS LABEL WITH;
      LEFT=INT_015*616,;
      TOP=INT_015*52,;
      WIDTH=INT_015*50,;
      CAPTION='信用額度' 
  ADD OBJECT TXTF27 AS TEXTBOX WITH;
      LEFT=INT_015*666,;
      TOP=INT_015*48,;
      WIDTH=INT_015*100,;
      INPUTMASK='99999999999999'
      NAME='TXTF27'           
  ADD OBJECT LBLF05 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*77,;
      WIDTH=INT_015*50,;
      CAPTION='公司簡稱'
  ADD OBJECT TXTF05 AS TEXTBOX WITH;      
      LEFT=INT_015*295,;
      TOP=INT_015*73,;
      WIDTH=INT_015*67,;
      MAXLENGTH=8,;
      NAME='TXTF05'        
  ADD OBJECT LBLF10 AS LABEL WITH;
      LEFT=INT_015*372,;
      TOP=INT_015*77,;
      WIDTH=INT_015*50,;
      CAPTION='統一編號'   
   ADD OBJECT TXTF10 AS TEXTBOX WITH;
      LEFT=INT_015*423,;
      TOP=INT_015*73,;
      WIDTH=INT_015*67,;
      MAXLENGTH=8,;   
      INPUTMASK='99999999',;
      NAME='TXTF10'       
   ADD OBJECT LBLF44 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*77,;
      WIDTH=INT_015*50,;
      CAPTION='統制客編'           
   ADD OBJECT TXTF44 AS TEXTBOX WITH;
      LEFT=INT_015*550,;
      TOP=INT_015*73,;
      WIDTH=INT_015*50,;
      MAXLENGTH=5,;
      NAME='TXTF44'                 
   ADD OBJECT LBLF35 AS LABEL WITH;
      LEFT=INT_015*616,;
      TOP=INT_015*77,;
      WIDTH=INT_015*50,;
      CAPTION='資  本  額'       
  ADD OBJECT TXTF35 AS TEXTBOX WITH;
      LEFT=INT_015*666,;
      TOP=INT_015*73,;
      WIDTH=INT_015*100,;
      MAXLENGTH=15,;   
      NAME='TXTF35'              
 ADD OBJECT LBLF41 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*102,;
      WIDTH=INT_015*50,;
      CAPTION='發票抬頭'              
  ADD OBJECT TXTF41 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*98,;
      WIDTH=INT_015*373,;
      MAXLENGTH=80,;
      NAME='TXTF41'                  
 ADD OBJECT LBLF42 AS LABEL WITH;
      LEFT=INT_015*673,;
      TOP=INT_015*102,;
      WIDTH=INT_015*50,;
      CAPTION='發票品號'            
 ADD OBJECT TXTF42 AS TEXTBOX WITH;
      LEFT=INT_015*725,;
      TOP=INT_015*98,;
      WIDTH=INT_015*40,;
      MAXLENGTH=4,;
      NAME='TXTF42'                    
 ADD OBJECT COMBOBOX42 AS COMBOBOX WITH;    
       HEIGHT=INT_015*25,;
       WIDTH=INT_015*50,;
       FONTSIZE=INT_015*9,;
       BOUNDCOLUMN=1,;
       ROWSOURCETYPE=1,;
       STYLE=2,;          
       LEFT=INT_015*725,;
       TOP=INT_015*98                               
 ADD OBJECT LBLF09 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*127,;
      WIDTH=INT_015*50,;
      CAPTION='英文名稱'       
  ADD OBJECT TXTF09 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*123,;
      WIDTH=INT_015*373,;
      MAXLENGTH=80,;
      NAME='TXTF09'            
 ADD OBJECT LBLF46 AS LABEL WITH;
      LEFT=INT_015*673,;
      TOP=INT_015*127,;
      WIDTH=INT_015*50,;
      CAPTION='統制報價'           
   ADD OBJECT TXTF46 AS TEXTBOX WITH;
      LEFT=INT_015*725,;
      TOP=INT_015*123,;
      WIDTH=INT_015*20,;
      MAXLENGTH=1,;
      NAME='TXTF46'                           
  ADD OBJECT LBLF06 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*152,;
      WIDTH=INT_015*50,;
      CAPTION='地        址'
  ADD OBJECT TXTF06 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*148,;
      WIDTH=INT_015*470,;
      MAXLENGTH=60,;
      NAME='TXTF06'        
  ADD OBJECT LBLF07 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*177,;
      WIDTH=INT_015*50,;
      CAPTION='送貨地址'
  ADD OBJECT TXTF07 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*173,;
      WIDTH=INT_015*470,;
      MAXLENGTH=80,;
      NAME='TXTF07'      
  ADD OBJECT LBLF08 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*202,;
      WIDTH=INT_015*50,;
      CAPTION='英文地址'      
 ADD OBJECT TXTF08 AS TEXTBOX WITH;
      LEFT=INT_015*295, ;
      TOP=INT_015*198, ;
      WIDTH=INT_015*470, ;
      MAXLENGTH=100,;
      NAME='TXTF08'           
   ADD OBJECT TXTF34 AS TEXTBOX WITH;
      LEFT=INT_015*295, ;
      TOP=INT_015*223, ;
      WIDTH=INT_015*470, ;
      MAXLENGTH=100,;
      NAME='TXTF34'           
  ADD OBJECT LBLF32 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*252,;
      WIDTH=INT_015*50,;
      CAPTION='出貨指示'    
  ADD OBJECT TXTF32 AS TEXTBOX WITH;
      LEFT=INT_015*295, ;
      TOP=INT_015*248, ;
      WIDTH=INT_015*454, ;
      MAXLENGTH=80,;
      NAME='TXTF32'              
   ADD OBJECT LBLF12 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*277,;
      WIDTH=INT_015*50,;
      CAPTION='連  絡  人'               
   ADD OBJECT TXTF12 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*295,;
      TOP=INT_015*273,;
      WIDTH=INT_015*153,;
      MAXLENGTH=20,;
      NAME='TXTF12'         
  ADD OBJECT LBLF11 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*277,;
      WIDTH=INT_015*50,;
      CAPTION='負  責  人'      
  ADD OBJECT TXTF11 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*273,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF11'         
  ADD OBJECT LBLF14 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*302,;
      WIDTH=INT_015*50,;
      CAPTION='傳真號碼'        
    ADD OBJECT TXTF14 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*298,;
      WIDTH=INT_015*153,;
      MAXLENGTH=20,;
      NAME='TXTF14'               
  ADD OBJECT LBLF13 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*302,;
      WIDTH=INT_015*50,;
      CAPTION='聯絡電話'        
  ADD OBJECT TXTF13 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*298,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF13'
  ADD OBJECT LBLF21 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*327,;
      WIDTH=INT_015*50,;
      CAPTION='產  品  別'       
  ADD OBJECT TXTF21 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*323,;
      WIDTH=INT_015*153,;
      MAXLENGTH=30,;
      NAME='TXTF21'                                
  ADD OBJECT LBLF39 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*352,;
      WIDTH=INT_015*50,;
      CAPTION='交易幣別'        
  ADD OBJECT CRCY AS CRCY WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*348,;
      WIDTH=INT_015*55,;
      NAME='CRCY'    
 ADD OBJECT TXTF39 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*348,;
      WIDTH=INT_015*38,;
      MAXLENGTH=4,;
      NAME='TXTF39'  
  ADD OBJECT LBLF17 AS LABEL WITH;
      LEFT=INT_015*360,;
      TOP=INT_015*352,;
      WIDTH=INT_015*50,;
      CAPTION='入帳日期'      
  ADD OBJECT TXTF17 AS TEXTBOX WITH;
      LEFT=INT_015*410,;
      TOP=INT_015*348,;
      WIDTH=INT_015*38,;
      MAXLENGTH=2,;
      INPUTMASK='99',;
      NAME='TXTF17'         
   ADD OBJECT LBLF15 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*327,;
      WIDTH=INT_015*50,;
      CAPTION='結帳方式'     
   ADD OBJECT LBLF151 AS LABEL WITH;
      LEFT=INT_015*590,;
      TOP=INT_015*327,;
      AUTOSIZE=.T.       
   ADD OBJECT TXTF15 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*323,;
      WIDTH=INT_015*36,;
      MAXLENGTH=1,;
      INPUTMASK='9',;
      NAME='TXTF15'       
  ADD OBJECT COMBOBOX15 AS COMBOBOX15 WITH;    
      LEFT=INT_015*549,;
      TOP=INT_015*323          
   ADD OBJECT TXTF36 AS TXTF36  WITH;
      LEFT=INT_015*586,;
      TOP=INT_015*323             
  ADD OBJECT LBLF37 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*352,;
      WIDTH=INT_015*50,;
      CAPTION='票期天數'        
 ADD OBJECT TXTF37 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*348,;
      WIDTH=INT_015*36,;
      MAXLENGTH=4,;
      INPUTMASK='9999'
      NAME='TXTF37'           
  ADD OBJECT LBLF38 AS LABEL WITH;
      LEFT=INT_015*660,;
      TOP=INT_015*352,;
      WIDTH=INT_015*45,;
      CAPTION='請款日'            
  ADD OBJECT TXTF38 AS TEXTBOX WITH;
      LEFT=INT_015*700,;
      TOP=INT_015*348,;
      WIDTH=INT_015*30,;
      MAXLENGTH=2,;
      INPUTMASK='99'
      NAME='TXTF38'           
  ADD OBJECT LBLF18 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*379,;
      WIDTH=INT_015*50,;
      CAPTION='業  務  A'   
  ADD OBJECT LBLF181 AS LABEL WITH;
      LEFT=INT_015*346,;
      TOP=INT_015*379,;
      WIDTH=INT_015*55    
  ADD OBJECT TXTF18 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*373,;
      WIDTH=INT_015*50,;
      MAXLENGTH=5,;
      NAME='TXTF18'                      
  ADD OBJECT LBLF33 AS LABEL WITH;
      LEFT=INT_015*429,;
      TOP=INT_015*379,;
      WIDTH=INT_015*50,;
      CAPTION='業  務  B'   
  ADD OBJECT LBLF331 AS LABEL WITH;
      LEFT=INT_015*531,;
      TOP=INT_015*379,;
      WIDTH=INT_015*55         
   ADD OBJECT TXTF33 AS TEXTBOX WITH;
      LEFT=INT_015*480,;
      TOP=INT_015*373,;
      WIDTH=INT_015*50,;
      MAXLENGTH=5,;
      NAME='TXTF33'          
  ADD OBJECT LBLF23 AS LABEL WITH;
      LEFT=INT_015*618,;
      TOP=INT_015*377,;
      WIDTH=INT_015*50,;
      CAPTION='業務助理'  
  ADD OBJECT LBLF231 AS LABEL WITH;
      LEFT=INT_015*720,;
      TOP=INT_015*377,;
      WIDTH=INT_015*55    
  ADD OBJECT TXTF23 AS TEXTBOX WITH;
      LEFT=INT_015*669,;
      TOP=INT_015*373,;
      WIDTH=INT_015*50,;
      MAXLENGTH=5,;
      NAME='TXTF23'                                
  ADD OBJECT LBLF20 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*404,;
      WIDTH=INT_015*50,;
      CAPTION='地 區 別'       
  ADD OBJECT TXTF20 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*398,;
      WIDTH=INT_015*106,;
      NAME='TXTF20'                  
  ADD OBJECT LBLF28 AS LABEL WITH;
      LEFT=INT_015*408,;
      TOP=INT_015*404,;
      WIDTH=INT_015*50,;
      CAPTION='圖號索引'    
    ADD OBJECT TXTF28 AS TEXTBOX WITH;
      LEFT=INT_015*458,;
      TOP=INT_015*398,;
      WIDTH=INT_015*33,;
      MAXLENGTH=3,;
      NAME='TXTF28'       
  ADD OBJECT LBLF22 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*402,;
      WIDTH=INT_015*50,;
      CAPTION='E-MAIL'  
  ADD OBJECT TXTF22 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*398,;
      WIDTH=INT_015*196,;
      NAME='TXTF22'      
  ADD OBJECT LBLF31 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*429,;
      WIDTH=INT_015*50,;
      CAPTION='交貨方式'    
  ADD OBJECT TXTF31 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*423,;
      WIDTH=INT_015*196,;
      MAXLENGTH=40,;
      NAME='TXTF31'           
 ADD OBJECT LBLF29 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*427,;
      WIDTH=INT_015*50,;
      CAPTION='發票種類'  
  ADD OBJECT TXTF29 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*423,;
      WIDTH=INT_015*50,;
      MAXLENGTH=6,;
      NAME='TXTF29'         
 ADD OBJECT LBLF30 AS LABEL WITH; &&課稅別
      LEFT=INT_015*605,;
      TOP=INT_015*427,;
      WIDTH=INT_015*50,;
      CAPTION=''                        
 ADD OBJECT LBLF47 AS LABEL WITH; &&電子發票交付類別
      LEFT=INT_015*646,;
      TOP=INT_015*427,;
      AUTOSIZE=.T.,;
      CAPTION=''           
  ADD OBJECT LBLF24 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*454,;
      WIDTH=INT_015*50,;
      CAPTION='付款方式'    
  ADD OBJECT TXTF24 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*448,;
      WIDTH=INT_015*196,;
      MAXLENGTH=40,;
      NAME='TXTF24'                             
  ADD OBJECT LBLF40 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*479,;
      WIDTH=INT_015*50,;
      CAPTION='收  件  人'    
  ADD OBJECT TXTF40 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*473,;
      WIDTH=INT_015*153,;
      MAXLENGTH=20,;
      NAME='TXTF40'                        
  ADD OBJECT LBLF25 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*454,;
      WIDTH=INT_015*50,;
      CAPTION='備註說明'          
  ADD OBJECT TXTF25 AS EDITBOX WITH;&&文書編輯EDITBOX
      LEFT=INT_015*549,;
      TOP=INT_015*448,;
      WIDTH=INT_015*220,;
      HEIGHT=INT_015*50,;
      READONLY=.T.,;
      MAXLENGTH=200,;
      ALIGNMENT=0,;
      NAME='TXTF25'           
  ADD OBJECT LBLF26 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*502,;
      WIDTH=INT_015*50,;
      CAPTION='安全資料'   
  ADD OBJECT LBLF261 AS LABEL WITH;
      LEFT=INT_015*294,;
      TOP=INT_015*502,;
      AUTOSIZE=.T.  
  ADD OBJECT LBLF98 AS LABEL WITH;
      LEFT=INT_015*398,;
      TOP=INT_015*502,;
      WIDTH=INT_015*50,;
      CAPTION='權限安資'   
  ADD OBJECT LBLF981 AS LABEL WITH;
      LEFT=INT_015*448,;
      TOP=INT_015*502,;
      AUTOSIZE=.T.    
      CAPTION=''      
  ADD OBJECT LBLF16 AS LABEL WITH;
      LEFT=INT_015*548,;
      TOP=INT_015*502,;
      WIDTH=INT_015*50,;
      CAPTION='最後交易'      
  ADD OBJECT LBLF161 AS LABEL WITH;
      LEFT=INT_015*599,;
      TOP=INT_015*502,;
      AUTOSIZE=.T.,;
      CAPTION=''            
  ADD OBJECT LBLF19 AS LABEL WITH;
      LEFT=INT_015*670,;
      TOP=INT_015*502,;
      WIDTH=INT_015*50,;
      CAPTION='最後報價'        
 ADD OBJECT LBLF191 AS LABEL WITH;
      LEFT=INT_015*721,;
      TOP=INT_015*502,;
      AUTOSIZE=.T.,;
      CAPTION=''            
  ADD OBJECT INV_TYPE AS INV_TYPE WITH;      
      AUTOCENTER=.T.     
  ADD OBJECT TAX_TYPE AS TAX_TYPE WITH;      
      AUTOCENTER=.T.       
  ADD OBJECT EPAY_TYPE AS EPAY_TYPE WITH;      
      AUTOCENTER=.T.            
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=4,;            
      RECORDSOURCE='C01',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',; 
      COLUMN4.NAME='COLUMN4' 
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.              
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOSIZE=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*493,;
      LEFT=INT_015*687      
  PROCEDURE COMBOBOX03.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .ADDITEM('A')
          .ADDITEM('B')
          .ADDITEM('C')   
          .ADDITEM('D') 
          .ADDITEM('E') 
     ENDWITH   
  ENDPROC           
  PROCEDURE COMBOBOX42.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .ADDITEM('我方')
          .ADDITEM('對方')
     ENDWITH   
  ENDPROC             
  PROC INIT
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限  
       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無查詢報價紀錄的權限  
       THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.)           
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.CT_TYPE.ENABLED=.F.
       THISFORM.CT_TYPE.VISIBLE=.F.
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')       
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'
	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='索引簡碼'
	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='公司簡稱'
	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='統一編號'	   
	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F01'
	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F02'
	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F05'
	   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F10'  
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS
       JK='客戶編號'
  ENDPROC     
  PROCEDURE CT_TYPE.INIT
      WITH THIS 
           .ADDITEM('OEM    ')
           .ADDITEM('ODM    ')
           .ADDITEM('OEM&ODM')
           .ADDITEM('CMMS   ')
           .ADDITEM('EMS    ')
           .ADDITEM('OBM    ')                      
           .ADDITEM('加工廠 ')
           .ADDITEM('貿易商 ')
           .ADDITEM('其他   ')
       ENDWITH   
  ENDPROC        
  PROCEDURE TXTF01.INTERACTIVECHANGE
     THISFORM.TXTF44.VALUE=THIS.VALUE
  ENDPROC
  PROCEDURE TXTF04.INTERACTIVECHANGE
    THISFORM.TXTF05.VALUE=LEFT(THIS.VALUE,8)
    THISFORM.TXTF05.REFRESH
    THISFORM.TXTF41.VALUE=THIS.VALUE
    THISFORM.TXTF41.REFRESH
  ENDPROC
  PROCEDURE TXTF06.INTERACTIVECHANGE
    THISFORM.TXTF07.VALUE=THIS.VALUE

    THISFORM.TXTF07.REFRESH

  ENDPROC  

  PROCEDURE TXTF17.VALID
    LPARAMETERS NINDEX
    IF ALLTRIM(THIS.VALUE)<'32'
       NINDEX=.T.
    ELSE 
       =MESSAGEBOX('輸入資料格式不符',0+64,'提示視窗')       
       NINDEX=.F.   
    ENDIF   
    RETURN NINDEX
  ENDPROC   
  PROCEDURE TXTF46.VALID
    LPARAMETERS  NINDEX
    IF ALLTRIM(THIS.VALUE)='Y' .OR. ALLTRIM(THIS.VALUE)='N'
       NINDEX=.T.
    ELSE
       =MESSAGEBOX("請輸入'Y'代表以統制編號為報價依據,'N'則表示個別獨立報價!",0+48,"提示視窗")    
       NINDEX=.F.
    ENDIF
    RETURN NINDEX
  ENDPROC          
  PROCEDURE TXTF18.INTERACTIVECHANGE      
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 WHERE LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) NOWAIT
       ELSE
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 NOWAIT
       ENDIF   
       MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
       MAN_SEEK.SHOW    
       THIS.VALUE=FLG
       THIS.REFRESH
       FLG='0'
    ENDIF   
       THISFORM.LBLF181.CAPTION=IIF(SEEK(THIS.VALUE,'A01'),A01.F03,'')
  ENDPROC
  PROCEDURE TXTF23.INTERACTIVECHANGE      
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 WHERE LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) NOWAIT
       ELSE
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 NOWAIT
       ENDIF   
       MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
       MAN_SEEK.SHOW    
       THIS.VALUE=FLG
       THIS.REFRESH
       FLG='0'
    ENDIF   
       THISFORM.LBLF231.CAPTION=IIF(SEEK(THIS.VALUE,'A01'),A01.F03,'')
  ENDPROC  
  PROCEDURE TXTF33.INTERACTIVECHANGE      
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 WHERE LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) NOWAIT
       ELSE
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 NOWAIT
       ENDIF   
       MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
       MAN_SEEK.SHOW    
       THIS.VALUE=FLG
       THIS.REFRESH
       FLG='0'
    ENDIF   
       THISFORM.LBLF331.CAPTION=IIF(SEEK(THIS.VALUE,'A01'),A01.F03,'')
  ENDPROC 
  *********  
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依客戶編號排列')
           .ADDITEM('依索引簡碼排列')
           .ADDITEM('依公司簡稱排列')
           .ADDITEM('依統一編號排列')
           .ADDITEM('依業務員A排列')
           .ADDITEM('依業務員B排列')
           .ADDITEM('依業務助理排列')
           .ADDITEM('依英文名稱排列')
           .ADDITEM('依統制編號排列')
       ENDWITH      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE C01
       DO CASE
          CASE THIS.DISPLAYVALUE='依客戶編號排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F02'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='公司簡稱'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F05' 
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='統一編號'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F10'                
               SET ORDER TO C011     
          CASE THIS.DISPLAYVALUE='依索引簡碼排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F02'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='公司簡稱'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F05' 
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='統一編號'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F10'      
               SET ORDER TO C012
           CASE THIS.DISPLAYVALUE='依公司簡稱排列' 
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='公司簡稱'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F05'   
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F02'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='統一編號'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F10' 
               SET ORDER TO C013 
           CASE THIS.DISPLAYVALUE='依統一編號排列' 
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='統一編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F10'   
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='公司簡稱'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F05'   
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F02'
               SET ORDER TO C014     
           CASE THIS.DISPLAYVALUE='依業務員A排列' 
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='業務A編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F18'   
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業務A姓名'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE="IIF(SEEK(F18,'A01'),A01.F03,'')"
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='公司簡稱'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F05'
               SET ORDER TO C015    
           CASE THIS.DISPLAYVALUE='依業務員B排列' 
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='業務B編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F33'   
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業務A姓名'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE="IIF(SEEK(F33,'A01'),A01.F03,'')"
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='公司簡稱'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F05'
               SET ORDER TO C016   
           CASE THIS.DISPLAYVALUE='依業務助理排列' 
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='業助編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F23'   
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業助姓名'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE="IIF(SEEK(F23,'A01'),A01.F03,'')"
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='公司簡稱'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F05'
               SET ORDER TO C017                             
           CASE THIS.DISPLAYVALUE='依英文名稱排列' 
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*90
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='英文名稱'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F09'   
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F01'   
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='客戶簡稱'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F05'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F02'
               SET ORDER TO C018                
            CASE THIS.DISPLAYVALUE='依統制編號排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='統制編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F44'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C01.F02'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='公司簡稱'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C01.F05' 
                     
               SET ORDER TO C019                                             
       ENDCASE 
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC                
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       THISFORM.TXTF01.VALUE=F01
       THISFORM.TXTF02.VALUE=F02
       THISFORM.TXTF43.VALUE=CTP(ALLTRIM(F43))
       THISFORM.TXTF03.VALUE=F03
       THISFORM.TXTF04.VALUE=F04
       THISFORM.TXTF41.VALUE=F41
       THISFORM.TXTF05.VALUE=F05
       THISFORM.TXTF06.VALUE=F06
       THISFORM.TXTF07.VALUE=F07
       THISFORM.TXTF08.VALUE=F08
       THISFORM.TXTF09.VALUE=F09
       THISFORM.TXTF10.VALUE=F10
       THISFORM.TXTF11.VALUE=F11
       THISFORM.TXTF12.VALUE=F12
       THISFORM.TXTF13.VALUE=F13
       THISFORM.TXTF14.VALUE=F14
       THISFORM.TXTF15.VALUE=F15
      
       THISFORM.TXTF17.VALUE=F17
       THISFORM.TXTF18.VALUE=F18
       
       THISFORM.TXTF20.VALUE=F20
       THISFORM.TXTF21.VALUE=F21
       THISFORM.TXTF22.VALUE=F22
       THISFORM.TXTF23.VALUE=F23
       THISFORM.TXTF24.VALUE=F24
       THISFORM.TXTF40.VALUE=F40
       THISFORM.TXTF25.VALUE=F25
       THISFORM.TXTF27.VALUE=F27
       THISFORM.TXTF28.VALUE=F28
       THISFORM.TXTF29.VALUE=IIF(F29='31','三聯式',IIF(F29='32','二聯式',''))
       THISFORM.TXTF31.VALUE=F31
       THISFORM.TXTF32.VALUE=F32
       THISFORM.TXTF33.VALUE=F33
       THISFORM.TXTF34.VALUE=F34
       THISFORM.TXTF35.VALUE=F35
       THISFORM.TXTF36.VALUE=F36
       THISFORM.TXTF37.VALUE=F37
       THISFORM.TXTF38.VALUE=F38
       THISFORM.TXTF39.VALUE=F39
       THISFORM.TXTF42.VALUE=IIF(F42='2','對方','我方')
       THISFORM.TXTF44.VALUE=F44
       THISFORM.TXTF46.VALUE=F46
       THISFORM.LBLF30.CAPTION=IIF(F30='1','應稅',IIF(F30='2','零稅',IIF(F30='3','免稅','')))  
       THISFORM.LBLF47.CAPTION=IIF(F47='E','發票交付類別：交換',IIF(F29='31','發票交付類別：存證',''))
       THISFORM.LBLF261.CAPTION=C01.F26            
       THISFORM.LBLF161.CAPTION=IIF(!EMPTY(C01.F16),DTCX(C01.F16),'')
       THISFORM.LBLF191.CAPTION=IIF(!EMPTY(C01.F19),DTCX(C01.F19),'')
       THISFORM.LBLF151.CAPTION=IIF(C01.F15='0','現結',IIF(C01.F15='1','月結',IIF(C01.F15='2','次月結','T/T  '+ALLTRIM(STR(F36))+'  天')))
       THISFORM.LBLF181.CAPTION=IIF(SEEK(F18,'A01'),A01.F03,'')
       THISFORM.LBLF231.CAPTION=IIF(SEEK(F23,'A01'),A01.F03,'')
       THISFORM.LBLF331.CAPTION=IIF(SEEK(F33,'A01'),A01.F03,'')     
       THISFORM.LBLF981.CAPTION=C01.F98
       THISFORM.COMBOBOX03.DISPLAYVALUE=F03
       THISFORM.COMBOBOX42.DISPLAYVALUE=IIF(F42='2','對方','我方')
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.REFRESH
  ENDPROC       
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK    &&新增資料
    THISFORM.SETALL('READONLY',.F.,'TEXTBOX')     
   
    
    THISFORM.TXTF25.READONLY=.F.
    THISFORM.TXTF03.VISIBLE=.F.
    THISFORM.TXTF15.VISIBLE=.F.
    THISFORM.TXTF42.VISIBLE=.F.
    THISFORM.TXTF46.VALUE='N'
    THISFORM.COMBOBOX03.VISIBLE=.T.
    THISFORM.COMBOBOX03.ENABLED=.T.    
    THISFORM.COMBOBOX42.VISIBLE=.T.
    THISFORM.COMBOBOX42.ENABLED=.T.        
    THISFORM.COMBOBOX15.VISIBLE=.T.
    THISFORM.COMBOBOX15.ENABLED=.T.
    THISFORM.CT_TYPE.ENABLED=.T.
    THISFORM.CT_TYPE.VISIBLE=.T.
    THISFORM.CT_TYPE.VALUE=9
    THISFORM.TXTF37.READONLY=.T.    
    THISFORM.TXTF39.VISIBLE=.F.
    THISFORM.CRCY.VISIBLE=.T. 
    THISFORM.TXTF29.VISIBLE=.F.
    THISFORM.INV_TYPE.VISIBLE=.T.
    THISFORM.LBLF30.VISIBLE=.F.
    THISFORM.LBLF47.VISIBLE=.F.
    THISFORM.TAX_TYPE.VISIBLE=.T.
    THISFORM.EPAY_TYPE.VISIBLE=.T.
    IF INT_003=.T.
       H='C000 '    
       SELE A0I   
       SET ORDER TO 1
       SEEK H           
       IF FOUND() 
          PO_NO=F08
          RLOCK()
          DELE 
          UNLOCK
       ELSE
          SELE A09
          SEEK H
          IF FOUND()
             RLOCK()
             PO_NO=RIGHT(ALLTRIM(F08),4)
             HX=VAL(PO_NO)+1
             PO_NO='0000'
             PO_NO=LEFT(F08,1)+STUFF(PO_NO,5-INT(LOG(HX)/LOG(10)+1),INT(LOG(HX)/LOG(10)+1),RIGHT(STR(HX),INT(LOG(HX)/LOG(10)+1)))
             REPL F08 WITH PO_NO
             UNLOCK              
          ENDIF   
       ENDIF       
       THISFORM.TXTF01.VALUE=PO_NO
       THISFORM.TXTF44.VALUE=PO_NO 
       THISFORM.TXTF01.REFRESH
       THISFORM.TXTF01.READONLY=.T.
       THISFORM.TXTF02.SETFOCUS
    ELSE
       THISFORM.TXTF01.VALUE=''
       THISFORM.TXTF01.SETFOCUS   
    ENDIF   
    THISFORM.TXTF02.VALUE=''
    THISFORM.TXTF03.VALUE=''
    THISFORM.TXTF04.VALUE=''
    THISFORM.COMBOBOX03.VALUE=1
    THISFORM.COMBOBOX42.VALUE=1
    THISFORM.TXTF04.VALUE=''
    THISFORM.TXTF41.VALUE=''
    THISFORM.TXTF05.VALUE=''
    THISFORM.TXTF06.VALUE=''
    THISFORM.TXTF07.VALUE=''
    THISFORM.TXTF08.VALUE=''
    THISFORM.TXTF09.VALUE=''
    THISFORM.TXTF10.VALUE=''
    THISFORM.TXTF11.VALUE=''
    THISFORM.TXTF12.VALUE=''
    THISFORM.TXTF13.VALUE=''
    THISFORM.TXTF14.VALUE=''
    THISFORM.TXTF15.VALUE='0'
    THISFORM.LBLF151.CAPTION='現結'
    THISFORM.COMBOBOX15.VALUE=1
    
    THISFORM.TXTF17.VALUE='31'
    THISFORM.TXTF18.VALUE=''
    
    THISFORM.LBLF181.CAPTION=''
    THISFORM.LBLF231.CAPTION=''
    THISFORM.LBLF331.CAPTION=''
    THISFORM.TXTF20.VALUE=''
    THISFORM.TXTF21.VALUE=''
    THISFORM.TXTF22.VALUE=''
    THISFORM.TXTF23.VALUE=''
    THISFORM.TXTF24.VALUE='首次交易請付現金'
    THISFORM.TXTF40.VALUE=''
    THISFORM.TXTF25.VALUE=''
    THISFORM.LBLF261.CAPTION=''
    THISFORM.TXTF27.VALUE=0
    THISFORM.TXTF28.VALUE=''
    THISFORM.TXTF29.VALUE=''
    THISFORM.LBLF30.CAPTION=''
    THISFORM.LBLF47.CAPTION=''
    THISFORM.TXTF31.VALUE=''
    THISFORM.TXTF32.VALUE=''
    THISFORM.TXTF33.VALUE=''
    THISFORM.TXTF34.VALUE=''
    THISFORM.TXTF35.VALUE=''
    THISFORM.TXTF36.VALUE=0
    THISFORM.TXTF37.VALUE=0
    THISFORM.TXTF38.VALUE=1
    THISFORM.TXTF46.VALUE='N'
    THISFORM.CRCY.DISPLAYVALUE=INT_011
    THISFORM.LBLF981.CAPTION=''
    THISFORM.GRID1.ENABLED=.F.
    THISFORM.ANS_BOTT.ENABLED=.F.
    THISFORM.EXCEL_BOTT.ENABLED=.F.
   * FLG='1'
  ENDPROC  
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK  &&修改資料
     THISFORM.TXTF01.READONLY=.T.
     IF A02.F09='*' 
         THISFORM.TXTF18.READONLY=.F.
         THISFORM.TXTF23.READONLY=.F.     
         THISFORM.TXTF33.READONLY=.F.     
         THISFORM.TXTF03.READONLY=.F.
         THISFORM.TXTF24.READONLY=.F.   
         THISFORM.TXTF27.READONLY=.F.     
         THISFORM.TXTF42.READONLY=.F.
         THISFORM.COMBOBOX03.VISIBLE=.T.
         THISFORM.COMBOBOX03.ENABLED=.T.         
         THISFORM.COMBOBOX42.VISIBLE=.T.
         THISFORM.COMBOBOX42.ENABLED=.T.              
         THISFORM.TXTF15.VISIBLE=.F.
         THISFORM.COMBOBOX15.VISIBLE=.T.
         THISFORM.COMBOBOX15.ENABLED=.T.
         THISFORM.COMBOBOX15.VALUE=IIF(C01.F15='0',1,IIF(C01.F15='1',2,IIF(C01.F15='2',3,4)))
         THISFORM.TXTF36.READONLY=IIF(C01.F15='3',.F.,.T.)
         THISFORM.TXTF36.VISIBLE=IIF(C01.F15='3',.T.,.F.)
         THISFORM.TXTF37.READONLY=IIF(C01.F15='0' .OR. C01.F15='3',.T.,.F.)         
         THISFORM.LBLF151.LEFT=IIF(C01.F15='3',INT_015*625,INT_015*590)
         THISFORM.COMBOBOX03.SETFOCUS 
     ELSE
          THISFORM.TXTF18.READONLY=.T.
          THISFORM.TXTF23.READONLY=.T.     
          THISFORM.TXTF33.READONLY=.T.     
          THISFORM.TXTF03.READONLY=.T.
          THISFORM.TXTF24.READONLY=.T. 
          THISFORM.TXTF27.READONLY=.T.
          THISFORM.TXTF15.READONLY=.T.
          THISFORM.TXTF36.READONLY=.T.
          THISFORM.TXTF37.READONLY=.T.
          THISFORM.TXTF38.READONLY=.T.
          THISFORM.TXTF02.SETFOCUS 
     ENDIF    
    
     THISFORM.CT_TYPE.ENABLED=.T.
     THISFORM.CT_TYPE.VISIBLE=.T.
     THISFORM.CT_TYPE.DISPLAYVALUE=CTP(C01.F43)   
     
     THISFORM.TXTF25.READONLY=.F.
     THISFORM.TXTF29.VISIBLE=.F.
     THISFORM.INV_TYPE.VISIBLE=.T.
     THISFORM.LBLF30.VISIBLE=.F.
     THISFORM.LBLF47.VISIBLE=.F.
     THISFORM.TAX_TYPE.VISIBLE=.T.
     THISFORM.EPAY_TYPE.VISIBLE=.T.
     THISFORM.GRID1.ENABLED=.F.
     THISFORM.ANS_BOTT.ENABLED=.F.     
     THISFORM.EXCEL_BOTT.ENABLED=.F.
     THISFORM.INV_TYPE.VALUE=IIF(C01.F29='31',1,IIF(C01.F29='32',2,0))
     THISFORM.TAX_TYPE.VALUE=IIF(C01.F30='1',1,IIF(C01.F30='2',2,IIF(C01.F30='3',3,0)))  
     THISFORM.EPAY_TYPE.VISIBLE=IIF(C01.F29='31',.T.,.F.)
     THISFORM.EPAY_TYPE.VALUE=IIF(C01.F47='E',2,1) 
     THISFORM.TXTF39.VISIBLE=.F.
     THISFORM.CRCY.VISIBLE=.T.
     THISFORM.CRCY.DISPLAYVALUE=THISFORM.TXTF39.VALUE
     SELECT C01
     LOCK()
     IF !RLOCK()
        DO FILE_IMPACT
        THISFORM.SHRGROUP.ABANDON_BOTT.CLICK                    
*        RETURN
     ENDIF
  ENDPROC      
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK  &&刪除資料
  IF MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	   
     SELE C02
     SEEK C01.F01
     IF FOUND()
        =MESSAGEBOX('此客戶仍有報價資料,無法刪除',0+64,'注意')
        SELE C01
        THISFORM.GRID1.SETFOCUS
        RETURN
     ENDIF   
     SELE C05
     SEEK C01.F01
     IF FOUND()
        =MESSAGEBOX('此客戶仍有出貨計劃,無法刪除',0+64,'注意')
        SELE C01
        THISFORM.GRID1.SETFOCUS
        RETURN
     ENDIF   
     *****檢查應收帳款
     SELE C19   
     SEEK C01.F01
     IF FOUND()
        =MESSAGEBOX('此客戶仍有售價設定資料,無法刪除',0+64,'注意')
        SELE C01
        THISFORM.GRID1.SETFOCUS        
        RETURN
     ENDIF
        SELE C01
        LOCK()
        IF RLOCK()
           IF INT_003=.T.
              SELE A0I
              SET ORDER TO 1
              APPEND BLANK
              LOCK()
              REPL F01 WITH 'C000 '
              REPL F06 WITH '客戶編號'
              REPL F08 WITH C01.F01
              UNLOCK
           ENDIF   
           SELE C01
           DELE
           UNLOCK
           SKIP -1
           IF BOF()
              GO TOP
           ENDIF  
           THISFORM.GRID1.SETFOCUS()
           IF THISFORM.GRID1.ACTIVEROW=0
              THISFORM.SETALL('VALUE','','TEXTBOX')
              THISFORM.LBLF151.CAPTION=''
              THISFORM.LBLF181.CAPTION=''
              THISFORM.LBLF261.CAPTION=''
              THISFORM.CMDGROUP.ENABLED=.F.
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
           ELSE
              THISFORM.CMDGROUP.ENABLED=.T. 
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限    
              THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無查詢報價紀錄的權限        
              THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.)      
           ENDIF 
        ELSE
          DO FILE_IMPACT    
        ENDIF     
     ENDIF   
  ENDPROC
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK  &&新增確認
    SELE C01
    COD=SYS(21)
    SET ORDER TO C011
    SEEK ALLTRIM(THISFORM.TXTF01.VALUE)
    IF FOUND()
       =MESSAGEBOX('客戶編號重複!',0+64,'提示視窗')
       SET ORDER TO &COD
       RETURN
    ENDIF
    IF EMPTY(THISFORM.TXTF02.VALUE)
       =MESSAGEBOX('索引簡碼不得空白!且不得少於四碼',0+64,'提示視窗')   
       SET ORDER TO &COD
       THISFORM.TXTF02.SETFOCUS
       RETURN
    ENDIF
     IF EMPTY(THISFORM.TXTF05.VALUE)
        =MESSAGEBOX('公司簡稱不得空白!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF05.SETFOCUS
        RETURN
     ENDIF    
     IF EMPTY(THISFORM.TXTF44.VALUE)
        =MESSAGEBOX('統制客編不得空白!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF44.SETFOCUS
        RETURN
     ENDIF    
     IF chk_unit(thisform.txtf10.value)=.f. AND !EMPTY(ALLTRIM(THISFORM.TXTF10.VALUE))
        =MESSAGEBOX('統一編號輸入錯誤!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        thisform.txtf10.setfocus
        return
     endif
    IF SEEK(THISFORM.TXTF18.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF18.VALUE)
       =MESSAGEBOX('業務A資料輸入錯誤!',0+64,'提示視窗')   
       THISFORM.TXTF18.SETFOCUS
       SET ORDER TO &COD
       RETURN
     ENDIF
    IF SEEK(THISFORM.TXTF23.VALUE,'A01','A01')=.F. AND !EMPTY(THISFORM.TXTF23.VALUE)
       =MESSAGEBOX('業務助理資料輸入錯誤!',0+64,'提示視窗')   
       THISFORM.TXTF23.SETFOCUS
        SET ORDER TO &COD
       RETURN
     ENDIF     
*!*	    IF SEEK(THISFORM.TXTF33.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF33.VALUE)
*!*	       =MESSAGEBOX('業務B資料輸入錯誤!',0+64,'提示視窗')   
*!*	       THISFORM.TXTF33.SETFOCUS
*!*	       SET ORDER TO &COD
*!*	       RETURN
*!*	     ENDIF           
     IF EMPTY(ALLTRIM(THISFORM.TXTF10.VALUE)) AND THISFORM.INV_TYPE.VALUE=1
         =MESSAGEBOX('無統編客戶之發票種類不能設為三聯式!',0+64,'提示視窗')   
        THISFORM.INV_TYPE.VALUE=2         
     ENDIF   
     THISFORM.INV_TYPE.VALUE=1
     IF EMPTY(THISFORM.TXTF17.VALUE)
        =MESSAGEBOX('入帳日期不得空白!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF17.SETFOCUS
        RETURN
     ENDIF 
*!*	    IF THISFORM.COMBOBOX15.VALUE=4
*!*		 IF EMPTY(THISFORM.TXTF36.VALUE)
*!*		      =MESSAGEBOX('T/T之天數不得空白!',0+48,'提示訊息視窗')
*!*		      SET ORDER TO &COD
*!*		      THISFORM.TXTF36.SETFOCUS
*!*		      RETURN
*!*		 ENDIF        
*!*	    ENDIF     
*!*	     IF EMPTY(THISFORM.TXTF37.VALUE)
*!*	        =MESSAGEBOX('票期天數不得空白!',0+48,'提示訊息視窗')
*!*	        SET ORDER TO &COD
*!*	        THISFORM.TXTF37.SETFOCUS
*!*	        RETURN
*!*	     ENDIF
     IF EMPTY(THISFORM.TXTF38.VALUE)
        =MESSAGEBOX('請款日不得為零!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF
     IF THISFORM.TXTF38.VALUE>31
        =MESSAGEBOX('請款日不得超過31日!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF                
   SELECT C01
   SET ORDER TO 3   && F05  
    IF IIF(SEEK((ALLTRIM(THISFORM.TXTF05.VALUE)),'C01'),.T.,.F.)
        =MESSAGEBOX('此客戶已有資料,請確認後再輸入!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF05.SETFOCUS
        RETURN
     ENDIF
    SELECT C01
    SET ORDER TO &COD
    APPEND BLANK
    LOCK()
    IF RLOCK()
       REPLACE F01 WITH THISFORM.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.TXTF02.VALUE
       REPLACE F03 WITH ALLTRIM(THISFORM.COMBOBOX03.DISPLAYVALUE)
       DO CASE
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='OEM    '
               REPLACE F43 WITH 'E'       
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='ODM    '
               REPLACE F43 WITH 'D'
         CASE THISFORM.CT_TYPE.DISPLAYVALUE='OBM    '
               REPLACE F43 WITH 'B'              
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='OEM&ODM'
               REPLACE F43 WITH 'O'
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='CMMS   '
               REPLACE F43 WITH 'C'
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='EMS    '
               REPLACE F43 WITH 'M'
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='貿易商 '
               REPLACE F43 WITH 'T'
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='加工廠 '
               REPLACE F43 WITH 'K'    
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='其他   '
               REPLACE F43 WITH 'A'                   
       ENDCASE
       REPLACE F04 WITH THISFORM.TXTF04.VALUE
       REPLACE F41 WITH THISFORM.TXTF41.VALUE
       REPLACE F05 WITH THISFORM.TXTF05.VALUE
       REPLACE F06 WITH THISFORM.TXTF06.VALUE
       REPLACE F07 WITH THISFORM.TXTF07.VALUE
       REPLACE F08 WITH THISFORM.TXTF08.VALUE
       REPLACE F09 WITH THISFORM.TXTF09.VALUE
       REPLACE F10 WITH THISFORM.TXTF10.VALUE
       REPLACE F11 WITH THISFORM.TXTF11.VALUE
       REPLACE F12 WITH THISFORM.TXTF12.VALUE
       REPLACE F13 WITH THISFORM.TXTF13.VALUE
       REPLACE F14 WITH THISFORM.TXTF14.VALUE
       REPLACE F15 WITH THISFORM.TXTF15.VALUE
       REPLACE F17 WITH THISFORM.TXTF17.VALUE
       REPLACE F18 WITH THISFORM.TXTF18.VALUE
       REPLACE F20 WITH THISFORM.TXTF20.VALUE
       REPLACE F21 WITH THISFORM.TXTF21.VALUE
       REPLACE F22 WITH THISFORM.TXTF22.VALUE
       REPLACE F23 WITH THISFORM.TXTF23.VALUE
       REPLACE F24 WITH THISFORM.TXTF24.VALUE
       REPLACE F40 WITH THISFORM.TXTF40.VALUE
       REPLACE F25 WITH THISFORM.TXTF25.VALUE
       REPLACE F26 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       REPLACE F27 WITH THISFORM.TXTF27.VALUE
       REPLACE F28 WITH THISFORM.TXTF28.VALUE
       REPLACE F29 WITH IIF(THISFORM.INV_TYPE.VALUE=1,'31','32')
       REPLACE F30 WITH ALLTRIM(STR(THISFORM.TAX_TYPE.VALUE))
       REPLACE F47 WITH IIF(THISFORM.EPAY_TYPE.VALUE=2,'E','')
       REPLACE F31 WITH THISFORM.TXTF31.VALUE
       REPLACE F32 WITH THISFORM.TXTF32.VALUE
       REPLACE F33 WITH THISFORM.TXTF33.VALUE
       REPLACE F34 WITH THISFORM.TXTF34.VALUE
       REPLACE F35 WITH THISFORM.TXTF35.VALUE
       REPLACE F44 WITH THISFORM.TXTF44.VALUE
       REPLACE F46 WITH THISFORM.TXTF46.VALUE
       REPLACE F45 WITH IIF(THISFORM.TXTF46.VALUE='Y',F44,F01)
       IF THISFORM.COMBOBOX15.VALUE=4
            REPLACE F36 WITH THISFORM.TXTF36.VALUE
       ENDIF       
       REPLACE F37 WITH THISFORM.TXTF37.VALUE
       REPLACE F38 WITH THISFORM.TXTF38.VALUE
       REPLACE F39 WITH THISFORM.CRCY.DISPLAYVALUE
       REPLACE F42 WITH IIF(ALLTRIM(THISFORM.COMBOBOX42.DISPLAYVALUE)='我方','1','2')
    ENDIF
    UNLOCK
    SET ORDER TO &COD
    THISFORM.REC_COUNT.CAPTION=STR(RECCOUNT())
    THISFORM.GRID1.ENABLED=.T.
    THISFORM.REFRESH
    THISFORM.GRID1.SETFOCUS    
    THISFORM.ORPGROUP.NEW_BOTT.CLICK            
  ENDPROC
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK      &&修改確認
     IF EMPTY(THISFORM.TXTF05.VALUE)
        =MESSAGEBOX('公司簡稱不得空白!',0+48,'提示訊息視窗')
        THISFORM.TXTF05.SETFOCUS
        RETURN
     ENDIF     
     IF EMPTY(THISFORM.TXTF44.VALUE)
        =MESSAGEBOX('統制客編不得空白!',0+48,'提示訊息視窗')
        THISFORM.TXTF44.SETFOCUS
        RETURN
     ENDIF    
     IF chk_unit(thisform.txtf10.value)=.f. AND !EMPTY(ALLTRIM(THISFORM.TXTF10.VALUE))
        =MESSAGEBOX('統一編號輸入錯誤!',0+48,'提示訊息視窗')
        thisform.txtf10.setfocus
        return
     endif     
    IF SEEK(THISFORM.TXTF18.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF18.VALUE)
       =MESSAGEBOX('業務A資料輸入錯誤!',0+64,'提示視窗')   
       THISFORM.TXTF18.SETFOCUS
       RETURN
     ENDIF
    IF SEEK(THISFORM.TXTF23.VALUE,'A01','A01')=.F. AND !EMPTY(THISFORM.TXTF23.VALUE)
       =MESSAGEBOX('業務助理資料輸入錯誤!',0+64,'提示視窗')   
       THISFORM.TXTF23.SETFOCUS
       RETURN
     ENDIF     
*!*	   IF SEEK(THISFORM.TXTF33.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF33.VALUE)
*!*	       =MESSAGEBOX('業務B資料輸入錯誤!',0+64,'提示視窗')   
*!*	       THISFORM.TXTF33.SETFOCUS
*!*	       RETURN
*!*	     ENDIF              
    IF EMPTY(THISFORM.TXTF02.VALUE)
       =MESSAGEBOX('索引簡碼不得空白!且不得少於四碼',0+64,'提示視窗')   
       THISFORM.TXTF02.SETFOCUS
       RETURN
    ENDIF     
*!*	    IF THISFORM.COMBOBOX15.VALUE=4
*!*		 IF EMPTY(THISFORM.TXTF36.VALUE)
*!*		      =MESSAGEBOX('T/T之天數不得空白!',0+48,'提示訊息視窗')
*!*		      THISFORM.TXTF36.SETFOCUS
*!*		      RETURN
*!*		 ENDIF        
*!*	    ENDIF
*!*	     IF EMPTY(THISFORM.TXTF37.VALUE)
*!*	        =MESSAGEBOX('票期天數不得空白!',0+48,'提示訊息視窗')
*!*	        THISFORM.TXTF37.SETFOCUS
*!*	        RETURN
*!*	     ENDIF
     IF EMPTY(ALLTRIM(THISFORM.TXTF10.VALUE)) AND THISFORM.INV_TYPE.VALUE=1
         =MESSAGEBOX('無統編客戶之發票種類不能設為三聯式!',0+64,'提示視窗')   
        THISFORM.INV_TYPE.VALUE=2               
     ENDIF   
     IF EMPTY(THISFORM.TXTF38.VALUE)
        =MESSAGEBOX('請款日不得為零!',0+48,'提示訊息視窗')
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF     
     IF THISFORM.TXTF38.VALUE>31
        =MESSAGEBOX('請款日不得超過31日!',0+48,'提示訊息視窗')
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF        
    SELE C01
    IF RLOCK()
       REPLACE F02 WITH THISFORM.TXTF02.VALUE
       REPLACE F03 WITH ALLTRIM(THISFORM.COMBOBOX03.DISPLAYVALUE)
       DO CASE
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='OEM    '
               REPLACE F43 WITH 'E'       
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='ODM    '
               REPLACE F43 WITH 'D'
         CASE THISFORM.CT_TYPE.DISPLAYVALUE='OBM    '
               REPLACE F43 WITH 'B'                            
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='OEM&ODM'
               REPLACE F43 WITH 'O'
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='CMMS   '
               REPLACE F43 WITH 'C'
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='EMS    '
               REPLACE F43 WITH 'M'
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='貿易商 '
               REPLACE F43 WITH 'T'
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='加工廠 '
               REPLACE F43 WITH 'K'    
          CASE THISFORM.CT_TYPE.DISPLAYVALUE='其他   '
               REPLACE F43 WITH 'A'                   
       ENDCASE
       
       REPLACE F04 WITH THISFORM.TXTF04.VALUE
       REPLACE F41 WITH THISFORM.TXTF41.VALUE
       REPLACE F05 WITH THISFORM.TXTF05.VALUE
       REPLACE F06 WITH THISFORM.TXTF06.VALUE
       REPLACE F07 WITH THISFORM.TXTF07.VALUE
       REPLACE F08 WITH THISFORM.TXTF08.VALUE
       REPLACE F09 WITH THISFORM.TXTF09.VALUE
       REPLACE F10 WITH THISFORM.TXTF10.VALUE
       REPLACE F11 WITH THISFORM.TXTF11.VALUE
       REPLACE F12 WITH THISFORM.TXTF12.VALUE
       REPLACE F13 WITH THISFORM.TXTF13.VALUE
       REPLACE F14 WITH THISFORM.TXTF14.VALUE
       REPLACE F15 WITH THISFORM.TXTF15.VALUE
       REPLACE F17 WITH THISFORM.TXTF17.VALUE
       REPLACE F18 WITH THISFORM.TXTF18.VALUE
       REPLACE F20 WITH THISFORM.TXTF20.VALUE
       REPLACE F21 WITH THISFORM.TXTF21.VALUE
       REPLACE F22 WITH THISFORM.TXTF22.VALUE
       REPLACE F23 WITH THISFORM.TXTF23.VALUE
       REPLACE F24 WITH THISFORM.TXTF24.VALUE
       REPLACE F40 WITH THISFORM.TXTF40.VALUE
       REPLACE F25 WITH THISFORM.TXTF25.VALUE
       REPLACE F26 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       REPLACE F27 WITH THISFORM.TXTF27.VALUE
       REPLACE F28 WITH THISFORM.TXTF28.VALUE
       REPLACE F29 WITH IIF(THISFORM.INV_TYPE.VALUE=1,'31','32')
       REPLACE F30 WITH ALLTRIM(STR(THISFORM.TAX_TYPE.VALUE))
       REPLACE F47 WITH IIF(THISFORM.EPAY_TYPE.VALUE=2,'E','')
       REPLACE F31 WITH THISFORM.TXTF31.VALUE
       REPLACE F32 WITH THISFORM.TXTF32.VALUE
       REPLACE F33 WITH THISFORM.TXTF33.VALUE
       REPLACE F34 WITH THISFORM.TXTF34.VALUE
       REPLACE F35 WITH THISFORM.TXTF35.VALUE
       REPLACE F44 WITH THISFORM.TXTF44.VALUE
       REPLACE F46 WITH THISFORM.TXTF46.VALUE
       REPLACE F45 WITH IIF(THISFORM.TXTF46.VALUE='Y',F44,F01)
       IF THISFORM.COMBOBOX15.VALUE=4
            REPLACE F36 WITH THISFORM.TXTF36.VALUE
       ENDIF
       REPLACE F37 WITH THISFORM.TXTF37.VALUE
       REPLACE F38 WITH THISFORM.TXTF38.VALUE  
       REPLACE F39 WITH THISFORM.CRCY.DISPLAYVALUE  
       REPLACE F42 WITH IIF(ALLTRIM(THISFORM.COMBOBOX42.DISPLAYVALUE)='我方','1','2')
       IF A02.F09='*'  
          REPLACE F98 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'') 
       ENDIF
       IF F01<>F45
          SELECT C02
          UPDATE C02 SET F01=C01.F45 WHERE F01=C01.F01
          IF !USED('C21')
             SELECT 0
             USE C21
          ELSE
             SELECT C21
          ENDIF
          SET ORDER TO 1       
          UPDATE C21 SET F01=C01.F45 WHERE F01=C01.F01
          USE
          SELECT C01
       ENDIF
    ELSE
      DO FILE_IMPACT
      RETURN   
    ENDIF   
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC   
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK  &&放棄
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限      
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.KEY_LIST.ENABLED=.T.      
      THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無查詢報價紀錄的權限      
      THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.) 
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.TXTF03.VISIBLE=.T.
      THISFORM.TXTF15.VISIBLE=.T.
      THISFORM.TXTF42.VISIBLE=.T.
      THISFORM.LBLF151.LEFT=INT_015*590
      THISFORM.COMBOBOX03.VISIBLE=.F.
      THISFORM.COMBOBOX03.ENABLED=.F.            
      THISFORM.COMBOBOX15.VISIBLE=.F.
      THISFORM.COMBOBOX15.ENABLED=.F.      
      THISFORM.COMBOBOX42.VISIBLE=.F.
      THISFORM.COMBOBOX42.ENABLED=.F.            
      THISFORM.CT_TYPE.ENABLED=.F.
      THISFORM.CT_TYPE.VISIBLE=.F.
      THISFORM.TXTF36.READONLY=.T.
      THISFORM.TXTF36.VISIBLE=.F.
      THISFORM.TXTF25.READONLY=.T. 
      THISFORM.TXTF29.VISIBLE=.T.
      THISFORM.INV_TYPE.VISIBLE=.F.
      THISFORM.LBLF30.VISIBLE=.T.
      THISFORM.LBLF47.VISIBLE=.T.
      THISFORM.TAX_TYPE.VISIBLE=.F.
      THISFORM.EPAY_TYPE.VISIBLE=.F.
      THISFORM.TXTF39.VISIBLE=.T.
      THISFORM.CRCY.VISIBLE=.F.
      UNLOCK ALL
      SELE C01
      THISFORM.GRID1.ENABLED=.T.
      THISFORM.GRID1.SETFOCUS
  ENDPROC
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK  &&結束
      IF INT_003=.T.
         SELE A0I
         SET ORDER TO 1
         APPEND BLANK
         LOCK()
         REPL F01 WITH 'C000 '
         REPL F06 WITH '客戶編號'
         REPL F08 WITH PO_NO
         UNLOCK
       ENDIF  
       SELE C01
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
  PROC ANS_BOTT.CLICK
       SELE F03,F02,F04,F06,F07,F08,F13,F09,F10,F11,F99 FROM C02 WHERE F01=C01.F01 ORDER BY F03,F02 INTO CURSOR C02_1 READWRITE
       INDEX ON F03 + DTOS(F02) + F04 TAG C02_11
       INDEX ON F04 + DTOS(F02) + F03 TAG C02_12
       IF _TALLY>0
         SLP_SEEK=CREATEOBJECT("SLP_SEEK")  
         SLP_SEEK.SHOW                                      
         AREA1='C01'
         THISFORM.GRID1.SETFOCUS
       ELSE
         =MESSAGEBOX('此客戶無報價紀錄',0+64,'提示視窗')   
         RETURN       
       ENDIF
       THISFORM.GRID1.SETFOCUS
  ENDPROC  
  PROC EXCEL_BOTT.CLICK
       EXBO='1'
       SELECT C01
       ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
       ANS_RANGE.SHOW 
       EXBO=''
       THISFORM.GRID1.SETFOCUS
  ENDPROC   
  PROCEDURE txtf25.init
     *ON KEY LABEL RIGHTMOUSE  DO remouse 
  ENDPROC
  PROCEDURE INV_TYPE.INTERACTIVECHANGE
       IF THIS.VALUE=1
          THISFORM.EPAY_TYPE.VISIBLE=.T.          
       ELSE
          THISFORM.EPAY_TYPE.VISIBLE=.F.
          THISFORM.EPAY_TYPE.VALUE=1
       ENDIF
  ENDPROC
ENDDEFINE    
************************************************報價紀錄
DEFINE CLASS SLP_SEEK AS FORM
  AUTOCENTER=.T.
  CAPTION='C02.報價紀錄'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*340
  WIDTH=INT_015*792
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='SLP_SEEK'
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      TOP=INT_015*313,;
      AUTOSIZE=.T.,;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID WITH;          
      AUTOCENTER=.T.,;
      TOP=INT_015*0,;
      WIDTH=INT_015*792,;      
      HEIGHT=INT_015*310,;      
      DELETEMARK=.F.,;
      READONLY=.T.,;
      ROWHEIGHT=INT_015*18,;
      HEADERHEIGHT=INT_015*19,;
      ALLOWCELLSELECTION=.T.,;
      HIGHLIGHTROWLINEWIDTH=4,;
      ALLOWROWSIZING=.F.,;
      RECORDSOURCETYPE=1,; 
      COLUMNCOUNT=10,;            
      NAME='GRID1',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;      
      COLUMN3.NAME='COLUMN3',;      
      COLUMN4.NAME='COLUMN4',;      
      COLUMN5.NAME='COLUMN5',;      
      COLUMN6.NAME='COLUMN6',;      
      COLUMN7.NAME='COLUMN7',;      
      COLUMN8.NAME='COLUMN8',;      
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10'      
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;      
      TOP=INT_015*310,;
      LEFT=INT_015*330,;
      VISIBLE=.T.    
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*545,;
      TOP=INT_015*314,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<X.離開',;
      TOOLTIPTEXT='離開此查詢尋畫面!快速鍵->ALT+X'
      NAME='CMND2'
      PROCEDURE INIT 
         AREA1='C02_1' 
         SELECT C02_1
         SET ORDER TO C02_11
         THISFORM.GRID1.READONLY=.T. 
         THISFORM.GRID1.RECORDSOURCE='C02_1'
         THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
         THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
         THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料號'
         THISFORM.GRID1.COLUMN1.CONTROLSOURCE='F03'         
         THISFORM.GRID1.COLUMN1.WIDTH=INT_015*160   
         THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶料號/品號'
         THISFORM.GRID1.COLUMN2.CONTROLSOURCE='F04'         
         THISFORM.GRID1.COLUMN2.WIDTH=INT_015*100   
         THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='報價日期'
         THISFORM.GRID1.COLUMN3.CONTROLSOURCE='F02'         
         THISFORM.GRID1.COLUMN3.WIDTH=INT_015*60
         THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='幣別'
         THISFORM.GRID1.COLUMN4.CONTROLSOURCE='F06'
         THISFORM.GRID1.COLUMN4.WIDTH=INT_015*35
         THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單價'
         THISFORM.GRID1.COLUMN5.CONTROLSOURCE='F07'
         THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
         THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='最小訂貨量'        
         THISFORM.GRID1.COLUMN6.CONTROLSOURCE='F08'
         THISFORM.GRID1.COLUMN6.WIDTH=INT_015*65
         THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='包裝基量'
         THISFORM.GRID1.COLUMN7.CONTROLSOURCE='F13'
         THISFORM.GRID1.COLUMN7.WIDTH=INT_015*50
         THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='交易條件'
         THISFORM.GRID1.COLUMN8.CONTROLSOURCE='F10'
         THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
         THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='報價單號'
         THISFORM.GRID1.COLUMN9.CONTROLSOURCE='F11'
         THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70
         THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='安全資料'
         THISFORM.GRID1.COLUMN10.CONTROLSOURCE='F99'
         THISFORM.GRID1.COLUMN10.WIDTH=INT_015*90
         THISFORM.GRID1.SETFOCUS
         IF THISFORM.GRID1.ACTIVEROW<>0
              THISFORM.GRID1.AFTERROWCOLCHANGE 
         ENDIF
         JK='料號'
      ENDPROC
      PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS XCOLINDEX     
         FCH=THISFORM.ACTIVECONTROL.NAME  
      ENDPROC 
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依料號+報價日期排列')
           .ADDITEM('依客戶料號/品號+報價日期排列')
           .VALUE=1      
       ENDWITH      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELECT  C02_1
       DO CASE
       	  CASE THIS.DISPLAYVALUE='依料號+報價日期排列' 
       	       SET ORDER TO C02_11
	           THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料號'
	           THISFORM.GRID1.COLUMN1.CONTROLSOURCE='F03'         
	           THISFORM.GRID1.COLUMN1.WIDTH=INT_015*160   
	           THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶料號/品號'
	           THISFORM.GRID1.COLUMN2.CONTROLSOURCE='F04'         
	           THISFORM.GRID1.COLUMN2.WIDTH=INT_015*100   
	           THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='報價日期'
	           THISFORM.GRID1.COLUMN3.CONTROLSOURCE='F02'         
	           THISFORM.GRID1.COLUMN3.WIDTH=INT_015*60
	           THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='幣別'
	           THISFORM.GRID1.COLUMN4.CONTROLSOURCE='F06'
	           THISFORM.GRID1.COLUMN4.WIDTH=INT_015*35
	           THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單價'
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE='F07'
	           THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
	           THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='最小訂貨量'        
	           THISFORM.GRID1.COLUMN6.CONTROLSOURCE='F08'
	           THISFORM.GRID1.COLUMN6.WIDTH=INT_015*65
	           THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='包裝基量'
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE='F13'
	           THISFORM.GRID1.COLUMN7.WIDTH=INT_015*50
	           THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='交易條件'
	           THISFORM.GRID1.COLUMN8.CONTROLSOURCE='F10'
	           THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
	           THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='報價單號'
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE='F11'
	           THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70
	           THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='安全資料'
	           THISFORM.GRID1.COLUMN10.CONTROLSOURCE='F99'
	           THISFORM.GRID1.COLUMN10.WIDTH=INT_015*90
       	  CASE THIS.DISPLAYVALUE='依客戶料號/品號+報價日期排列'
       	       SET ORDER TO C02_12
	           THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶料號/品號'
	           THISFORM.GRID1.COLUMN1.CONTROLSOURCE='F04'         
	           THISFORM.GRID1.COLUMN1.WIDTH=INT_015*100   
	           THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料號'
	           THISFORM.GRID1.COLUMN2.CONTROLSOURCE='F03'         
	           THISFORM.GRID1.COLUMN2.WIDTH=INT_015*160   
	           THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='報價日期'
	           THISFORM.GRID1.COLUMN3.CONTROLSOURCE='F02'         
	           THISFORM.GRID1.COLUMN3.WIDTH=INT_015*60
	           THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='幣別'
	           THISFORM.GRID1.COLUMN4.CONTROLSOURCE='F06'
	           THISFORM.GRID1.COLUMN4.WIDTH=INT_015*35
	           THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單價'
	           THISFORM.GRID1.COLUMN5.CONTROLSOURCE='F07'
	           THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
	           THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='最小訂貨量'        
	           THISFORM.GRID1.COLUMN6.CONTROLSOURCE='F08'
	           THISFORM.GRID1.COLUMN6.WIDTH=INT_015*65
	           THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='包裝基量'
	           THISFORM.GRID1.COLUMN7.CONTROLSOURCE='F13'
	           THISFORM.GRID1.COLUMN7.WIDTH=INT_015*50
	           THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='交易條件'
	           THISFORM.GRID1.COLUMN8.CONTROLSOURCE='F10'
	           THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
	           THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='報價單號'
	           THISFORM.GRID1.COLUMN9.CONTROLSOURCE='F11'
	           THISFORM.GRID1.COLUMN9.WIDTH=INT_015*70
	           THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='安全資料'
	           THISFORM.GRID1.COLUMN10.CONTROLSOURCE='F99'
	           THISFORM.GRID1.COLUMN10.WIDTH=INT_015*90
       ENDCASE
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC 
      PROCEDURE CMND2.CLICK
          SELECT C02_1
          USE
          FLG=''   
          THISFORM.RELEASE
      ENDPROC      
ENDDEFINE   
*********************************************************************發票種類
DEFINE CLASS INV_TYPE AS OPTIONGROUP
  HEIGHT=INT_015*25
  TOP=INT_015*424
  LEFT=INT_015*549
  HEIGHT=INT_015*25
  WIDTH=INT_015*120
  FONTSIZE=INT_015*9
  VISIBLE=.F.
  BUTTONCOUNT=2
  VALUE=1
  NAME='INV_TYPE'
  OPTION1.CAPTION='三聯式'
  OPTION1.TOP=INT_015*5
  OPTION1.WIDTH=INT_015*52
  OPTION1.LEFT=INT_015*5
  OPTION1.NAME='OPTION1'
  OPTION2.CAPTION='二聯式'
  OPTION2.TOP=INT_015*5
  OPTION2.WIDTH=INT_015*52
  OPTION2.LEFT=INT_015*59
  OPTION2.NAME='OPTION2'
ENDDEFINE  
*********************************************************************課稅別
DEFINE CLASS TAX_TYPE AS COMBOBOX
  HEIGHT=INT_015*25
  AUTOSIZE=.T.
  TOP=INT_015*424
  LEFT=INT_015*671
  FONTSIZE=INT_015*9
  BOUNDCOLUMN=1
  COLUMNCOUNT=1
  WIDTH=INT_015*52
  ROWSOURCETYPE=1
  VISIBLE=.F.
  VALUE=1
  STYLE=2
  NAME='TAX_TYPE'
  PROCEDURE INIT
     WITH THIS 
          .ADDITEM('應稅')
          .ADDITEM('零稅')          
          .ADDITEM('免稅')          
     ENDWITH   
  ENDPROC
ENDDEFINE        
***********************************************************電子發票交付類別
DEFINE CLASS EPAY_TYPE AS COMBOBOX
  HEIGHT=INT_015*25
  AUTOSIZE=.T.
  TOP=INT_015*424
  LEFT=INT_015*724
  FONTSIZE=INT_015*9
  BOUNDCOLUMN=1
  COLUMNCOUNT=1
  WIDTH=INT_015*52
  ROWSOURCETYPE=1
  VISIBLE=.F.
  VALUE=1
  STYLE=2
  NAME='EPAY_TYPE'
  PROCEDURE INIT
     WITH THIS 
          .ADDITEM('存證')
          .ADDITEM('交換')          
     ENDWITH   
  ENDPROC
ENDDEFINE        
**************************************列印程序 
PROC PNT_PRC
   SELECT C01
   PO_NO=C01.F01
   ANS_CHK=CREATEOBJECT("ANS_CHK")  
   ANS_CHK.SHOW        
ENDPROC
********************************************************
DEFINE CLASS ANS_CHK AS FORM
  AUTOCENTER=.T.
  CAPTION='請選擇列印內容'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*105
  WIDTH=INT_015*230
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_CHK'
ADD OBJECT DATA_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*17,;
      TOP=INT_015*20,;
      AUTOSIZE=.T.,;
      FONTSIZE=INT_015*12,;
      BUTTONCOUNT=3,;
      OPTION1.CAPTION='列印信封',;
      OPTION1.TOP=INT_015*0,;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='列印客戶地址標籤',;
      OPTION2.TOP=INT_015*20,;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.AUTOSIZE=.T.,;      
      OPTION3.CAPTION='列印客戶資料明細',;
      OPTION3.TOP=INT_015*40,;
      OPTION3.FONTSIZE=INT_015*9,;
      OPTION3.AUTOSIZE=.T.,;
      NAME='DATA_OPTION'   
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*20,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<Y.確定',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;
      TOP=INT_015*60,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'     
  *****   
  PROCEDURE CMND1.CLICK   
        DO  CASE
               CASE THISFORM.DATA_OPTION.VALUE=1
*!*			          SELE F07,F04,F12 FROM C01  WHERE F01=PO_NO NOWAIT     
*!*			          IF _TALLY>0
*!*			               REPORT FORM ALLTRIM(INT_116)+'C01' TO PRINT PROMPT        
*!*			          ENDIF               
                      ENV_ITEM=CREATEOBJECT("ENV_ITEM")  
                      ENV_ITEM.SHOW        
               CASE THISFORM.DATA_OPTION.VALUE=2
      			   LBL_QTY=CREATEOBJECT("LBL_QTY")  
         		   LBL_QTY.SHOW                                      
               CASE THISFORM.DATA_OPTION.VALUE=3    
                  	  ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   			  ANS_RANGE.SHOW                  
        ENDCASE  
        THISFORM.CMND2.CLICK                        
  ENDPROC  
******
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE  
******************************************LABEL列印張數
DEFINE CLASS LBL_QTY AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印張數'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*190
  WIDTH=INT_015*200
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='LBL_QTY'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*75,;
      FONTSIZE=INT_015*9,;
      NAME='LABEL1'
      ADD OBJECT TEXT1 AS TEXTBOX WITH;
          AUTOSIZE=.T.,;
          TOP=INT_015*70,;
          WIDTH=INT_015*30,;
          LEFT=INT_015*120,;
          HEIGHT=INT_015*25,; 
          FONTSIZE=INT_015*9,;
          INPUTMASK='99'
          NAME='TEXT1'
      ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
          AUTOSIZE=.T.,;
          LEFT=INT_015*25,;    
          HEIGHT=INT_015*25,;   
          TOP=INT_015*144,;  
          WIDTH=INT_015*80,;
          FONTSIZE=INT_015*9,;          
          CAPTION='\<Y.執行',;
          TOOLTIPTEXT='確認欲列印張數!快速鍵->ALT+Y',;
          NAME='CMND1'
      ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
          AUTOSIZE=.T.,;
          LEFT=INT_015*90,;
          TOP=INT_015*144,;
          HEIGHT=INT_015*25,;
          WIDTH=INT_015*80,;
          FONTSIZE=INT_015*9,;
          CAPTION='\<C.取消',;
          TOOLTIPTEXT='取消列印作業!快速鍵->ALT+C',;
          NAME='CMND2'
      PROCEDURE INIT 
          THISFORM.LABEL1.CAPTION='列印張數'
          THISFORM.TEXT1.VALUE=1
      ENDPROC    
      PROCEDURE CMND1.CLICK 
          SELE F07,F04,F13 FROM C01  WHERE F01=PO_NO INTO CURSOR LBL1
          CREATE CURSOR  LBL2 (F07 C(80), F04 C(40),F13 C(20))
          SELE LBL2
          FOR I=1 TO THISFORM.TEXT1.VALUE
              APPEND BLANK
              REPL F07 WITH LBL1.F07
              REPL F04 WITH LBL1.F04
              REPL F13 WITH LBL1.F13
          ENDFOR
            REPORT FORM ALLTRIM(INT_116) + 'C01A' TO PRINT PROMPT 
*!*	              REPORT FORM ALLTRIM(INT_116)+'C01A' TO PRINT PROMPT PREVIEW
              SELE LBL2
              USE
              SELE LBL1
              USE               
          THISFORM.RELEASE                
      ENDPROC
      PROCEDURE CMND2.CLICK
          THISFORM.RELEASE
      ENDPROC      
ENDDEFINE            
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*110
  WIDTH=INT_015*320
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      WIDTH=INT_015*60,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*25,;
      TOP=INT_015*25,;
      CAPTION='起始編號',;
      NAME='LABEL1'
  ADD OBJECT LABEL2 AS LABEL WITH;
      WIDTH=INT_015*60,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*172,;
      TOP=INT_015*25,;
      CAPTION='截止編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      WIDTH=INT_015*70,;
      TOP=INT_015*19,;
      LEFT=INT_015*85,;
      HEIGHT=INT_015*25,; 
      MAXLENGTH=5,; 
      NAME='TEXT1'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      WIDTH=INT_015*70,;
      TOP=INT_015*19,;
      LEFT=INT_015*230,;
      HEIGHT=INT_015*25,;  
      MAXLENGTH=5,;        
      NAME='TEXT2'    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*90,;    
      HEIGHT=INT_015*25,;   
      TOP=INT_015*70,;  
      WIDTH=INT_015*50,;
      CAPTION='\<Y.執行',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*215,;
      TOP=INT_015*70,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*50,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'
  PROCEDURE INIT 
      SELECT C01
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')                                             
      DO CASE
            CASE KEY()='F01'
                      THISFORM.LABEL1.CAPTION='起始編號'
                      THISFORM.LABEL2.CAPTION='截止編號'
                      THISFORM.TEXT1.MAXLENGTH=5
                      THISFORM.TEXT2.MAXLENGTH=5
                      THISFORM.TEXT1.VALUE=C01.F01
                      THISFORM.TEXT2.VALUE=C01.F01     
            CASE KEY()='F02'
                      THISFORM.LABEL1.CAPTION='起始簡碼'
                      THISFORM.LABEL2.CAPTION='截止簡碼'
                      THISFORM.TEXT1.MAXLENGTH=4
                      THISFORM.TEXT2.MAXLENGTH=4            
                      THISFORM.TEXT1.VALUE=C01.F02
                      THISFORM.TEXT2.VALUE=C01.F02                                 
            CASE KEY()='F05'
                      THISFORM.LABEL1.CAPTION='起始簡稱'
                      THISFORM.LABEL2.CAPTION='截止簡稱'
                      THISFORM.TEXT1.MAXLENGTH=8
                      THISFORM.TEXT2.MAXLENGTH=8           
                      THISFORM.TEXT1.VALUE=C01.F05
                      THISFORM.TEXT2.VALUE=C01.F05   
            CASE KEY()='F10'
                      THISFORM.LABEL1.CAPTION='起始統編'
                      THISFORM.LABEL2.CAPTION='截止統號'
                      THISFORM.TEXT1.MAXLENGTH=8
                      THISFORM.TEXT2.MAXLENGTH=8            
                      THISFORM.TEXT1.VALUE=C01.F10
                      THISFORM.TEXT2.VALUE=C01.F10   
            CASE KEY()='F18'
                      THISFORM.LABEL1.CAPTION='起始業務A'
                      THISFORM.LABEL2.CAPTION='截止業務A'
                      THISFORM.TEXT1.MAXLENGTH=5
                      THISFORM.TEXT2.MAXLENGTH=5            
                      THISFORM.TEXT1.VALUE=C01.F18
                      THISFORM.TEXT2.VALUE=C01.F18   
            CASE KEY()='F33'
                      THISFORM.LABEL1.CAPTION='起始業務B'
                      THISFORM.LABEL2.CAPTION='截止業務B'
                      THISFORM.TEXT1.MAXLENGTH=5
                      THISFORM.TEXT2.MAXLENGTH=5            
                      THISFORM.TEXT1.VALUE=C01.F33
                      THISFORM.TEXT2.VALUE=C01.F33   
            CASE KEY()='F23'
                      THISFORM.LABEL1.CAPTION='起始業助'
                      THISFORM.LABEL2.CAPTION='截止業助'
                      THISFORM.TEXT1.MAXLENGTH=5
                      THISFORM.TEXT2.MAXLENGTH=5            
                      THISFORM.TEXT1.VALUE=C01.F23
                      THISFORM.TEXT2.VALUE=C01.F23
      ENDCASE
  ENDPROC    
  PROCEDURE CMND1.CLICK     
      DO CASE
            CASE KEY()='F01'
                      SELECT * FROM C01 WHERE  C01.F01>=THISFORM.TEXT1.VALUE .AND. C01.F01<=THISFORM.TEXT2.VALUE ORDER BY C01.F01 INTO CURSOR C01_TEMP  
            CASE KEY()='F02'
                      SELECT * FROM C01 WHERE  C01.F02>=THISFORM.TEXT1.VALUE .AND. C01.F02<=THISFORM.TEXT2.VALUE ORDER BY C01.F02 INTO CURSOR C01_TEMP                             
            CASE KEY()='F05'
                      SELECT * FROM C01 WHERE  C01.F05>=THISFORM.TEXT1.VALUE .AND. C01.F05<=THISFORM.TEXT2.VALUE ORDER BY C01.F05 INTO CURSOR C01_TEMP  
            CASE KEY()='F10'
                      SELECT * FROM C01 WHERE  C01.F10>=THISFORM.TEXT1.VALUE .AND. C01.F10<=THISFORM.TEXT2.VALUE ORDER BY C01.F10 INTO CURSOR C01_TEMP  
            CASE KEY()='F18'
                      SELECT * FROM C01 WHERE  C01.F18>=THISFORM.TEXT1.VALUE .AND. C01.F18<=THISFORM.TEXT2.VALUE ORDER BY C01.F18 INTO CURSOR C01_TEMP  
            CASE KEY()='F33'
                      SELECT * FROM C01 WHERE  C01.F33>=THISFORM.TEXT1.VALUE .AND. C01.F33<=THISFORM.TEXT2.VALUE ORDER BY C01.F33 INTO CURSOR C01_TEMP  
            CASE KEY()='F23'
                       SELECT * FROM C01 WHERE  C01.F23>=THISFORM.TEXT1.VALUE .AND. C01.F23<=THISFORM.TEXT2.VALUE ORDER BY C01.F23 INTO CURSOR C01_TEMP
      ENDCASE
        SELECT C01_TEMP
        GO TOP
	IF _TALLY>0
	     IF EMPTY(EXBO)
	         REPORT FORM ALLTRIM(INT_116)+'C01B' TO PRINT PROMPT PREVIEW 
	     ELSE
	         SELECT F01 客戶編號,F02 客戶簡碼,F03 客戶類別,F04 公司名稱,F05 公司簡稱,F06 公司地址,F07 送貨地址,F08 英文地址A,F34 英文地址B,F09 英文名稱,F10 統一編號,;
	                        F11 負責人,F12 連絡人,F13 電話,F14 傳真號碼,F15 結帳方式,F16 最進交易日期,F17 入帳日期,F18 業務A編號,F19 最後報價日,F20 USER自定,F21 USER自定,;
	                        F22 USER自定,F23 業助編號,F24 付款方式,F25 備註,F26 安全資料,F27 信用額度,F28 圖號索引,F29 發票種類,F30 課稅別,F31 交貨方式,F32 出貨指示,F33 業務B編號,;
	                        F35 公司資本,F36 TT之天數,F37 票期天數,F38 請款日 FROM C01_TEMP ORDER BY F01 INTO CURSOR C01AA
	                        SELECT C01AA
	         FILENAME='客戶資料明細'
		 GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		 IF !EMPTY(GCDELIMFILE) 
		      ON ERROR DO FILE_IMPACT
		      COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF     
	     ENDIF
	     THISFORM.CMND2.CLICK
	ELSE
	     =MESSAGEBOX('無此範圍資料',0+48,'警示')
      	     THISFORM.TEXT1.VALUE=''
      	     THISFORM.TEXT2.VALUE=''	     
	     THISFORM.TEXT1.SETFOCUS
	ENDIF         
  ENDPROC
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC        
ENDDEFINE       
**************************************結帳方式
DEFINE CLASS COMBOBOX15 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2   
       VALUE=1
       NAME='COMBOBOX15'
 PROCEDURE INIT    
       THIS.ADDITEM('0')
       THIS.ADDITEM('1')
       THIS.ADDITEM('2')
       THIS.ADDITEM('3')
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
   THISFORM.LBLF151.LEFT=INT_015*590 
   THISFORM.TXTF36.READONLY=.T.
   THISFORM.TXTF36.VISIBLE=.F. 
   THISFORM.TXTF37.READONLY=.F.
       DO CASE 
             CASE THIS.VALUE=1
                        THISFORM.TXTF15.VALUE='0'
                        THISFORM.LBLF151.CAPTION='現結'
                        THISFORM.TXTF37.READONLY=.T.
             CASE THIS.VALUE=2
                        THISFORM.TXTF15.VALUE='1'
                        THISFORM.LBLF151.CAPTION='月結'         
             CASE THIS.VALUE=3
                        THISFORM.TXTF15.VALUE='2'
                        THISFORM.LBLF151.CAPTION='次月結'      
             CASE THIS.VALUE=4                        
                        THISFORM.TXTF15.VALUE='3'
                        THISFORM.LBLF151.CAPTION='T/T  '+ALLTRIM(STR(THISFORM.TXTF36.VALUE))+'  天'
                        THISFORM.LBLF151.LEFT=INT_015*625
                        THISFORM.TXTF36.VISIBLE=.T. 
                        THISFORM.TXTF36.READONLY=.F.
                        THISFORM.TXTF36.VALUE=0     
                        THISFORM.TXTF37.READONLY=.T.
        ENDCASE
       THISFORM.TXTF15.REFRESH    
       THISFORM.TXTF36.REFRESH 
  ENDPROC       
ENDDEFINE
*********T/T天數
DEFINE CLASS TXTF36 AS TEXTBOX
  VISIBLE=.F.
  READONLY=.T.
  MAXLENGTH=4
  WIDTH=INT_015*35
  HEIGHT=INT_015*25
  INPUTMASK='9999'
  FONTSIZE=INT_015*9  
  PROCEDURE INTERACTIVECHANGE     
       THISFORM.LBLF151.CAPTION='T/T  '+ALLTRIM(STR(THIS.VALUE))+'  天'  
  ENDPROC
ENDDEFINE
***************************************************幣別設定
DEFINE CLASS CRCY AS COMBOBOX
  HEIGHT=INT_015*25
  FONTSIZE=INT_015*9     
  AUTOSIZE=.T.
  TOP=INT_015*9
  LEFT=INT_015*474
  VISIBLE = .F.
  BOUNDCOLUMN=1
  COLUMNCOUNT=1
  WIDTH=INT_015*60
  ROWSOURCETYPE=1
  STYLE=2
  NAME='CRCY'
  PROCEDURE INIT
    SELECT C00
    GO TOP 
    DO WHILE .NOT. EOF()
       L=4-LEN(ALLTRIM(F01))
       THIS.ADDITEM(F01)
       SKIP
    ENDDO
  ENDPROC
  PROCEDURE INTERACTIVECHANGE
    THISFORM.TXTF39.VALUE=THIS.DISPLAYVALUE
    THISFORM.TXTF39.REFRESH
  ENDPROC
ENDDEFINE  
*******************  
***********************************************列印信封欄位選項
DEFINE CLASS ENV_ITEM AS FORM
*!*	       AUTOCENTER=.T.
   CAPTION='請選擇信封中欲列出的欄位'
   TOP=INT_015*180
   LEFT=INT_015*220          
   AUTOCENTER=.T.
   FONTSIZE=INT_015*9
   HEIGHT=INT_015*170
   WIDTH=INT_015*355
   FONTSIZE=INT_015*9
   MOVABLE=.F.
   MAXBUTTON=.F.
   MINBUTTON=.F.      
   CONTROLBOX=.F.
   BORDERSTYLE=2
   SHOWTIPS=.T.
   SHOWWINDOW=1
   WINDOWTYPE=1
   NAME='ENV_ITEM'

  ADD OBJECT ADDR_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*10,;
      TOP=INT_015*10,;
      HEIGHT=INT_015*75,;    
      WIDTH=INT_015*80,;      
      BUTTONCOUNT=3,;
      OPTION1.CAPTION='送貨地址',;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.LEFT=INT_015*4,;
      OPTION1.TOP=INT_015*3,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='地        址',;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.LEFT=INT_015*4,;
      OPTION2.TOP=INT_015*28,;
      OPTION2.AUTOSIZE=.T.,;      
      OPTION3.CAPTION='英文地址',;
      OPTION3.FONTSIZE=INT_015*9,;
      OPTION3.LEFT=INT_015*4,;
      OPTION3.TOP=INT_015*53,;
      OPTION3.AUTOSIZE=.T.,;      
      NAME='ADDR_OPTION'
  ADD OBJECT NAME_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*130,;
      TOP=INT_015*10,;
      HEIGHT=INT_015*50,;    
      WIDTH=INT_015*80,;      
      BUTTONCOUNT=2,;
      OPTION1.CAPTION='中文名稱',;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.LEFT=INT_015*4,;
      OPTION1.TOP=INT_015*3,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='英文名稱',;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.LEFT=INT_015*4,;
      OPTION2.TOP=INT_015*28,;
      OPTION2.AUTOSIZE=.T.,;      
      NAME='NAME_OPTION'       
  ADD OBJECT PRSN_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*250,;
      TOP=INT_015*10,;
      HEIGHT=INT_015*75,;    
      WIDTH=INT_015*80,;      
      BUTTONCOUNT=3,;
      OPTION1.CAPTION='連  絡  人',;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.LEFT=INT_015*4,;
      OPTION1.TOP=INT_015*3,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='收  件  人',;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.LEFT=INT_015*4,;
      OPTION2.TOP=INT_015*28,;
      OPTION2.AUTOSIZE=.T.,;      
      OPTION3.CAPTION='不印人名',;
      OPTION3.FONTSIZE=INT_015*9,;
      OPTION3.LEFT=INT_015*4,;
      OPTION3.TOP=INT_015*53,;
      OPTION3.AUTOSIZE=.T.,;            
      NAME='PRSN_OPTION'       
   ADD OBJECT RMK_LBL AS LABEL WITH; 
       LEFT=INT_015*10,;
       TOP=INT_015*96,;   
       HEIGHT=INT_015*25,;
       WIDTH=INT_015*50,;
       FONTSIZE=INT_015*9,;
       CAPTION='特別附註'
   ADD OBJECT RMK_TXT AS TEXTBOX WITH;
       LEFT=INT_015*61,;
       TOP=INT_015*92,;   
       HEIGHT=INT_015*25,;
       WIDTH=INT_015*255,;
       FONTSIZE=INT_015*9,;
       MAXLENGTH=40,;
       NAME="RMK_TXT"
   ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
       LEFT=INT_015*60,;    
       HEIGHT=INT_015*25,;   
       TOP=INT_015*140,;  
       WIDTH=INT_015*50,;
       CAPTION='\<Y.執  行',;
       TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
       NAME='CMND1'
   ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
       LEFT=INT_015*200,;
       TOP=INT_015*140,;
       HEIGHT=INT_015*25,;
       WIDTH=INT_015*50,;
       CAPTION='\<C.取  消',;
       TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
       NAME='CMND2'   
   PROCEDURE INIT 
      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON') 
      THISFORM.SETALL('MOUSEPOINTER',99,'COMMANDBUTTON')
      THISFORM.SETALL('MOUSEICON','BMPS\harrow.CUR','COMMANDBUTTON')          
      THISFORM.NAME_OPTION.VALUE=1               
      THISFORM.ADDR_OPTION.VALUE=1               
      THISFORM.PRSN_OPTION.VALUE=1                
          
   ENDPROC                
   PROCEDURE CMND1.CLICK
      TKX=THISFORM.RMK_TXT.VALUE
      OP1=THISFORM.ADDR_OPTION.VALUE
      OP2= THISFORM.NAME_OPTION.VALUE               
      OP3=THISFORM.PRSN_OPTION.VALUE      
      SELE F04,F06,F07,F08,F09,F12,F34,F40 FROM C01  WHERE F01=PO_NO NOWAIT     
	  IF _TALLY>0
	     REPORT FORM ALLTRIM(INT_116)+'C01' TO PRINT PROMPT        
	   ENDIF               
       THISFORM.CMND2.CLICK
   ENDPROC
   
      PROCEDURE CMND2.CLICK
     
        THISFORM.RELEASE                   
   ENDPROC                      
ENDDEFINE   

