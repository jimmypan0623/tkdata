**程式名稱:出貨日報表
CLOSE ALL
CLEAR 
AREA1='C10'
FLG='0'
FCH=''
CHK=''
UKEF='N  '
EXBO=''
IF !USED('A01')
   SELE 0
   USE A01
ELSE
   SELE A01
ENDIF
SET ORDER TO 1         
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'C10'      
IF !USED('A23')
    SELE 0
    USE A23
ELSE 
   SELE A23
ENDIF
SET ORDER TO 1 
IF !USED ('B01')
   SELE 0
   USE B01 
ELSE 
   SELE B01
ENDIF
SET ORDER TO B011     
B04='B04'+LEFT(DTOS(DATE()),6)
B041='B041'+LEFT(DTOS(DATE()),6)
IF !USED('&B04')
   SELE 0
   USE (B04) ALIA B04
ELSE
   SELE B04
ENDIF
SET ORDER TO 1      
B05='B05'+LEFT(DTOS(DATE()),6)
B051='B051'+LEFT(DTOS(DATE()),6)
IF !USED('&B05')
   SELE 0
   USE (B05) ALIA B05
ELSE
   SELE B05
ENDIF
SET ORDER TO 1      

   G11='G11'+LEFT(DTOS(DATE()),6)
   G111='G111'+LEFT(DTOS(DATE()),6)
   IF !USED('&G11')
      SELE 0
      USE (G11) ALIA G11
   ELSE
      SELE G11
   ENDIF
   SET ORDER TO 1      

IF !USED('C01')
   SELE 0
   USE C01
ELSE 
   SELE C01
ENDIF
SET ORDER TO C011                  
C10='C10'+LEFT(DTOS(DATE()),6)   &&出貨日報表檔
C101='C101'+LEFT(DTOS(DATE()),6) 
C102='C102'+LEFT(DTOS(DATE()),6) 
C103='C103'+LEFT(DTOS(DATE()),6) 
C104='C104'+LEFT(DTOS(DATE()),6) 
C105='C105'+LEFT(DTOS(DATE()),6) 
C106='C106'+LEFT(DTOS(DATE()),6) 
C107='C107'+LEFT(DTOS(DATE()),6) 
C108='C108'+LEFT(DTOS(DATE()),6) 
C109='C109'+LEFT(DTOS(DATE()),6) 
IF !USED('&C10')
   SELE 0
   USE (C10) ALIA C10 INDE (C10)
ELSE
   SELE C10
ENDIF
SET ORDER TO C101    
IF A02.F10='*'
   IF A23.F09
      SET RELATION TO F79 INTO G11 
   ELSE
      SET RELATION TO F79 INTO B01   
   ENDIF
ENDIF      
SET RELA TO F02 INTO C01  ADDI
GO TOP
C10FORM=CREATEOBJECT("TKC10")
C10FORM.SHOW  
DEFINE CLASS TKC10 AS FORM
  CAPTION='C10.出貨日報表'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=3  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  ADD OBJECT REC_COUNT AS REC_COUNT  WITH;
      LEFT=INT_015*628,;
      BACKCOLOR=RGB(255,255,0),;
      TOP=INT_015*7
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*130
  ADD OBJECT MTH_LIST AS MTH_LIST WITH;
      AUTOCENTER=.T.      
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=17,;            
      RECORDSOURCE='C10',; 
      HEIGHT=INT_015*500,;     
      WIDTH=INT_015*780,;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',; 
      COLUMN4.NAME='COLUMN4',; 
      COLUMN5.NAME='COLUMN5',;             
      COLUMN6.NAME='COLUMN6',;       
      COLUMN7.NAME='COLUMN7',;       
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10',;
      COLUMN11.NAME='COLUMN11',;
      COLUMN12.NAME='COLUMN12',;
      COLUMN13.NAME='COLUMN13',;
      COLUMN14.NAME='COLUMN14',;
      COLUMN15.NAME='COLUMN15',;
      COLUMN16.NAME='COLUMN16',;
      COLUMN17.NAME='COLUMN17'
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;      
      TOP=INT_015*0,;
      LEFT=INT_015*403              
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=INT_015*0,;
      LEFT=INT_015*228,;
      ENABLED=.T.,;
      VISIBLE=.T.                     
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*5,;
      LEFT=INT_015*443,;      
      FONTSIZE=INT_015*9,;
      CAPTION='\<A.列印出貨分析',;
      HEIGHT=INT_015*25,;     
      WIDTH=INT_015*88
  PROCEDURE INIT
        SELE C10
*       CALCULATE  SUM(F07*F08) FOR LEFT(F04,2) = "BC" TO TQTY  
       CALCULATE  SUM(F07*F08)  TO TQTY         
       GO TOP
       THISFORM.REC_COUNT.CAPTION='目前金額：'+ALLTRIM(TRANSFORM(ROUND(TQTY,2),'@R 999,999,999,999.99'))
       CHK_STR=THISFORM.MTH_LIST.DISPLAYVALUE
       IF A02.F10 = '*'
          IF A23.F09
             THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(ROUND((C10.F07-G11.F21)/C10.F07*100,6) < 0,RGB(255,0,0),'')","COLUMN")              
          ELSE
             THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(ROUND((C10.F07-B01.F37)/C10.F07*100,6) < 0,RGB(255,0,0),'')","COLUMN")                             
          ENDIF   
       ENDIF
       THISFORM.ORPGROUP.NEW_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.DEL_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限     
       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.)   &&判斷有無列印出貨分析的權限     
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)  
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')
       THISFORM.GRID1.LOCKCOLUMNS=2
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*30
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*149
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN16.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN17.WIDTH=INT_015*55       
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='日期'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料        號'	          
       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單據編號'	   	     	   	   
	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='客戶編號'	   	   
	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='客戶簡稱'
  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='訂單編號'  	   
  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='銷售單價'   	   
  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='出貨金額'   	
  	   THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='毛利率(%)'  
  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='業務A編號' 
  	   THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='業務A姓名' 
  	   THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='業務B編號' 
  	   THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務B姓名'   	   
  	   THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='負責業助' 
  	   THISFORM.GRID1.COLUMN17.HEADER1.CAPTION='業助姓名' 
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C10.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C10.F04'
       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C10.F02'
       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F09'
       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F05'
       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F08'
       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F06'
       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F07'	   
       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(C10.F07*C10.F08,INT_069)"
       *IF C10.F08>0
          THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08 < 0 ,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
       *ENDIF   
       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C10.F10'	
       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='C10.F11'	
       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F12'	
       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F13'	
       THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F14'	
       THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F15'	            
       THISFORM.GRID1.COLUMN11.VISIBLE=!EMPTY(A02.F10)   
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS
       JK='日期'
  ENDPROC     
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依  日期   排列')
           .ADDITEM('依客戶+日期排列')
           .ADDITEM('依料號+日期排列')           
           .ADDITEM('依訂單+日期排列')           
           .ADDITEM('依業務A編號排列')  
           .ADDITEM('依業務B編號排列') 
           .ADDITEM('依業助編號排列')  
       ENDWITH      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE C10       
       DO CASE
          CASE THIS.DISPLAYVALUE='依  日期   排列'
		     THISFORM.GRID1.COLUMN1.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN2.WIDTH=INT_015*149
		     THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN6.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN14.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN16.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN17.WIDTH=INT_015*55       
		     THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='日期'
		     THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料        號'	          
		     THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單據編號'	   	     	   	   
		     THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='客戶編號'	   	   
		     THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='客戶簡稱'
		     THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='訂單編號'  	   
		     THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
		     THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
		     THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='銷售單價'   	   
		     THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='出貨金額'   	
		     THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='毛利率(%)'  
		     THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='業務A編號' 
		     THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='業務A姓名' 
		     THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='業務B編號' 
		     THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務B姓名'   	   
		     THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='負責業助' 
		     THISFORM.GRID1.COLUMN17.HEADER1.CAPTION='業助姓名' 
		     THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C10.F01'
		     THISFORM.GRID1.COLUMN2.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
		     THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C10.F04'
		     THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C10.F02'
		     THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F09'
		     THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F05'
		     THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F08'
		     THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F06'
		     THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F07'	   
		     THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(C10.F07*C10.F08,INT_069)"
		     *IF C10.F08>0
		        THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08 < 0,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
		     *ENDIF   
		     THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C10.F10'	
		     THISFORM.GRID1.COLUMN13.CONTROLSOURCE='C10.F11'	
		     THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F12'	
		     THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F13'	
		     THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F14'	
		     THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F15'	            
		     THISFORM.GRID1.COLUMN11.VISIBLE=!EMPTY(A02.F10)             
		     THISFORM.GRID1.COLUMN13.VISIBLE=.T.		                  
               	     SET ORDER TO C101
          CASE THIS.DISPLAYVALUE='依客戶+日期排列'
		     THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN2.WIDTH=INT_015*80          
		     THISFORM.GRID1.COLUMN3.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN4.WIDTH=INT_015*149
		     THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN6.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN14.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN16.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN17.WIDTH=INT_015*55       
		     THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'	   	   
		     THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶簡稱'		     
		     THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='日期'
		     THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	          
		     THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單據編號'	   	     	   	   
		     THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='訂單編號'  	   
		     THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
		     THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
		     THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='銷售單價'   	   
		     THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='出貨金額'   	
		     THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='毛利率(%)'  
		     THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='業務A編號' 
		     THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='業務A姓名' 
		     THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='業務B編號' 
		     THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務B姓名'   	   
		     THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='負責業助' 
		     THISFORM.GRID1.COLUMN17.HEADER1.CAPTION='業助姓名' 
		     THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C10.F02'
		     THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C10.F09'		     
		     THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C10.F01'
		     THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
		     THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F04'
		     THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F05'
		     THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F08'
		     THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F06'
		     THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F07'	   
		     THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(C10.F07*C10.F08,INT_069)"
		     *IF C10.F08>0
		        THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08 < 0,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
		     *ENDIF   
		     THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C10.F10'	
		     THISFORM.GRID1.COLUMN13.CONTROLSOURCE='C10.F11'	
		     THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F12'	
		     THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F13'	
		     THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F14'	
		     THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F15'	            
		     THISFORM.GRID1.COLUMN11.VISIBLE=!EMPTY(A02.F10)       
		     THISFORM.GRID1.COLUMN13.VISIBLE=.T.		                        
               	     SET ORDER TO C102
          CASE THIS.DISPLAYVALUE='依料號+日期排列'
		     THISFORM.GRID1.COLUMN1.WIDTH=INT_015*149
		     THISFORM.GRID1.COLUMN2.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN6.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN14.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN16.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN17.WIDTH=INT_015*55       
		     THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料        號'	 
		     THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='日期'
		     THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單據編號'	   	     	   	   
		     THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='客戶編號'	   	   
		     THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='客戶簡稱'
		     THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='訂單編號'  	   
		     THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
		     THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
		     THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='銷售單價'   	   
		     THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='出貨金額'   	
		     THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='毛利率(%)'  
		     THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='業務A編號' 
		     THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='業務A姓名' 
		     THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='業務B編號' 
		     THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務B姓名'   	   
		     THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='負責業助' 
		     THISFORM.GRID1.COLUMN17.HEADER1.CAPTION='業助姓名' 
		     THISFORM.GRID1.COLUMN1.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
		     THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C10.F01'
		     THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C10.F04'
		     THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C10.F02'
		     THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F09'
		     THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F05'
		     THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F08'
		     THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F06'
		     THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F07'	   
		     THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(C10.F07*C10.F08,INT_069)"
		     *IF C10.F08>0
		        THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08 < 0,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
		     *ENDIF   
		     THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C10.F10'	
		     THISFORM.GRID1.COLUMN13.CONTROLSOURCE='C10.F11'	
		     THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F12'	
		     THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F13'	
		     THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F14'	
		     THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F15'	            
		     THISFORM.GRID1.COLUMN11.VISIBLE=!EMPTY(A02.F10)           
		     THISFORM.GRID1.COLUMN13.VISIBLE=.T.		         
		     IF A02.F10='*'
		        SET ORDER TO C109
		     ELSE           
               	SET ORDER TO C103           
             ENDIF  	                  	                             
          CASE THIS.DISPLAYVALUE='依訂單+日期排列'
           	     THISFORM.GRID1.COLUMN1.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN2.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN3.WIDTH=INT_015*149
		     THISFORM.GRID1.COLUMN4.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN5.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN6.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN14.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN16.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN17.WIDTH=INT_015*55    
		     THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='訂單編號'     
		     THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='日期'
		     THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='料        號'	          
		     THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='單據編號'	   	     	   	   
		     THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='客戶編號'	   	   
		     THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='客戶簡稱'		     	   
		     THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
		     THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
		     THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='銷售單價'   	   
		     THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='出貨金額'   	
		     THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='毛利率(%)'  
		     THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='業務A編號' 
		     THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='業務A姓名' 
		     THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='業務B編號' 
		     THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務B姓名'   	   
		     THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='負責業助' 
		     THISFORM.GRID1.COLUMN17.HEADER1.CAPTION='業助姓名' 
		     THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C10.F05'
		     THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C10.F01'
		     THISFORM.GRID1.COLUMN3.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
		     THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C10.F04'
		     THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F02'
		     THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F09'
		     THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F08'
		     THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F06'
		     THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F07'	   
		     THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(C10.F07*C10.F08,INT_069)"
		    * IF C10.F08>0
		        THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08 < 0,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
		     *ENDIF   
		     THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C10.F10'	
		     THISFORM.GRID1.COLUMN13.CONTROLSOURCE='C10.F11'	
		     THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F12'	
		     THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F13'	
		     THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F14'	
		     THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F15'	            
		     THISFORM.GRID1.COLUMN11.VISIBLE=!EMPTY(A02.F10)                          
		     THISFORM.GRID1.COLUMN13.VISIBLE=.T.
               	     SET ORDER TO C104
          CASE THIS.DISPLAYVALUE='依業務A編號排列'
		     THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60          
		     THISFORM.GRID1.COLUMN3.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN4.WIDTH=INT_015*149
		     THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN6.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN7.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN10.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN14.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN16.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN17.WIDTH=INT_015*55       
		     THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='業務A編號' 
		     THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業務A姓名' 		     
		     THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='日期'
		     THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	          
		     THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單據編號'	   	     	   	   
		     THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='客戶編號'	   	   
		     THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='客戶簡稱'
		     THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='訂單編號'  	   
		     THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='數        量'
		     THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='幣別' 
		     THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='銷售單價'   	   
		     THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='出貨金額'   	
		     THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='毛利率(%)'  
		     THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='業務B編號' 
		     THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務B姓名'   	   
		     THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='負責業助' 
		     THISFORM.GRID1.COLUMN17.HEADER1.CAPTION='業助姓名' 
		     THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C10.F10'	
		     THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C10.F11'			     
		     THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C10.F01'
		     THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
		     THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F04'
		     THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F02'
		     THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F09'
		     THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F05'
		     THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F08'
		     THISFORM.GRID1.COLUMN10.CONTROLSOURCE='C10.F06'
		     THISFORM.GRID1.COLUMN11.CONTROLSOURCE='C10.F07'	   
		     THISFORM.GRID1.COLUMN12.CONTROLSOURCE="ROUND(C10.F07*C10.F08,INT_069)"
		     *IF C10.F08>0
		        THISFORM.GRID1.COLUMN13.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08<0,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
		     *ENDIF   
		     THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F12'	
		     THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F13'	
		     THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F14'	
		     THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F15'	      
		     THISFORM.GRID1.COLUMN11.VISIBLE=.T.
		     THISFORM.GRID1.COLUMN13.VISIBLE=!EMPTY(A02.F10)                          
               	     SET ORDER TO C106
          CASE THIS.DISPLAYVALUE='依業務B編號排列'
		     THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60          
		     THISFORM.GRID1.COLUMN3.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN4.WIDTH=INT_015*149
		     THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN6.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN7.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN10.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN14.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN16.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN17.WIDTH=INT_015*55       
		     THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='業務B編號' 
		     THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業務B姓名' 		     
		     THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='日期'
		     THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	          
		     THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單據編號'	   	     	   	   
		     THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='客戶編號'	   	   
		     THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='客戶簡稱'
		     THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='訂單編號'  	   
		     THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='數        量'
		     THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='幣別' 
		     THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='銷售單價'   	   
		     THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='出貨金額'   	
		     THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='毛利率(%)'  
		     THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='業務A編號' 
		     THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務A姓名'   	   
		     THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='負責業助' 
		     THISFORM.GRID1.COLUMN17.HEADER1.CAPTION='業助姓名' 
		     THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C10.F12'	
		     THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C10.F13'			     
		     THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C10.F01'
		     THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
		     THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F04'
		     THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F02'
		     THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F09'
		     THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F05'
		     THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F08'
		     THISFORM.GRID1.COLUMN10.CONTROLSOURCE='C10.F06'
		     THISFORM.GRID1.COLUMN11.CONTROLSOURCE='C10.F07'	   
		     THISFORM.GRID1.COLUMN12.CONTROLSOURCE="ROUND(C10.F07*C10.F08,INT_069)"
		    * IF C10.F08>0
		        THISFORM.GRID1.COLUMN13.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08 < 0,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
		     *ENDIF   
		     THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F10'	
		     THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F11'	
		     THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F14'	
		     THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F15'	      
		     THISFORM.GRID1.COLUMN11.VISIBLE=.T.
		     THISFORM.GRID1.COLUMN13.VISIBLE=!EMPTY(A02.F10)                          
               	     SET ORDER TO C107              
          CASE THIS.DISPLAYVALUE='依業助編號排列'
		     THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60          
		     THISFORM.GRID1.COLUMN3.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN4.WIDTH=INT_015*149
		     THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN6.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN7.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN8.WIDTH=INT_015*80
		     THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN10.WIDTH=INT_015*30
		     THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN14.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		     THISFORM.GRID1.COLUMN16.WIDTH=INT_015*50
		     THISFORM.GRID1.COLUMN17.WIDTH=INT_015*55       
		     THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='負責業助' 
		     THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業助姓名' 	     
		     THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='日期'
		     THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	          
		     THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單據編號'	   	     	   	   
		     THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='客戶編號'	   	   
		     THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='客戶簡稱'
		     THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='訂單編號'  	   
		     THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='數        量'
		     THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='幣別' 
		     THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='銷售單價'   	   
		     THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='出貨金額'   	
		     THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='毛利率(%)'  
		     THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='業務A編號' 
		     THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務A姓名' 			     
		     THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='業務B編號' 
		     THISFORM.GRID1.COLUMN17.HEADER1.CAPTION='業務B姓名'   	   
		     THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C10.F14'	
		     THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C10.F15'			     
		     THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C10.F01'
		     THISFORM.GRID1.COLUMN4.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
		     THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F04'
		     THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F02'
		     THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F09'
		     THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F05'
		     THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F08'
		     THISFORM.GRID1.COLUMN10.CONTROLSOURCE='C10.F06'
		     THISFORM.GRID1.COLUMN11.CONTROLSOURCE='C10.F07'	   
		     THISFORM.GRID1.COLUMN12.CONTROLSOURCE="ROUND(C10.F07*C10.F08,INT_069)"
		     *IF C10.F08>0
		        THISFORM.GRID1.COLUMN13.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08 < 0,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
		     *ENDIF   
		     THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F10'	
		     THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F11'	
		     THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F12'	
		     THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F13'	      
		     THISFORM.GRID1.COLUMN11.VISIBLE=.T.
		     THISFORM.GRID1.COLUMN13.VISIBLE=!EMPTY(A02.F10)                          
               	     SET ORDER TO C108                    
       ENDCASE 
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC              
  PROC MTH_LIST.INTERACTIVECHANGE
       CHK_STR=THISFORM.MTH_LIST.DISPLAYVALUE
       SELE C10
       SET RELATION OFF INTO C01
       IF A02.F10='*'
          IF A23.F09
             SET RELATION OFF INTO G11
          ELSE
             SET RELATION OFF INTO B01
          ENDIF 
       ENDIF   
       SELECT A23
       SEEK DTOS(CTOD(CHK_STR+'/01'))
       THISFORM.GRID1.RECORDSOURCE=''
 
       SELECT G11
       USE
       SELECT B05
       USE
       SELECT B04
       USE
       SELE C10
       USE
       B04='B04'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       IF !USED('&B04')
          SELE 0
          USE (B04) ALIA B04
       ELSE
          SELE B04
       ENDIF
       SET ORDER TO 1               
       B05='B05'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       IF !USED('&B05')
          SELE 0
          USE (B05) ALIA B05
       ELSE
          SELE B05
       ENDIF
       SET ORDER TO 1                      

          G11='G11'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
          IF !USED('&G11')
             SELE 0
             USE (G11) ALIA G11
          ELSE
             SELE G11
          ENDIF
          SET ORDER TO 1                             
       C10='C10'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C101='C101'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C102='C102'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C103='C103'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C104='C104'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C105='C105'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C106='C106'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C107='C107'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C108='C108'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       C109='C109'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       IF !USED('&C10')
          SELE 0
          USE (C10) ALIA C10
       ELSE
          SELE C10
       ENDIF
       SET ORDER TO C101      
       IF A02.F10='*'
          IF A23.F09
             SET RELATION TO F79 INTO G11           
          ELSE   
             SET RELATION TO F79 INTO B01            
          ENDIF
       ENDIF      
       SET RELA TO F02 INTO C01 ADDI
*       CALCULATE  SUM(F07*F08) FOR LEFT(F04,2) = "BC" TO TQTY  
       CALCULATE  SUM(F07*F08)  TO TQTY         
       GO TOP
       THISFORM.REC_COUNT.CAPTION='目前金額：'+ALLTRIM(TRANSFORM(ROUND(TQTY,2),'@R 999,999,999,999.99'))             
       THISFORM.GRID1.RECORDSOURCE='C10'
     THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C10.F01'
     THISFORM.GRID1.COLUMN2.CONTROLSOURCE="IIF(A02.F10='*',C10.F79,C10.F03)"
     THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C10.F04'
     THISFORM.GRID1.COLUMN4.CONTROLSOURCE='C10.F02'
     THISFORM.GRID1.COLUMN5.CONTROLSOURCE='C10.F09'
     THISFORM.GRID1.COLUMN6.CONTROLSOURCE='C10.F05'
     THISFORM.GRID1.COLUMN7.CONTROLSOURCE='C10.F08'
     THISFORM.GRID1.COLUMN8.CONTROLSOURCE='C10.F06'
     THISFORM.GRID1.COLUMN9.CONTROLSOURCE='C10.F07'	   
     THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(C10.F07*C10.F08,0)"
     *IF C10.F08>0
        THISFORM.GRID1.COLUMN11.CONTROLSOURCE="IIF(C10.F07 = 0 OR C10.F08 < 0,0,ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6))"
     *ENDIF   
     THISFORM.GRID1.COLUMN12.CONTROLSOURCE='C10.F10'	
     THISFORM.GRID1.COLUMN13.CONTROLSOURCE='C10.F11'	
     THISFORM.GRID1.COLUMN14.CONTROLSOURCE='C10.F12'	
     THISFORM.GRID1.COLUMN15.CONTROLSOURCE='C10.F13'	
     THISFORM.GRID1.COLUMN16.CONTROLSOURCE='C10.F14'	
     THISFORM.GRID1.COLUMN17.CONTROLSOURCE='C10.F15'	      
       IF A02.F10 = '*'
          IF A23.F09 AND C10.F08>0
            THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(ROUND((C10.F07-G11.F21)/C10.F07*100,6) < 0,RGB(255,0,0),'')","COLUMN")    
          ELSE
            THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(ROUND((C10.F07-B01.F37)/C10.F07*100,6) < 0,RGB(255,0,0),'')","COLUMN")                             
          ENDIF   
       ENDIF
       THISFORM.KEY_LIST.INTERACTIVECHANGE
	   THISFORM.GRID1.SETFOCUS        
	   THISFORM.REFRESH
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.ENABLED=.F.
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
          THISFORM.ANS_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.ENABLED=.T.      
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限    
          THISFORM.ANS_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.)   &&判斷有無列印出貨分析的權限
       ENDIF          
  ENDPROC      
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
        IF A02.F10 = '*' AND C10.F08>0           
             THISFORM.GRID1.TOOLTIPTEXT=IIF(ROUND(IIF(A23.F09,(C10.F07-G11.F21)/C10.F07,(C10.F07-B01.F37)/C10.F07)*100,6) < 0,'負毛利率','')
       ENDIF      
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.REFRESH
  ENDPROC  
*************       
  PROC ANS_BOTT.CLICK                               &&列印出貨分析
  	SELECT  C10
   	ANS_CHK=CREATEOBJECT("ANS_CHK")  
   	ANS_CHK.SHOW
   	THISFORM.GRID1.SETFOCUS 
  ENDPROC   
  ENDDEFINE  
********************************************************
DEFINE CLASS ANS_CHK AS FORM
  AUTOCENTER=.T.
  CAPTION='請選擇列印內容'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*180
  WIDTH=INT_015*250
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.  
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_CHK'
ADD OBJECT DATA_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*17,;
      TOP=INT_015*20,;
      AUTOSIZE=.T.,;
      FONTSIZE=INT_015*12,;
      BUTTONCOUNT=7,;
      OPTION1.CAPTION='客戶別出貨分析',;
      OPTION1.TOP=INT_015*0,;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='產品別出貨分析',;
      OPTION2.TOP=INT_015*20,;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.AUTOSIZE=.T.,;      
      OPTION3.CAPTION='業務A別出貨分析',;
      OPTION3.TOP=INT_015*40,;
      OPTION3.FONTSIZE=INT_015*9,;
      OPTION3.AUTOSIZE=.T.,;
      OPTION4.CAPTION='業務B別出貨分析',;
      OPTION4.TOP=INT_015*60,;
      OPTION4.FONTSIZE=INT_015*9,;
      OPTION4.AUTOSIZE=.T.,;
      OPTION5.CAPTION='業務助理別出貨分析',;
      OPTION5.TOP=INT_015*80,;
      OPTION5.FONTSIZE=INT_015*9,;
      OPTION5.AUTOSIZE=.T.,;      
      OPTION6.CAPTION='客戶型態別出貨分析',;
      OPTION6.TOP=INT_015*100,;
      OPTION6.FONTSIZE=INT_015*9,;
      OPTION6.AUTOSIZE=.T.,;      
      OPTION7.CAPTION='佣金明細統計表',;
      OPTION7.TOP=INT_015*120,;
      OPTION7.FONTSIZE=INT_015*9,;
      OPTION7.AUTOSIZE=.T.,;      
      NAME='DATA_OPTION'   
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*20,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<P.列   印',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*60,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<E.轉EXCEL',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;
      TOP=INT_015*100,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<C.取   消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'     
  *****    
 PROCEDURE CMND1.CLICK   
  DO CASE
  	 CASE THISFORM.DATA_OPTION.VALUE=1   &&依客戶別
		     SELECT C10.*,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 GROUP BY C10.F02 ORDER BY F02 INTO CURSOR C10A READWRITE &&WHERE LEFT(F04,2) LIKE 'BC'
		     SELECT C10.*,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 WHERE F03 = ANY (SELECT F01 FROM B01 WHERE F97 LIKE 'N') GROUP BY C10.F02 ORDER BY F02  INTO CURSOR C10B &&LEFT(F04,2) LIKE 'BC' AND 
		     SELECT C10.*,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 WHERE F03 = ANY (SELECT F01 FROM B01 WHERE F97 LIKE 'Y') GROUP BY C10.F02 ORDER BY F02  INTO CURSOR C10C &&LEFT(F04,2) LIKE 'BC' AND
		     CREATE CURSOR C10_TEMP;
		    (F02 C(5),F09 C(8),F11 C(8),F13 C(8),F15 C(8),TL1 N(13),TL2 N(13),TL3 N(13),F44 C(5))  	 
		     INDE ON F02  TAG C10_TEMP1
		     INDEX ON F44+F02 TAG C10_TEMP2
		     SET ORDER TO C10_TEMP1
		     SELECT  C10A
		     GO TOP
	       	     DO WHILE !EOF()
	          	    SELECT  C10_TEMP
		           APPEND BLANK
		           REPLACE  C10_TEMP.F02 WITH C10A.F02
		           REPLACE  C10_TEMP.F09 WITH C10A.F09
		           REPLACE  C10_TEMP.F11 WITH C10A.F11
		           REPLACE  C10_TEMP.F13 WITH C10A.F13
		           REPLACE  C10_TEMP.F15 WITH C10A.F15
		           REPLACE  C10_TEMP.TL3 WITH C10A.C10SUM 
		           REPLACE C10_TEMP.F44 WITH IIF(SEEK(F02,'C01','C011'),C01.F44,F02)
		           SELECT  C10A
		           SKIP
	       	    ENDDO
	       	    SELECT C10A
	       	    USE
	       	    SELECT  C10B
	            GO TOP
	            DO WHILE !EOF()
		          SELE C10_TEMP
		          SEEK C10B.F02
	                  IF FOUND()
	                      REPL C10_TEMP.TL1 WITH  C10B.C10SUM 
	                  ENDIF      
	                  SELE C10B
	                  SKIP
	            ENDDO
	            SELECT C10B
	            USE
	       	    SELECT  C10C
	            GO TOP
	            DO WHILE !EOF()
		          SELE C10_TEMP
		          SEEK C10C.F02
	                  IF FOUND()
	                      REPL C10_TEMP.TL2 WITH  C10C.C10SUM 
	                  ENDIF      
	                  SELE C10C
	                  SKIP
	            ENDDO
	            SELECT C10C
	            USE	            
	            SELECT C10_TEMP
		    CALC SUM(TL1) TO TT1
		    CALC SUM(TL2) TO TT2
		    CALC SUM(TL3) TO TT3
 		       SELECT C10_TEMP
 		       SET ORDER TO C10_TEMP2
 		       GO TOP
		       IF _TALLY>0
		*          REPORT FORM C10Z TO FILE BK.TXT ASCII  ,IIF(SEEK(F02,'C01'),C01.F21,'') 產業別
		          IF EMPTY(EXBO)
		              REPORT FORM ALLTRIM(INT_116)+'C10Z' TO PRINT PROMPT PREVIEW
		          ELSE
	         	      SELECT F02 客戶編號,F09 客戶簡稱,IIF(SEEK(F02,'C01'),C01.F03,'') 等級,IIF(SEEK(F02,'C01'),C01.F21,'') 產業別,;
	         	                    F11 業務A,F13 業務B,F15 業務助理,ROUND(TL1,0) 部品出貨金額,ROUND(TL1/TL3*100,0) 部品比例,;
	         	                    ROUND(TL2,0) 製品出貨金額,ROUND(TL2/TL3*100,0) 製品比例,ROUND(TL3,0) 出金額總計 FROM C10_TEMP  ORDER BY F02 INTO CURSOR C10ABC
	         	      FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'客戶別出貨分析'+'(C10)'
		              GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		              IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+48,'提示訊息視窗') 
		              ENDIF   		              
		          ENDIF		          
		       ENDIF
		       SELE C10_TEMP
		       USE      
		       THISFORM.RELEASE  
  	 CASE THISFORM.DATA_OPTION.VALUE=2       &&依產品別
		    SELE C10.F03,SUM(C10.F07*C10.F08),SUM(C10.F07*C10.F08)/TQTY*100 FROM C10 GROUP BY C10.F03 ORDER BY C10.F03  INTO CURSOR C10_3
		       IF _TALLY>0
		*          REPORT FORM C10Z TO FILE BK.TXT ASCII
		          IF EMPTY(EXBO)
		              REPORT FORM ALLTRIM(INT_116)+'C10W' TO PRINT PROMPT PREVIEW
		          ELSE
	         	      SELECT F03 料品編號,IIF(SEEK(F03,'B01'),B01.F02,'') 品名規格,ROUND(SUM_EXP_2,0) 出金額總計,ROUND(EXP_3,6) 百分比 FROM C10_3  ORDER BY F03 INTO CURSOR C10ABC		          
	         	      FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'產品別出貨分析'+'(C10)'
		              GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		              IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+48,'提示訊息視窗') 
		              ENDIF   		              
		          ENDIF			          
		       ENDIF
		       SELECT C10_3
		       USE
		       THISFORM.RELEASE  		       
	CASE THISFORM.DATA_OPTION.VALUE=3	&&業務A
		     SELECT F10,F11,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 GROUP BY F10,F11 ORDER BY F10 INTO CURSOR C10A READWRITE && WHERE LEFT(F04,2) LIKE 'BC'
		     SELECT F10,F11,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 WHERE F03 = ANY (SELECT F01 FROM B01 WHERE F97 LIKE 'N') GROUP BY F10,F11  INTO CURSOR C10B &&LEFT(F04,2) LIKE 'BC' AND 
		     SELECT F10,F11,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 WHERE F03 = ANY (SELECT F01 FROM B01 WHERE F97 LIKE 'Y') GROUP BY F10,F11  INTO CURSOR C10C &&LEFT(F04,2) LIKE 'BC' AND 
		     CREATE CURSOR C10_TEMP;
		     (F10 C(5),F11 C(8),TL1 N(13),TL2 N(13),TL3 N(13))
		     INDE ON F10  TAG C10_TEMP1
		     SET ORDER TO C10_TEMP1
		     SELE C10A
		     GO TOP
	       	     DO WHILE !EOF()
	          	    SELECT  C10_TEMP
		           APPEND BLANK
		           REPLACE  C10_TEMP.F10 WITH C10A.F10
		           REPLACE  C10_TEMP.F11 WITH C10A.F11
		           REPLACE  C10_TEMP.TL3 WITH C10A.C10SUM 
		           SELECT  C10A
		           SKIP
	       	    ENDDO
	       	    SELECT C10A
	       	    USE
	       	    SELECT  C10B
	            GO TOP
	            DO WHILE !EOF()
		          SELE C10_TEMP
		          SEEK C10B.F10
	                  IF FOUND()
	                      REPL C10_TEMP.TL1 WITH  C10B.C10SUM 
	                  ENDIF      
	                  SELE C10B
	                  SKIP
	            ENDDO
	            SELECT C10B
	            USE
	       	    SELECT  C10C
	            GO TOP
	            DO WHILE !EOF()
		          SELE C10_TEMP
		          SEEK C10C.F10
	                  IF FOUND()
	                      REPL C10_TEMP.TL2 WITH  C10C.C10SUM 
	                  ENDIF      
	                  SELE C10C
	                  SKIP
	            ENDDO
	            SELECT C10C
	            USE	            
	            SELECT C10_TEMP
		    CALC SUM(TL1) TO TT1
		    CALC SUM(TL2) TO TT2
		    CALC SUM(TL3) TO TT3
		    SELECT  C10_TEMP.F10,C10_TEMP.F11,C10_TEMP.TL1,C10_TEMP.TL2,C10_TEMP.TL3 FROM C10_TEMP ORDER BY C10_TEMP.TL3 DESC  INTO CURSOR C10AB
		    SELECT C10AB
		       IF _TALLY>0
		*          REPORT FORM C10Z TO FILE BK.TXT ASCII
		          IF EMPTY(EXBO)
		              REPORT FORM ALLTRIM(INT_116)+'C10Y' TO PRINT PROMPT PREVIEW
		          ELSE
	         	      SELECT F11 業務A姓名,ROUND(TL1,0) 部品出貨金額,ROUND(TL1/TL3*100,0) 部品出貨比例,ROUND(TL2,0) 製品出貨金額,;
	         	      ROUND(TL2/TL3*100,0) 製品出貨比例,ROUND(TL3,0) 出貨金額總計 FROM C10AB  ORDER BY F11 INTO CURSOR C10ABC		          	         	     
	         	      FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'業務員A別出貨分析'+'(C10)'
		              GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		              IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		              ENDIF   		              
		          ENDIF		          
		       ENDIF
		       SELECT C10AB
		       USE
		       SELE C10_TEMP
		       USE      
		       THISFORM.RELEASE  
	CASE THISFORM.DATA_OPTION.VALUE=4	&&業務B
		     SELECT F12,F13,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 GROUP BY F12,F13 ORDER BY F12 INTO CURSOR C10A READWRITE &&WHERE LEFT(F04,2) LIKE 'BC' 
		     SELECT F12,F13,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 WHERE F03 = ANY (SELECT F01 FROM B01 WHERE F97 LIKE 'N') GROUP BY F12,F13  INTO CURSOR C10B &&LEFT(F04,2) LIKE 'BC' AND 
		     SELECT F12,F13,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 WHERE F03 = ANY (SELECT F01 FROM B01 WHERE F97 LIKE 'Y') GROUP BY F12,F13  INTO CURSOR C10C &&LEFT(F04,2) LIKE 'BC' AND 
		     CREATE CURSOR C10_TEMP;
		     (F12 C(5),F13 C(8),TL1 N(13),TL2 N(13),TL3 N(13))
		     INDE ON F12  TAG C10_TEMP1
		     SET ORDER TO C10_TEMP1
		     SELE C10A
		     GO TOP
	       	     DO WHILE !EOF()
	          	    SELECT  C10_TEMP
		           APPEND BLANK
		           REPLACE  C10_TEMP.F12 WITH C10A.F12
		           REPLACE  C10_TEMP.F13 WITH C10A.F13
		           REPLACE  C10_TEMP.TL3 WITH C10A.C10SUM 
		           SELECT  C10A
		           SKIP
	       	    ENDDO
	       	    SELECT C10A
	       	    USE
	       	    SELECT  C10B
	            GO TOP
	            DO WHILE !EOF()
		          SELE C10_TEMP
		          SEEK C10B.F12
	                  IF FOUND()
	                      REPL C10_TEMP.TL1 WITH  C10B.C10SUM 
	                  ENDIF      
	                  SELE C10B
	                  SKIP
	            ENDDO
	            SELECT C10B
	            USE
	       	    SELECT  C10C
	            GO TOP
	            DO WHILE !EOF()
		          SELE C10_TEMP
		          SEEK C10C.F12
	                  IF FOUND()
	                      REPL C10_TEMP.TL2 WITH  C10C.C10SUM 
	                  ENDIF      
	                  SELE C10C
	                  SKIP
	            ENDDO
	            SELECT C10C
	            USE	            
	            SELECT C10_TEMP
		    CALC SUM(TL1) TO TT1
		    CALC SUM(TL2) TO TT2
		    CALC SUM(TL3) TO TT3
		    SELECT  C10_TEMP.F12,C10_TEMP.F13,C10_TEMP.TL1,C10_TEMP.TL2,C10_TEMP.TL3 FROM C10_TEMP ORDER BY C10_TEMP.TL3 DESC  INTO CURSOR C10AB
		    SELECT C10AB	
		       IF _TALLY>0
		*          REPORT FORM C10Z TO FILE BK.TXT ASCII
		          IF EMPTY(EXBO)
		              REPORT FORM ALLTRIM(INT_116)+'C10V' TO PRINT PROMPT PREVIEW
		          ELSE
	         	      SELECT F13 業務B姓名,ROUND(TL1,0) 部品出貨金額,ROUND(TL1/TL3*100,0) 部品出貨比例,ROUND(TL2,0) 製品出貨金額,;
	         	      ROUND(TL2/TL3*100,0) 製品出貨比例,ROUND(TL3,0) 出貨金額總計 FROM C10AB  ORDER BY F13 INTO CURSOR C10ABC	         	      
	         	      FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'業務員B別出貨分析'+'(C10)'
		              GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		              IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		              ENDIF   		              
		          ENDIF		          
		       ENDIF
		       SELECT C10AB
		       USE
		       SELE C10_TEMP
		       USE      
		       THISFORM.RELEASE  		       
	CASE THISFORM.DATA_OPTION.VALUE=5	&&業助
		     SELECT F14,F15,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 GROUP BY F14,F15 ORDER BY F14 INTO CURSOR C10A READWRITE  &&WHERE LEFT(F04,2) LIKE 'BC' 
		     SELECT F14,F15,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 WHERE F03 = ANY (SELECT F01 FROM B01 WHERE F97 LIKE 'N') GROUP BY F14,F15  INTO CURSOR C10B &&LEFT(F04,2) LIKE 'BC' AND
		     SELECT F14,F15,ROUND(SUM(F07 * F08),0) AS C10SUM FROM C10 WHERE F03 = ANY (SELECT F01 FROM B01 WHERE F97 LIKE 'Y') GROUP BY F14,F15  INTO CURSOR C10C &&LEFT(F04,2) LIKE 'BC' AND 
		     CREATE CURSOR C10_TEMP;
		     (F14 C(5),F15 C(8),TL1 N(13),TL2 N(13),TL3 N(13))
		     INDE ON F14  TAG C10_TEMP1
		     SET ORDER TO C10_TEMP1
		     SELE C10A
		     GO TOP
	       	     DO WHILE !EOF()
	          	    SELECT  C10_TEMP
		           APPEND BLANK
		           REPLACE  C10_TEMP.F14 WITH C10A.F14
		           REPLACE  C10_TEMP.F15 WITH C10A.F15
		           REPLACE  C10_TEMP.TL3 WITH C10A.C10SUM 
		           SELECT  C10A
		           SKIP
	       	    ENDDO
	       	    SELECT C10A
	       	    USE
	       	    SELECT  C10B
	            GO TOP
	            DO WHILE !EOF()
		          SELE C10_TEMP
		          SEEK C10B.F14
	                  IF FOUND()
	                      REPL C10_TEMP.TL1 WITH  C10B.C10SUM 
	                  ENDIF      
	                  SELE C10B
	                  SKIP
	            ENDDO
	            SELECT C10B
	            USE
	       	    SELECT  C10C
	            GO TOP
	            DO WHILE !EOF()
		          SELE C10_TEMP
		          SEEK C10C.F14
	                  IF FOUND()
	                      REPL C10_TEMP.TL2 WITH  C10C.C10SUM 
	                  ENDIF      
	                  SELE C10C
	                  SKIP
	            ENDDO
	            SELECT C10C
	            USE	            
	            SELECT C10_TEMP
		    CALC SUM(TL1) TO TT1
		    CALC SUM(TL2) TO TT2
		    CALC SUM(TL3) TO TT3
		    SELECT  C10_TEMP.F14,C10_TEMP.F15,C10_TEMP.TL1,C10_TEMP.TL2,C10_TEMP.TL3 FROM C10_TEMP ORDER BY C10_TEMP.TL3 DESC  INTO CURSOR C10AB
		    SELECT C10AB	
		       IF _TALLY>0
		*          REPORT FORM C10Z TO FILE BK.TXT ASCII
		          IF EMPTY(EXBO)
		              REPORT FORM ALLTRIM(INT_116)+'C10X' TO PRINT PROMPT PREVIEW
		          ELSE
	         	      SELECT F15 業務助理姓名,ROUND(TL1,0) 部品出貨金額,ROUND(TL1/TL3*100,0) 部品出貨比例,ROUND(TL2,0) 製品出貨金額,;
	         	      ROUND(TL2/TL3*100,0) 製品出貨比例,ROUND(TL3,0) 出貨金額總計 FROM C10AB  ORDER BY F15 INTO CURSOR C10ABC		         	      
	         	      FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'業務助理別出貨分析'+'(C10)'
		              GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		              IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		              ENDIF   		              
		          ENDIF
		       ENDIF
		       SELECT C10AB
		       USE
		       SELE C10_TEMP
		       USE      
		       THISFORM.RELEASE  
	CASE THISFORM.DATA_OPTION.VALUE=6	&&客戶型態別
 	     CREATE CURSOR C10_TEMP;
	     (F01 C(1),F02 C(7),F03 N(13,2),F04 N(13,2))
	     INDEX ON F01 TAG C10_TEMP1
	     SET ORDER TO 1
	     SELECT C10
	     GO TOP
	     DO WHILE !EOF()
	        K_TYPE=IIF(SEEK(C10.F02,'C01'),C01.F43,'A')
	        SELECT C10_TEMP
	        SEEK K_TYPE
	        IF !FOUND()
	           APPEND BLANK
	           REPLACE F01 WITH K_TYPE
	           REPLACE F02 WITH CTP(K_TYPE)
	        ENDIF
	        IF IIF(SEEK(C10.F03,'B01'),B01.F97,'')='Y'
	           REPLACE F04 WITH F04+C10.F07*C10.F08
	        ELSE
	           REPLACE F03 WITH F03+C10.F07*C10.F08
	        ENDIF
	        SELECT C10
	        SKIP
	     ENDDO
	     SELECT C10_TEMP
	        CALC SUM(F03) TO TT1
		    CALC SUM(F04) TO TT2
		    CALC SUM(F03+F04) TO TT3
	     GO TOP
	     IF EMPTY(EXBO)
	        REPORT FORM ALLTRIM(INT_116)+'C10T' TO PRINT PROMPT PREVIEW
	     ELSE
	        SELECT F01 型別代號,F02 產業型態,F03 部品金額,ROUND(F03/(F03+F04)*100,2) 部品百分比,F04 製品金額,ROUND(F04/(F03+F04)*100,2) 製品百分比,F03+F04 總計 FROM C10_TEMP ORDER BY F01 NOWAIT
	        IF _TALLY>0
	                  FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'客戶型態別出貨分析'+'(C10)'
		              GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		              IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		              ENDIF   		              
		    ENDIF          
	     ENDIF
	     SELECT C10_TEMP
	     USE
			       THISFORM.RELEASE  
			       
	CASE THISFORM.DATA_OPTION.VALUE=7	&&佣金統計
	     IF !USED('C21')
	        SELECT 0
	        USE C21
	      ELSE
	        SELECT C21
	      ENDIF
	      SET ORDER TO 1
	      SELECT C10.F02 客戶編號,C10.F09 客戶簡稱,C10.F03 料號,C10.F04 出貨單號,C10.F05 訂單號碼,C10.F07 單價,C10.F08 數量,C10.F07*C10.F08 出貨小計,C21.F05 百分比,C10.F07*C10.F08*VAL(LEFT(C21.F05,AT('%',C21.F05)))/100 佣金小計,C10.F16 客戶PO_NO,RIGHT(C10.F17,29) 客戶料號,C10.F13 業務擔當,C10.F15 業務助理 FROM C10,C21,C01 WHERE  C21.F04=LEFT(C10.F17,1) AND C21.F01=C01.F45 AND C21.F02=C10.F03 AND C01.F01=C10.F02 AND BETWEEN(ASC(LEFT(C10.F17,1)),33,47) NOWAIT
	      IF _TALLY>0
	        
	            FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'佣金統計分析'+'(C10)'
		        GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		        IF !EMPTY(GCDELIMFILE) 
		           ON ERROR DO FILE_IMPACT
		           COPY TO (GCDELIMFILE) TYPE XL5     
		           =MESSAGEBOX('儲存成功',0+48,'提示訊息視窗') 
		        ENDIF   	
		          	             
	      ELSE
	         =MESSAGEBOX('本月份無需提撥佣金',0+48,'提示訊息視窗')
	         
	      ENDIF     
	      SELECT C21
	      USE
  	ENDCASE
  	SELECT C10
        THISFORM.RELEASE                         
  ENDPROC
  ****
  PROCEDURE CMND2.CLICK
     EXBO='1'
     THISFORM.CMND1.CLICK
     EXBO='' 
     THISFORM.RELEASE
  ENDPROC       
 ***** 
  PROCEDURE CMND3.CLICK
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE           
***********************************************列印程序
PROCEDURE PNT_PRC  
   FLG='0'
   SELE C10
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW    
   IF FLG<>'1'
       =MESSAGEBOX('無此範圍資料',0+48,'警示')
   ENDIF   
   FLG='0'     
ENDPROC
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*150
  WIDTH=INT_015*500
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*25,;
      TOP=INT_015*40,;
      NAME='LABEL1'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      TOP=INT_015*34,;
      LEFT=INT_015*78,;
      HEIGHT=INT_015*25,; 
      NAME='TEXT1'
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*25,;
      TOP=INT_015*90,;
      NAME='LABEL2'      
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      TOP=INT_015*84,;
      LEFT=INT_015*78,;
      HEIGHT=INT_015*25,;         
      NAME='TEXT2'    
  ADD OBJECT OUSK_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*300,;
      TOP=INT_015*45,;
      HEIGHT=INT_015*60,;    
      WIDTH=INT_015*60,;      
      BUTTONCOUNT=3,;
      OPTION1.CAPTION='部品',;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.LEFT=INT_015*4,;
      OPTION1.TOP=INT_015*3,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='製品',;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.LEFT=INT_015*4,;
      OPTION2.TOP=INT_015*23,;
      OPTION2.AUTOSIZE=.T.,;      
      OPTION3.CAPTION='全部',;
      OPTION3.FONTSIZE=INT_015*9,;
      OPTION3.LEFT=INT_015*4,;
      OPTION3.TOP=INT_015*43,;
      OPTION3.AUTOSIZE=.T.,;      
      NAME='OUSK_OPTION'                   
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*400,;     
      TOP=INT_015*20,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<P.列   印',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*400,;     
      TOP=INT_015*60,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<E.轉EXCEL',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*400,;
      TOP=INT_015*100,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<C.取   消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'    
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')        
      THISFORM.OUSK_OPTION.VALUE=1    
      DO CASE
         CASE KEY()='F01'    
              THISFORM.LABEL1.CAPTION='起始日期'
              THISFORM.LABEL2.CAPTION='截止日期'
              THISFORM.TEXT1.WIDTH=INT_015*25
              THISFORM.TEXT2.WIDTH=INT_015*25   
              THISFORM.TEXT1.MAXLENGTH=2           
              THISFORM.TEXT2.MAXLENGTH=2                                       
              THISFORM.TEXT1.VALUE=C10.F01
              THISFORM.TEXT2.VALUE=C10.F01              
         CASE KEY()='F02+F01'
              THISFORM.LABEL1.CAPTION='起始客戶'
              THISFORM.LABEL2.CAPTION='截止客戶'
              THISFORM.TEXT1.WIDTH=INT_015*60
              THISFORM.TEXT2.WIDTH=INT_015*60 
              THISFORM.TEXT1.MAXLENGTH=5
              THISFORM.TEXT2.MAXLENGTH=5
              THISFORM.TEXT1.VALUE=C10.F02
              THISFORM.TEXT2.VALUE=C10.F02               
         CASE KEY()='F03+F01'      
              THISFORM.LABEL1.CAPTION='起始料號'
              THISFORM.LABEL2.CAPTION='截止料號'
              THISFORM.TEXT1.WIDTH=INT_015*200
              THISFORM.TEXT2.WIDTH=INT_015*200   
              THISFORM.TEXT1.MAXLENGTH=43             
              THISFORM.TEXT2.MAXLENGTH=43                                       
              THISFORM.TEXT1.VALUE=C10.F03
              THISFORM.TEXT2.VALUE=C10.F03
         CASE KEY()='F79+F01'         
              THISFORM.LABEL1.CAPTION='起始料號'
              THISFORM.LABEL2.CAPTION='截止料號'
              THISFORM.TEXT1.WIDTH=INT_015*200
              THISFORM.TEXT2.WIDTH=INT_015*200   
              THISFORM.TEXT1.MAXLENGTH=43             
              THISFORM.TEXT2.MAXLENGTH=43                                       
              THISFORM.TEXT1.VALUE=C10.F79
              THISFORM.TEXT2.VALUE=C10.F79
         CASE KEY()='F05+F01'   
              THISFORM.LABEL1.CAPTION='起始單號'
              THISFORM.LABEL2.CAPTION='截止單號'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=10              
              THISFORM.TEXT2.MAXLENGTH=10                            
              THISFORM.TEXT1.VALUE=C10.F05
              THISFORM.TEXT2.VALUE=C10.F05           
         CASE KEY()='F10'   
              THISFORM.LABEL1.CAPTION='起始編號'
              THISFORM.LABEL2.CAPTION='截止編號'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=5             
              THISFORM.TEXT2.MAXLENGTH=5                            
              THISFORM.TEXT1.VALUE=C10.F10
              THISFORM.TEXT2.VALUE=C10.F10      
         CASE KEY()='F12'   
              THISFORM.LABEL1.CAPTION='起始編號'
              THISFORM.LABEL2.CAPTION='截止編號'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=5             
              THISFORM.TEXT2.MAXLENGTH=5                            
              THISFORM.TEXT1.VALUE=C10.F12
              THISFORM.TEXT2.VALUE=C10.F12           
         CASE KEY()='F14'   
              THISFORM.LABEL1.CAPTION='起始編號'
              THISFORM.LABEL2.CAPTION='截止編號'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=5             
              THISFORM.TEXT2.MAXLENGTH=5                            
              THISFORM.TEXT1.VALUE=C10.F14
              THISFORM.TEXT2.VALUE=C10.F14                                                                               
      ENDCASE   
  ENDPROC    
  PROCEDURE CMND1.CLICK      
      DO CASE
            CASE THISFORM.OUSK_OPTION.VALUE=1           
                        UKEF='N'
            CASE THISFORM.OUSK_OPTION.VALUE=2
                        UKEF='Y'
                 IF A02.F10<>'*'
                    IF !USED('E02')
       		           SELECT 0
       		           USE E02
       		        ELSE 
       		           SELECT E02
       		        ENDIF
       		        SET ORDER TO 1      
 			        IF !USED('E18')
 			           SELECT 0
 			           USE E18 
 			        ELSE 
 			           SELECT E18
 			        ENDIF
 			        SET ORDER TO 1      
 			        IF !USED('E19')
 			           SELECT 0
 			           USE E19 
 			        ELSE 
 			           SELECT E19
 			        ENDIF
 			        SET ORDER TO E193      
 			        SET RELATION TO F01 INTO E18
 			        SELECT C10
 			     ENDIF   
            CASE THISFORM.OUSK_OPTION.VALUE=3 
                        UKEF='TYN'       
      ENDCASE  
     DO CASE 
        CASE KEY()='F01'   
             SELECT C10.F01,;           
                    C10.F02,;
                    C10.F03,;
                    C10.F04,;
                    C10.F05,;                  
                    C10.F06,;
                    C10.F07,;                    
                    C10.F08,;
                    C10.F09,;
                    C10.F10,;
                    C10.F11,;
                    C10.F12,;
                    C10.F13,;
                    C10.F14,;
                    C10.F15,;        
                    C10.F79,;               
                    B01.F02,;
                    IIF(C10.F08>0,VAL(TRANSFORM(IIF(A23.F09,IIF(SEEK(C10.F79,'G11'),G11.F21,0),IIF(SEEK(C10.F79,'B01'),B01.F37,0)),'@R 9999999999.999999')),0) AS F21,;
                    B01.F97;
             FROM C10,B01 WHERE  B01.F01=C10.F03 AND B01.F97$UKEF;
             AND C10.F01>=THISFORM.TEXT1.VALUE AND C10.F01<=THISFORM.TEXT2.VALUE ORDER BY C10.F01 INTO CURSOR C10AB
             SELECT C10AB
             GO TOP
             IF _TALLY >0           
                    IF EMPTY(EXBO)                       
                         IF A02.F10='*'
                             REPORT FORM ALLTRIM(INT_116)+'C10A_A' TO PRINT PROMPT PREVIEW
                         ELSE
                             REPORT FORM ALLTRIM(INT_116)+'C10A' TO PRINT PROMPT PREVIEW
                         ENDIF
                    ELSE
                        FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'出貨日報表'+'('+ICASE(ALLTRIM(UKEF)='TYN','全部',ALLTRIM(UKEF)='Y','製品','部品')+')'
                         IF A02.F10='*'
                             SELECT F01 日期,F79 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,F06 幣別,;
                             F21 成本單價,F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,IIF(F07=0,0,ROUND((F07-F21)/F07*100,6)) 毛利率,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC
                         ELSE
                             SELECT F01 日期,F03 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,;
                             F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC                         
 			             ENDIF       
 			             SELECT C10ABC
 			             GO TOP
 			             IF ALLTRIM(UKEF)='Y' AND A02.F10<>'*'
                            SELECT C10ABC.*,IIF(SEEK(C10ABC.料號,'E19','E193'),IIF(SEEK(E18.F03,'E02'),E02.F04,SPACE(8)),SPACE(10)) 加工廠商 FROM C10ABC  NOWAIT         
 			             ENDIF
		                 GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		                 IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		                 ENDIF   			               
                    ENDIF
                    FLG='1'
             ENDIF  
             SELECT C10AB
             USE
        CASE KEY()='F02+F01' 
             SELECT C10.F01,;           
                    C10.F02,;
                    C10.F03,;
                    C10.F04,;
                    C10.F05,;    
                    C10.F06,;              
                    C10.F07,;                    
                    C10.F08,;
                    C10.F09,;
                    C10.F10,;
                    C10.F11,;
                    C10.F12,;
                    C10.F13,;       
                    C10.F14,;
                    C10.F15,;       
                    C10.F79,;                             
                    B01.F02,;
                    IIF(C10.F08>0,VAL(TRANSFORM(IIF(A23.F09,IIF(SEEK(C10.F79,'G11'),G11.F21,0),IIF(SEEK(C10.F79,'B01'),B01.F37,0)),'@R 9999999999.999999')),0) AS F21,;
                    B01.F97;
             FROM C10,B01 WHERE  B01.F01=C10.F03 AND B01.F97$UKEF;
             AND C10.F02>=THISFORM.TEXT1.VALUE AND C10.F02<=THISFORM.TEXT2.VALUE ORDER BY C10.F02,C10.F01 INTO CURSOR C10AB
             SELECT C10AB
             GO TOP
             IF _TALLY >0           
                    IF EMPTY(EXBO)
                         IF A02.F10='*'
                             REPORT FORM ALLTRIM(INT_116)+'C10B_B' TO PRINT PROMPT PREVIEW
                         ELSE
                             REPORT FORM ALLTRIM(INT_116)+'C10B' TO PRINT PROMPT PREVIEW
                         ENDIF
                    ELSE
                         FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'出貨日報表'+'('+ICASE(ALLTRIM(UKEF)='TYN','全部',ALLTRIM(UKEF)='Y','製品','部品')+')'
                         IF A02.F10='*'
                             SELECT F01 日期,F79 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,F06 幣別,;
                                            F21 成本單價,F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,IIF(F07=0,0,ROUND((F07-F21)/F07*100,6)) 毛利率,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC
                         ELSE
                             SELECT F01 日期,F03 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,;
                                            F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC                         
 			 ENDIF       
 			 SELECT C10ABC
 			 GO TOP
 			 IF ALLTRIM(UKEF)='Y' AND A02.F10<>'*'
                SELECT C10ABC.*,IIF(SEEK(C10ABC.料號,'E19','E193'),IIF(SEEK(E18.F03,'E02'),E02.F04,SPACE(8)),SPACE(10)) 加工廠商 FROM C10ABC  NOWAIT         
 			 ENDIF
		         GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		         IF !EMPTY(GCDELIMFILE) 
		              ON ERROR DO FILE_IMPACT
		              COPY TO (GCDELIMFILE) TYPE XL5     
		              =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		         ENDIF   			               
                    ENDIF
                    FLG='1'
             ENDIF  
             SELECT C10AB
             USE                      
        CASE KEY()='F79+F01'
             
                 SELECT C10.F01,;
                    C10.F02,;
                    C10.F03,;
                    C10.F04,;
                    C10.F05,;
                    C10.F06,;                  
                    C10.F07,;                    
                    C10.F08,;
                    C10.F09,;
                    C10.F10,;
                    C10.F11,;
                    C10.F12,;
                    C10.F13,;   
                    C10.F14,;
                    C10.F15,;              
                    C10.F79,;   
                    B01.F02,;
                    IIF(C10.F08>0,VAL(TRANSFORM(IIF(A23.F09,IIF(SEEK(C10.F79,'G11'),G11.F21,0),IIF(SEEK(C10.F79,'B01'),B01.F37,0)),'@R 9999999999.999999')),0) AS F21,;
                    B01.F97;
                    FROM C10,B01 WHERE  B01.F01=C10.F79 AND B01.F97$UKEF;
                    AND C10.F79>=THISFORM.TEXT1.VALUE AND C10.F79<=THISFORM.TEXT2.VALUE ORDER BY C10.F79,C10.F01 INTO CURSOR C10AB
                     SELECT C10AB
             GO TOP
             IF _TALLY >0           
                    IF EMPTY(EXBO)
                         
                             REPORT FORM ALLTRIM(INT_116)+'C10C_C' TO PRINT PROMPT PREVIEW
                          
                    ELSE
                         FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'出貨日報表'+'('+ICASE(ALLTRIM(UKEF)='TYN','全部',ALLTRIM(UKEF)='Y','製品','部品')+')'                          
                         SELECT F79 料號,F02_B 品名規格,F01 日期,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,F06 幣別,;
                         F21 成本單價,F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,IIF(F07=0,0,ROUND((F07-F21)/F07*100,6)) 毛利率,F11 業務A,F13 業務B,F15 業務助理  FROM C10AB ORDER BY F01 INTO CURSOR C10ABC
 			             SELECT C10ABC
 			             GO TOP
 		   	             IF ALLTRIM(UKEF)='Y' &&AND A02.F10<>'*'
                            SELECT C10ABC.*,IIF(SEEK(C10ABC.料號,'E19','E193'),IIF(SEEK(E18.F03,'E02'),E02.F04,SPACE(8)),SPACE(10)) 加工廠商 FROM C10ABC  NOWAIT         
 			             ENDIF
		                 GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		                 IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+48,'提示訊息視窗') 
		                 ENDIF   			               
                    ENDIF
                    FLG='1'
             ENDIF  
             SELECT C10AB
             USE                  
            CASE KEY()='F03+F01'
                 SELECT C10.F01,;
                    C10.F02,;
                    C10.F03,;
                    C10.F04,;
                    C10.F05,;
                    C10.F06,;                  
                    C10.F07,;                    
                    C10.F08,;
                    C10.F09,;
                    C10.F10,;
                    C10.F11,;
                    C10.F12,;
                    C10.F13,;   
                    C10.F14,;
                    C10.F15,;              
                    C10.F79,;   
                    B01.F02,;
                    IIF(C10.F08>0,VAL(TRANSFORM(IIF(A23.F09,IIF(SEEK(C10.F79,'G11'),G11.F21,0),IIF(SEEK(C10.F79,'B01'),B01.F37,0)),'@R 9999999999.999999')),0) AS F21,;
                    B01.F97;
                    FROM C10,B01 WHERE  B01.F01=C10.F03 AND B01.F97$UKEF;
                    AND C10.F03>=THISFORM.TEXT1.VALUE AND C10.F03<=THISFORM.TEXT2.VALUE ORDER BY C10.F03,C10.F01 INTO CURSOR C10AB
                      
             SELECT C10AB
             GO TOP
             IF _TALLY >0           
                    IF EMPTY(EXBO)
                          
                             REPORT FORM ALLTRIM(INT_116)+'C10C' TO PRINT PROMPT PREVIEW
                          
                    ELSE
                         FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'出貨日報表'+'('+ICASE(ALLTRIM(UKEF)='TYN','全部',ALLTRIM(UKEF)='Y','製品','部品')+')'                          
                         SELECT F03 料號,F02_B 品名規格,F01 日期,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,;
                        F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC                         
 			                   
 			             SELECT C10ABC
 			             GO TOP
 			             IF ALLTRIM(UKEF)='Y' &&AND A02.F10<>'*'
                            SELECT C10ABC.*,IIF(SEEK(C10ABC.料號,'E19','E193'),IIF(SEEK(E18.F03,'E02'),E02.F04,SPACE(8)),SPACE(10)) 加工廠商 FROM C10ABC  NOWAIT         
 		  	             ENDIF
		                 GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		                 IF !EMPTY(GCDELIMFILE) 
		                    ON ERROR DO FILE_IMPACT
		                    COPY TO (GCDELIMFILE) TYPE XL5     
		                    =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		                 ENDIF   			               
                    ENDIF
                    FLG='1'
             ENDIF  
             SELECT C10AB
             USE                  
        CASE KEY()='F05+F01'   
             SELECT C10.F01,;           
                    C10.F02,;
                    C10.F03,;
                    C10.F04,;
                    C10.F05,;                  
                    C10.F06,;
                    C10.F07,;                    
                    C10.F08,;
                    C10.F09,;
                    C10.F10,;
                    C10.F11,;
                    C10.F12,;
                    C10.F13,;       
                    C10.F14,;
                    C10.F15,;              
                    C10.F79,;                      
                    B01.F02,;
                    IIF(C10.F08>0,VAL(TRANSFORM(IIF(A23.F09,IIF(SEEK(C10.F79,'G11'),G11.F21,0),IIF(SEEK(C10.F79,'B01'),B01.F37,0)),'@R 9999999999.999999')),0) AS F21,;
                    B01.F97;
             FROM C10,B01 WHERE  B01.F01=C10.F03 AND B01.F97$UKEF;
             AND C10.F05>=THISFORM.TEXT1.VALUE AND C10.F05<=THISFORM.TEXT2.VALUE ORDER BY C10.F05,C10.F01 INTO CURSOR C10AB
             SELECT C10AB
             GO TOP
             IF _TALLY >0           
                    IF EMPTY(EXBO)
                         IF A02.F10='*'
                             REPORT FORM ALLTRIM(INT_116)+'C10D_D' TO PRINT PROMPT PREVIEW
                         ELSE
                             REPORT FORM ALLTRIM(INT_116)+'C10D' TO PRINT PROMPT PREVIEW
                         ENDIF
                    ELSE
                        FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'出貨日報表'+'('+ICASE(ALLTRIM(UKEF)='TYN','全部',ALLTRIM(UKEF)='Y','製品','部品')+')'
                         IF A02.F10='*'
                             SELECT F05 訂單編號,F01 日期,F79 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F08 出貨數量,F06 幣別,;
                                            F21 成本單價,F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,IIF(F07=0,0,ROUND((F07-F21)/F07*100,6)) 毛利率,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC
                         ELSE
                             SELECT F05 訂單編號,F01 日期,F03 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F08 出貨數量,;
                                            F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC                         
 			 ENDIF       
 			 SELECT C10ABC
 			 GO TOP
 			 IF ALLTRIM(UKEF)='Y' AND A02.F10<>'*'
                SELECT C10ABC.*,IIF(SEEK(C10ABC.料號,'E19','E193'),IIF(SEEK(E18.F03,'E02'),E02.F04,SPACE(8)),SPACE(10)) 加工廠商 FROM C10ABC  NOWAIT         
 			 ENDIF
		         GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		         IF !EMPTY(GCDELIMFILE) 
		              ON ERROR DO FILE_IMPACT
		              COPY TO (GCDELIMFILE) TYPE XL5     
		              =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		         ENDIF   			               
                    ENDIF
                    FLG='1'
             ENDIF  
             SELECT C10AB
             USE        
        CASE KEY()='F10'   
             SELECT C10.F01,;           
                    C10.F02,;
                    C10.F03,;
                    C10.F04,;
                    C10.F05,;                  
                    C10.F06,;
                    C10.F07,;                    
                    C10.F08,;
                    C10.F09,;
                    C10.F10,;
                    C10.F11,;
                    C10.F12,;
                    C10.F13,;      
                    C10.F14,;
                    C10.F15,;    
                    C10.F79,;                                 
                    B01.F02,;
                    IIF(C10.F08>0,VAL(TRANSFORM(IIF(A23.F09,IIF(SEEK(C10.F79,'G11'),G11.F21,0),IIF(SEEK(C10.F79,'B01'),B01.F37,0)),'@R 9999999999.999999')),0) AS F21,;
                    B01.F97;
             FROM C10,B01 WHERE B01.F01=C10.F03 AND B01.F97$UKEF;
             AND C10.F10>=THISFORM.TEXT1.VALUE AND C10.F10<=THISFORM.TEXT2.VALUE ORDER BY C10.F01 INTO CURSOR C10AB
             SELECT C10AB
             GO TOP
             IF _TALLY >0           
                    IF EMPTY(EXBO)
                         IF A02.F10='*'
                             REPORT FORM ALLTRIM(INT_116)+'C10A_A' TO PRINT PROMPT PREVIEW
                         ELSE
                             REPORT FORM ALLTRIM(INT_116)+'C10A' TO PRINT PROMPT PREVIEW
                         ENDIF
                    ELSE
                        FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'出貨日報表'+'('+ICASE(ALLTRIM(UKEF)='TYN','全部',ALLTRIM(UKEF)='Y','製品','部品')+')'
                         IF A02.F10='*'
                             SELECT F01 日期,F79 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,F06 幣別,;
                                            F21 成本單價,F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,IIF(F07=0,0,ROUND((F07-F21)/F07*100,6)) 毛利率,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC
                         ELSE
                             SELECT F01 日期,F03 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,;
                                            F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC                         
 			 ENDIF       
 			 SELECT C10ABC
 			 GO TOP
 			 IF ALLTRIM(UKEF)='Y' AND A02.F10<>'*'
                SELECT C10ABC.*,IIF(SEEK(C10ABC.料號,'E19','E193'),IIF(SEEK(E18.F03,'E02'),E02.F04,SPACE(8)),SPACE(10)) 加工廠商 FROM C10ABC  NOWAIT         
 			 ENDIF
		         GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		         IF !EMPTY(GCDELIMFILE) 
		              ON ERROR DO FILE_IMPACT
		              COPY TO (GCDELIMFILE) TYPE XL5     
		              =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		         ENDIF   			               
                    ENDIF
                    FLG='1'
             ENDIF  
             SELECT C10AB
             USE                 
        CASE KEY()='F12'   
             SELECT C10.F01,;           
                    C10.F02,;
                    C10.F03,;
                    C10.F04,;
                    C10.F05,;                  
                    C10.F06,;
                    C10.F07,;                    
                    C10.F08,;
                    C10.F09,;
                    C10.F10,;
                    C10.F11,;
                    C10.F12,;
                    C10.F13,;  
                    C10.F14,;
                    C10.F15,;     
                    C10.F79,;                                   
                    B01.F02,;
                    IIF(C10.F08>0,VAL(TRANSFORM(IIF(A23.F09,IIF(SEEK(C10.F79,'G11'),G11.F21,0),IIF(SEEK(C10.F79,'B01'),B01.F37,0)),'@R 9999999999.999999')),0) AS F21,;
                    B01.F97;
             FROM C10,B01 WHERE  B01.F01=C10.F03 AND B01.F97$UKEF;
             AND C10.F12>=THISFORM.TEXT1.VALUE AND C10.F12<=THISFORM.TEXT2.VALUE ORDER BY C10.F01 INTO CURSOR C10AB
             SELECT C10AB
             GO TOP
             IF _TALLY >0           
                    IF EMPTY(EXBO)
                         IF A02.F10='*'
                             REPORT FORM ALLTRIM(INT_116)+'C10A_A' TO PRINT PROMPT PREVIEW
                         ELSE
                             REPORT FORM ALLTRIM(INT_116)+'C10A' TO PRINT PROMPT PREVIEW
                         ENDIF
                    ELSE
                         FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'出貨日報表'+'('+ICASE(ALLTRIM(UKEF)='TYN','全部',ALLTRIM(UKEF)='Y','製品','部品')+')'
                         IF A02.F10='*'
                             SELECT F01 日期,F79 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,F06 幣別,;
                                            F21 成本單價,F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,IIF(F07=0,0,ROUND((F07-F21)/F07*100,6)) 毛利率,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC
                         ELSE
                             SELECT F01 日期,F03 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,;
                                            F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC                         
 			 ENDIF       
 			 SELECT C10ABC
 			 GO TOP
  			 IF ALLTRIM(UKEF)='Y' AND A02.F10<>'*'
                SELECT C10ABC.*,IIF(SEEK(C10ABC.料號,'E19','E193'),IIF(SEEK(E18.F03,'E02'),E02.F04,SPACE(8)),SPACE(10)) 加工廠商 FROM C10ABC  NOWAIT         
 			 ENDIF			 
		         GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		         IF !EMPTY(GCDELIMFILE) 
		              ON ERROR DO FILE_IMPACT
		              COPY TO (GCDELIMFILE) TYPE XL5     
		              =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		         ENDIF   			               
                    ENDIF
                    FLG='1'
             ENDIF  
             SELECT C10AB
             USE       
        CASE KEY()='F14'   
             SELECT C10.F01,;           
                    C10.F02,;
                    C10.F03,;
                    C10.F04,;
                    C10.F05,;                  
                    C10.F06,;
                    C10.F07,;                    
                    C10.F08,;
                    C10.F09,;
                    C10.F10,;
                    C10.F11,;
                    C10.F12,;
                    C10.F13,;  
                    C10.F14,;
                    C10.F15,;      
                    C10.F79,;                                  
                    B01.F02,;
                    IIF(C10.F08>0,VAL(TRANSFORM(IIF(A23.F09,IIF(SEEK(C10.F79,'G11'),G11.F21,0),IIF(SEEK(C10.F79,'B01'),B01.F37,0)),'@R 9999999999.999999')),0) AS F21,;
                    B01.F97;
             FROM C10,B01 WHERE  B01.F01=C10.F03 AND B01.F97$UKEF;
             AND C10.F14>=THISFORM.TEXT1.VALUE AND C10.F14<=THISFORM.TEXT2.VALUE ORDER BY C10.F01 INTO CURSOR C10AB
             SELECT C10AB
             GO TOP
             IF _TALLY >0           
                    IF EMPTY(EXBO)
                         IF A02.F10='*'
                             REPORT FORM ALLTRIM(INT_116)+'C10A_A' TO PRINT PROMPT PREVIEW
                         ELSE
                             REPORT FORM ALLTRIM(INT_116)+'C10A' TO PRINT PROMPT PREVIEW
                         ENDIF
                    ELSE
                        FILENAME=LEFT(CHK_STR,4)+'年'+RIGHT(CHK_STR,2)+'月份'+'出貨日報表'+'('+ICASE(ALLTRIM(UKEF)='TYN','全部',ALLTRIM(UKEF)='Y','製品','部品')+')'
                         IF A02.F10='*'
                             SELECT F01 日期,F79 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,F06 幣別,;
                                            F21 成本單價,F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,IIF(F07=0,0,ROUND((F07-F21)/F07*100,6)) 毛利率,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC
                         ELSE
                             SELECT F01 日期,F03 料號,F02_B 品名規格,F04 單據編號,F02_A 客戶編號,F09 客戶簡稱,F05 訂單編號,F08 出貨數量,;
                                            F07 銷售單價,ROUND(F07*F08,0) 出貨金額小計,F11 業務A,F13 業務B,F15 業務助理 FROM C10AB ORDER BY F01 INTO CURSOR C10ABC                         
 			 ENDIF       
 			 SELECT C10ABC
 			 GO TOP
 			 IF USED('E02')
  			    IF ALLTRIM(UKEF)='Y' AND A02.F10<>'*'
                   SELECT C10ABC.*,IIF(SEEK(C10ABC.料號,'E19','E193'),IIF(SEEK(E18.F03,'E02'),E02.F04,SPACE(8)),SPACE(10)) 加工廠商 FROM C10ABC NOWAIT         
 			    ENDIF			 
 			 ENDIF   
		         GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		         IF !EMPTY(GCDELIMFILE) 
		              ON ERROR DO FILE_IMPACT
		              COPY TO (GCDELIMFILE) TYPE XL5     
		              =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		         ENDIF   			               
                    ENDIF
                    FLG='1'
             ENDIF  
             SELECT C10AB
             USE                                                                               
         ENDCASE 
         IF ALLTRIM(UKEF)='Y' AND A02.F10<>'*'
            IF USED('E02')
               SELECT E02
               USE
            ENDIF
            IF USED('E18')    
               SELECT E18
               USE
            ENDIF
            IF USED('E19')    
               SELECT E19
               USE
            ENDIF    
         ENDIF
     THISFORM.RELEASE    
  ENDPROC
  ****
  PROCEDURE CMND2.CLICK
     EXBO='1'
     THISFORM.CMND1.CLICK
     EXBO='' 
     THISFORM.RELEASE
  ENDPROC     
  PROCEDURE CMND3.CLICK
      FLG='1'   
      THISFORM.RELEASE
  ENDPROC        
ENDDEFINE  
