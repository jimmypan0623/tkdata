SET EXCL OFF
CLOSE ALL
CLEAR 
AREA1='D01'
FLG='0'
FCH=''
CHK=''
EXBO=''
IF !USED('A01')
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK sys_oper+'D01'
IF !USED('A0I')
   SELE 0
   USE A0I
ELSE
   SELE A0I
ENDIF
SET ORDER TO 1  
IF !USED('A09')
   SELE 0
   USE A09
ELSE
   SELE A09
ENDIF
SET ORDER TO 1
IF !USED('D02')
   SELE 0
   USE D02
ELSE
   SELE D02
ENDIF
SET ORDER TO D021      
IF !USED('d01')
   SELE 0
   USE d01 INDE d01
ELSE
   SELE d01
ENDIF
SET ORDER TO D011
D01FORM=CREATEOBJECT("TKD01")
D01FORM.SHOW  
DEFINE CLASS TKD01 AS FORM
  CAPTION='D01.廠商基本主檔'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  controlcount=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT LBL_REC AS LBL_REC WITH;
      AUTOCENTER =.T.
  ADD OBJECT REC_COUNT AS REC_COUNT  with;
      CAPTION=STR(RECCOUNT())        
  ADD OBJECT EXCEL_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      FONTSIZE=INT_015*9,;
      WIDTH=INT_015*65,;
      CAPTION='\<T.轉EXCEL',;
      NAME='EXCEL_BOTT'                
  ADD OBJECT LBLF01 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*27,;
      WIDTH=INT_015*50,;
      CAPTION='廠商編號'
  ADD OBJECT TXTF01 AS TEXTBOX WITH;      
      LEFT=INT_015*295,;
      TOP=INT_015*23,;
      WIDTH=INT_015*60,;
      MAXLENGTH=5,;
      NAME='TXTF01'        
  ADD OBJECT LBLF02 AS LABEL WITH;      
      LEFT=INT_015*498,;
      TOP=INT_015*27,;
      WIDTH=INT_015*50,;
      CAPTION='索引簡碼'      
  ADD OBJECT TXTF02 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*23,;
      WIDTH=INT_015*50,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=4,;
      NAME='TXTF02'           
  ADD OBJECT LBLF12 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*52,;
      WIDTH=INT_015*50,;
      CAPTION='品質等級'
  ADD OBJECT TXTF12 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*48,;
      WIDTH=INT_015*20,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=1,;
      NAME='TXTF12'           
  ADD OBJECT LBLF03 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*77,;
      WIDTH=INT_015*50,;
      CAPTION='公司名稱'
  ADD OBJECT TXTF03 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*73,;
      WIDTH=INT_015*290,;
      MAXLENGTH=40,;
      NAME='TXTF03'         
  ADD OBJECT LBLF04 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*102,;
      WIDTH=INT_015*50,;
      CAPTION='公司簡稱'
  ADD OBJECT TXTF04 AS TEXTBOX WITH;      
      LEFT=INT_015*295,;
      TOP=INT_015*98,;
      WIDTH=INT_015*74,;
      MAXLENGTH=8,;
      NAME='TXTF04'         
  ADD OBJECT LBLF05 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*127,;
      WIDTH=INT_015*50,;
      CAPTION='公司地址'
  ADD OBJECT TXTF05 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*123,;
      WIDTH=INT_015*450,;
      MAXLENGTH=100,;
      NAME='TXTF05'           
  ADD OBJECT LBLF21 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*152,;
      WIDTH=INT_015*50,;
      CAPTION='工廠地址'
  ADD OBJECT TXTF21 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*148,;
      WIDTH=INT_015*450,;
      MAXLENGTH=100,;
      NAME='TXTF21'      
  ADD OBJECT LBLF11 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*177,;
      WIDTH=INT_015*50,;
      CAPTION='營業項目'         
 ADD OBJECT TXTF11 AS TEXTBOX WITH;
      LEFT=INT_015*295, ;
      TOP=INT_015*173, ;
      WIDTH=INT_015*450, ;
      MAXLENGTH=40,;
      NAME='TXTF11'      
  ADD OBJECT LBLF16 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*202,;
      WIDTH=INT_015*50,;
      CAPTION='備註說明'         
  ADD OBJECT TXTF16 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*198,;
      WIDTH=INT_015*450,;
      MAXLENGTH=40,;
      NAME='TXTF16'            
  ADD OBJECT LBLF06 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*227,;
      WIDTH=INT_015*50,;
      CAPTION='統一編號'         
  ADD OBJECT TXTF06 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*223,;
      WIDTH=INT_015*74,;
      MAXLENGTH=8,;   
      INPUTMASK='99999999',;
      NAME='TXTF06'      
  ADD OBJECT LBLF07 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*227,;
      WIDTH=INT_015*50,;
      CAPTION='負  責  人'         
  ADD OBJECT TXTF07 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*223,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF07'           
  ADD OBJECT LBLF08 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*252,;
      WIDTH=INT_015*50,;
      CAPTION='連  絡  人'         
  ADD OBJECT TXTF08 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*295,;
      TOP=INT_015*248,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF08'      
  ADD OBJECT LBLF09 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*252,;
      WIDTH=INT_015*50,;
      CAPTION='聯絡電話'         
  ADD OBJECT TXTF09 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*248,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF09'          
  ADD OBJECT LBLF10 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*277,;
      WIDTH=INT_015*50,;
      CAPTION='傳真號碼'         
  ADD OBJECT TXTF10 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*273,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF10'         
  ADD OBJECT LBLF13 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*277,;
      WIDTH=INT_015*50,;
      CAPTION='結帳方式'      
  ADD OBJECT LBLF131 AS LABEL WITH;
      LEFT=INT_015*590,;
      TOP=INT_015*277,;
      AUTOSIZE=.T.
  ADD OBJECT TXTF13 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*273,;
      WIDTH=INT_015*20,;
      MAXLENGTH=1,;
      INPUTMASK='9',;
      NAME='TXTF13'           
  ADD OBJECT COMBOBOX13 AS COMBOBOX13 WITH;    
      LEFT=INT_015*549,;
      TOP=INT_015*273               
   ADD OBJECT TXTF36 AS TXTF36  WITH;
      LEFT=INT_015*586,;
      TOP=INT_015*273            
  ADD OBJECT LBLF14 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*302,;
      WIDTH=INT_015*50,;
      CAPTION='最後採購'         
  ADD OBJECT TXTF14 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*298,;
      WIDTH=INT_015*74,;
      NAME='TXTF14'           
  ADD OBJECT LBLF37 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*302,;
      WIDTH=INT_015*50,;
      CAPTION='票期天數'         
 ADD OBJECT TXTF37 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*298,;
      WIDTH=INT_015*36,;
      MAXLENGTH=4,;
      INPUTMASK='9999'
      NAME='TXTF37'          
  ADD OBJECT LBLF38 AS LABEL WITH;
      LEFT=INT_015*660,;
      TOP=INT_015*302,;
      WIDTH=INT_015*45,;
      CAPTION='請款日'          
  ADD OBJECT TXTF38 AS TEXTBOX WITH;
      LEFT=INT_015*700,;
      TOP=INT_015*298,;
      WIDTH=INT_015*30,;
      MAXLENGTH=2,;
      INPUTMASK='99'
      NAME='TXTF38'                 
  ADD OBJECT LBLF20 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*327,;
      WIDTH=INT_015*50,;
      CAPTION='最後詢價'         
  ADD OBJECT TXTF20 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*323,;
      WIDTH=INT_015*74,;
      NAME='TXTF20'             
  ADD OBJECT LBLF15 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*327,;
      WIDTH=INT_015*50,;
      CAPTION='結帳日期'              
  ADD OBJECT TXTF15 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*323,;
      WIDTH=INT_015*30,;
      MAXLENGTH=2,;
      INPUTMASK='99',;
      NAME='TXTF15'          
  ADD OBJECT LBLF17 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*352,;
      WIDTH=INT_015*50,;
      CAPTION='訂單加稅'        
  ADD OBJECT TXTF17 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*348,;
      WIDTH=INT_015*20,;
      maxlength=1,;
      NAME='TXTF17'           
  ADD OBJECT LBLF19 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*352,;
      WIDTH=INT_015*50,;
      CAPTION='付款條件'          
  ADD OBJECT TXTF19 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*348,;
      WIDTH=INT_015*149,;
      maxlength=20,;
      NAME='TXTF19'                                                                                                                                       
  ADD OBJECT LBLF23 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*377,;
      WIDTH=INT_015*50,;
      CAPTION='樣品窗口'         
  ADD OBJECT TXTF23 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*373,;
      WIDTH=INT_015*150,;
      NAME='TXTF23'           
  ADD OBJECT LBLF22 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*377,;
      WIDTH=INT_015*50,;
      CAPTION='E-m@il'              
  ADD OBJECT TXTF22 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*373,;
      WIDTH=INT_015*149,;
      maxlength=20,;
      NAME='TXTF22'                 
  ADD OBJECT LBLF39 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*402,;
      WIDTH=INT_015*50,;
      CAPTION='採購人員'         
  ADD OBJECT LBLF391 AS LABEL WITH;
      LEFT=INT_015*360,;
      TOP=INT_015*402,;
      AUTOSIZE=.T.,;
      CAPTION=''            
  ADD OBJECT TXTF39 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*398,;
      WIDTH=INT_015*55,;
      MAXLENGTH=5,;
      NAME='TXTF39'        
  ADD OBJECT LBLF25 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*402,;
      WIDTH=INT_015*50,;
      CAPTION=INT_045         
  ADD OBJECT TXTF25 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*398,;
      WIDTH=INT_015*106,;
      NAME='TXTF25'                
  ADD OBJECT LBLF24 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*427,;
      WIDTH=INT_015*50,;
      CAPTION='樣品採購'    
  ADD OBJECT LBLF241 AS LABEL WITH;
      LEFT=INT_015*360,;
      TOP=INT_015*427,;
      AUTOSIZE=.T.,;
      CAPTION=''     
  ADD OBJECT TXTF24 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*423,;
      WIDTH=INT_015*55,;
      MAXLENGTH=5,;
      NAME='TXTF24'             
  ADD OBJECT LBLF18 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*430,;
      WIDTH=INT_015*50,;
      CAPTION='安全資料'   
  ADD OBJECT LBLF181 AS LABEL WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*430,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='LBLF181'                                         
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      columncount=4,;            
      RECORDSOURCE='D01',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',; 
      COLUMN4.NAME='COLUMN4' 
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.              
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;      
      AUTOSIZE=.T.              
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*455,;
      LEFT=INT_015*498           
  PROCEDURE INIT
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限     
       THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.)    
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')       
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(SYS_OPER,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='廠商編號'
	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='索引簡碼'
	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='廠商簡稱'
	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='統一編號'		   
	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='d01.F01'
	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='d01.F02'
	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='d01.F04'
	   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='d01.F06'
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS      
       JK='廠商編號'
  ENDPROC     
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依廠商編號排列')
           .ADDITEM('依索引簡碼排列')
           .ADDITEM('依廠商簡稱排列')
           .ADDITEM('依統一編號排列')
       ENDWITH      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE d01
       DO CASE
           CASE THIS.DISPLAYVALUE='依廠商編號排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='廠商編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D01.F01'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D01.F02'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='廠商簡稱'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D01.F04' 
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='統一編號'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D01.F06'      
               SET ORDER TO d011     
          CASE THIS.DISPLAYVALUE='依索引簡碼排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D01.F02'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='廠商編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D01.F01'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='廠商簡稱'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D01.F04' 
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='統一編號'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D01.F06'    
               SET ORDER TO d012
           CASE THIS.DISPLAYVALUE='依廠商簡稱排列' 
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='廠商簡稱'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D01.F04'   
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='廠商編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D01.F01'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D01.F02'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='統一編號'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D01.F06' 
               SET ORDER TO D013
          CASE THIS.DISPLAYVALUE='依統一編號排列' 
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*70
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='統一編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D01.F06'   
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='廠商簡稱'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D01.F04'   
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='廠商編號'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D01.F01'
               THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D01.F02'
               SET ORDER TO D014               
       ENDCASE 
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC                
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       THISFORM.TXTF01.VALUE=d01.F01
       THISFORM.TXTF02.VALUE=d01.F02
       THISFORM.TXTF03.VALUE=d01.F03
       THISFORM.TXTF04.VALUE=d01.F04
       THISFORM.TXTF05.VALUE=d01.F05
       THISFORM.TXTF06.VALUE=d01.F06
       THISFORM.TXTF07.VALUE=d01.F07
       THISFORM.TXTF08.VALUE=d01.F08
       THISFORM.TXTF09.VALUE=d01.F09
       THISFORM.TXTF10.VALUE=d01.F10
       THISFORM.TXTF11.VALUE=d01.F11
       THISFORM.TXTF12.VALUE=d01.F12
       THISFORM.TXTF13.VALUE=d01.F13
       THISFORM.TXTF14.VALUE=dtoc(d01.F14)
       THISFORM.TXTF15.VALUE=d01.F15
       THISFORM.TXTF16.VALUE=d01.F16
       THISFORM.TXTF17.VALUE=d01.F17
       THISFORM.LBLF181.CAPTION=D01.F18
       THISFORM.TXTF19.VALUE=d01.F19
       THISFORM.TXTF20.VALUE=dtoc(d01.F20)
       THISFORM.TXTF21.VALUE=d01.F21
       THISFORM.TXTF22.VALUE=d01.F22
       THISFORM.TXTF23.VALUE=d01.F23
       THISFORM.TXTF24.VALUE=d01.F24
       THISFORM.TXTF25.VALUE=d01.F25
       THISFORM.TXTF36.VALUE=D01.F36
       THISFORM.TXTF37.VALUE=D01.F37
       THISFORM.TXTF38.VALUE=D01.F38     
       THISFORM.TXTF39.VALUE=D01.F39  
       THISFORM.LBLF391.CAPTION=IIF(SEEK(F39,'A01'),A01.F03,'') 
       THISFORM.LBLF241.CAPTION=IIF(SEEK(F24,'A01'),A01.F03,'') 
       THISFORM.LBLF131.CAPTION=IIF(D01.F13='0','現結',IIF(D01.F13='1','月結',IIF(D01.F13='2','次月結','T/T  '+ALLTRIM(STR(F36))+'  天')))
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       thisform.refresh
  ENDPROC       
  PROCEDURE TXTF03.INTERACTIVECHANGE
    THISFORM.TXTF04.VALUE=LEFT(THIS.VALUE,8 )
    THISFORM.TXTF04.REFRESH    
  ENDPROC
  PROCEDURE TXTF05.INTERACTIVECHANGE
    THISFORM.TXTF21.VALUE=THIS.VALUE
    THISFORM.TXTF21.REFRESH
  ENDPROC
*!*	  PROCEDURE TXTF13.VALID
*!*	    LPARAMETERS NINDEX
*!*	    IF THIS.VALUE<'2'
*!*	       NINDEX=.T.
*!*	    ELSE
*!*	       =MESSAGEBOX("請輸入'0'代表'現結'或是'1'代表'月結'!",0+64,"提示視窗")
*!*	       NINDEX=.F.
*!*	    ENDIF
*!*	    RETURN NINDEX
*!*	  ENDPROC  
*!*	  PROCEDURE TXTF13.INTERACTIVECHANGE  
*!*	    THISFORM.LBLF131.CAPTION=IIF(THIS.VALUE='0','現結','月結')
*!*	  ENDPROC
  PROCEDURE TXTF15.VALID
    LPARAMETERS NINDEX
    IF ALLTRIM(THIS.VALUE)<'32'
       NINDEX=.T.
    ELSE 
       =messagebox('輸入資料格式不符',0+64,'提示視窗')       
       NINDEX=.F.   
    ENDIF   
    RETURN NINDEX
  ENDPROC  
  PROCEDURE TXTF24.INTERACTIVECHANGE      
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 WHERE LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) NOWAIT
       ELSE
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 NOWAIT    
       ENDIF   
       MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
       MAN_SEEK.SHOW    
       THIS.VALUE=FLG
       THIS.REFRESH
       FLG='0'
    ENDIF   
       THISFORM.LBLF241.CAPTION=IIF(SEEK(THIS.VALUE,'A01'),A01.F03,'')
  ENDPROC
  PROCEDURE TXTF39.INTERACTIVECHANGE      
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 WHERE LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) NOWAIT
       ELSE
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 NOWAIT
       ENDIF   
       MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
       MAN_SEEK.SHOW    
       THIS.VALUE=FLG
       THIS.REFRESH
       FLG='0'
    ENDIF   
       THISFORM.LBLF391.CAPTION=IIF(SEEK(THIS.VALUE,'A01'),A01.F03,'')
  ENDPROC    
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK 
    THISFORM.SETALL('READONLY',.F.,'TEXTBOX')    
    THISFORM.TXTF13.VISIBLE=.F.
    THISFORM.COMBOBOX13.VISIBLE=.T.
    THISFORM.COMBOBOX13.ENABLED=.T.
    THISFORM.TXTF37.READONLY=.T.    
    THISFORM.TXTF14.READONLY=.T.
    THISFORM.TXTF20.READONLY=.T.
    IF INT_004=.T. 
       H='D000 '    
       SELE A0I   
       SET ORDER TO 1
       SEEK H           
       IF FOUND() 
          PO_NO=F08
          RLOCK()
          DELE 
          UNLOCK
       ELSE
          SELE A09
          SEEK H
          IF FOUND()
             RLOCK()
             PO_NO=RIGHT(ALLTRIM(F08),4)
             HX=VAL(PO_NO)+1
             PO_NO='0000'
             PO_NO=LEFT(F08,1)+STUFF(PO_NO,5-INT(LOG(HX)/LOG(10)+1),INT(LOG(HX)/LOG(10)+1),RIGHT(STR(HX),INT(LOG(HX)/LOG(10)+1)))
             REPL F08 WITH PO_NO
             UNLOCK              
          ENDIF   
       ENDIF
       THISFORM.TXTF01.VALUE=PO_NO
       THISFORM.TXTF01.REFRESH
       thisform.txtf01.readonly=.t.
       THISFORM.TXTF02.SETFOCUS
    ELSE
       THISFORM.TXTF01.VALUE=''
       THISFORM.TXTF01.SETFOCUS           
    ENDIF       
    THISFORM.TXTF02.VALUE=''
    THISFORM.TXTF03.VALUE=''
    THISFORM.TXTF04.VALUE=''
    THISFORM.TXTF05.VALUE=''
    THISFORM.TXTF06.VALUE=''
    THISFORM.TXTF07.VALUE=''
    THISFORM.TXTF08.VALUE=''
    THISFORM.TXTF09.VALUE=''
    THISFORM.TXTF10.VALUE=''
    THISFORM.TXTF11.VALUE=''
    THISFORM.TXTF12.VALUE=''
    THISFORM.TXTF13.VALUE='0'
    THISFORM.LBLF131.CAPTION='現結'
    THISFORM.COMBOBOX13.VALUE=1    
    THISFORM.TXTF14.VALUE=CTOD('')
    THISFORM.TXTF15.VALUE='31'
    THISFORM.TXTF16.VALUE=''
    THISFORM.TXTF17.VALUE=''
    THISFORM.LBLF181.CAPTION=''
    THISFORM.TXTF19.VALUE=''
    THISFORM.TXTF20.VALUE=CTOD('')
    THISFORM.TXTF21.VALUE=''
    THISFORM.TXTF22.VALUE=''
    THISFORM.TXTF23.VALUE=''
    THISFORM.TXTF24.VALUE=''
    THISFORM.TXTF25.VALUE=''
    THISFORM.TXTF36.VALUE=0
    THISFORM.TXTF37.VALUE=0
    THISFORM.TXTF38.VALUE=1   
    THISFORM.TXTF39.VALUE='' 
    THISFORM.LBLF391.CAPTION=''
    THISFORM.EXCEL_BOTT.ENABLED=.F.
    THISFORM.GRID1.ENABLED=.F.
    FLG='1'
  ENDPROC  
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK    
     THISFORM.TXTF01.READONLY=.T.
     THISFORM.TXTF13.VISIBLE=.F.
     THISFORM.COMBOBOX13.VISIBLE=.T.
     THISFORM.COMBOBOX13.ENABLED=.T.     
     THISFORM.COMBOBOX13.VALUE=IIF(D01.F13='0',1,IIF(D01.F13='1',2,IIF(D01.F13='2',3,4)))
     THISFORM.LBLF131.LEFT=IIF(F13='3',INT_015*625,INT_015*590)     
     THISFORM.TXTF36.READONLY=IIF(F13='3',.F.,.T.)
     THISFORM.TXTF36.VISIBLE=IIF(F13='3',.T.,.F.)
     THISFORM.TXTF37.READONLY=IIF(F13='0' .OR. F13='3',.T.,.F.)     
     THISFORM.TXTF14.READONLY=.T.
     THISFORM.TXTF20.READONLY=.T.
     THISFORM.EXCEL_BOTT.ENABLED=.F.
     THISFORM.GRID1.ENABLED=.F.
     THISFORM.TXTF03.SETFOCUS
     LOCK()
     IF !RLOCK()
        DO file_impact
        THISFORM.SHRGROUP.ABANDON_BOTT.CLICK                    
*        return
     endif
  endproc 
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK
     if messagebox('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	      
        SELE D02   
        SEEK D01.F01
        IF FOUND()
           =MESSAGEBOX('此廠商仍有詢價資料,無法刪除',0+64,'注意')
           sele D01
           RETURN
        ENDIF
        SELE D01
        LOCK()
        IF RLOCK()
           IF INT_004=.T.
              SELE A0I        
              SET ORDER TO 1
              APPEND BLANK
              LOCK()
              REPL F01 WITH 'D000 '
              REPL F06 WITH '廠商編號'
              REPL F08 WITH D01.F01
              UNLOCK
            ENDIF
            SELE D01
            DELE
            unlock
            SKIP -1
            IF BOF()
               GO TOP
            ENDIF  
            THISFORM.GRID1.SETFOCUS
            IF THISFORM.GRID1.ACTIVEROW=0
               THISFORM.SETALL('VALUE','','TEXTBOX')
               THISFORM.LBLF181.CAPTION=''
               THISFORM.CMDGROUP.ENABLED=.F.
            ELSE
               THISFORM.CMDGROUP.ENABLED=.T.            
               THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
               THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
               THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限   
               THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.)              
            ENDIF 
        ELSE
           DO file_impact    
        ENDIF       
     ENDIF        
  ENDPROC     
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
    SELE D01
    COD=SYS(21)
    SET ORDER TO D011
    seek ALLTRIM(THISFORM.TXTF01.VALUE)
    if found()
       =messagebox('廠商編號重複!',0+64,'提示視窗')
       SET ORDER TO &COD
       RETURN
    ENDIF
    IF EMPTY(THISFORM.TXTF02.VALUE) .OR. LEN(ALLTRIM(THISFORM.TXTF02.VALUE))<4
       =MESSAGEBOX('索引簡碼不得空白!且不得小於四碼',0+64,'提示視窗')  
       SET ORDER TO &COD 
       THISFORM.TXTF02.SETFOCUS
       RETURN
    ENDIF   
    IF chk_unit(THISFORM.TXTF06.VALUE)=.f. AND !EMPTY(ALLTRIM(thisform.txtf06.value))
       =MESSAGEBOX('統一編號輸入錯誤!',0+48,'提示訊息視窗')
       SET ORDER TO &COD
       THISFORM.TXTF06.SETFOCUS
       RETURN
    ENDIF    
    
    
    IF EMPTY(THISFORM.TXTF15.VALUE)
       =MESSAGEBOX('入帳日期不得空白!',0+48,'提示訊息視窗')
       SET ORDER TO &COD
       THISFORM.TXTF15.SETFOCUS
       RETURN
    ENDIF
     IF EMPTY(THISFORM.TXTF38.VALUE)
        =MESSAGEBOX('請款日不得為零!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF
     IF THISFORM.TXTF38.VALUE>31
        =MESSAGEBOX('請款日不得超過31日!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF  
      IF SEEK(THISFORM.TXTF24.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF24.VALUE)
         =MESSAGEBOX('無此樣品採購人員請重新輸入!',0+64,'提示視窗')   
         THISFORM.TXTF24.SETFOCUS
         SET ORDER TO &COD
         RETURN
     ENDIF   
     IF SEEK(THISFORM.TXTF39.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF39.VALUE)
         =MESSAGEBOX('無此採購人員請重新輸入!',0+64,'提示視窗')   
         THISFORM.TXTF39.SETFOCUS
         SET ORDER TO &COD
         RETURN
     ENDIF   
    APPEND BLANK
    LOCK()
    IF RLOCK()
       REPLACE F01 WITH THISFORM.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.TXTF02.VALUE
       REPLACE F03 WITH THISFORM.TXTF03.VALUE
       REPLACE F04 WITH THISFORM.TXTF04.VALUE
       REPLACE F05 WITH THISFORM.TXTF05.VALUE
       REPLACE F06 WITH THISFORM.TXTF06.VALUE
       REPLACE F07 WITH THISFORM.TXTF07.VALUE
       REPLACE F08 WITH THISFORM.TXTF08.VALUE
       REPLACE F09 WITH THISFORM.TXTF09.VALUE
       REPLACE F10 WITH THISFORM.TXTF10.VALUE
       REPLACE F11 WITH THISFORM.TXTF11.VALUE
       REPLACE F12 WITH THISFORM.TXTF12.VALUE
       REPLACE F13 WITH THISFORM.TXTF13.VALUE
       REPLACE F15 WITH THISFORM.TXTF15.VALUE
       REPLACE F16 WITH THISFORM.TXTF16.VALUE
       REPLACE F17 WITH THISFORM.TXTF17.VALUE
       REPLACE F18 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       REPLACE F19 WITH THISFORM.TXTF19.VALUE
       REPLACE F21 WITH THISFORM.TXTF21.VALUE
       REPLACE F22 WITH THISFORM.TXTF22.VALUE
       REPLACE F23 WITH THISFORM.TXTF23.VALUE
       REPLACE F24 WITH THISFORM.TXTF24.VALUE
       REPLACE F25 WITH THISFORM.TXTF25.VALUE
       IF THISFORM.COMBOBOX13.VALUE=4
            REPLACE F36 WITH THISFORM.TXTF36.VALUE
       ENDIF       
       REPLACE F37 WITH THISFORM.TXTF37.VALUE
       REPLACE F38 WITH THISFORM.TXTF38.VALUE
       REPLACE F39 WITH THISFORM.TXTF39.VALUE
    ENDIF
    UNLOCK    
    SET ORDER TO &COD  
    THISFORM.REC_COUNT.CAPTION=STR(RECCOUNT())
    THISFORM.GRID1.ENABLED=.T.
    THISFORM.REFRESH
    THISFORM.GRID1.SETFOCUS    
    THISFORM.ORPGROUP.NEW_BOTT.CLICK            
  ENDPROC
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
    IF EMPTY(THISFORM.TXTF02.VALUE) .OR. LEN(ALLTRIM(THISFORM.TXTF02.VALUE))<4
       =MESSAGEBOX('索引簡碼不得空白!且不得小於四碼',0+64,'提示視窗')  
       THISFORM.TXTF02.SETFOCUS        
       RETURN
    ENDIF     
     IF chk_unit(THISFORM.TXTF06.VALUE)=.f. AND !EMPTY(ALLTRIM(thisform.txtf06.value))
       =MESSAGEBOX('統一編號輸入錯誤!',0+48,'提示訊息視窗')
       THISFORM.TXTF06.SETFOCUS
       RETURN
    ENDIF       
    
     IF EMPTY(THISFORM.TXTF38.VALUE)
        =MESSAGEBOX('請款日不得為零!',0+48,'提示訊息視窗')
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF     
     IF THISFORM.TXTF38.VALUE>31
        =MESSAGEBOX('請款日不得超過31日!',0+48,'提示訊息視窗')
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF 
      IF SEEK(THISFORM.TXTF24.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF24.VALUE)
         =MESSAGEBOX('無此樣品採購人員請重新輸入!',0+64,'提示視窗')   
         THISFORM.TXTF24.SETFOCUS
         RETURN
     ENDIF   
     IF SEEK(THISFORM.TXTF39.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF39.VALUE)
         =MESSAGEBOX('無此採購人員請重新輸入!',0+64,'提示視窗')   
         THISFORM.TXTF39.SETFOCUS
         RETURN
     ENDIF         
    SELE D01
    IF RLOCK()
       REPLACE F01 WITH THISFORM.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.TXTF02.VALUE
       REPLACE F03 WITH THISFORM.TXTF03.VALUE
       REPLACE F04 WITH THISFORM.TXTF04.VALUE
       REPLACE F05 WITH THISFORM.TXTF05.VALUE
       REPLACE F06 WITH THISFORM.TXTF06.VALUE
       REPLACE F07 WITH THISFORM.TXTF07.VALUE
       REPLACE F08 WITH THISFORM.TXTF08.VALUE
       REPLACE F09 WITH THISFORM.TXTF09.VALUE
       REPLACE F10 WITH THISFORM.TXTF10.VALUE
       REPLACE F11 WITH THISFORM.TXTF11.VALUE
       REPLACE F12 WITH THISFORM.TXTF12.VALUE
       REPLACE F13 WITH THISFORM.TXTF13.VALUE
       REPLACE F15 WITH THISFORM.TXTF15.VALUE
       REPLACE F16 WITH THISFORM.TXTF16.VALUE
       REPLACE F17 WITH THISFORM.TXTF17.VALUE
       REPLACE F18 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       REPLACE F19 WITH THISFORM.TXTF19.VALUE
       REPLACE F21 WITH THISFORM.TXTF21.VALUE
       REPLACE F22 WITH THISFORM.TXTF22.VALUE
       REPLACE F23 WITH THISFORM.TXTF23.VALUE
       REPLACE F24 WITH THISFORM.TXTF24.VALUE
       REPLACE F25 WITH THISFORM.TXTF25.VALUE
       IF THISFORM.COMBOBOX13.VALUE=4
            REPLACE F36 WITH THISFORM.TXTF36.VALUE
       ENDIF
       REPLACE F37 WITH THISFORM.TXTF37.VALUE
       REPLACE F38 WITH THISFORM.TXTF38.VALUE  
       REPLACE F39 WITH THISFORM.TXTF39.VALUE       
    ELSE
      DO file_impact
      return   
    ENDIF   
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC   
  procedure SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限      
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.KEY_LIST.ENABLED=.T.      
      THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.)  
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.TXTF13.VISIBLE=.T.
      THISFORM.LBLF131.LEFT=INT_015*590
      THISFORM.COMBOBOX13.VISIBLE=.F.
      THISFORM.COMBOBOX13.ENABLED=.F.      
      THISFORM.TXTF36.READONLY=.T.
      THISFORM.TXTF36.VISIBLE=.F.      
      UNLOCK ALL 
      SELE D01
      THISFORM.GRID1.ENABLED=.T.
      THISFORM.GRID1.SETFOCUS    
  ENDPROC
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
       IF INT_004=.T.
          SELE A0I
          SET ORDER TO 1
          APPEND BLANK
          LOCK()
          REPL F01 WITH 'D000 '
          REPL F06 WITH '廠商編號'
          REPL F08 WITH PO_NO
          UNLOCK
       ENDIF   
       SELE D01
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
  PROC EXCEL_BOTT.CLICK
       EXBO='1'
       SELECT D01
       ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
       ANS_RANGE.SHOW 
       EXBO=''
       THISFORM.GRID1.SETFOCUS
  ENDPROC     
ENDDEFINE      
**************************************列印程序 
PROC PNT_PRC
   SELECT D01
   PO_NO=D01.F01
   ANS_CHK=CREATEOBJECT("ANS_CHK")  
   ANS_CHK.SHOW           
ENDPROC
********************************************************
DEFINE CLASS ANS_CHK AS FORM
  AUTOCENTER=.T.
  CAPTION='請選擇列印內容'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*105
  WIDTH=INT_015*230
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_CHK'
ADD OBJECT DATA_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*17,;
      TOP=INT_015*20,;
      AUTOSIZE=.T.,;
      FONTSIZE=INT_015*12,;
      BUTTONCOUNT=3,;
      OPTION1.CAPTION='列印信封',;
      OPTION1.TOP=INT_015*0,;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='列印標籤',;
      OPTION2.TOP=INT_015*20,;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.AUTOSIZE=.T.,;      
      OPTION3.CAPTION='列印廠商資料明細',;
      OPTION3.TOP=INT_015*40,;
      OPTION3.FONTSIZE=INT_015*9,;
      OPTION3.AUTOSIZE=.T.,;
      NAME='DATA_OPTION'   
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*20,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<Y.確定',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;
      TOP=INT_015*60,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'     
  *****   
  PROCEDURE CMND1.CLICK   
        DO  CASE
               CASE THISFORM.DATA_OPTION.VALUE=1
		            SELE F03,F05,F08 FROM D01  WHERE F01=PO_NO NOWAIT     
		            IF _TALLY>0
		               REPORT FORM ALLTRIM(INT_116)+'D01' TO PRINT PROMPT        
		            ENDIF               
               CASE THISFORM.DATA_OPTION.VALUE=2
      			    LBL_QTY=CREATEOBJECT("LBL_QTY")  
         		    LBL_QTY.SHOW                                      
               CASE THISFORM.DATA_OPTION.VALUE=3    
                  	ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   			        ANS_RANGE.SHOW                  
        ENDCASE 
        THISFORM.CMND2.CLICK                         
  ENDPROC  
******
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE  
******************************************LABEL列印張數
DEFINE CLASS LBL_QTY AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印張數'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*190
  WIDTH=INT_015*200
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='LBL_QTY'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*75,;
      FONTSIZE=INT_015*9,;
      NAME='LABEL1'
      ADD OBJECT TEXT1 AS TEXTBOX WITH;
          AUTOSIZE=.T.,;
          TOP=INT_015*70,;
          WIDTH=INT_015*30,;
          LEFT=INT_015*120,;
          HEIGHT=INT_015*25,; 
          FONTSIZE=INT_015*9,;
          INPUTMASK='99'
          NAME='TEXT1'
      ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
          AUTOSIZE=.T.,;
          LEFT=INT_015*25,;    
          HEIGHT=INT_015*25,;   
          TOP=INT_015*144,;  
          WIDTH=INT_015*80,;
          FONTSIZE=INT_015*9,;          
          CAPTION='\<Y.執行',;
          TOOLTIPTEXT='確認欲列印張數!快速鍵->ALT+Y',;
          NAME='CMND1'
      ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
          AUTOSIZE=.T.,;
          LEFT=INT_015*90,;
          TOP=INT_015*144,;
          HEIGHT=INT_015*25,;
          WIDTH=INT_015*80,;
          FONTSIZE=INT_015*9,;
          CAPTION='\<C.取消',;
          TOOLTIPTEXT='取消列印作業!快速鍵->ALT+C',;
          NAME='CMND2'
      PROCEDURE INIT 
          THISFORM.LABEL1.CAPTION='列印張數'
          THISFORM.TEXT1.VALUE=1
      ENDPROC    
      PROCEDURE CMND1.CLICK 
          SELE F03,F05,F09 FROM D01  WHERE F01=PO_NO INTO CURSOR LBL1
          CREATE CURSOR  LBL2 (F03 C(40), F05 C(100),F09 C(20))
          SELE LBL2
          FOR I=1 TO THISFORM.TEXT1.VALUE
              APPEND BLANK
              REPL F03 WITH LBL1.F03
              REPL F05 WITH LBL1.F05
              REPL F09 WITH LBL1.F09
          ENDFOR
            REPORT FORM ALLTRIM(INT_116) + 'D01A' TO PRINT PROMPT 
*!*	              REPORT FORM ALLTRIM(INT_116)+'D01A' TO PRINT PROMPT PREVIEW
              SELE LBL2
              USE
              SELE LBL1
              USE               
          THISFORM.RELEASE                
      ENDPROC
      PROCEDURE CMND2.CLICK
          THISFORM.RELEASE
      ENDPROC      
ENDDEFINE    
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*110
  WIDTH=INT_015*320
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      WIDTH=INT_015*60,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*25,;
      TOP=INT_015*25,;
      CAPTION='起始編號',;
      NAME='LABEL1'
  ADD OBJECT LABEL2 AS LABEL WITH;
      WIDTH=INT_015*60,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*172,;
      TOP=INT_015*25,;
      CAPTION='截止編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      WIDTH=INT_015*70,;
      TOP=INT_015*19,;
      LEFT=INT_015*85,;
      HEIGHT=INT_015*25,; 
      MAXLENGTH=5,; 
      NAME='TEXT1'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      WIDTH=INT_015*70,;
      TOP=INT_015*19,;
      LEFT=INT_015*230,;
      HEIGHT=INT_015*25,;  
      MAXLENGTH=5,;        
      NAME='TEXT2'    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*90,;    
      HEIGHT=INT_015*25,;   
      TOP=INT_015*70,;  
      WIDTH=INT_015*50,;
      CAPTION='\<Y.執行',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*215,;
      TOP=INT_015*70,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*50,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'
  PROCEDURE INIT 
      SELECT D01
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')                                             
      DO CASE
            CASE KEY()='F01'
                      THISFORM.LABEL1.CAPTION='起始編號'
                      THISFORM.LABEL2.CAPTION='截止編號'
                      THISFORM.TEXT1.MAXLENGTH=5
                      THISFORM.TEXT2.MAXLENGTH=5
                      THISFORM.TEXT1.VALUE=D01.F01
                      THISFORM.TEXT2.VALUE=D01.F01     
            CASE KEY()='F02'
                      THISFORM.LABEL1.CAPTION='起始簡碼'
                      THISFORM.LABEL2.CAPTION='截止簡碼'
                      THISFORM.TEXT1.MAXLENGTH=4
                      THISFORM.TEXT2.MAXLENGTH=4            
                      THISFORM.TEXT1.VALUE=D01.F02
                      THISFORM.TEXT2.VALUE=D01.F02                                 
            CASE KEY()='F04'
                      THISFORM.LABEL1.CAPTION='起始簡稱'
                      THISFORM.LABEL2.CAPTION='截止簡稱'
                      THISFORM.TEXT1.MAXLENGTH=8
                      THISFORM.TEXT2.MAXLENGTH=8           
                      THISFORM.TEXT1.VALUE=D01.F04
                      THISFORM.TEXT2.VALUE=D01.F04   
            CASE KEY()='F06'
                      THISFORM.LABEL1.CAPTION='起始統編'
                      THISFORM.LABEL2.CAPTION='截止統號'
                      THISFORM.TEXT1.MAXLENGTH=8
                      THISFORM.TEXT2.MAXLENGTH=8            
                      THISFORM.TEXT1.VALUE=D01.F06
                      THISFORM.TEXT2.VALUE=D01.F06   
      ENDCASE
  ENDPROC    
  PROCEDURE CMND1.CLICK     
      DO CASE
            CASE KEY()='F01'
                      SELECT * FROM D01 WHERE  D01.F01>=THISFORM.TEXT1.VALUE .AND. D01.F01<=THISFORM.TEXT2.VALUE ORDER BY D01.F01 INTO CURSOR D01_TEMP  
            CASE KEY()='F02'
                      SELECT * FROM D01 WHERE  D01.F02>=THISFORM.TEXT1.VALUE .AND. D01.F02<=THISFORM.TEXT2.VALUE ORDER BY D01.F02 INTO CURSOR D01_TEMP                             
            CASE KEY()='F04'
                      SELECT * FROM D01 WHERE  D01.F04>=THISFORM.TEXT1.VALUE .AND. D01.F04<=THISFORM.TEXT2.VALUE ORDER BY D01.F04 INTO CURSOR D01_TEMP  
            CASE KEY()='F06'
                      SELECT * FROM D01 WHERE  D01.F06>=THISFORM.TEXT1.VALUE .AND. D01.F06<=THISFORM.TEXT2.VALUE ORDER BY D01.F06 INTO CURSOR D01_TEMP 
        ENDCASE
        SELECT D01_TEMP
        GO TOP
	IF _TALLY>0
	     IF EMPTY(EXBO)
	         REPORT FORM ALLTRIM(INT_116)+'D01B' TO PRINT PROMPT PREVIEW 
	     ELSE
	         SELECT F01 廠商編號,F02 客戶簡碼,F03 廠商名稱,F04 廠商簡稱,F05 地址,F06 統一編號,F07 負責人,F08 連絡人,F09 電話,F10 傳真號碼,;
	                        F11 營業項目,F12 品質等級,F13 結帳方式,F14 最進採購日期,F15 入帳日期,F16 備註,F17 採購訂單是否外加營業稅,F18 安全資料,;
	                        F19 付款條件,F20 最後詢價日,F21 工廠地址,F22 USER自定,F23 USER自定,F24 USER自定,F25 USER自定,F36 TT之天數,F37 票期天數,F38 請款日,F39 採購人員 FROM D01_TEMP ORDER BY F01 INTO CURSOR D01AA
	                        SELECT D01AA
	         FILENAME='廠商資料明細'
		 GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		 IF !EMPTY(GCDELIMFILE) 
		      ON ERROR DO FILE_IMPACT
		      COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF     
	     ENDIF
	     THISFORM.CMND2.CLICK
	ELSE
	     =MESSAGEBOX('無此範圍資料',0+48,'警示')
      	     THISFORM.TEXT1.VALUE=''
      	     THISFORM.TEXT2.VALUE=''	     
	     THISFORM.TEXT1.SETFOCUS
	ENDIF         
  ENDPROC
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC        
ENDDEFINE   
**************************************結帳方式
DEFINE CLASS COMBOBOX13 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2   
       VALUE=1
       NAME='COMBOBOX13'
 PROCEDURE INIT    
       THIS.ADDITEM('0')
       THIS.ADDITEM('1')
       THIS.ADDITEM('2')
       THIS.ADDITEM('3')
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
   THISFORM.LBLF131.LEFT=INT_015*590 
   THISFORM.TXTF36.READONLY=.T.
   THISFORM.TXTF36.VISIBLE=.F. 
   THISFORM.TXTF37.READONLY=.F.
       DO CASE 
             CASE THIS.VALUE=1
                        THISFORM.TXTF13.VALUE='0'
                        THISFORM.LBLF131.CAPTION='現結'
                        THISFORM.TXTF37.READONLY=.T.
             CASE THIS.VALUE=2
                        THISFORM.TXTF13.VALUE='1'
                        THISFORM.LBLF131.CAPTION='月結'         
             CASE THIS.VALUE=3
                        THISFORM.TXTF13.VALUE='2'
                        THISFORM.LBLF131.CAPTION='次月結'      
             CASE THIS.VALUE=4                        
                        THISFORM.TXTF13.VALUE='3'
                        THISFORM.LBLF131.CAPTION='T/T  '+ALLTRIM(STR(THISFORM.TXTF36.VALUE))+'  天'
                        THISFORM.LBLF131.LEFT=INT_015*625
                        THISFORM.TXTF36.VISIBLE=.T. 
                        THISFORM.TXTF36.READONLY=.F.
                        THISFORM.TXTF36.VALUE=0     
                        THISFORM.TXTF37.READONLY=.T.
        ENDCASE
       THISFORM.TXTF13.REFRESH    
       THISFORM.TXTF36.REFRESH 
  ENDPROC       
ENDDEFINE
*********T/T天數
DEFINE CLASS TXTF36 AS TEXTBOX
  VISIBLE=.F.
  READONLY=.T.
  MAXLENGTH=4
  WIDTH=INT_015*35
  HEIGHT=INT_015*25
  INPUTMASK='9999'
  FONTSIZE=INT_015*9  
  PROCEDURE INTERACTIVECHANGE     
       THISFORM.LBLF131.CAPTION='T/T  '+ALLTRIM(STR(THIS.VALUE))+'  天'  
  ENDPROC
ENDDEFINE  