***程式名稱:S06.離職人員薪資基本檔
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
R=0
AREA1='S05_1'
AREA2='S06'
IF !USED('A01')  &&操作人員資料設定
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')  &&權限設定檔
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'S06'   
IF FOUND()  AND A02.F09='*'   &&判斷是否有權限可處理所有員工
    ALL_CHK=.T.
ELSE
    ALL_CHK=.F.
ENDIF  
IF !USED('A14')  &&部門設定檔
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141     
IF !USED('S00') &&薪資參數設定
   SELE 0
   USE S00
ELSE
   SELE S00
ENDIF
SET ORDER TO S001 
IF !USED('S01')  &&薪資資料設定
   SELE 0
   USE S01 
ELSE
   SELE S01
ENDIF
SET ORDER TO S011
IF !USED('S03')  &&健保費表
   SELE 0
   USE S03 
ELSE
   SELE S03
ENDIF
SET ORDER TO S031
IF !USED('S04')  &&勞保費表
   SELE 0
   USE S04 
ELSE 
   SELE S04
ENDIF
SET ORDER TO S041
IF !USED('S06')  &&薪資項目及扣款項目
   SELE 0
   USE S06 
ELSE
   SELE S06
ENDIF
SET ORDER TO S061
IF !USED('S05') &&人事薪資基本檔
   SELE 0
   USE S05 
ELSE
   SELE S05
ENDIF
****建立在職人員編號索引資料
SELECT F01 FROM S05  WHERE F28='A' OR F28='B' OR F28='C' OR F28='2' OR F28='4'  OR S05.F28='9' INTO CURSOR S05A_SEEK READWRITE
INDE ON F01 TAG S05A_SEEK1
SET ORDER TO S05A_SEEK1
****
****建立離職人員編號索引資料
SELECT F01 FROM S05  WHERE F28='1'  OR F28='3'  OR F28='7' OR F28='8'  INTO CURSOR S05B_SEEK READWRITE
INDE ON F01 TAG S05B_SEEK1
SET ORDER TO S05B_SEEK1
****
CREATE CURSOR S05_1;
(F01 C(4),F02 C(8),F03 C(1),F04 C(15),F05 C(4),F06 C(8),F07 C(30),F08 C(30),F09 D(8),F10 D(8),F11 N(2),F12 N(4,1),F13 C(15),F14 C(60),F15 C(1),;
F16 N(2),F17 N(2),F18 N(6),F19 C(10),F20 D(8),F21 D(8),F22 N(2),F23 N(6),F24 C(10),F25 C(30),F26 C(15),F27 L(1),F28 C(1),F29 C(2),F30 C(1),F99 C(17))
INDE ON F01 TAG S05_11
INDE ON F02 TAG S05_12
SELECT * FROM S05 WHERE IIF(ALL_CHK=.T.,.T.,S05.F27=.T.) AND (S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8') ORDER BY S05.F01 INTO CURSOR S05_TEMP   		
SELECT S05_TEMP
GO TOP
DO WHILE !EOF()
	SELECT S05_1
	APPEND BLANK 
	REPLACE  S05_1.F01 WITH S05_TEMP.F01
	REPLACE  S05_1.F02 WITH S05_TEMP.F02
	REPLACE  S05_1.F03 WITH S05_TEMP.F03
	REPLACE  S05_1.F04 WITH S05_TEMP.F04
	REPLACE  S05_1.F05 WITH S05_TEMP.F05
	REPLACE  S05_1.F06 WITH S05_TEMP.F06
	REPLACE  S05_1.F07 WITH S05_TEMP.F07
	REPLACE  S05_1.F08 WITH S05_TEMP.F08
	REPLACE  S05_1.F09 WITH S05_TEMP.F09
	REPLACE  S05_1.F10 WITH S05_TEMP.F10
	REPLACE  S05_1.F11 WITH S05_TEMP.F11
	REPLACE  S05_1.F12 WITH S05_TEMP.F12
	REPLACE  S05_1.F13 WITH S05_TEMP.F13
	REPLACE  S05_1.F14 WITH S05_TEMP.F14
	REPLACE  S05_1.F15 WITH S05_TEMP.F15
	REPLACE  S05_1.F16 WITH S05_TEMP.F16
	REPLACE  S05_1.F17 WITH S05_TEMP.F17
	REPLACE  S05_1.F18 WITH S05_TEMP.F18
	REPLACE  S05_1.F19 WITH S05_TEMP.F19
	REPLACE  S05_1.F20 WITH S05_TEMP.F20
	REPLACE  S05_1.F21 WITH S05_TEMP.F21
	REPLACE  S05_1.F22 WITH S05_TEMP.F22
	REPLACE  S05_1.F23 WITH S05_TEMP.F23
	REPLACE  S05_1.F24 WITH S05_TEMP.F24
	REPLACE  S05_1.F25 WITH S05_TEMP.F25
	REPLACE  S05_1.F26 WITH S05_TEMP.F26
	REPLACE  S05_1.F27 WITH S05_TEMP.F27
	REPLACE  S05_1.F28 WITH S05_TEMP.F28
	REPLACE  S05_1.F29 WITH S05_TEMP.F29
	REPLACE  S05_1.F30 WITH S05_TEMP.F30
	REPLACE  S05_1.F99 WITH S05_TEMP.F99
	SELECT S05_TEMP
	SKIP
ENDDO
SELECT S05_TEMP
USE
SELECT S05_1
GO TOP
SET ORDER TO S05_11
********
S06FORM=CREATEOBJECT("TKS06")
S06FORM.SHOW  
DEFINE CLASS TKS06 AS FORM
  CAPTION='S06.離職人員薪資基本檔'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKS06'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.     
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      TOP=INT_015*5,;
      LEFT=INT_015*242,;
      WIDTH=INT_015*530,;
      HEIGHT=INT_015*510,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      PAGECOUNT=3,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='基本薪資資料設定',;      
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='薪資所得明細設定',;   
      PAGE3.NAME='PAGE3',;
      PAGE3.VISIBLE=.T.,;
      PAGE3.CAPTION='薪資扣款明細設定'         
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*215
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=3,;            
      RECORDSOURCE='S05_1',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;   
      COLUMN3.NAME='COLUMN3' 
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=4,;            
      RECORDSOURCE='S06',; 
      LINKMASTER='S05_1',;
      RELATIONALEXPR='F01',;
      CHILDORDER='S061',;  
      VISIBLE=.F.,;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
	AUTOSIZE=.T. 
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
	AUTOSIZE=.T.             
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*450,;
      LEFT=INT_015*558              
 ADD OBJECT CHANG_BOTT AS COMMANDBUTTON WITH;
     TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*125,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<C.轉至人事薪資基本檔',;
      NAME='CHANG_BOTT'       
**************  基本薪資資料設定          
 PROCEDURE PAGEFRAME1.PAGE1.INIT     
   THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*15
          .WIDTH=INT_015*50
          .CAPTION='員工編號'          
     ENDWITH
  THIS.ADDOBJECT('TXTF01','TEXTBOX')          
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*9
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
     ENDWITH         
   THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*15
          .WIDTH=INT_015*50
          .CAPTION='部門編號' 
     ENDWITH
  THIS.ADDOBJECT('TXTF05','TEXTBOX')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*9
          .WIDTH=INT_015*60
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
     ENDWITH
  THIS.ADDOBJECT('COMBOBOX05','COMBOBOX05') 
     WITH THIS.COMBOBOX05 
          .VISIBLE=.F.
          .LEFT=INT_015*350
          .TOP=INT_015*9
     ENDWITH           
   THIS.ADDOBJECT('LBLF06','LABEL')&&部門名稱
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*415
          .TOP=INT_015*15
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH           
  THIS.ADDOBJECT('LBLF02','LABEL')     
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*40
          .WIDTH=INT_015*50  
          .CAPTION='姓        名'
     ENDWITH                
     THIS.ADDOBJECT('TXTF02','TEXTBOX')          
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*34
          .WIDTH=INT_015*75
          .HEIGHT=INT_015*25
          .MAXLENGTH=8
     ENDWITH                
     THIS.ADDOBJECT('LBLF03','LABEL')
     WITH THIS.LBLF03
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*40
         .WIDTH=INT_015*50
         .CAPTION='性        別'
     ENDWITH     
  THIS.ADDOBJECT('OPTIONGROUP03','OPTIONGROUP')
     WITH THIS.OPTIONGROUP03
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*34
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*105
	  .BUTTONCOUNT=2
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP03'
	  .OPTION1.CAPTION='男'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='女'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*60
	  .OPTION2.NAME='OPTION2'         
     ENDWITH           
   THIS.ADDOBJECT('LBLF04','LABEL')
     WITH THIS.LBLF04
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*65
         .WIDTH=INT_015*50
         .CAPTION='身份證號'
     ENDWITH    
   THIS.ADDOBJECT('TXTF04','TEXTBOX')
     WITH THIS.TXTF04
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*59
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*25
          .MAXLENGTH=15
     ENDWITH    
   THIS.ADDOBJECT('LBLF29','LABEL')
     WITH THIS.LBLF29
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*65
          .WIDTH=INT_015*50
          .CAPTION='班        別'          
     ENDWITH    
   THIS.ADDOBJECT('LBLF291','LABEL')
     WITH THIS.LBLF291
          .VISIBLE=.T.
          .LEFT=INT_015*395
          .TOP=INT_015*65
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH        
   THIS.ADDOBJECT('TXTF29','TEXTBOX')
     WITH THIS.TXTF29
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*59
          .WIDTH=INT_015*30
          .HEIGHT=INT_015*25
          .MAXLENGTH=2
     ENDWITH     
  THIS.ADDOBJECT('COMBOBOX29','COMBOBOX29') 
     WITH THIS.COMBOBOX29 
          .VISIBLE=.F.
          .LEFT=INT_015*350
          .TOP=INT_015*59
     ENDWITH                             
   THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*90
         .WIDTH=INT_015*50
         .CAPTION='職        稱'
     ENDWITH    
   THIS.ADDOBJECT('TXTF07','TEXTBOX')
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*84
          .WIDTH=INT_015*135
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX07','COMBOBOX071') 
     WITH THIS.COMBOBOX07 
          .LEFT=INT_015*64
          .TOP=INT_015*84
     ENDWITH         
   THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*90
         .WIDTH=INT_015*50
         .CAPTION='職        等'
     ENDWITH    
   THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*84
          .WIDTH=INT_015*135
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH      
  THIS.ADDOBJECT('COMBOBOX08','COMBOBOX08') 
     WITH THIS.COMBOBOX08 
          .LEFT=INT_015*350
          .TOP=INT_015*84
     ENDWITH         
   THIS.ADDOBJECT('LBLF09','LABEL')
     WITH THIS.LBLF09
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*115
         .WIDTH=INT_015*50
         .CAPTION='到職日期'
     ENDWITH    
   THIS.ADDOBJECT('TXTF09','TEXTBOX')
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*109
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25              
     ENDWITH    
   THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*115
         .WIDTH=INT_015*50
         .CAPTION='異動日期'
     ENDWITH    
   THIS.ADDOBJECT('TXTF10','TEXTBOX')          
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*109
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8
     ENDWITH                 
   THIS.ADDOBJECT('LBLF28','LABEL')
     WITH THIS.LBLF28
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*140
         .WIDTH=INT_015*50
         .CAPTION='任職狀況'
     ENDWITH    
   THIS.ADDOBJECT('TXTF28','TEXTBOX')
     WITH THIS.TXTF28
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*134
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25     
     ENDWITH         
  THIS.ADDOBJECT('COMBOBOX28','COMBOBOX28') 
     WITH THIS.COMBOBOX28 
          .VISIBLE=.F.
          .LEFT=INT_015*64
          .TOP=INT_015*134
      ENDWITH      
   THIS.ADDOBJECT('LBLF30','LABEL')
     WITH THIS.LBLF30
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*140
         .WIDTH=INT_015*50
         .CAPTION='是否刷卡'
     ENDWITH    
  THIS.ADDOBJECT('OPTIONGROUP30','OPTIONGROUP')
     WITH THIS.OPTIONGROUP30
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*134
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*105
	  .BUTTONCOUNT=2
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP30'
	  .OPTION1.CAPTION='是'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='否'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*60
	  .OPTION2.NAME='OPTION2'         
     ENDWITH        
   THIS.ADDOBJECT('LBLF13','LABEL')
     WITH THIS.LBLF13
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*165
         .WIDTH=INT_015*50
         .CAPTION='聯絡電話'
     ENDWITH    
   THIS.ADDOBJECT('TXTF13','TEXTBOX')
     WITH THIS.TXTF13
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*159
          .WIDTH=INT_015*105
          .HEIGHT=INT_015*25
     ENDWITH       
   THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*190
         .WIDTH=INT_015*50
         .CAPTION='聯絡地址'
     ENDWITH    
   THIS.ADDOBJECT('TXTF14','TEXTBOX')
     WITH THIS.TXTF14
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*184
          .WIDTH=INT_015*380
          .HEIGHT=INT_015*25
          .MAXLENGTH=60          
     ENDWITH 
 ***********
   THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*215
          .WIDTH=INT_015*50
          .CAPTION='發薪總類'          
     ENDWITH
  THIS.ADDOBJECT('OPTIONGROUP15','OPTIONGROUP')
     WITH THIS.OPTIONGROUP15
         .VISIBLE=.T.
         .LEFT=INT_015*64
         .TOP=INT_015*209
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*170
	  .BUTTONCOUNT=3
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP15'
	  .OPTION1.CAPTION='月薪'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='日薪'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*60
	  .OPTION2.NAME='OPTION2'        
	  .OPTION3.CAPTION='時薪'
	  .OPTION3.TOP=INT_015*5
	  .OPTION3.FONTSIZE=INT_015*9	  
	  .OPTION3.AUTOSIZE=.T.
	  .OPTION3.LEFT=INT_015*115
	  .OPTION3.NAME='OPTION3' 	   
     ENDWITH            
   THIS.ADDOBJECT('LBLF11','LABEL')
     WITH THIS.LBLF11
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*217
         .WIDTH=INT_015*50
         .CAPTION='可休年假'
     ENDWITH    
   THIS.ADDOBJECT('TXTF11','TEXTBOX')
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*209
          .WIDTH=INT_015*30
          .HEIGHT=INT_015*25
          .MAXLENGTH=2         
          .INPUTMASK='99'              
     ENDWITH      
     THIS.ADDOBJECT('LBLF17','LABEL')
     WITH THIS.LBLF17
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*240
         .WIDTH=INT_015*50
         .CAPTION='撫養人數' 
     ENDWITH     
 THIS.ADDOBJECT('SPINNER17','SPINNER')      
    WITH THIS.SPINNER17
          .VISIBLE=.T.
	  .TOP=INT_015*234 
	  .LEFT=INT_015*64
          .HEIGHT=INT_015*25     
	  .WIDTH=INT_015*45    
	  .KEYBOARDLOWVALUE=0
	  .KEYBOARDHIGHVALUE=99
	  .SPINNERLOWVALUE=0
	  .SPINNERHIGHVALUE=99
	  .INPUTMASK='99'     
     ENDWITH                        
   THIS.ADDOBJECT('LBLF12','LABEL')
     WITH THIS.LBLF12
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*242
         .WIDTH=INT_015*50
         .CAPTION='已休年假'
     ENDWITH    
   THIS.ADDOBJECT('TXTF12','TEXTBOX')          
     WITH THIS.TXTF12
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*234
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*25
          .MAXLENGTH=4          
          .INPUTMASK='99.9'    
       ENDWITH  
   THIS.ADDOBJECT('LBLF121','LABEL')
     WITH THIS.LBLF121
         .VISIBLE=.T.
         .LEFT=INT_015*405
         .TOP=INT_015*239
         .WIDTH=INT_015*50
         .BACKCOLOR=RGB(0,255,255)         
         .CAPTION='剩餘年假'
     ENDWITH
   THIS.ADDOBJECT('LBLF122','LABEL')
     WITH THIS.LBLF122
         .VISIBLE=.T.
         .LEFT=INT_015*455
         .TOP=INT_015*239
         .WIDTH=INT_015*50
         .BACKCOLOR=RGB(0,255,255)
         .CAPTION=''
     ENDWITH         
   THIS.ADDOBJECT('LBLF18','LABEL')
     WITH THIS.LBLF18
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*265
         .WIDTH=INT_015*50
         .CAPTION='勞保金額'
     ENDWITH    
   THIS.ADDOBJECT('TXTF18','TEXTBOX')
     WITH THIS.TXTF18
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*259
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=7
	  .INPUTMASK='9999999'           
     ENDWITH
  THIS.ADDOBJECT('COMBOBOX18','COMBOBOX18') 
     WITH THIS.COMBOBOX18 
          .LEFT=INT_015*64
          .TOP=INT_015*259
     ENDWITH       
   THIS.ADDOBJECT('LBLF19','LABEL')
     WITH THIS.LBLF19
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*265
         .WIDTH=INT_015*50
         .CAPTION='勞保卡號'
     ENDWITH    
   THIS.ADDOBJECT('TXTF19','TEXTBOX')
     WITH THIS.TXTF19
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*259
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=10       
     ENDWITH         
   THIS.ADDOBJECT('LBLF20','LABEL')
     WITH THIS.LBLF20
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*290
         .WIDTH=INT_015*50
         .CAPTION='加保日期'
     ENDWITH    
   THIS.ADDOBJECT('TXTF20','TEXTBOX')
     WITH THIS.TXTF20
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*284
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8      
     ENDWITH    
   THIS.ADDOBJECT('LBLF21','LABEL')
     WITH THIS.LBLF21
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*290
         .WIDTH=INT_015*50
         .CAPTION='退保日期'
     ENDWITH    
   THIS.ADDOBJECT('TXTF21','TEXTBOX')
     WITH THIS.TXTF21
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*284
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8      
     ENDWITH        
   THIS.ADDOBJECT('LBLF22','LABEL')
     WITH THIS.LBLF22
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*315
         .WIDTH=INT_015*50
         .CAPTION='健保等級'
     ENDWITH    
   THIS.ADDOBJECT('TXTF22','TEXTBOX')
     WITH THIS.TXTF22
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*309
          .WIDTH=INT_015*25
          .HEIGHT=INT_015*25
          .MAXLENGTH=2         
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX22','COMBOBOX22') 
     WITH THIS.COMBOBOX22 
          .LEFT=INT_015*64
          .TOP=INT_015*309
     ENDWITH         
  THIS.ADDOBJECT('LBLF16','LABEL')     
     WITH THIS.LBLF16
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*315
          .WIDTH=INT_015*50  
          .CAPTION='眷口人數'
     ENDWITH                
 THIS.ADDOBJECT('SPINNER16','SPINNER')      
    WITH THIS.SPINNER16
          .VISIBLE=.T.
	  .TOP=INT_015*309
	  .LEFT=INT_015*350
          .HEIGHT=INT_015*25     
	  .WIDTH=INT_015*45    
	  .KEYBOARDLOWVALUE=0
	  .KEYBOARDHIGHVALUE=99
	  .SPINNERLOWVALUE=0
	  .SPINNERHIGHVALUE=99
	  .INPUTMASK='99'     
     ENDWITH     
   THIS.ADDOBJECT('LBLF23','LABEL')
     WITH THIS.LBLF23
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*340
         .WIDTH=INT_015*50
         .CAPTION='健保金額'
     ENDWITH         
   THIS.ADDOBJECT('TXTF23','TEXTBOX')
     WITH THIS.TXTF23
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*334
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=7
	  .INPUTMASK='9999999'           
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX23','COMBOBOX23') 
     WITH THIS.COMBOBOX23 
          .LEFT=INT_015*64
          .TOP=INT_015*334
     ENDWITH      
   THIS.ADDOBJECT('LBLF24','LABEL')
     WITH THIS.LBLF24
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*340
         .WIDTH=INT_015*50
         .CAPTION='健保卡號'
     ENDWITH    
   THIS.ADDOBJECT('TXTF24','TEXTBOX')
     WITH THIS.TXTF24
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*334
          .WIDTH=INT_015*75
          .HEIGHT=INT_015*25
          .MAXLENGTH=10      
     ENDWITH                 
   THIS.ADDOBJECT('LBLF25','LABEL')
     WITH THIS.LBLF25
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*365
         .WIDTH=INT_015*50
         .CAPTION='撥款銀行'
     ENDWITH    
   THIS.ADDOBJECT('TXTF25','TEXTBOX')
     WITH THIS.TXTF25
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*359
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30         
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX25','COMBOBOX25') 
     WITH THIS.COMBOBOX25 
          .LEFT=INT_015*64
          .TOP=INT_015*359
     ENDWITH         
   THIS.ADDOBJECT('LBLF26','LABEL')
     WITH THIS.LBLF26
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*365
         .WIDTH=INT_015*50
         .CAPTION='銀行帳號'
     ENDWITH    
   THIS.ADDOBJECT('TXTF26','TEXTBOX')
     WITH THIS.TXTF26
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*359
          .WIDTH=INT_015*110
          .HEIGHT=INT_015*25
          .MAXLENGTH=15       
     ENDWITH
     THIS.ADDOBJECT('LBLF27','LABEL')
     WITH THIS.LBLF27
         .VISIBLE=.T.
         .BACKCOLOR=RGB(255,255,0)
         .LEFT=INT_015*14
         .TOP=INT_015*390
         .WIDTH=INT_015*50
         .CAPTION='作業限制'
     ENDWITH          
  THIS.ADDOBJECT('OPTIONGROUP27','OPTIONGROUP')
     WITH THIS.OPTIONGROUP27
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*384
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*141
	  .BUTTONCOUNT=2
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP27'
	  .OPTION1.CAPTION='共用'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='單獨'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*70
	  .OPTION2.NAME='OPTION2'         
     ENDWITH             
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*390
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH    
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*350
         .TOP=INT_015*390
         .AUTOSIZE=.T.
         .CAPTION=''         
     ENDWITH                                     
  ENDPROC  
***********薪資所得明細設定
 PROCEDURE PAGEFRAME1.PAGE2.INIT    
   THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*15
          .WIDTH=INT_015*50
          .CAPTION='薪資類別'          
     ENDWITH
  THIS.ADDOBJECT('TXTF06','TEXTBOX')          
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*9
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH     
  THIS.ADDOBJECT('COMBOBOX06','COMBOBOX061')          
     WITH THIS.COMBOBOX06
          .LEFT=INT_015*64
          .TOP=INT_015*9
     ENDWITH       
   THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*40
          .WIDTH=INT_015*50
          .CAPTION='薪資項目'          
     ENDWITH
  THIS.ADDOBJECT('TXTF07','TEXTBOX')          
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*34
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX07','COMBOBOX07') 
     WITH THIS.COMBOBOX07
          .LEFT=INT_015*64
          .TOP=INT_015*34
     ENDWITH
   THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*65
          .WIDTH=INT_015*50
          .CAPTION='薪資所得'          
     ENDWITH
  THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.     
          .ALIGNMENT=1
          .LEFT=INT_015*64
          .TOP=INT_015*59    
	  .WIDTH=INT_015*55
	  .HEIGHT=INT_015*25
	  .MAXLENGTH=7
	  .INPUTMASK='9999999'  
     ENDWITH         
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*145
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH    
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*64
         .TOP=INT_015*145
         .AUTOSIZE=.T.
         .CAPTION=''         
     ENDWITH                
ENDPROC   
***********  薪資扣款明細設定
 PROCEDURE PAGEFRAME1.PAGE3.INIT    
   THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*15
          .WIDTH=INT_015*50
          .CAPTION='扣款類別'          
     ENDWITH
  THIS.ADDOBJECT('TXTF06','TEXTBOX')          
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*9
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH     
  THIS.ADDOBJECT('COMBOBOX06','COMBOBOX062')          
     WITH THIS.COMBOBOX06
          .LEFT=INT_015*64
          .TOP=INT_015*9
     ENDWITH      
   THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*40
          .WIDTH=INT_015*50
          .CAPTION='扣款項目'          
     ENDWITH
  THIS.ADDOBJECT('TXTF07','TEXTBOX')          
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*34
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX07','COMBOBOX07') 
     WITH THIS.COMBOBOX07 
          .LEFT=INT_015*64
          .TOP=INT_015*34
     ENDWITH
   THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*65
          .WIDTH=INT_015*50
          .CAPTION='扣款金額'          
     ENDWITH
  THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*64
          .TOP=INT_015*59
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=7             
     ENDWITH          
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*145
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH    
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*64
         .TOP=INT_015*145
         .AUTOSIZE=.T.
         .CAPTION=''         
     ENDWITH                
ENDPROC
********  
  PROC INIT       
       THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
       THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)      
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*10
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*10   
       THISFORM.PAGEFRAME1.PAGE3.FONTSIZE=INT_015*10      
       THISFORM.PAGEFRAME1.PAGE1.LBLF27.VISIBLE=IIF(A02.F09<>'*',.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VISIBLE=IIF(A02.F09<>'*',.F.,.T.)              
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.        
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')     
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')    
       THISFORM.SETALL('FONTSIZE',INT_015*9,'SPINNER')            
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('READONLY',.T.,'SPINNER')     
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.READONLY=.T.      
       THISFORM.GRID2.READONLY=.T.            
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='任職狀況'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05_1.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05_1.F02'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE="BILL_MODE(S05_1.F28)"
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55    
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*55    
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')     
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='薪資類別'    
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='薪資項目名稱'
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='薪資所得'
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='安全資料'
       THISFORM.GRID2.LINKMASTER='S05_1'
       THISFORM.GRID2.RELATIONALEXPR='F01'
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE="SALARY_CLASS(S06.F06)"
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE='S06.F07'
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE='S06.F08'
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE='S06.F99'
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*80       
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*140
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*60
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*100       
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
       	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.    
           THISFORM.CHANG_BOTT.ENABLED=.F.
       ELSE
       	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE3.ENABLED=.T.
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.) &&判斷有無修改的權限
           THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.)
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限       
           THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED  AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.) 
       ENDIF          
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)
       JK='員工編號'
       SELE S05_1
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05_1.F01
  ENDPROC           
***********
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE 
        R=0
	SELECT S05_1
        DO CASE
               CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                          SET ORDER TO S05_11 
               CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
              		  SET ORDER TO S05_12
         ENDCASE    
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)  
        THISFORM.PAGEFRAME1.PAGE3.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE3.FORECOLOR=RGB(0,0,0)                
        THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","","COLUMN") 
	THISFORM.SHRGROUP.TOP=INT_015*450
	THISFORM.SHRGROUP.LEFT=INT_015*558	
	THISFORM.CHANG_BOTT.VISIBLE=.T.     	
	THISFORM.GRID2.VISIBLE=.F.	  
        THISFORM.GRID2.ENABLED=.F.    
        THISFORM.GRID1.ENABLED=.T. 
        THISFORM.GRID1.SETFOCUS
         IF  THISFORM.GRID1.ACTIVEROW=0 AND THISFORM.SHRGROUP.ENABLED=.F.	
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.  &&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.    &&判斷有無列印的權限                     
              THISFORM.CHANG_BOTT.ENABLED=.F.
              THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS  
         ELSE    
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)   AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.)&&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.)
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限       
              THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED  AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.)    	
         ENDIF
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限 
  ENDPROC     
***********
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
	SELECT S06
	SET FILTER TO F05='1'
	SET ORDER TO S061
	GO TOP
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,255)  
        THISFORM.PAGEFRAME1.PAGE3.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE3.FORECOLOR=RGB(0,0,0)     	
        THISFORM.CHANG_BOTT.VISIBLE=.F. 
	THISFORM.KEY_LIST.ENABLED=.F.   
	THISFORM.GRID2.VISIBLE=.T. 	
	THISFORM.GRID2.ENABLED=.T.
        THISFORM.GRID2.SETFOCUS       
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='薪資類別'     
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='薪資項目名稱'       
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='薪資所得'      
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='安全資料'            
        THISFORM.GRID2.COLUMN1.CONTROLSOURCE="SALARY_CLASS(S06.F06)"
        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='S06.F07'
        THISFORM.GRID2.COLUMN3.CONTROLSOURCE='S06.F08'
        THISFORM.GRID2.COLUMN4.CONTROLSOURCE='S06.F99'
        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*80       
        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*140
        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*60
        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*100           
	THISFORM.SHRGROUP.TOP=INT_015*160
	THISFORM.SHRGROUP.LEFT=INT_015*558
       	THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=SALARY_CLASS(S06.F06)
       	THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S06.F07
       	THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S06.F08       	
       	THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S06.F99    
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       	 
        IF EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	 
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.      
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''
	 ELSE
	      IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE) AND THISFORM.SHRGROUP.ENABLED=.F. 
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	           THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
	           THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''	           		   
	      ELSE
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S06.F06<>'A'  AND S06.F06<>'B'  AND S06.F06<>'C'  AND S06.F06<>'F' &&判斷有無刪除的權限(A=底薪,B=日薪,C=時薪及F=全勤獎金不得刪除)
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 		      
	      ENDIF 
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.) &&判斷有無新增的權限         
	ENDIF            
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
*!*	       THISFORM.REFRESH   	                    
  ENDPROC     
***********
  PROCEDURE PAGEFRAME1.PAGE3.ACTIVATE
	SELECT S06
	SET FILTER TO F05='2'	
	SET ORDER TO S061
	GO TOP
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)  
        THISFORM.PAGEFRAME1.PAGE3.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE3.FORECOLOR=RGB(0,0,255)     	
	THISFORM.CHANG_BOTT.VISIBLE=.F. 
	THISFORM.KEY_LIST.ENABLED=.F.   	
	THISFORM.GRID2.VISIBLE=.T.
        THISFORM.GRID2.ENABLED=.T.  
        THISFORM.GRID2.SETFOCUS    	
	THISFORM.SHRGROUP.TOP=INT_015*160
	THISFORM.SHRGROUP.LEFT=INT_015*558	        
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='扣款類別'    
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='扣款項目名稱'              
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='扣款金額'
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='安全資料'       
        THISFORM.GRID2.COLUMN1.CONTROLSOURCE="SALARY_CLASS(S06.F06)"
        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='S06.F07'
        THISFORM.GRID2.COLUMN3.CONTROLSOURCE='S06.F08'
        THISFORM.GRID2.COLUMN4.CONTROLSOURCE='S06.F99'
        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*80       
        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*140
        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*60
        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*100  
   	THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=SALARY_CLASS(S06.F06)
   	THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=S06.F07    
   	THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=S06.F08   	   			 
   	THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=S06.F99         
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.   
        IF EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	       
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.PAGEFRAME1.PAGE3.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''
	 ELSE
	      IF EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE) AND THISFORM.SHRGROUP.ENABLED=.F. 
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.  
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	           THISFORM.PAGEFRAME1.PAGE3.SETALL('VALUE','','TEXTBOX')
	           THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''	           		   
	      ELSE
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S06.F06<>'J'  AND S06.F06<>'K'  &&判斷有無修改的權限(J=勞保及K=健保不得修改)
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  &&判斷有無刪除的權限	   
	           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 		      
	      ENDIF 
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)&&判斷有無新增的權限         
       ENDIF   
       R=RECNO('&AREA1')
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.        
*!*	       THISFORM.REFRESH     
  ENDPROC          
**********    
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依員工編號排列')
           .ADDITEM('依員工姓名排列')
           .VALUE=1
       ENDWITH             
  ENDPROC
********* 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE S05 
       DO CASE
          CASE THIS.DISPLAYVALUE='依員工編號排列'
               SET ORDER TO S05_11 
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05_1.F01'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05_1.F02'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55 
          CASE THIS.DISPLAYVALUE='依員工姓名排列'
               SET ORDER TO S05_12
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05_1.F02'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05_1.F01'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50                                                                
       ENDCASE 
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
***********  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       	THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05_1.F01
        THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=S05_1.F02    
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=IIF(S05_1.F03='M',1,2)
       	THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=S05_1.F04
        THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=S05_1.F05
        THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION=S05_1.F06
        THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=S05_1.F07 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=S05_1.F08
        THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE=S05_1.F09
        THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=S05_1.F10        
        THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=S05_1.F11
        THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=S05_1.F12
        THISFORM.PAGEFRAME1.PAGE1.LBLF122.CAPTION=SPACE(5)+TRANSFORM(IIF((S05_1.F11-S05_1.F12)<=0,0,S05_1.F11-S05_1.F12),'999.9')+'天'
        THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE=S05_1.F13
        THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE=S05_1.F14
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=IIF(S05_1.F15='M',1,IIF(S05_1.F15='D',2,3))             
       	THISFORM.PAGEFRAME1.PAGE1.SPINNER16.VALUE=S05_1.F16
        THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE=S05_1.F17    
       	THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=S05_1.F18
        THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE=S05_1.F19 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE=S05_1.F20
        THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE=S05_1.F21 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=S05_1.F22
        THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=S05_1.F23
        THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE=S05_1.F24
        THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=S05_1.F25
        THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE=S05_1.F26
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=IIF(S05_1.F27=.T.,1,2)        
        THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=BILL_MODE(S05_1.F28)            
        THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=S05_1.F29 
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE=VAL(S05_1.F30)
        THISFORM.PAGEFRAME1.PAGE1.LBLF291.CAPTION=IIF(INDEXSEEK('I'+S05_1.F29,.T.,'S00','S005'),S00.F50+'∼'+S00.F51,'')
        THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=S05_1.F99              
        IF THISFORM.GRID1.ACTIVEROW=0 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''       
	       THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION=''           
	       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=''             
	       THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE='' 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=''      
	       THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE='' 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE='' 	
	       THISFORM.PAGEFRAME1.PAGE1.SPINNER16.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE=''         	   
	       THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE=''       
	       THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE=''             
	       THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE=''         
	       THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=''       
	       THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=''  	             
	       THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	       THISFORM.CHANG_BOTT.ENABLED=.F.		             
 	 ELSE
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 	 	        
	       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.)   &&判斷有無修改的權限
	       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.)
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 	       
	       THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED AND IIF(S05_1.F28='A' OR S05_1.F28='B' OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.)
         ENDIF	      
         THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)	&&判斷有無新增的權限   
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION  
         IF THIS.ACTIVEROW=0
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
         ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
         ENDIF   
         CHK=''     
*!*	       THISFORM.REFRESH
  ENDPROC     
**********  
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       DO CASE
              CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=SALARY_CLASS(S06.F06)
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S06.F07
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S06.F08      			 
       			 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S06.F99 
       			 THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S06.F06<>'A'  AND S06.F06<>'B'  AND S06.F06<>'C'  AND S06.F06<>'F' &&判斷有無刪除的權限(A=底薪,B=日薪,C=時薪及F=全勤獎金不得刪除)
              CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3
       			 THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=SALARY_CLASS(S06.F06)
       			 THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=S06.F07       	
       			 THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=S06.F08       			 		 
       			 THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=S06.F99    
		         THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S06.F06<>'J'  AND S06.F06<>'K'  &&判斷有無修改的權限(J=勞保及K=健保不得修改)	 
       ENDCASE       			    			 
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=S06.F01
*!*	       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE 
*!*	       THISFORM.REFRESH
  ENDPROC 
***********     
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK 
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.F.   
     THISFORM.GRID2.ENABLED=.F.   
     DO CASE
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1
		      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.		      
		      THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")           
		      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX')   
		      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'SPINNER')              	      
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.ENABLED=.T. 
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.ENABLED=.T.    
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.ENABLED=.T.  
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.ENABLED=.T.    		      		      
		      THISFORM.PAGEFRAME1.PAGE1.TXTF01.READONLY=.F. 
		      THISFORM.PAGEFRAME1.PAGE1.TXTF09.READONLY=.T. 
		      THISFORM.PAGEFRAME1.PAGE1.TXTF10.READONLY=.F. 	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF11.READONLY=.T.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF12.READONLY=.T.	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF05.VISIBLE=.F.	      		
		      THISFORM.PAGEFRAME1.PAGE1.TXTF07.VISIBLE=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF08.VISIBLE=.F. 
		      THISFORM.PAGEFRAME1.PAGE1.TXTF18.VISIBLE=.F.	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF22.VISIBLE=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF23.VISIBLE=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF25.VISIBLE=.F.	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF28.VISIBLE=.F.	      
		      THISFORM.PAGEFRAME1.PAGE1.TXTF29.VISIBLE=.F.   	          
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VISIBLE=.T.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VISIBLE=.T.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX08.VISIBLE=.T.      
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.VISIBLE=.T.     
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.VISIBLE=.T.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.VISIBLE=.T.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX25.VISIBLE=.T.	
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VISIBLE=.T. 
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.VISIBLE=.T.	      	          
		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=IIF(S05_1.F03='M',1,2)
		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=IIF(S05_1.F15='M',1,IIF(S05_1.F15='D',2,3))
		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=IIF(S05_1.F27=.T.,1,2)	
		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE=VAL(S05_1.F30)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE+SPACE(5)+ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX08.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE	
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE=STR(THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.DISPLAYVALUE=STR(THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.DISPLAYVALUE=STR(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX25.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=IIF(S05_1.F28='1',1,IIF(S05_1.F28='2',2,IIF(S05_1.F28='7',3,4)))		      
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.DISPLAYVALUE=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE)+SPACE(4)+ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF291.CAPTION)  
		      THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2                  
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.		      
		      THISFORM.PAGEFRAME1.PAGE2.TXTF06.READONLY=.T.    
		      THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.T.  
		      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''	  
		      THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS         
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3               
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.           	      
           	      THISFORM.PAGEFRAME1.PAGE3.TXTF06.READONLY=.T.   
           	      THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T. 
		      THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''	 
		      THISFORM.PAGEFRAME1.PAGE3.TXTF08.SETFOCUS                 		      	      
    ENDCASE		      
    LOCK()
    IF !RLOCK()
         DO FILE_IMPACT
         RETURN
    ENDIF   
  ENDPROC    
**************
PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK   &&修改確認                 
  DO CASE    
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=1
 		     THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","RGB(58,186,152)","COLUMN") 
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
          		  =MESSAGEBOX('員工編號不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF    
		     IF  LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE))<4
          		  =MESSAGEBOX('員工編號不得少於四碼!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF        	 	     
    	 	     IF ALLTRIM(S05_1.F01)<>ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	                 IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,.F.,'S05A_SEEK','S05A_SEEK1')=.T.  
	           	      =MESSAGEBOX('此員工編號已存在S05.人事薪資基本檔中,請查明後再輸入!',0+64,'提示訊息視窗')
	          	      THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
	          	      RETURN   
	          	 ENDIF         	 	     
	                 IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,.F.,'S05B_SEEK','S05B_SEEK1')=.T.  
	           	      =MESSAGEBOX('此員工編號已存在S06.離職人員薪資基本檔中,請查明後再輸入!',0+64,'提示訊息視窗')
	          	      THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
	          	      RETURN   
	          	 ENDIF              
	       	     ENDIF           	       	 	     		                   
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.DISPLAYVALUE)
          		  =MESSAGEBOX('部門編號不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF    	       	    
	             IF SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE,'A14')=.F. 
	           	  =MESSAGEBOX('部門主檔中無此編號請先建立!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.SETFOCUS
	          	  RETURN            
	       	     ENDIF       	 	        	 	     
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
          		  =MESSAGEBOX('姓名不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF02.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF 
	             IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE)
	                   =MESSAGEBOX('異動日期不得空白!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.TXTF10.SETFOCUS
	          	   RETURN
	    	     ENDIF	    	 	     
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE)
*!*	          		  =MESSAGEBOX('加保日期不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF20.SETFOCUS
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.DISPLAYVALUE)
          		  =MESSAGEBOX('班別不得空白,若尚未建立班別請至S00.薪資參數中設定!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF    	     	     
    	 	    ****若修改員工編號,姓名及部門則相關資料庫也需一並修改
    	 	    *********S06 薪資明細及扣款項目
                    SELECT  RECNO() FROM S06 WHERE S06.F01=S05_1.F01 INTO ARRAY BK6              
                    JJ6=''                
                    IF _TALLY>0   
                        FOR I= 1 TO ALEN(BK6)
                                JJ6=JJ6+ALLTRIM(STR(BK6(I)))+','
                        ENDFOR    
                        KK6=STUFF(JJ6,RAT(',',JJ6,1),1,'')              
                        RLOCK(KK6,'S06')
                        LL6=RLOCK(KK6,'S06')
                    ELSE
                        LL6=.T.   
                    ENDIF                   
                    IF LL6=.T. AND LEN(ALLTRIM(JJ6))>0  	 	    
		        SELECT S06
                        FOR I= 1 TO ALEN(BK6)                      
                               GO BK6(I) 		        
		               REPLACE S06.F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)      		    		    
		               REPLACE S06.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)      		    
		               REPLACE S06.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE) 	 	     
		               REPLACE S06.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		        ENDFOR 
		    ENDIF           
		    *********S07 調薪修改作業
		    IF !USED('S07')
		        SELE 0
		        USE S07 
		    ELSE
		        SELE S07
		    ENDIF    
                    SELECT  RECNO() FROM S07 WHERE S07.F01=S05_1.F01 INTO ARRAY BK7              
                    JJ7=''                
                    IF _TALLY>0   
                        FOR I= 1 TO ALEN(BK7)
                                JJ7=JJ7+ALLTRIM(STR(BK7(I)))+','
                        ENDFOR    
                        KK7=STUFF(JJ7,RAT(',',JJ7,1),1,'')              
                        RLOCK(KK7,'S07')
                        LL7=RLOCK(KK7,'S07')
                    ELSE
                        LL7=.T.   
                    ENDIF                   
                    IF LL7=.T. AND LEN(ALLTRIM(JJ7))>0  	 	    
		        SELECT S07
                        FOR I= 1 TO ALEN(BK7)                      
                               GO BK7(I) 		    
		               REPLACE S07.F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE) 
			       REPLACE S07.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE) 		    
			       REPLACE S07.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)  	 	     
			       REPLACE S07.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION) 	  
			 ENDFOR
		    ENDIF	         
		    SELECT S07
		    USE
		    *********S08 懲處作業 
		    IF !USED('S08')
		        SELE 0
		        USE S08 
		    ELSE
		        SELE S08
		    ENDIF    		    
                    SELECT  RECNO() FROM S08 WHERE S08.F01=S05_1.F01 INTO ARRAY BK8              
                    JJ8=''                
                    IF _TALLY>0   
                        FOR I= 1 TO ALEN(BK8)
                                JJ8=JJ8+ALLTRIM(STR(BK8(I)))+','
                        ENDFOR    
                        KK8=STUFF(JJ8,RAT(',',JJ8,1),1,'')              
                        RLOCK(KK8,'S08')
                        LL8=RLOCK(KK8,'S08')
                    ELSE
                        LL8=.T.   
                    ENDIF                   
                    IF LL8=.T. AND LEN(ALLTRIM(JJ8))>0  	 	    
		        SELECT S08
                        FOR I= 1 TO ALEN(BK8)                      
                               GO BK8(I) 	
                               REPLACE S08.F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
			       REPLACE S08.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)      		    
			       REPLACE S08.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE) 	 	     
			       REPLACE S08.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION) 	    
			ENDFOR
		    ENDIF	      
		    SELECT S08
		    USE 
		    *********S09 其他所得發放作業
		    IF !USED('S09')
		        SELE 0
		        USE S09 
		    ELSE
		        SELE S09
		    ENDIF    		    
                    SELECT  RECNO() FROM S09 WHERE S09.F01=S05_1.F01 INTO ARRAY BK9              
                    JJ9=''                
                    IF _TALLY>0   
                        FOR I= 1 TO ALEN(BK9)
                                JJ9=JJ9+ALLTRIM(STR(BK9(I)))+','
                        ENDFOR    
                        KK9=STUFF(JJ9,RAT(',',JJ9,1),1,'')              
                        RLOCK(KK9,'S09')
                        LL9=RLOCK(KK9,'S09')
                    ELSE
                        LL9=.T.   
                    ENDIF                   
                    IF LL9=.T. AND LEN(ALLTRIM(JJ9))>0  	 	    
		        SELECT S09
                        FOR I= 1 TO ALEN(BK9)                      
                               GO BK9(I) 	
                               REPLACE S09.F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
			       REPLACE S09.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
			       REPLACE S09.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)      
			       REPLACE S09.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)	
			ENDFOR 
		    ENDIF	      	    
		    SELECT S09
		    USE
		    *********S0A 年度缺勤天數累計
		    IF !USED('S0A')
			SELE 0
			USE S0A
	            ELSE
			SELE S0A
		    ENDIF
                    SELECT  RECNO() FROM S0A WHERE S0A.F01=S05_1.F01 INTO ARRAY BKA             
                    JJA=''                
                    IF _TALLY>0   
                        FOR I= 1 TO ALEN(BKA)
                                JJA=JJA+ALLTRIM(STR(BKA(I)))+','
                        ENDFOR    
                        KKA=STUFF(JJA,RAT(',',JJA,1),1,'')              
                        RLOCK(KKA,'S0A')
                        LLA=RLOCK(KKA,'S0A')
                    ELSE
                        LLA=.T.   
                    ENDIF                   
                    IF LLA=.T. AND LEN(ALLTRIM(JJA))>0  	 	    
		        SELECT S0A
                        FOR I= 1 TO ALEN(BKA)                      
                               GO BKA(I) 	
                               REPLACE S0A.F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
			       REPLACE S0A.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)      		    
			       REPLACE S0A.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)   	 	     
			       REPLACE S0A.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)	
			ENDFOR
		    ENDIF	       	
		    SELECT S0A
		    USE	    
		    *********S10 薪資計算作業           
	            FILE_NAME=ALLTRIM('S10'+LEFT(DTOS(S05_1.F10),6)+'.DBF')
	            S10=ALLTRIM('S10'+LEFT(DTOS(S05_1.F10),6))
		    IF  FILE('&FILE_NAME')=.T.    
	                 IF !USED('&S10')
	                     SELECT  0
	                     USE (S10) ALIA S10
	                 ELSE
	                     SELECT  S10
	                 ENDIF
                         SELECT  RECNO() FROM S10 WHERE S10.F01=S05_1.F01  AND S10.F98='N' INTO ARRAY BK1             
                         JJ1=''                
                         IF _TALLY>0   
                             FOR I= 1 TO ALEN(BK1)
                                     JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
                             ENDFOR    
                             KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
                             RLOCK(KK1,'S10')
                             LL1=RLOCK(KK1,'S10')
                         ELSE
                             LL1=.T.   
                         ENDIF                   
                         IF LL1=.T. AND LEN(ALLTRIM(JJ1))>0  	 	    
		             SELECT S10
                             FOR I= 1 TO ALEN(BK1)                      
                                     GO BK1(I) 		
                                     REPLACE S10.F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
		                     REPLACE S10.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)  	 	     
			             REPLACE S10.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)       		    	                      
			             REPLACE S10.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)       
			     ENDFOR
			 ENDIF      
			 SELECT S10
			 USE    
		   ENDIF
		   RELEASE ALL LIKE BK*
		   *****修改離職人員薪資基本檔索引
		   SELECT S05B_SEEK
		   SEEK S05_1.F01
		   IF FOUND()
		        REPLACE S05B_SEEK.F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
		   ENDIF		   
		   ***
		   SELECT  S05_1   
		   IF RLOCK()
		         REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
		         REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		         REPLACE F03 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=1,'M','F')
		         REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
		         REPLACE F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		         REPLACE F06 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		         REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
		         REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE
		         REPLACE F11 WITH ABS(THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE)
		         REPLACE F12 WITH ABS(THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE)
		         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE
		         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE	
		         REPLACE F15 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'M',IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'D','T')) 
		         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE
		         REPLACE F19 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE
		         REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE
		         REPLACE F21 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE		         
		         REPLACE F24 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE
		         REPLACE F25 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE
		         REPLACE F26 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE	
 	                 DO CASE
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=1
 	                        	    REPLACE F28 WITH '1'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=2
 	                        	    REPLACE F28 WITH '3'      
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=3
 	                        	    REPLACE F28 WITH '7'     
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=4
 	                        	    REPLACE F28 WITH '8'      	                        	     	                        	                     	     	                        	    
 	                 ENDCASE		         
		         REPLACE F29 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE   
		         REPLACE F30 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE))              
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			         
		         IF A02.F09<>'*'
		         	REPLACE F27 WITH .T.
		         ELSE	
		         	REPLACE F27 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=1,.T.,.F.)
		         ENDIF		         	         
		         **判斷勞保投保金額是否有變動
			 IF S05_1.F18<>VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE))
			     REPLACE S05_1.F18 WITH VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE))
			     ***ROUND(投保金額*(勞工保險普通事故費率+勞工就業保險費率)*勞工負擔比率/30天*30天,0)
		             LOPO=ROUND(S05_1.F18*((IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F02,0)+IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F06,0))/100)*(IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F03,0)/100)/30*30,0)
		             SELECT S06
		             SET ORDER TO S061
		             SEEK S05_1.F01+'J'+'勞保費'  &&勞保費		
		             IF FOUND()	 
			    	  REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入勞保費金額,最多七位數","請輸入",ALLTRIM(STR(LOPO)))),7))
			    	  REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		           
			    	  IF EMPTY(S06.F08)
			    	      DELETE 
			    	 ENDIF	
			     ELSE
			         SELECT S06
			         APPEND BLANK
			    	 REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
			    	 REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
			    	 REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
			    	 REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
			    	 REPLACE F05 WITH '2'
			    	 REPLACE F06 WITH 'J'
			    	 REPLACE F07 WITH '勞保費'
			    	 REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入勞保費金額,最多七位數","請輸入",ALLTRIM(STR(LOPO)))),7))
			    	 REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			    	 IF EMPTY(S06.F08)
			    	      DELETE 
			    	 ENDIF			           	 		    	        
		             ENDIF
			 ENDIF
			 ***判斷健保投保金額,眷口人數及健保等級是否有變動
		         IF S05_1.F16<>THISFORM.PAGEFRAME1.PAGE1.SPINNER16.VALUE OR;
		             S05_1.F22<>VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.DISPLAYVALUE)) OR;
		             S05_1.F23<>VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.DISPLAYVALUE))
		             REPLACE S05_1.F16 WITH THISFORM.PAGEFRAME1.PAGE1.SPINNER16.VALUE
		             REPLACE S05_1.F22 WITH VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.DISPLAYVALUE))
		             REPLACE S05_1.F23 WITH VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.DISPLAYVALUE))
		             ***眷口人數大於不扣款之眷口數則為0,否則為 ROUND(投保金額*(全民健康保險費率)*(被保險人及眷屬月負擔金額比率),0)*(眷口人數+本人)
		             PEOP=IIF(S05_1.F16>=IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F06,0),S01.F06-1,S05_1.F16)
		             SINPO=ROUND(S05_1.F23*(IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F02,0)/100)*(IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F03,0)/100),0)*(PEOP+1)		             
		             SELECT S06
		             SET ORDER TO S061
		             SEEK S05_1.F01+'K'+'健保費'  &&健保費
		             IF FOUND()
			    	  REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入健保費金額,最多七位數","請輸入",ALLTRIM(STR(SINPO)))),7))
			    	  REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
			    	  IF EMPTY(S06.F08)
			    	      DELETE 
			    	 ENDIF	     
			     ELSE
			        SELECT S06
			        APPEND BLANK 
			    	REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
			    	REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
			    	REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
			    	REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
			    	REPLACE F05 WITH '2'
			    	REPLACE F06 WITH 'K'
			    	REPLACE F07 WITH '健保費'
			    	REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入健保費金額,最多七位數","請輸入",ALLTRIM(STR(SINPO)))),7))
			    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		
			    	IF EMPTY(S06.F08)
			    	     DELETE 
			    	ENDIF			    		     	              
		             ENDIF
		         ENDIF    
		         SELECT S05
		         SET ORDER TO S051
		         SEEK S05_1.F01
		         IF FOUND()
			     REPLACE F02 WITH S05_1.F02
			     REPLACE F03 WITH S05_1.F03
			     REPLACE F04 WITH S05_1.F04
			     REPLACE F05 WITH S05_1.F05
			     REPLACE F06 WITH S05_1.F06
			     REPLACE F07 WITH S05_1.F07
			     REPLACE F08 WITH S05_1.F08
			     REPLACE F09 WITH S05_1.F09
			     REPLACE F10 WITH S05_1.F10
			     REPLACE F11 WITH S05_1.F11
			     REPLACE F12 WITH S05_1.F12
			     REPLACE F13 WITH S05_1.F13
			     REPLACE F14 WITH S05_1.F14
			     REPLACE F15 WITH S05_1.F15
			     REPLACE F16 WITH S05_1.F16
			     REPLACE F17 WITH S05_1.F17
			     REPLACE F18 WITH S05_1.F18
			     REPLACE F19 WITH S05_1.F19
			     REPLACE F20 WITH S05_1.F20
			     REPLACE F21 WITH S05_1.F21
			     REPLACE F22 WITH S05_1.F22
			     REPLACE F23 WITH S05_1.F23	         
			     REPLACE F24 WITH S05_1.F24
			     REPLACE F25 WITH S05_1.F25
			     REPLACE F26 WITH S05_1.F26
			     REPLACE F27 WITH S05_1.F27
	 	             REPLACE F28 WITH S05_1.F28	         
			     REPLACE F29 WITH S05_1.F29
			     REPLACE F30 WITH S05_1.F30
			     REPLACE F99 WITH S05_1.F99         
		         ENDIF
		    ELSE
		          DO FILE_IMPACT
		          RETURN   
		    ENDIF   
		    SELECT S05_1
		    THISFORM.GRID1.SETFOCUS 
		    SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
         CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2   	
    	 	    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)
          		   =MESSAGEBOX('薪資所得不得為零!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
          		  RETURN
          	    ENDIF     
		    SELE S06          
		    IF RLOCK()	    
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		    ELSE
		          DO FILE_IMPACT
		          RETURN   
		    ENDIF 
		    THISFORM.GRID2.SETFOCUS 
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=3     
    	 	     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE)
          		   =MESSAGEBOX('扣款金額不得為零!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE3.TXTF08.SETFOCUS
          		  RETURN
          	    ENDIF            	 	    
		    SELE S06          
		    IF RLOCK()	    
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		    ELSE
		          DO FILE_IMPACT
		          RETURN   
		    ENDIF	   
		    THISFORM.GRID2.SETFOCUS 		      		          	    
   ENDCASE		              
   THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
ENDPROC   
*************
PROC ORPGROUP.DEL_BOTT.CLICK                    &&刪除資料程序
 IF  MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認')=6 
       DO CASE
            CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1
                       SELECT  RECNO() FROM S06 WHERE S06.F01=S05_1.F01 INTO ARRAY BK6              
                       JJ6=''               
                       IF _TALLY>0   
                           FOR I= 1 TO ALEN(BK6)
                                   JJ6=JJ6+ALLTRIM(STR(BK6(I)))+','
                           ENDFOR    
                           KK6=STUFF(JJ6,RAT(',',JJ6,1),1,'')              
                           RLOCK(KK6,'S06')
                           LL6=RLOCK(KK6,'S06')
                       ELSE
                           LL6=.T.   
                       ENDIF                   
                       IF LL6=.T. AND LEN(ALLTRIM(JJ6))>0  	 	    
		           SELECT S06
                           FOR I= 1 TO ALEN(BK6)                      
                                  GO BK6(I) 	            
    		                  DELETE 
    		           ENDFOR
    		       ENDIF            
    		       SELECT S05B_SEEK
    		       SEEK S05_1.F01
    		       IF FOUND()
    		            DELETE 
    		       ENDIF
         	       SELECT S05_1
         	       LOCK()
         	       IF RLOCK()
         	           SELECT S05
         	           SET ORDER TO S051
         	           SEEK S05_1.F01
         	           IF FOUND()
         	                DELETE 
         	           ENDIF
         	           SELECT S05_1
         	           DELETE 
         	           UNLOCK
         	           SKIP -1
         	           IF BOF()
         	               GO TOP
         	           ENDIF  
		       ELSE
		           DO FILE_IMPACT
		       ENDIF
		       THISFORM.GRID1.SETFOCUS   
            CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2
         	       SELECT S06
         	       LOCK()
         	       IF RLOCK()
         	       	   DO CASE
         	       	         CASE  S06.F06='A'
         	       	                     =MESSAGEBOX('底薪不得刪除!',0+64,'提示訊息視窗')
         	       	         CASE  S06.F06='B'
         	       	                     =MESSAGEBOX('日薪不得刪除!',0+64,'提示訊息視窗')
         	       	         CASE  S06.F06='C'
         	       	                     =MESSAGEBOX('時薪不得刪除!',0+64,'提示訊息視窗')
         	       	         OTHERWISE         	       	          
	         	       	            DELETE 
		         	            UNLOCK
		         	            SKIP -1
		         	            IF BOF()
		         	                GO TOP
		         	           ENDIF  
         	           ENDCASE
		       ELSE
		           DO FILE_IMPACT
		       ENDIF
		       THISFORM.GRID2.SETFOCUS 	
            CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3
         	       SELECT S06
         	       LOCK()
         	       IF RLOCK()
         	           DELETE 
         	           UNLOCK
         	           SKIP -1
         	           IF BOF()
         	               GO TOP
         	           ENDIF  
		       ELSE
		           DO FILE_IMPACT
		       ENDIF	
		       THISFORM.GRID2.SETFOCUS 
       ENDCASE   
  ENDIF
*!*	  THISFORM.REFRESH	       
ENDPROC  
****************
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.SETALL('VISIBLE',.T.,'TEXTBOX')       
      THISFORM.SETALL('READONLY',.T.,'SPINNER')    		          		                            
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.T.         
       DO CASE 
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1   
       	                THISFORM.KEY_LIST.ENABLED=.T.  
       	                THISFORM.GRID1.ENABLED=.T.
                        THISFORM.GRID2.ENABLED=.T. 
       	     		THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","","COLUMN")
		        THISFORM.PAGEFRAME1.PAGE1.TXTF05.READONLY=.T.
		        THISFORM.PAGEFRAME1.PAGE1.TXTF11.READONLY=.T.
		        THISFORM.PAGEFRAME1.PAGE1.TXTF12.READONLY=.T.	
		        THISFORM.PAGEFRAME1.PAGE1.TXTF28.READONLY=.T.	    
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.ENABLED=.F. 
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.ENABLED=.F.     
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.ENABLED=.F.
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.ENABLED=.F. 
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VISIBLE=.F.		              
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VISIBLE=.F.	     
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX08.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.VISIBLE=.F.     
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX25.VISIBLE=.F. 
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.VISIBLE=.F.
		        THISFORM.GRID1.SETFOCUS     	
      			 IF THISFORM.GRID1.ACTIVEROW=0
      			      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
	                      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
	                 ENDIF      	        	                
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2
       	     	        THISFORM.GRID2.ENABLED=.T. 
       	     		THISFORM.PAGEFRAME1.PAGE2.TXTF06.VISIBLE=.T.
		        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VISIBLE=.F.         	     
       	     		THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.T.
		        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.   
		   	THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=SALARY_CLASS(S06.F06)
		   	THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S06.F07
		   	THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S06.F08   		 
		   	THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S06.F99 
			THISFORM.GRID2.SETFOCUS 	
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3
       	                THISFORM.GRID2.ENABLED=.T. 	
       	     		THISFORM.PAGEFRAME1.PAGE3.TXTF06.VISIBLE=.T.
		        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX06.VISIBLE=.F.         	     	                     
		        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.  
		        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.  
		   	THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=SALARY_CLASS(S06.F06)
		   	THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=S06.F07    
		   	THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=S06.F08   	   			 
		   	THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=S06.F99
		        THISFORM.GRID2.SETFOCUS   		        
      ENDCASE	       
*!*	      THISFORM.REFRESH   
      UNLOCK ALL          
  ENDPROC
**********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
    SELECT S05_1
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO S05_11
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO S05_12
         ENDCASE   
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
************************人員異動**********
 PROC CHANG_BOTT.CLICK
    IF MESSAGEBOX('是否確定要將此人員轉至S05.人事薪資基本檔中',4+32+256,'請確認')=6
        SELECT S05_1
        LK=S05_1.F01
   	CHANG_CHK=CREATEOBJECT("CHANG_CHK")  
   	CHANG_CHK.SHOW
    ENDIF	
    THISFORM.GRID1.SETFOCUS 
    THISFORM.GRID1.AFTERROWCOLCHANGE
   ENDPROC   
 ENDDEFINE      
*********************************************************
DEFINE CLASS CHANG_CHK AS FORM
  CAPTION='請輸入異動內容   員工姓名 '+S05_1.F02
  TOP=INT_015*200
  LEFT=INT_015*300  
  HEIGHT=INT_015*135
  WIDTH=INT_015*230
  FONTSIZE=INT_015*9
  MOVABLE=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.  
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='CHANG_CHK'
  ADD OBJECT LABELA AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*20,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.,;
      BACKCOLOR=RGB(255,255,0),;
      CAPTION='異動之人員可以更改新的員工編號'      
  ADD OBJECT LABEL1 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*41,;
      WIDTH=INT_015*50,;
      CAPTION='員工編號'          
  ADD OBJECT TXTF1 AS TEXTBOX WITH;           
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*34,;
       WIDTH=INT_015*75,;
       HEIGHT=INT_015*25,;
       MAXLENGTH=4
  ADD OBJECT LABEL10 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*70,;
      WIDTH=INT_015*50,;
      CAPTION='異動日期'          
  ADD OBJECT TXTF10 AS TEXTBOX WITH;           
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*64,;
       WIDTH=INT_015*75,;
       HEIGHT=INT_015*25          
  ADD OBJECT LABEL7 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*99,;
      WIDTH=INT_015*50,;
      CAPTION='異動項目'                
  ADD OBJECT COMBOBOX7 AS COMBOBOX WITH;
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*93,;       
       HEIGHT=INT_015*25,;
       WIDTH=INT_015*75,;
       FONTSIZE=INT_015*9,;   
       BOUNDCOLUMN=1,;
       ROWSOURCETYPE=1,;
       STYLE=2,;    
       VALUE=1,;
       ROWSOURCE='離職復職,留職復職',;
       NAME='COMBOBOX7'
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*35,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<Y.確定',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;
      TOP=INT_015*94,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'     
  *****    
 PROC INIT   
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')     
       THISFORM.TXTF1.VALUE=LK
       THISFORM.TXTF10.VALUE=DATE()
       THISFORM.COMBOBOX7.VALUE=1
       THISFORM.TXTF1.SETFOCUS 
 ENDPROC
 *****
   PROC CMND1.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND1.TOP=INT_015*36
             THISFORM.CMND1.LEFT=INT_015*166
  ENDPROC     
  PROC CMND1.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND1.TOP=INT_015*35
             THISFORM.CMND1.LEFT=INT_015*165                  
  ENDPROC     
  PROC CMND2.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND2.TOP=INT_015*95
             THISFORM.CMND2.LEFT=INT_015*166
  ENDPROC     
  PROC CMND2.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND2.TOP=INT_015*94
             THISFORM.CMND2.LEFT=INT_015*165               
  ENDPROC     
 *******   
 PROCEDURE CMND1.CLICK   
     IF  MESSAGEBOX('是否確定要異動此人員資料',4+32+256,'請確認')=6 
 	  IF  EMPTY(THISFORM.TXTF1.VALUE)
  		=MESSAGEBOX('員工編號不得空白!',0+64,'提示訊息視窗')
  		THISFORM.TXTF1.SETFOCUS   
  		RETURN	  
    	  ENDIF    
 	  IF  LEN(ALLTRIM(THISFORM.TXTF1.VALUE))<4
  		=MESSAGEBOX('員工編號不得少於四碼!',0+64,'提示訊息視窗')
  		THISFORM.TXTF1.SETFOCUS   
  		RETURN	  
    	  ENDIF      	  
    	  IF ALLTRIM(LK)<>ALLTRIM(THISFORM.TXTF1.VALUE)
  	      IF INDEXSEEK(THISFORM.TXTF1.VALUE,.F.,'S05A_SEEK','S05A_SEEK1')=.T.	
  	           =MESSAGEBOX('此員工編號已存在S05.人事薪資基本檔中,請查明後在輸入!',0+64,'提示訊息視窗')
  	          THISFORM.TXTF1.SETFOCUS   
  	           RETURN	    	   
  	      ENDIF   
  	      IF INDEXSEEK(THISFORM.TXTF1.VALUE,.F.,'S05B_SEEK','S05B_SEEK1')=.T.	
  	           =MESSAGEBOX('此員工編號已存在S06.離職員工薪資基本檔中,請查明後在輸入!',0+64,'提示訊息視窗')
  	          THISFORM.TXTF1.SETFOCUS   
  	           RETURN	    	   
  	      ENDIF    	      
  	  ENDIF  
 	  IF  EMPTY(THISFORM.TXTF10.VALUE)
  		=MESSAGEBOX('異動日期不得空白!',0+64,'提示訊息視窗')
  		THISFORM.TXTF10.SETFOCUS   
  		RETURN	  
    	  ENDIF        	  
          SELECT S05
          SET ORDER TO S051
          SEEK LK
          IF FOUND()     
              REPLACE F01 WITH  ALLTRIM(THISFORM.TXTF1.VALUE)
              REPLACE F09 WITH  THISFORM.TXTF10.VALUE
              REPLACE F10 WITH  THISFORM.TXTF10.VALUE
              REPLACE F11 WITH  0
              REPLACE F12 WITH  0
              REPLACE F99 WITH  DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
              DO CASE
                     CASE THISFORM.COMBOBOX7.VALUE=1
                                REPLACE F28 WITH '2'                              
                     CASE THISFORM.COMBOBOX7.VALUE=2
                                REPLACE F28 WITH '4'                                                                                                           
              ENDCASE  
          ENDIF  
          SELECT S05_1
          SET ORDER TO S05_11 
          SEEK LK
          IF FOUND()
              DELETE 
          ENDIF
          SELECT S05A_SEEK
          APPEND BLANK 
          REPLACE S05A_SEEK.F01 WITH  ALLTRIM(THISFORM.TXTF1.VALUE)
          SELECT S05B_SEEK
          SEEK LK
          IF FOUND()
              DELETE 
          ENDIF    
          SELECT  RECNO() FROM S06 WHERE ALLTRIM(S06.F01)=ALLTRIM(LK) INTO ARRAY BK6              
          JJ6=''               
          IF _TALLY>0   
               FOR I= 1 TO ALEN(BK6)
                       JJ6=JJ6+ALLTRIM(STR(BK6(I)))+','
               ENDFOR    
               KK6=STUFF(JJ6,RAT(',',JJ6,1),1,'')              
               RLOCK(KK6,'S06')
               LL6=RLOCK(KK6,'S06')
          ELSE
               LL6=.T.   
          ENDIF                   
          IF LL6=.T. AND LEN(ALLTRIM(JJ6))>0  	 	    
               SELECT S06
               FOR I= 1 TO ALEN(BK6)                      
                      GO BK6(I) 
                      REPLACE S06.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
               ENDFOR       
          ENDIF   
          ***
	  IF !USED('S07')  
	     SELE 0
	     USE S07 
	  ELSE
	    SELE S07
	  ENDIF      
          SELECT  RECNO() FROM S07 WHERE ALLTRIM(S07.F01)=ALLTRIM(LK) INTO ARRAY BK7              
          JJ7=''               
          IF _TALLY>0   
               FOR I= 1 TO ALEN(BK7)
                       JJ7=JJ7+ALLTRIM(STR(BK7(I)))+','
               ENDFOR    
               KK7=STUFF(JJ7,RAT(',',JJ7,1),1,'')              
               RLOCK(KK7,'S07')
               LL7=RLOCK(KK7,'S07')
          ELSE
               LL7=.T.   
          ENDIF                   
          IF LL7=.T. AND LEN(ALLTRIM(JJ7))>0  	 	    
               SELECT S07
               FOR I= 1 TO ALEN(BK7)                      
                      GO BK7(I) 
                      REPLACE S07.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
               ENDFOR       
          ENDIF
          SELECT S07
          USE   
          ****  
	  IF !USED('S08')  
	     SELE 0
	     USE S08 
	  ELSE
	    SELE S08
	  ENDIF    
          SELECT  RECNO() FROM S08 WHERE ALLTRIM(S08.F01)=ALLTRIM(LK) INTO ARRAY BK8              
          JJ8=''               
          IF _TALLY>0   
               FOR I= 1 TO ALEN(BK8)
                       JJ8=JJ8+ALLTRIM(STR(BK8(I)))+','
               ENDFOR    
               KK8=STUFF(JJ8,RAT(',',JJ8,1),1,'')              
               RLOCK(KK8,'S08')
               LL8=RLOCK(KK8,'S08')
          ELSE
               LL8=.T.   
          ENDIF                   
          IF LL8=.T. AND LEN(ALLTRIM(JJ8))>0  	 	    
               SELECT S08
               FOR I= 1 TO ALEN(BK8)                      
                      GO BK8(I) 
                      REPLACE S08.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
               ENDFOR       
          ENDIF
          SELECT S08
          USE   
          ****        
	  IF !USED('S09')  
	     SELE 0
	     USE S09 
	  ELSE
	    SELE S09
	  ENDIF              
          SELECT  RECNO() FROM S09 WHERE ALLTRIM(S09.F01)=ALLTRIM(LK) INTO ARRAY BK9              
          JJ9=''               
          IF _TALLY>0   
               FOR I= 1 TO ALEN(BK9)
                       JJ9=JJ9+ALLTRIM(STR(BK9(I)))+','
               ENDFOR    
               KK9=STUFF(JJ9,RAT(',',JJ9,1),1,'')              
               RLOCK(KK9,'S09')
               LL9=RLOCK(KK9,'S09')
          ELSE
               LL9=.T.   
          ENDIF                   
          IF LL9=.T. AND LEN(ALLTRIM(JJ9))>0  	 	    
               SELECT S09
               FOR I= 1 TO ALEN(BK9)                      
                      GO BK9(I) 
                      REPLACE S09.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
               ENDFOR       
          ENDIF
          SELECT S09
          USE   
          ***     
          RELEASE ALL LIKE BK*              	                          
      ENDIF      
      THISFORM.CMND2.CLICK                
  ENDPROC
 ***** 
  PROCEDURE CMND2.CLICK
       SELECT S05_1
       THISFORM.RELEASE
  ENDPROC      
ENDDEFINE        
***********************************************列印程序
PROCEDURE PNT_PRC   
      CREATE CURSOR S06_TEMP (F01 C(4),F02 C(8),F04 C(8),F071 C(20),F081 N(7),F072 C(20),F082 N(7))
      CREATE CURSOR S06B (F01 C(4),F02 C(8),F04 C(8),F071 C(20),F081 N(7),F072 C(20),F082 N(7))
      SELECT F01,F02,F06 FROM S05 WHERE  IIF(A02.F09<>'*',S05.F27=.T.,.T.)  AND S05.F28='1' OR S05.F28='3'  OR S05.F28='7'  OR S05.F28='8' ORDER BY S05.F01 INTO CURSOR S05_TEMP
      SELECT S05_TEMP
      GO TOP
      DO WHILE !EOF()
              I=1
              SUM_A=0  &&所得金額小計
              SUM_B=0  &&扣款金額小計
              **所得明細
              SELECT S06.F07,S06.F08 FROM S06 WHERE S05_TEMP.F01=S06.F01 AND S06.F05='1' ORDER BY S06.F01,S06.F06 INTO CURSOR S06A      
              SELECT S06A
              GO TOP
              DO WHILE !EOF()            
                     SELECT S06B
                     APPEND BLANK 
	             REPLACE S06B.F01 WITH S05_TEMP.F01
	             REPLACE S06B.F02 WITH IIF(I=1,S05_TEMP.F02,'')
	             REPLACE S06B.F04 WITH IIF(I=1,S05_TEMP.F06,'')
	             REPLACE S06B.F071 WITH S06A.F07
	             REPLACE S06B.F081 WITH S06A.F08  
	             SUM_A=SUM_A+S06A.F08   
		     I=I+1
      		     SELECT S06A
      		     SKIP
      	     ENDDO
	     I=1
      	     SELECT S06A
      	     USE
      	     SELECT S06B
      	     GO TOP
      	     **扣款明細
             SELECT S06.F07,S06.F08 FROM S06 WHERE S05_TEMP.F01=S06.F01 AND S06.F05='2' ORDER BY S06.F01,S06.F06 INTO CURSOR S06A      
             SELECT S06A
             GO TOP      	     	     	
             DO WHILE !EOF() 
                     SELECT S06B
                     IF  !EOF()       
                           SELECT S06B
	                   REPLACE S06B.F072 WITH S06A.F07
	                   REPLACE S06B.F082 WITH S06A.F08   
      		      ELSE
                           SELECT S06B
                           APPEND BLANK 
	                   REPLACE S06B.F01 WITH S05_TEMP.F01
	                   REPLACE S06B.F02 WITH IIF(I=1,S05_TEMP.F02,'')
	                   REPLACE S06B.F04 WITH IIF(I=1,S05_TEMP.F06,'')
	                   REPLACE S06B.F072 WITH S06A.F07
	                   REPLACE S06B.F082 WITH S06A.F08         		      
      		      ENDIF    
      		      SUM_B=SUM_B+S06A.F08
      		      I=I+1
	              SELECT S06B
	              SKIP         		       
      		      SELECT S06A
      		      SKIP       		      
      	     ENDDO
      	     SELECT S06A
      	     USE
      	     SELECT S06B
      	     IF SUM_A<>0 OR SUM_B<>0 
      	          APPEND BLANK 
      	          REPLACE F071 WITH '小計'
      	          REPLACE F072 WITH '小計'
      	          REPLACE F081 WITH SUM_A
      	          REPLACE F082 WITH SUM_B
      	     ENDIF     
      	     GO TOP
             DO WHILE !EOF()
                    SELECT S06_TEMP
                    APPEND BLANK 
                    REPLACE S06_TEMP.F01 WITH S06B.F01
                    REPLACE S06_TEMP.F02 WITH S06B.F02
                    REPLACE S06_TEMP.F04 WITH S06B.F04
                    REPLACE S06_TEMP.F071 WITH S06B.F071
                    REPLACE S06_TEMP.F072 WITH S06B.F072
                    REPLACE S06_TEMP.F081 WITH S06B.F081
                    REPLACE S06_TEMP.F082 WITH S06B.F082                    
                    SELECT S06B
                    SKIP
             ENDDO   
            SELECT S06B
	    DELETE ALL          
            SELECT S05_TEMP
            SKIP
      ENDDO      
      SELECT S06B
      USE
      SELECT S05_TEMP
      USE      
      SELECT S06_TEMP
      GO TOP
      IF  _TALLY >0
           REPORT FORM ALLTRIM(INT_116)+'S06' TO PRINT PROMPT   PREVIEW
      ELSE
             =MESSAGEBOX('查無可列印之資料',0+48,'警示')
             RETURN     
      ENDIF   
      SELECT S06_TEMP
      USE  
     CLEAR
ENDPROC
***************************************************部門
DEFINE CLASS COMBOBOX05 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*60
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX05'
 PROCEDURE INIT    
       SELECT F01,F02 FROM A14 WHERE  LEN(ALLTRIM(F01))=4  ORDER BY F01 INTO CURSOR A14_TEMP
       SELECT A14_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(A14_TEMP.F01)+SPACE(5)+ALLTRIM(A14_TEMP.F02))
      	      SELECT  A14_TEMP
      	      SKIP
       ENDDO
       SELECT A14_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=LEFT(THIS.DISPLAYVALUE,4)
       THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION=RIGHT(ALLTRIM(THIS.DISPLAYVALUE),LEN(ALLTRIM(THIS.DISPLAYVALUE))-9)
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.REFRESH  
  ENDPROC       
ENDDEFINE
**************************************************職務項目名稱
DEFINE CLASS COMBOBOX071 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX071'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='D' ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=THIS.DISPLAYVALUE
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.REFRESH  
  ENDPROC       
ENDDEFINE
***********************************************職等項目名稱
DEFINE CLASS COMBOBOX08 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX08'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='E' ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=THIS.DISPLAYVALUE
       THISFORM.PAGEFRAME1.PAGE1.TXTF08.REFRESH  
  ENDPROC       
ENDDEFINE
***************************************************班別
DEFINE CLASS COMBOBOX29 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*40
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX29'
 PROCEDURE INIT    
     THIS.ADDITEM('') 
     SELECT F48,F50,F51 FROM S00 WHERE  F01='I'  ORDER BY F48,F50,F51 INTO CURSOR S00_TEMP
     SELECT S00_TEMP
     GO TOP  
     DO WHILE  !EOF()
            THIS.ADDITEM(ALLTRIM(S00_TEMP.F48)+SPACE(4)+ALLTRIM(S00_TEMP.F50)+'∼'+ALLTRIM(S00_TEMP.F51))
            SELECT  S00_TEMP
            SKIP
     ENDDO
     SELECT S00_TEMP
     USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=LEFT(ALLTRIM(THIS.DISPLAYVALUE),2)
       THISFORM.PAGEFRAME1.PAGE1.LBLF291.CAPTION=RIGHT(ALLTRIM(THIS.DISPLAYVALUE),LEN(ALLTRIM(THIS.DISPLAYVALUE))-6)
       THISFORM.PAGEFRAME1.PAGE1.TXTF29.REFRESH  
  ENDPROC       
ENDDEFINE
***************************************************勞保金額
DEFINE CLASS COMBOBOX18 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*70
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX18'
 PROCEDURE INIT    
       SELECT F02 FROM S04  ORDER BY F02 GROUP BY F02 INTO CURSOR S04_TEMP
       SELECT S04_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(STR(S04_TEMP.F02)))
      	      SELECT  S04_TEMP
      	      SKIP
       ENDDO
       SELECT S04_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.TXTF18.REFRESH  
  ENDPROC       
ENDDEFINE
**************************************************健保等級
DEFINE CLASS COMBOBOX22 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*40
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX22'
 PROCEDURE INIT    
       SELECT F01 FROM S03  ORDER BY F01 INTO CURSOR S03_TEMP
       SELECT S03_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(STR(S03_TEMP.F01)))
      	      SELECT  S03_TEMP
      	      SKIP
       ENDDO
       SELECT S03_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.VALUE=THIS.VALUE 
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.REFRESH       
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.REFRESH   
  ENDPROC       
ENDDEFINE
***************************************************健保金額
DEFINE CLASS COMBOBOX23 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*70
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX23'
 PROCEDURE INIT    
       SELECT F02 FROM S03  ORDER BY F02 INTO CURSOR S03_TEMP
       SELECT S03_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(STR(S03_TEMP.F02)))
      	      SELECT  S03_TEMP
      	      SKIP
       ENDDO
       SELECT S03_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.VALUE=THIS.VALUE 
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.REFRESH         
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.REFRESH  
  ENDPROC       
ENDDEFINE
*************************************************撥款銀行
DEFINE CLASS COMBOBOX25 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX25'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='H'  ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.TXTF25.REFRESH  
  ENDPROC       
ENDDEFINE
***************************************************任職狀況
DEFINE CLASS COMBOBOX28 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*80
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX28'
 PROCEDURE INIT    
       THIS.ADDITEM('已  離  職') 
       THIS.ADDITEM('留職停薪') 
       THIS.ADDITEM('退        休') 
       THIS.ADDITEM('資        遣') 
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=THIS.DISPLAYVALUE
       THISFORM.PAGEFRAME1.PAGE1.TXTF28.REFRESH  
  ENDPROC       
ENDDEFINE
***************************************************薪資/扣款項目名稱
DEFINE CLASS COMBOBOX07 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX07'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='F'  ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=ALLTRIM(THIS.DISPLAYVALUE)       
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.REFRESH  
       THISFORM.PAGEFRAME1.PAGE3.TXTF07.REFRESH       
  ENDPROC       
ENDDEFINE
**************************************************薪資類別(以後要修改時請參考S05.人事薪資基本檔)
DEFINE CLASS COMBOBOX061 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX061'
 PROCEDURE INIT         
       THIS.ADDITEM('')          
       THIS.ADDITEM('底薪')
       THIS.ADDITEM('伙食費')         
       THIS.ADDITEM('交通費')
       THIS.ADDITEM('全勤獎金')
       THIS.ADDITEM('職務津貼')
       THIS.ADDITEM('自訂項目')
  ENDPROC           
ENDDEFINE
**************************************************扣款類別
DEFINE CLASS COMBOBOX062 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX062'
 PROCEDURE INIT    
          THIS.ADDITEM('')          
          THIS.ADDITEM('勞保費')
          THIS.ADDITEM('健保費') 
          THIS.ADDITEM('所得稅') 
          THIS.ADDITEM('其他扣款')
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       DO CASE 
   	     CASE THIS.VALUE=1
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.  	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.   
    	                THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.DISPLAYVALUE=''        	     	        	    	     	        
   	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=''   	      	     	         	
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=''       
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=''  	 	     	                     
   	     CASE THIS.VALUE=2
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T.      	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.   	
   	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE='F'    	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE='勞保費'       	        
    	     	        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.
			THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=ROUND(THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE*((IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F02,0)+IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F06,0))/100)*(IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F03,0)/100)/30*30,0) 
   	     CASE THIS.VALUE=3
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.   	      
    	     	        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.
   	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE='G'
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE='健保費'       	     	     	        
    	     	        ****眷口人數大於不扣款之眷口數則為0,否則為 ROUND(投保金額*(全民健康保險費率)*(被保險人及眷屬月負擔金額比率),0)*(眷口人數+本人)
			PEOP=IIF(THISFORM.PAGEFRAME1.PAGE1.SPINNER16.VALUE>=IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F06,0),S01.F06-1,THISFORM.PAGEFRAME1.PAGE1.SPINNER16.VALUE)
			THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=INT(ROUND(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE*(IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F02,0)/100)*(IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F03,0)/100),0)*(PEOP+1))  
             CASE THIS.VALUE=4  		
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.   	      
    	     	        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.
   	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE='J'
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE='所得稅'              
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=0   	
   	     CASE THIS.VALUE=5
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.F.       	     
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.F.      	     
    	     	        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.T.   	
   	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE='H'   
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=''  
    	     	        THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=0
    	                THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.DISPLAYVALUE=''     	     	        
       ENDCASE 	  
       THISFORM.PAGEFRAME1.PAGE3.TXTF07.REFRESH  
  ENDPROC       
ENDDEFINE  