***託外工資詢價紀錄
close all
clear 
FLG='0'
FCH=''
CHK=''
CHK_STR=''
FTR_STR=''
UKEF=0
R=0
AREA1='E02'
AREA2='E10'
IF !USED('D00')
   SELE 0
   USE D00
ELSE
   SELE D00
ENDIF
SET ORDER TO 1
IF !USED('E00')
   SELE 0
   USE E00
ELSE
   SELE D00
ENDIF
SET ORDER TO 1
IF ! USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK sys_oper+'E15'
IF !USED('B01')
    SELECT 0
    USE B01
 ELSE
    SELECT B01
 ENDIF
 SET ORDER TO 1      
IF !USED('E04')
    SELECT 0
    USE E04
ELSE   
     SELECT E04
ENDIF
SET ORDER TO 1     
IF !USED('E05')
   SELE 0
   USE E05 INDE E05
ELSE
   SELE E05
ENDIF
SET ORDER TO 2
IF !USED('E02')
   SELE 0
   USE E02 INDE E02
ELSE
   SELE E02
ENDIF
SET ORDER TO E021
SET RELATION TO F01 INTO E04  ADDI
if !used('E10')
   SELE 0
   USE E10
ELSE
   SELE E10
ENDIF
SET ORDER TO E101      
SET RELATION TO F03 INTO B01 ADDITIVE
SET RELATION TO F05 INTO E00 ADDITIVE 
E10form=createobject("tkE10")
E10form.show  
define class tkE10 as form
  caption='E15.託外工資詢價紀錄'
*!*	  autocenter=.t.
  controlbox=.F.
  BORDERSTYLE=3  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  controlcount=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  showtips=.t.
  showwindow=1
  WIDTH=INT_015*789
  windowtype=1
  NAME='TKE10'
  add object shape1 as shape1 with;
      autocenter=.t.

  ADD OBJECT LBL_REC AS LBL_REC WITH;
      AUTOCENTER =.T.
  ADD OBJECT REC_COUNT AS REC_COUNT  with;
      caption=str(reccount())        
  add object shape2 as shape2 with;
      autocenter=.t.
  add object shape3 as shape3 with;
      autocenter=.t.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*200,;
      FONTSIZE=INT_015*9,;
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='依照廠商搜尋紀錄',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='詳細資料內容'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT grid1 AS grid1 WITH;
      columncount=3,;            
      RECORDSOURCE='E02',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3'
  ADD OBJECT grid2 AS grid2 WITH;
      columncount=10,;            
      RECORDSOURCE='E10',;
      LINKMASTER='E02',;
      RELATIONALEXPR='F01',;
      CHILDORDER='E101',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.              
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOSIZE=.T.              
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*173,;
      LEFT=INT_015*558          
  ADD OBJECT TRN_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;      
      AUTOSIZE=.T.,;
      FONTSIZE=INT_015*9,;
      CAPTION='將此筆詢價轉成標準成本',;
      NAME='TRN_BOTT'            
  PROCEDURE PAGEFRAME1.PAGE1.INIT     
     THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*27
          .WIDTH=INT_015*50
          .CAPTION='廠商編號'          
     ENDWITH
     THIS.ADDOBJECT('LBLF011','LABEL')     
     WITH THIS.LBLF011
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*27
          .AUTOSIZE=.T.  
     ENDWITH            
     THIS.AddObject('LBLF04','LABEL')
     WITH THIS.LBLF04
                 .LEFT=INT_015*14
                 .TOP=INT_015*52
                 .WIDTH=INT_015*50
                 .CAPTION='版        本'                 
     ENDWITH
     THIS.AddObject('LBLF05','LABEL')
     WITH THIS.LBLF05
                 .LEFT=INT_015*14
                 .TOP=INT_015*77
                 .WIDTH=INT_015*50
                 .CAPTION='製程編號'
     ENDWITH
     THIS.AddObject('LBLF051','LABEL')
     WITH THIS.LBLF051
                 .LEFT=INT_015*98
                 .TOP=INT_015*77
                 .AUTOSIZE=.T.
                 .CAPTION=''
     ENDWITH          
     THIS.ADDOBJECT('TXTF01','TEXTBOX')     
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*23
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=5
     ENDWITH        
     THIS.ADDOBJECT('TXTF04','TEXTBOX')     
     WITH THIS.TXTF04
          .LEFT=INT_015*65
          .TOP=INT_015*48
          .WIDTH=INT_015*25
          .HEIGHT=INT_015*25
          .MAXLENGTH=3
     ENDWITH        
     THIS.ADDOBJECT('TXTF05','TEXTBOX')     
     WITH THIS.TXTF05
          .LEFT=INT_015*65
          .TOP=INT_015*73
          .WIDTH=INT_015*32
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
     ENDWITH             
  ENDPROC   
  PROCEDURE PAGEFRAME1.PAGE2.INIT
	THIS.ADDOBJECT('LBLF01','LABEL')
	WITH THIS.LBLF01  
         .LEFT=INT_015*14
         .TOP=INT_015*13
	     .WIDTH=INT_015*50
         .CAPTION='廠商編號'
    ENDWITH  
    THIS.ADDOBJECT('LBLF011','LABEL')
    WITH THIS.LBLF011
         .LEFT=INT_015*126
	     .TOP=INT_015*14
	     .autosize=.t.
	ENDWITH     
    THIS.ADDOBJECT('LBLF03','LABEL')
    WITH THIS.LBLF03
         .VISIBLE=.T.
	     .LEFT=INT_015*14
	     .TOP=INT_015*14
	     .WIDTH=INT_015*50
	     .CAPTION='品        號'
	ENDWITH     
    THIS.ADDOBJECT('LBLF031','Label')
    WITH THIS.LBLF031
         .VISIBLE=.T.
         .LEFT=INT_015*327
         .TOP=INT_015*14
         .WIDTH=INT_015*144         
    ENDWITH     
    THIS.ADDOBJECT('LBLF04','LABEL')
    WITH THIS.LBLF04
         .VISIBLE=.T.    
         .LEFT=INT_015*14
         .TOP=INT_015*39
         .WIDTH=INT_015*50
         .CAPTION='版        本'       
    ENDWITH     
    THIS.ADDOBJECT('LBLF02','LABEL')      
    WITH THIS.LBLF02
         .VISIBLE=.T.       
         .LEFT=INT_015*328
         .TOP=INT_015*39
         .WIDTH=INT_015*50
         .CAPTION='詢價日期'
    ENDWITH     
    THIS.ADDOBJECT('LBLF05','LABEL')
    WITH THIS.LBLF05
         .VISIBLE=.T.           
         .LEFT=INT_015*144
         .TOP=INT_015*39
         .WIDTH=INT_015*50
         .CAPTION='製程代號'
    ENDWITH     
    THIS.ADDOBJECT('LBLF051','LABEL')
    WITH THIS.LBLF051
         .VISIBLE=.T.           
         .LEFT=INT_015*230
         .TOP=INT_015*39
         .AUTOSIZE=.T.
         .CAPTION=''
    ENDWITH         
    THIS.ADDOBJECT('LBLF06','LABEL')
    WITH THIS.LBLF06
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*64
         .WIDTH=INT_015*50
         .CAPTION='幣        別'
    ENDWITH     
    THIS.ADDOBJECT('LBLF07','LABEL')
    WITH THIS.LBLF07
         .VISIBLE=.T.           
         .LEFT=INT_015*144
         .TOP=INT_015*64
         .WIDTH=INT_015*50
         .CAPTION='發包單價'
    ENDWITH     
    THIS.ADDOBJECT('LBLF14','LABEL')
    WITH THIS.LBLF14
         .VISIBLE=.T.           
         .LEFT=INT_015*328
         .TOP=INT_015*64
         .WIDTH=INT_015*50
         .CAPTION='購置單價'
    ENDWITH         
    THIS.ADDOBJECT('LBLF13','LABEL')
    WITH THIS.LBLF13
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*89
         .WIDTH=INT_015*50
         .CAPTION='加工基量'               
    ENDWITH  
    THIS.ADDOBJECT('LBLF131','LABEL')
    WITH THIS.LBLF131
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*89
         .WIDTH=INT_015*50
         .CAPTION='1/'               
    ENDWITH  
    THIS.ADDOBJECT('LBLF08','LABEL')
    WITH THIS.LBLF08
        .VISIBLE=.T.           
        .LEFT=INT_015*328
        .TOP=INT_015*89
        .WIDTH=INT_015*50
        .CAPTION='發包基量'         
    ENDWITH    
    THIS.ADDOBJECT('LBLF15','LABEL')
    WITH THIS.LBLF15
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*114
         .WIDTH=INT_015*50
         .CAPTION='備註說明'
    ENDWITH                 
    THIS.ADDOBJECT('LBLF09','LABEL')
    WITH THIS.LBLF09
         .VISIBLE=.T.           
         .LEFT=INT_015*328
         .TOP=INT_015*114
         .WIDTH=INT_015*50
         .CAPTION='前置日數'         
    ENDWITH     
    THIS.ADDOBJECT('LBLF10','LABEL')
    WITH THIS.LBLF10
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*139
         .WIDTH=INT_015*50
         .CAPTION='交易條件'         
    ENDWITH     
    THIS.ADDOBJECT('LBLF11','LABEL')
    WITH THIS.LBLF11
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*164
         .WIDTH=INT_015*50
         .CAPTION='安全資料'          
    ENDWITH     
    THIS.ADDOBJECT('LBLF111','LABEL')
    WITH THIS.LBLF111
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*164
         .AUTOSIZE=.T.          
    ENDWITH     
	THIS.ADDOBJECT('TXTF01','TXTF01')
	WITH THIS.TXTF01      
	     .LEFT=INT_015*65
	     .TOP=INT_015*10
	     .WIDTH=INT_015*60
	     .HEIGHT=INT_015*25
	     .MAXLENGTH=5
	     .NAME='TXTF01'  
	ENDWITH     
	THIS.ADDOBJECT('TXTF03','TXTF03')
	WITH THIS.TXTF03
	     .VISIBLE=.T.
	     .LEFT=INT_015*65
	     .TOP=INT_015*10
	     .WIDTH=INT_015*261
	     .HEIGHT=INT_015*25
	     .MAXLENGTH=43
	     .NAME='TXTF03'	    
	ENDWITH     
    THIS.ADDOBJECT('TXTF04','TEXTBOX')
    WITH THIS.TXTF04
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*35
         .WIDTH=INT_015*28
         .MAXLENGTH=3
         .NAME='TXTF04'
    ENDWITH     
    THIS.ADDOBJECT('TXTF05','TXTF05')
    WITH THIS.TXTF05     
         .VISIBLE=.T.           
         .LEFT=INT_015*195
         .TOP=INT_015*35
         .WIDTH=INT_015*34
         .MAXLENGTH=4
         .NAME='TXTF05'
    ENDWITH     
    THIS.ADDOBJECT('TXTF02','TEXTBOX')
    WITH THIS.TXTF02
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*35
         .WIDTH=INT_015*74
         .HEIGHT=INT_015*25
         .NAME='TXTF02'                            
    ENDWITH         
    THIS.ADDOBJECT('TXTF06','TEXTBOX')
    WITH THIS.TXTF06
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*60
         .WIDTH=INT_015*44
         .MAXLENGTH=4
         .NAME='TXTF06'                 
    ENDWITH     
    THIS.ADDOBJECT('CRCY','CRCY')
    THIS.ADDOBJECT('TXTF07','TEXTBOX')
    WITH THIS.TXTF07
         .VISIBLE=.T.           
         .LEFT=INT_015*195
         .TOP=INT_015*60
         .WIDTH=INT_015*80
         .INPUTMASK='9999999.999999'
         .ALIGNMENT=1
         .NAME='TXTF07'
    ENDWITH     
    THIS.ADDOBJECT('TXTF14','TEXTBOX')
    WITH THIS.TXTF14
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*60
         .WIDTH=INT_015*80
         .INPUTMASK='9999999.999999'
         .ALIGNMENT=1         
         .NAME='TXTF14'
    ENDWITH         
    THIS.ADDOBJECT('TXTF13','TEXTBOX')
    WITH THIS.TXTF13
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*85
         .WIDTH=INT_015*80
         .INPUTMASK='99999999999'
         .ALIGNMENT=1
         .NAME='TXTF13'                       
    ENDWITH     
    THIS.ADDOBJECT('TXTF08','TEXTBOX')
    WITH THIS.TXTF08
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*85
         .WIDTH=INT_015*80
         .INPUTMASK='99999999999'
         .ALIGNMENT=1
         .NAME='TXTF08'
    ENDWITH     
    THIS.ADDOBJECT('TXTF15','TEXTBOX')
    WITH THIS.TXTF15
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*110
         .WIDTH=INT_015*224
         .MAXLENGTH=20
         .NAME='TXTF15'
    ENDWITH                 
    THIS.ADDOBJECT('TXTF09','TEXTBOX')    
    WITH THIS.TXTF09
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*110
         .WIDTH=INT_015*74
         .INPUTMASK='999'
         .ALIGNMENT=1
         .NAME='TXTF09'              
    ENDWITH     
    THIS.ADDOBJECT('TXTF10','TEXTBOX')
    WITH THIS.TXTF10
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*135
         .WIDTH=INT_015*149
         .MAXLENGTH=20
         .NAME='TXTF10'                   
    ENDWITH
  ENDPROC       
  PROCEDURE PAGEFRAME1.PAGE1.activate
     R=0
     IF THISFORM.KEY_LIST.DISPLAYVALUE='依廠商編號排列'
        SELE E02
     ELSE
        SELE E05
     ENDIF      
     THISFORM.GRID1.ENABLED=.T.          
     THISFORM.GRID1.SETFOCUS     
     IF THISFORM.GRID1.ACTIVEROW=0
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
     ENDIF   
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
     THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
     THISFORM.TRN_BOTT.ENABLED=.F.
     THISFORM.KEY_LIST.ENABLED=.T.
  ENDPROC
  PROCEDURE PAGEFRAME1.PAGE2.activate
       SELE E10 
     IF THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.GRID2.READONLY=.T.    
        THISFORM.GRID2.SETFOCUS    
     ENDIF 
     IF THISFORM.GRID2.ACTIVEROW=0 .and. thisform.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF111.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF051.CAPTION=''
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限  
        THISFORM.TRN_BOTT.ENABLED=!E10.F12
     ENDIF   
     R=RECNO('&AREA1')
     THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
     THISFORM.GRID1.ENABLED=.F.     
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
     THISFORM.KEY_LIST.ENABLED=.F.     
  ENDPROC   

  PROC INIT              
           THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
           THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9    
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限  
           thisform.setall('height',INT_015*25,'textbox')
           thisform.setall('height',INT_015*17,'label')
           thisform.setall('FONTSIZE',INT_015*9,'textbox')
           thisform.setall('FONTSIZE',INT_015*9,'label')       
           THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
           THISFORM.SHRGROUP.VISIBLE=.F.
           THISFORM.SHRGROUP.ENABLED=.F.
           THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
           THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
           THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
           THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
           thisform.GRID1.setall('FONTSIZE',INT_015*9,'COLUMN')
           thisform.GRID1.setall('FONTSIZE',INT_015*9,'HEADER')         
           THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='廠商編號'
           THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='廠商簡稱'
           THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='隸屬編號'       
           THISFORM.GRID1.COLUMN1.CONTROLSOURCE='E02.F01'
           THISFORM.GRID1.COLUMN2.CONTROLSOURCE='E02.F04'
           THISFORM.GRID1.COLUMN3.CONTROLSOURCE='E04.F02'
           THISFORM.grid2.COLUMN1.HEADER1.CAPTION='料品編號'
           THISFORM.grid2.COLUMN2.HEADER1.CAPTION='版次'
	   THISFORM.grid2.COLUMN3.HEADER1.CAPTION='製程名稱'       
	   THISFORM.grid2.COLUMN4.HEADER1.CAPTION='詢價日期'
	   THISFORM.grid2.COLUMN5.HEADER1.CAPTION='幣別'
	   THISFORM.grid2.COLUMN6.HEADER1.CAPTION='發包單價'
	   THISFORM.grid2.COLUMN7.HEADER1.CAPTION='購置單價'  	   
	   THISFORM.grid2.COLUMN8.HEADER1.CAPTION='加工基量'
	   THISFORM.grid2.COLUMN9.HEADER1.CAPTION='發包基量'
	   THISFORM.grid2.COLUMN10.HEADER1.CAPTION='前置日數'
            thisform.GRID2.setall('FONTSIZE',INT_015*9,'COLUMN')
           thisform.GRID2.setall('FONTSIZE',INT_015*9,'HEADER')	        	   
	   THISFORM.grid2.COLUMN1.CONTROLSOURCE='E10.F03'
	   THISFORM.grid2.COLUMN2.CONTROLSOURCE='E10.F04'
	   THISFORM.grid2.COLUMN3.CONTROLSOURCE="E00.F04"	   	   	   
	   THISFORM.grid2.COLUMN4.CONTROLSOURCE='E10.F02'	   
	   THISFORM.grid2.COLUMN5.CONTROLSOURCE='E10.F06'
	   THISFORM.grid2.COLUMN6.CONTROLSOURCE='E10.F07'
	   THISFORM.grid2.COLUMN7.CONTROLSOURCE='E10.F14'	   
	   THISFORM.GRID2.COLUMN8.CONTROLSOURCE="IIF(E00.F05='4','1/','')+ALLTRIM(STR(E10.F13))"
	   
	   THISFORM.grid2.COLUMN9.CONTROLSOURCE='E10.F08'
	   THISFORM.grid2.COLUMN10.CONTROLSOURCE='E10.F09'
	   THISFORM.grid2.COLUMN1.WIDTH=INT_015*140
	   THISFORM.GRID2.COLUMN2.WIDTH=INT_015*25
       THISFORM.grid2.COLUMN3.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN5.WIDTH=INT_015*30
       THISFORM.GRID2.COLUMN6.WIDTH=INT_015*80
       THISFORM.GRID2.COLUMN7.WIDTH=INT_015*80
       THISFORM.grid1.READONLY=.T.  
       THISFORM.GRID2.READONLY=.T.     
       THISFORM.grid1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.      
       ENDIF          
       THISFORM.KEY_LIST.DISPLAYVALUE='依廠商編號排列'       
       JK='廠商編號'
       SELE E02
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=E02.F01
       THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=E02.F04
  ENDPROC     
  PROC KEY_LIST.INIT 
       with this 
           .additem('依廠商編號排列')
           .additem('依品號製程排列')
       endwith      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE             
       SELECT E00
       SET RELATION OFF INTO E10    
       SELE E02
       SET RELA OFF INTO E10
       SELE E05
       SET RELA OFF INTO E10
       SET RELATION OFF INTO E00
       SET RELATION OFF INTO B01
       SELE E10
       SET RELATION  OFF INTO E05       
       SET RELATION  OFF INTO E02
       SET RELATION OFF INTO B01
       SET RELATION OFF INTO E00
       THISFORM.GRID1.RECORDSOURCE=''
       THISFORM.GRID1.CHILDORDER=''
       THISFORM.GRID2.LINKMASTER=''
       THISFORM.GRID2.RELATIONALEXPR=''
       THISFORM.GRID2.CHILDORDER=''
       DO CASE
          CASE THIS.DISPLAYVALUE='依廠商編號排列'
               THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照廠商搜尋紀錄'
               SELE E10
               SET ORDER TO E101                    
               SET RELATION TO F03 INTO B01 ADDI               
               SET RELATION TO F05 INTO E00 ADDI
               AREA1='E02'
               THISFORM.PAGEFRAME1.PAGE1.LBLF04.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE1.TXTF04.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE1.LBLF05.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE1.LBLF051.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE1.TXTF04.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE1.TXTF05.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='廠商編號'
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.WIDTH=INT_015*50
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.MAXLENGTH=5
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=E02.F01
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.LEFT=INT_015*140
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=E02.F04
               THISFORM.PAGEFRAME1.PAGE2.LBLF01.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF011.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.ENABLED=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF03.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF031.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.ENABLED=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF05.VISIBLE=.T.       
               THISFORM.PAGEFRAME1.PAGE2.LBLF05.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF051.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF04.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF04.VISIBLE=.T.                      
               THISFORM.GRID1.RECORDSOURCE='E02'
               THISFORM.GRID1.CHILDORDER='E021'
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='廠商編號'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='廠商簡稱'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='隸屬編號'               
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='E02.F01'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='E02.F04'   
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='E04.F02'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
               THISFORM.GRID2.LINKMASTER='E02'
               THISFORM.GRID2.RELATIONALEXPR='F01'               
               THISFORM.GRID2.CHILDORDER='E101'                           
               THISFORM.grid2.COLUMN1.HEADER1.CAPTION='料品編號'
               THISFORM.grid2.COLUMN1.CONTROLSOURCE='E10.F03'
               THISFORM.grid2.COLUMN1.WIDTH=INT_015*140
               THISFORM.grid2.COLUMN2.HEADER1.CAPTION='版次'
               THISFORM.grid2.COLUMN2.CONTROLSOURCE='E10.F04'   
               THISFORM.grid2.COLUMN2.WIDTH=INT_015*25            
               THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='製程名稱'
               THISFORM.GRID2.COLUMN3.CONTROLSOURCE="E00.F04"
          CASE THIS.DISPLAYVALUE='依品號製程排列'
               THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照料號搜尋紀錄'    
               SELECT E05
               SET RELATION TO F07 INTO E00 ADDITIVE 
               SET RELATION TO F01 INTO B01 ADDITIVE 
               SELE E10
               SET ORDER TO E102
               SET RELATION TO F01 INTO E02 ADDI                        
               AREA1='E05'
               THISFORM.PAGEFRAME1.PAGE1.LBLF04.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE1.TXTF04.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE1.LBLF05.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE1.LBLF051.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE1.TXTF04.VISIBLE=.T.               
               THISFORM.PAGEFRAME1.PAGE1.TXTF05.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='料品編號'
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.WIDTH=INT_015*149
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.MAXLENGTH=43
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=E05.F01
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.LEFT=INT_015*230
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=B01.F02
               THISFORM.PAGEFRAME1.PAGE2.LBLF01.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF011.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.ENABLED=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF03.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF031.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.ENABLED=.F.  
               THISFORM.PAGEFRAME1.PAGE2.TXTF05.VISIBLE=.F.       
               THISFORM.PAGEFRAME1.PAGE2.LBLF05.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF051.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF04.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF04.VISIBLE=.F.                               
               THISFORM.GRID1.RECORDSOURCE='E05'
               THISFORM.GRID1.CHILDORDER='E052'
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料品編號'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='版本'
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='製程名稱'               
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='E05.F01'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='E05.F02'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='E00.F04'               
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*140
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*25 
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
               THISFORM.GRID2.LINKMASTER='E05'
               THISFORM.GRID2.RELATIONALEXPR='F01+F02+F07'
               THISFORM.GRID2.CHILDORDER='E102'                                
               THISFORM.grid2.COLUMN1.HEADER1.CAPTION='廠商編號'
               THISFORM.grid2.COLUMN1.CONTROLSOURCE='E10.F01'
               THISFORM.grid2.COLUMN1.WIDTH=INT_015*50               
               THISFORM.grid2.COLUMN2.HEADER1.CAPTION='廠商簡稱'
               THISFORM.grid2.COLUMN2.CONTROLSOURCE='E02.F04'       
               THISFORM.grid2.COLUMN2.WIDTH=INT_015*50                         
               THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='隸屬編號'
               THISFORM.GRID2.COLUMN3.CONTROLSOURCE='E04.F02'                              
       ENDCASE 
*        THISFORM.PAGEFRAME1.ACTIVEPAGE=2
        THISFORM.PAGEFRAME1.ACTIVEPAGE=1
        SELE &AREA1
        GO TOP
        THISFORM.grid1.SETFOCUS
  ENDPROC      
  PROC grid1.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       IF THISFORM.KEY_list.DISPLAYVALUE='依廠商編號排列'
          THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=E02.F01
          THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=E02.F04
       ELSE          
          THISFORM.PAGEFRAME1.page1.TXTF01.VALUE=E05.F01
          THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=B01.F02
          THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=E05.F02
          THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=E05.F07
          THISFORM.PAGEFRAME1.PAGE1.LBLF051.CAPTION=E00.F04
       ENDIF
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION  
       IF THIS.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
       ENDIF   
       CHK=''     
       thisform.refresh
  ENDPROC     
  PROC grid2.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=F01
       THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=E02.F04
       THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=F02
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=F03
       THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=LEFT(B01.F02,20)
       THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=F04
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=F05
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=F06
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=F07
       THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=F08
       THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=F09
       THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=F10
       THISFORM.PAGEFRAME1.PAGE2.LBLF111.CAPTION=F11
       THISFORM.PAGEFRAME1.PAGE2.LBLF051.CAPTION=IIF(EMPTY(E10.F05),'整組加工',E00.F04)
       THISFORM.PAGEFRAME1.PAGE2.TXTF13.LEFT=INT_015*65+IIF(E00.F05='4',20,0)
       THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=F13       
       THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=F14
       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=F15
       THISFORM.TRN_BOTT.ENABLED=!E10.F12
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       IF AREA1='E02'
            CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
        ELSE
            CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
        ENDIF    
       if thisform.pageframe1.activepage=1
          thisform. CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ENDIF   
  ENDPROC 
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
    THISFORM.SETALL('READONLY',.F.,'TEXTBOX')       
    THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
     THISFORM.TRN_BOTT.ENABLED=.F.    
    THISFORM.GRID2.ENABLED=.F. 
    THISFORM.PAGEFRAME1.PAGE2.CRCY.VISIBLE=.T.
    THISFORM.PAGEFRAME1.PAGE2.CRCY.DISPLAYVALUE=INT_011
    IF AREA1='E02'
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F.            
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS     
        THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.F.
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=1        
        THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=1        
     ELSE
        THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=E05.F99
        THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=E05.F99
        THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=E05.F13
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.READONLY=.F. 
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=''     
     ENDIF   
     THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=DATE()
     THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=0
     THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=0
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=IIF(AREA1='E05',B01.F28,1)
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.LBLF111.CAPTION=''
     THISFORM.PAGEFRAME1.PAGE2.LBLF051.CAPTION='' 
  ENDPROC  
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
     THISFORM.TRN_BOTT.ENABLED=.F.     
     THISFORM.GRID2.ENABLED=.F.
     THISFORM.PAGEFRAME1.PAGE2.CRCY.VISIBLE=.T.
     THISFORM.PAGEFRAME1.PAGE2.CRCY.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
     IF AREA1='E02'
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS    
        THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.F. 
     ELSE
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS     
     ENDIF   
     LOCK()
     IF !RLOCK()
        DO file_impact
        return
     endif
  endproc 
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK
     if messagebox('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	      
        SELE E10   
        LOCK()
        IF RLOCK()
           DELE
           unlock
           SKIP -1
           IF BOF()
             GO TOP
           ENDIF   
           THISFORM.GRID2.SETFOCUS
           IF THISFORM.GRID2.ACTIVEROW=0
              THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
              THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
              THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
              THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
              THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
              THISFORM.TRN_BOTT.ENABLED=.F.              
              THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX') 
              THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=''
              THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
              THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''              
              THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=''
              THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
              THISFORM.PAGEFRAME1.PAGE2.LBLF111.CAPTION=''                                         
              THISFORM.PAGEFRAME1.PAGE2.LBLF051.CAPTION=''              
           ELSE
              THISFORM.CMDGROUP.ENABLED=.T.
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限        
              THISFORM.TRN_BOTT.ENABLED=!E10.F12
           ENDIF
        ELSE
          DO file_impact    
        ENDIF          
     ENDIF        
  ENDPROC     
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
    DO CASE
       CASE AREA1='E02'
            IF SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE;
            +ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),'E05')=.F. 
               =MESSAGEBOX('BOM或標準工時資料中無此紀錄!',0+64,'提示訊息視窗')
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
               RETURN
            ELSE
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE   
            ENDIF   
       CASE AREA1='E05'
            IF SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE,'E02')=.F. 
               =MESSAGEBOX('廠商基本主檔無此編號請先建立!',0+64,'提示訊息視窗')
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
               RETURN
            ELSE
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE    
            ENDIF
    ENDCASE          
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE<=0
         =MESSAGEBOX('發包單與及購置單價不能兩者都小於或等於 0')
           THISFORM.PAGEFRAME1.PAGE2.TXTF07.SETFOCUS
           RETURN
    ENDIF 
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE <=0
         =MESSAGEBOX('加工基量必須大於 0 !',0+48,'請修正!')
         THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
         RETURN
     ENDIF
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE<=0
         =MESSAGEBOX('發包基量必須大於 0 !',0+48,'請修正!')
         THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
         RETURN
     ENDIF     
     IF THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE%THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE<>0 AND E00.F05<>'4'
         =MESSAGEBOX('發包基量必須為加工基量的倍數!',0+48,'請修正!')    
         THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
         RETURN
     ENDIF       
    SELE E10
    APPEND BLANK
    LOCK()
    IF RLOCK()
       REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE
       REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE       
       IF AREA1='E02'
            REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
            REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
        ELSE
            REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
            REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE                                        
        ENDIF    
       REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.CRCY.DISPLAYVALUE
       REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE
       REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
       REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE
       REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
       REPLACE F11 WITH DTCX(DATE())+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
       REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE    
       REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE   
    ENDIF
    UNLOCK
    IF AREA1='E02'
       SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE;
       +THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE+DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)
    ELSE
       SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE;
       +THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE+DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)
    ENDIF   
    THISFORM.grid2.ENABLED=.T.    
    THISFORM.grid2.SETFOCUS        
    THISFORM.ORPGROUP.NEW_BOTT.CLICK            
  ENDPROC
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
    IF AREA1='E02'
            IF SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE;
            +ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),'E05')=.F. 
               =MESSAGEBOX('BOM或標準工時資料中無此紀錄!',0+64,'提示訊息視窗')
               THISFORM.PAGEFRAME1.PAGE2.TXTF04.SETFOCUS
               RETURN
            ELSE    
                  THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
         ENDIF     
	    ELSE
            IF SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE,'E02')=.F. 
               =MESSAGEBOX('廠商基本主檔無此編號請先建立!',0+48,'提示訊息視窗')
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
               RETURN
            ELSE
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE    
            ENDIF    
    ENDIF      
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE<=0
         =MESSAGEBOX('發包單價與購置單價不能兩者都小於或等於 0',0+48,'提示訊息視窗')
           THISFORM.PAGEFRAME1.PAGE2.TXTF07.SETFOCUS
           RETURN
    ENDIF     
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE<=0
         =MESSAGEBOX('加工基量必須大於 0 !',0+48,'請修正!')
         THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
         RETURN
     ENDIF
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE<=0
         =MESSAGEBOX('發包基量必須大於 0 !',0+48,'請修正!')
         THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
         RETURN
     ENDIF          
     IF THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE%THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE<>0 AND E00.F05<>'4'
         =MESSAGEBOX('發包基量必須為加工基量的倍數!',0+48,'請修正!')    
         THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
         RETURN
     ENDIF           
    SELE E10
    IF RLOCK()
       REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE
       REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
       REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
       REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
       REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
       REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE
       REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
       REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE
       REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
       REPLACE F11 WITH DTCX(DATE())+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       REPLACE F12 WITH .F.
       REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
       REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
       REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE       
    ELSE
      DO file_impact
      return   
    ENDIF   
    
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC   
  procedure SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限
     THISFORM.TRN_BOTT.ENABLED=!E10.F12      
      THISFORM.PAGEFRAME1.PAGE2.CRCY.VISIBLE=.F.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.PAGEFRAME1.PAGE2.TXTF01.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.T.
      UNLOCK ALL
      SELE E10
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.grid2.ENABLED=.T.
      THISFORM.grid2.SETFOCUS
      UNLOCK ALL
  ENDPROC
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
       SELE E10
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
    PROCEDURE TRN_BOTT.CLICK
     THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
     THISFORM.GRID2.ENABLED=.F.
     SELE E10
     RLOCK()
     IF RLOCK()     
          IF AREA1='E02'
              SELE E05       
              SEEK E10.F03+E10.F04+E10.F05
              IF FOUND()
                  RLOCK()
                  IF RLOCK()
                      REPLACE F11 WITH E10.F07*IIF(SEEK(E10.F06,'D00'),D00.F02,1)
                      REPLACE F12 WITH E10.F14*IIF(SEEK(E10.F06,'D00'),D00.F02,1)
                      REPLACE F04 WITH DTCX(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
                      UNLOCK
                   ELSE
                      DO file_impact
                      UNLOCK ALL
                      return
                   ENDIF
                   SELE E10
                   REPLACE F12 WITH .T.     
                   UNLOCK                          
              ELSE     
                   K=0
                   SEEK E10.F03+E10.F04
                   IF FOUND()
                       
                       DO WHILE F01+F02=E10.F03+E10.F04
                              K=K+(IIF(F09=0,1,F09)*F99+F10)
                              SKIP
                       ENDDO   
                       IF K<>0
                          SEEK E10.F03+E10.F04
                          DO WHILE F01+F02=E10.F03+E10.F04
                              REPLACE F11 WITH E10.F07*IIF(SEEK(E10.F06,'D00'),D00.F02,1)*(IIF(F09=0,1,F09)*F99+F10)/K/F99
                              REPLACE F12 WITH E10.F14*IIF(SEEK(E10.F06,'D00'),D00.F02,1)*(IIF(F09=0,1,F09)*F99+F10)/K/F99
                              REPLACE F04 WITH DTCX(DATE())+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                          
                              SKIP
                          ENDDO
                       ENDIF                                                                     
                   ENDIF
                   SELE E10
                   REPLACE F12 WITH IIF(K=0,.F.,.T.)   
                   UNLOCK       
             ENDIF          
          ELSE
              REPLACE F12 WITH .T.
              UNLOCK
              SELECT E05
              RLOCK()
              IF RLOCK()
                      REPLACE F11 WITH E10.F07*IIF(SEEK(E10.F06,'D00'),D00.F02,1)
                      REPLACE F12 WITH E10.F14*IIF(SEEK(E10.F06,'D00'),D00.F02,1)
                      REPLACE F04 WITH DTCX(DATE())+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
                      UNLOCK              
              ELSE
                   DO file_impact
                   unlock all
                    return              
              ENDIF
          ENDIF    
    ELSE
       DO file_impact
       unlock all
       return
    endif  
    SELECT E10
    IF F12=.F.
       MESSAGEBOX('可能在系統F01 BOM建立中此筆資料未確認故無法轉單價!',0+48,'請確認BOM後再確認單價')
    ENDIF
    THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
    THISFORM.GRID2.ENABLED=.T.
    THISFORM.GRID2.SETFOCUS  
  ENDPROC           
ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
  IF AREA1='E02'  
     LK=E02.F01   
     SELECT E10.F01,;
                    E10.F02,;
                    E10.F03,;          
                    E10.F04,;
                    E10.F05,;
                    E10.F06,;
                    E10.F07,;       
                    E10.F08,;
                    E10.F09,;
                    E10.F10,;                       
                    E10.F13,;         
                    E10.F14,;   
                    E10.F15,;
                    B01.F02,;
                    E02.F03;
     FROM E10,B01,E02;
     WHERE E10.F01=LK AND E02.F01=LK AND B01.F01=E10.F03 ORDER BY E10.F03,E10.F04,E10.F05,E10.F02 NOWAIT
     IF _tally >0
        REPORT FORM ALLTRIM(INT_116)+'E15A' TO PRINT PROMPT PREVIEW 
     ENDIF
  ELSE
     LK=E05.F01+E05.F02+E05.F07
     SELECT E10.F01,;
                    E10.F02,;
                    E10.F03,;                              
                    E10.F04,;
                    E10.F05,;
                    E10.F06,;
                    E10.F07,;       
                    E10.F08,;
                    E10.F09,;
                    E10.F10,;                       
                    E10.F13,;      
                    E10.F14,;
                    E10.F15,;      
                    B01.F02,;
                    E00.F04,;
                    E02.F03;
     FROM E10,B01,E00,E02; 
     WHERE E10.F03+E10.F04+E10.F05=LK AND B01.F01=E10.F03  AND E00.F01=E10.F05 AND E02.F01=E10.F01 ORDER BY E10.F01,E10.F02 NOWAIT
     IF _tally >0
        REPORT FORM ALLTRIM(INT_116)+'E15B' TO PRINT PROMPT PREVIEW
     ENDIF  
  ENDIF             
ENDPROC

************************************************特殊輸入欄位的設定----料號
DEFINE CLASS TXTF03 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=20
  FONTSIZE=INT_015*9
  PROCEDURE INTERACTIVECHANGE
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT E05.F01,E05.F02,E05.F07,E05.F99,E00.F04 FROM E05,E00 INTO CURSOR TSR ORDER BY E05.F01,E05.F02 WHERE  LEFT(E05.F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) AND E00.F01=E05.F07 
       ELSE
          SELECT E05.F01,E05.F02,E05.F07,E05.F99,E00.F04 FROM E05,E00 INTO CURSOR TSR ORDER BY E05.F01,E05.F02 WHERE E00.F01=E05.F07
       ENDIF
       IF _TALLY>0   
          FLG='0'        
          CHK_STR=''
          FTR_STR=''
          UKEF=0       
          TSR_SEEK=createobject("TSR_SEEK")  
          TSR_SEEK.SHOW    
          THIS.VALUE=FLG
          THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=CHK_STR
          THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=FTR_STR
          THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=UKEF
          THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=UKEF          
          THIS.REFRESH
       ENDIF   
    ENDIF  
       THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=IIF(SEEK(THIS.VALUE,'B01'),B01.F02,'')  
       THISFORM.PAGEFRAME1.PAGE2.LBLF051.CAPTION=IIF(SEEK(FTR_STR,'E00'),E00.F04,'')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.REFRESH       
       THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=IIF(SEEK(THIS.VALUE,'B01'),B01.F28,'')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=IIF(SEEK(THIS.VALUE+CHK_STR+FTR_STR,'E05'),E05.F13,'')
          FLG='0'        
          CHK_STR=''
          FTR_STR=''
          UKEF=0         
  ENDPROC

ENDDEFINE
***************************************************特殊輸入欄位設定-----------廠商
DEFINE CLASS TXTF01 AS TEXTBOX
  FONTSIZE=INT_015*9
  READONLY=.T.
  MAXLENGTH=5
  PROCEDURE INTERACTIVECHANGE
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F02,F01,F04 FROM E02 INTO CURSOR VDR ORDER BY F02 WHERE LEFT(F02,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1)
       ELSE
          SELECT F02,F01,F04 FROM E02 INTO CURSOR VDR ORDER BY F02 
       ENDIF   
       IF _TALLY>0
          VDR_SEEK=createobject("VDR_SEEK")  
          VDR_SEEK.SHOW    
          THIS.VALUE=FLG
          THIS.REFRESH
          FLG='0'        
       ENDIF   
    ENDIF  
       THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=IIF(SEEK(THIS.VALUE,'E02'),E02.F04,'')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=IIF(SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'E05'),E05.F07,'')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.REFRESH       
  ENDPROC
ENDDEFINE
***************************************************幣別設定
DEFINE CLASS CRCY AS COMBOBOX
  HEIGHT=INT_015*25
  FONTSIZE=INT_015*9  
  AUTOSIZE=.T.
  TOP=INT_015*60
  LEFT=INT_015*65
  BOUNDCOLUMN=1
  COLUMNCOUNT=1
  WIDTH=INT_015*60
  ROWSOURCETYPE=1
  STYLE=2
  NAME='CRCY'
  PROCEDURE INIT
    SELECT D00
    GO TOP 
    DO WHILE .NOT. EOF()
       L=4-LEN(ALLTRIM(F01))
       THIS.ADDITEM(F01)
       SKIP
    ENDDO
    THIS.DISPLAYVALUE=D00.F01
  ENDPROC  
  PROCEDURE INTERACTIVECHANGE
    THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=THIS.DISPLAYVALUE
  ENDPROC  
ENDDEFINE      
************************************************特殊輸入欄位的設定----製程輸入
DEFINE CLASS TXTF05 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=4
  FONTSIZE=INT_015*9
  TOP=INT_015*60
  HEIGHT=INT_015*25
  PROCEDURE INTERACTIVECHANGE
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT E05.F07,E00.F04 FROM E05,E00 INTO CURSOR RTE ORDER BY E05.F06 WHERE  LEFT(E05.F07,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) AND E05.F01+E05.F02=THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE AND E00.F01=E05.F07
       ELSE
          SELECT E05.F07,E00.F04 FROM E05,E00 INTO CURSOR RTE ORDER BY E05.F06 WHERE E05.F01=THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE AND E00.F01=E05.F07
       ENDIF        
       IF _TALLY>0
          RTE_SEEK=createobject("RTE_SEEK")  
          RTE_SEEK.SHOW    
          THIS.VALUE=FLG
          THIS.REFRESH
          FLG='0'               
       ENDIF    
    ENDIF  
    THISFORM.PAGEFRAME1.PAGE2.LBLF051.CAPTION=IIF(SEEK(THIS.VALUE,'E00'),E00.F04,'')   
    THISFORM.PAGEFRAME1.PAGE2.TXTF13.LEFT=INT_015*65+IIF(E00.F05='4',20,0)
    THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE+THIS.Value,'E05'),E05.F99,1)
  ENDPROC
ENDDEFINE
**********************************************************製品料號搜尋畫面
define class TSR_SEEK as form
  autocenter=.t.
  caption='製品料號製程一纜表'
  fontsize=INT_015*9
  HEIGHT=INT_015*280
  WIDTH=INT_015*447
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  showwindow=1
  windowtype=1
  name='TSR_SEEK'
  add object GRID1 as GRID with;          
      AUTOCENTER=.T.,;
      top=0,;
      WIDTH=INT_015*447,;      
      HEIGHT=INT_015*250,;  
      ROWHEIGHT=INT_015*18,;
      HEADERHEIGHT=INT_015*19,;
      ALLOWCELLSELECTION=.F.,;
      deletemark=.f.,;
      READONLY=.T.,;
      recordsourcetype=1,;
      columncount=5,;            
      RECORDSOURCE='TSR',;      
      NAME='GRID1',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2' ,;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5'
  add object cmnd1 as commandbutton with;
      autosize=.t.,;
      left=INT_015*20,;    
      HEIGHT=INT_015*25,;   
      top=INT_015*252,;  
      WIDTH=INT_015*80,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='harrow.cur',;        
      caption='\<S.選取',;
      TOOLTIPTEXT='選擇游標所指的紀錄!快速鍵->ALT+S'
      name='cmnd1'
  add object cmnd2 as commandbutton with;
      autosize=.t.,;
      left=INT_015*130,;
      top=INT_015*252,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*80,;
      FONTSIZE=INT_015*9,;     
      MOUSEPOINTER=99,;
      MOUSEICON='harrow.cur',;         
      caption='\<C.取消',;
      TOOLTIPTEXT='取消此搜尋畫面!快速鍵->ALT+C'
      name='cmnd2'
      procedure init 
         THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
         THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')      
         THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料      號'
         THISFORM.GRID1.COLUMN1.WIDTH=INT_015*168
         THISFORM.GRID1.COLUMN1.CONTROLSOURCE='TSR.F01'
         THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='版次'
         THISFORM.GRID1.COLUMN2.WIDTH=INT_015*25
         THISFORM.GRID1.COLUMN2.CONTROLSOURCE='TSR.F02'
         THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='製程編號'
         THISFORM.GRID1.COLUMN3.CONTROLSOURCE='TSR.F07'
         THISFORM.GRID1.COLUMN3.WIDTH=INT_015*65
         THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='製程名稱'
         THISFORM.GRID1.COLUMN4.CONTROLSOURCE='TSR.F04'
         THISFORM.GRID1.COLUMN4.WIDTH=INT_015*65
         THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='加工基量'
         THISFORM.GRID1.COLUMN5.CONTROLSOURCE='TSR.F99'
         THISFORM.GRID1.COLUMN5.WIDTH=INT_015*60
         THISFORM.GRID1.SETFOCUS
         IF THISFORM.GRID1.ACTIVEROW<>0
              THISFORM.GRID1.AFTERROWCOLCHANGE 
         ENDIF       
      ENDPROC
      PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS XColIndex
       FLG=TSR.F01
       CHK_STR=TSR.F02
       FTR_STR=TSR.F07
       UKEF=TSR.F99
      ENDPROC 
      procedure cmnd1.click                               
          SELE TSR
          USE     
          THISFORM.RELEASE 
      endproc
      procedure cmnd2.click
          FLG=''   
          CHK_STR=''
          FTR_STR=''
          UKEF=''
          SELE TSR
          USE               
          thisform.release
      endproc
 
enddefine   