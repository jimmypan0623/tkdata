******C23.PACKING LIST
CLOSE ALL
CLEAR 
PO_NO=''
FLG='0'
FCH=''
CHK=''
CHK1=''
R=0
MTH_STR=''
ENDN='' &&截止箱號
*********
AREA1='C28'
AREA2='C29'
HD1='C023 '
HD2='CE'
HD3='PACKING LIST'
IF ! USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
GSYS=IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
GEMAL=IIF(SEEK(SYS_OPER,'A01'),A01.F10,'')
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021
SEEK SYS_OPER+'C23'
GL=F04
GM=F05
GN=F06
GP=F07
IF !USED('A09')
   SELE 0
   USE A09
ELSE
   SELE A09
ENDIF
SET ORDER TO 1
A24='A24'+LEFT(DTOS(DATE()),6)
IF !USED('&A24')
   SELE 0
   USE (A24) ALIA A24
ELSE
   SELE A24
ENDIF
SET ORDER TO 1     
IF !USED('A26')
   SELE 0
   USE A26 INDE A26
ELSE
   SELE A26
ENDIF
SET ORDER TO 1  
IF !USED('B01')
   SELE 0
   USE B01 
ELSE
   SELE B01
ENDIF
SET ORDER TO B011
IF !USED('C00')
   SELE 0
   USE C00
ELSE
   SELE C00
ENDIF
SET ORDER TO 1
IF !USED('C01')
   SELE 0
   USE C01  
ELSE 
   SELE C01
ENDIF
SET ORDER TO C011
IF !USED('C04')
   SELE 0
   USE C04 
ELSE
   SELE C04
ENDIF
SET ORDER TO C041
IF !USED('C20')
    SELE 0
    USE C20
ELSE 
   SELE C20
ENDIF
SET ORDER TO C201
IF !USED('C24')
    SELE 0
    USE C24
ELSE 
   SELE C24
ENDIF
SET ORDER TO C242
IF !USED('C28')
    SELE 0
    USE C28
ELSE 
   SELE C28
ENDIF
SET ORDER TO C281
IF !USED('C29')
    SELE 0
    USE C29
ELSE 
   SELE C29
ENDIF
SET ORDER TO C291     
**************************
C23FORM=CREATEOBJECT("TKC23")
C23FORM.SHOW  
DEFINE CLASS TKC23 AS FORM
  CAPTION='C23.PICKING LIST'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKC23'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT LBL_REC AS LBL_REC WITH;
      AUTOCENTER =.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*285,;
      FONTSIZE=INT_015*9,;
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='表頭資料',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='表身詳細資料內容'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=3,;            
      RECORDSOURCE='C28',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3'
  ADD OBJECT GRID2 AS GRID2 WITH;
      TOP=INT_015*285,;
      HEIGHT=INT_015*233,;
      COLUMNCOUNT=9,;            
      RECORDSOURCE='C29',; 
      LINKMASTER='C28',;
      RELATIONALEXPR='F01',;
      CHILDORDER='C291',;  
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9'
   ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.              
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOSIZE=.T.              
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*252,;
      LEFT=INT_015*600       
 ADD OBJECT XLS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*155,;
      HEIGHT=INT_015*25,;
      FONTSIZE=INT_015*9,;      
      WIDTH=INT_015*70,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;         
      CAPTION='轉EXCEL檔',;
      TOOLTIPTEXT='將此張出貨單轉入EXCEL檔',;
      NAME='XLS_BOTT'                               
***************************PAGEFRAME1.PAGE1
PROCEDURE PAGEFRAME1.PAGE1.INIT   
  THIS.ADDOBJECT('LBLF01','LABEL')&&PACKING LIST
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*8
          .TOP=INT_015*8
          .WIDTH=INT_015*80
          .CAPTION='PACKING'          
     ENDWITH
  THIS.ADDOBJECT('TXTF01','TEXTBOX')     
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*2
          .WIDTH=INT_015*85
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH
THIS.ADDOBJECT('LBLF04','LABEL')&&出貨單號'
     WITH THIS.LBLF04
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*33
          .WIDTH=INT_015*50
          .CAPTION='出貨單號'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF04','TXTF04')     
     WITH THIS.TXTF04
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*27
          .WIDTH=INT_015*85
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH     
 THIS.ADDOBJECT('LBLF03','LABEL')&&客戶編號
     WITH THIS.LBLF03
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*58
          .WIDTH=INT_015*50
          .CAPTION='客戶編號'          
     ENDWITH
   THIS.ADDOBJECT('LBLF031','LABEL')
     WITH THIS.LBLF031
          .VISIBLE=.T.
          .LEFT=INT_015*113
          .TOP=INT_015*58
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH
  THIS.ADDOBJECT('TXTF03','TXTF03')     
     WITH THIS.TXTF03
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*52
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=5
     ENDWITH         
 THIS.ADDOBJECT('LBLF05','LABEL')&&公司名稱A
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*83
          .WIDTH=INT_015*50
          .CAPTION='公司名稱'          
     ENDWITH
  THIS.ADDOBJECT('TXTF05','TEXTBOX')     
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*77
          .WIDTH=INT_015*460
          .HEIGHT=INT_015*25
          .MAXLENGTH=80
     ENDWITH
  THIS.ADDOBJECT('TXTF18','TEXTBOX')     &&公司名稱B
     WITH THIS.TXTF18
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*102
          .WIDTH=INT_015*460
          .HEIGHT=INT_015*25
          .MAXLENGTH=80
     ENDWITH     
 THIS.ADDOBJECT('LBLF06','LABEL')&&英文送貨地址A
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*133
          .WIDTH=INT_015*50
          .CAPTION='送貨地址'          
     ENDWITH
  THIS.ADDOBJECT('TXTF06','TEXTBOX')     
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*127
          .WIDTH=INT_015*460
          .HEIGHT=INT_015*25
          .MAXLENGTH=100
     ENDWITH
  THIS.ADDOBJECT('TXTF17','TEXTBOX') &&英文送貨地址B    
     WITH THIS.TXTF17
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*152
          .WIDTH=INT_015*460
          .HEIGHT=INT_015*25
          .MAXLENGTH=100
     ENDWITH     
 THIS.ADDOBJECT('LBLF08','LABEL')&&備註資料一
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*183
          .WIDTH=INT_015*50
          .CAPTION='備  註  一'          
     ENDWITH
  THIS.ADDOBJECT('TXTF08','TEXTBOX')     
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*177
          .WIDTH=INT_015*430
          .HEIGHT=INT_015*25
          .MAXLENGTH=120
     ENDWITH
THIS.ADDOBJECT('LBLF16','LABEL')&&備註資料二
     WITH THIS.LBLF16
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*208
          .WIDTH=INT_015*50
          .CAPTION='備  註  二'          
     ENDWITH
  THIS.ADDOBJECT('TXTF16','TEXTBOX')     
     WITH THIS.TXTF16
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*202
          .WIDTH=INT_015*430
          .HEIGHT=INT_015*25
          .MAXLENGTH=120
     ENDWITH     
 THIS.ADDOBJECT('LBLF13','LABEL')&&FROM
     WITH THIS.LBLF13
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*233
          .WIDTH=INT_015*35
          .CAPTION='FROM'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF13','TEXTBOX')     
     WITH THIS.TXTF13
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*227
          .WIDTH=INT_015*160
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH
  THIS.ADDOBJECT('FROM13','FROM13')
       WITH THIS.FROM13
          .VISIBLE=.F.
          .LEFT=INT_015*60
          .TOP=INT_015*227
          .WIDTH=INT_015*160
          .HEIGHT=INT_015*25
     ENDWITH                      
  THIS.ADDOBJECT('LBLF14','LABEL')&&TO
     WITH THIS.LBLF14
          .VISIBLE=.T.
          .LEFT=INT_015*222
          .TOP=INT_015*233
          .WIDTH=INT_015*17
          .CAPTION='TO'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF14','TEXTBOX')     
     WITH THIS.TXTF14
          .VISIBLE=.T.
          .LEFT=INT_015*239
          .TOP=INT_015*227
          .WIDTH=INT_015*116
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH     
THIS.ADDOBJECT('LBLF02','LABEL')&&日        期
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*210
          .TOP=INT_015*8
          .WIDTH=INT_015*50
          .CAPTION='日        期'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF02','TEXTBOX')     
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*2
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH                   
THIS.ADDOBJECT('LBLF07','LABEL')&&交貨日期'
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*210
          .TOP=INT_015*33
          .WIDTH=INT_015*50
          .CAPTION='交貨日期'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF07','TEXTBOX')     
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*27
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH
THIS.ADDOBJECT('LBLF12','LABEL')&&裝箱尺寸
     WITH THIS.LBLF12
          .VISIBLE=.T.
          .LEFT=INT_015*210
          .TOP=INT_015*58
          .WIDTH=INT_015*50
          .CAPTION='裝箱尺寸'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF12','TEXTBOX')     
     WITH THIS.TXTF12
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*52
          .WIDTH=INT_015*120
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH            
THIS.ADDOBJECT('LBLF09','LABEL')&&賣頭
     WITH THIS.LBLF09
          .VISIBLE=.T.
          .LEFT=INT_015*390
          .TOP=INT_015*8
          .WIDTH=INT_015*50
          .CAPTION='賣        頭'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF09','TEXTBOX')     
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .LEFT=INT_015*440
          .TOP=INT_015*2
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .MAXLENGTH=15
     ENDWITH
 THIS.ADDOBJECT('LBLF10','LABEL')&&製造地
     WITH THIS.LBLF10
          .VISIBLE=.T.
          .LEFT=INT_015*390
          .TOP=INT_015*33
          .WIDTH=INT_015*50
          .CAPTION='製  造  地'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF10','TEXTBOX')     
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .LEFT=INT_015*440
          .TOP=INT_015*27
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .MAXLENGTH=15
     ENDWITH
 THIS.ADDOBJECT('LBLF11','LABEL')&&C/NO
     WITH THIS.LBLF11
          .VISIBLE=.T.
          .LEFT=INT_015*390
          .TOP=INT_015*58
          .WIDTH=INT_015*50
          .CAPTION='     C/NO'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF11','TEXTBOX')     
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .LEFT=INT_015*440
          .TOP=INT_015*52
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .MAXLENGTH=15
     ENDWITH                        
 THIS.ADDOBJECT('LBLF15','LABEL')&&安全資料'
     WITH THIS.LBLF15
          .VISIBLE=.T.
          .LEFT=INT_015*375
          .TOP=INT_015*233
          .WIDTH=INT_015*50
          .CAPTION='安全資料'          
     ENDWITH
 THIS.ADDOBJECT('LBLF151','LABEL')
     WITH THIS.LBLF151
          .VISIBLE=.T.
          .LEFT=INT_015*425
          .TOP=INT_015*233
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH                                            
***********************PAGEFRAME1.PAGE2                  
PROCEDURE PAGEFRAME1.PAGE2.INIT
 THIS.ADDOBJECT('LBLF02','LABEL')&&品        號
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*11
          .WIDTH=INT_015*50
          .CAPTION='品        號'          
     ENDWITH
THIS.ADDOBJECT('TXTF02','TXTF02')          
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*5
          .WIDTH=INT_015*261
          .HEIGHT=INT_015*25
          .MAXLENGTH=43
ENDWITH
THIS.ADDOBJECT('LBLF021','LABEL')
     WITH THIS.LBLF021
          .VISIBLE=.T.
          .LEFT=INT_015*337
          .TOP=INT_015*11
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH            
THIS.ADDOBJECT('LBLF09','LABEL')&&單裝合計數量
     WITH THIS.LBLF09
         .VISIBLE=.T.
         .LEFT=INT_015*10
         .TOP=INT_015*36
         .WIDTH=INT_015*50
         .CAPTION='數        量'
ENDWITH
THIS.ADDOBJECT('TXTF09','TXTF0I')          
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*30
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .MAXLENGTH=11
ENDWITH
THIS.ADDOBJECT('LBLF04','LABEL')&&包裝量
     WITH THIS.LBLF04
         .VISIBLE=.T.
         .LEFT=INT_015*10
         .TOP=INT_015*61
         .WIDTH=INT_015*50
         .CAPTION='包  裝  量'
ENDWITH
THIS.ADDOBJECT('TXTF04','TXTF0D')          
     WITH THIS.TXTF04
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*55
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .MAXLENGTH=11
ENDWITH      
THIS.ADDOBJECT('LBLF05','LABEL')&&毛重    
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*86
          .WIDTH=INT_015*50  
          .CAPTION='毛        重'
ENDWITH            
THIS.ADDOBJECT('TXTF05','TXTF0E')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*80
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .INPUTMASK='9999.999'
          .MAXLENGTH=9
ENDWITH
THIS.ADDOBJECT('LBLF10','LABEL')&&總毛重    
     WITH THIS.LBLF10
          .VISIBLE=.T.
          .LEFT=INT_015*150
          .TOP=INT_015*86
          .WIDTH=INT_015*50  
          .CAPTION='總  毛  重'
ENDWITH            
THIS.ADDOBJECT('TXTF10','TEXTBOX')          
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*80
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .INPUTMASK='99999.999'
          .MAXLENGTH=10
ENDWITH
THIS.ADDOBJECT('LBLF06','LABEL')&&淨重
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*111
          .WIDTH=INT_015*50
          .CAPTION='淨        重'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF06','TXTF0F')     
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*105
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .INPUTMASK='9999.999'
          .MAXLENGTH=9
     ENDWITH
 THIS.ADDOBJECT('LBLF11','LABEL')&&總淨重
     WITH THIS.LBLF11
          .VISIBLE=.T.
          .LEFT=INT_015*150
          .TOP=INT_015*111
          .WIDTH=INT_015*50
          .CAPTION='總  淨  重'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF11','TEXTBOX')     
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*105
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .INPUTMASK='99999.999'
          .MAXLENGTH=10
     ENDWITH
THIS.ADDOBJECT('LBLF08','LABEL')&&起始箱號
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*10
          .TOP=INT_015*136
          .WIDTH=INT_015*50
          .CAPTION='箱        號'          
     ENDWITH    
 THIS.ADDOBJECT('TXTF08','TEXTBOX')     
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*130
          .WIDTH=INT_015*35
          .HEIGHT=INT_015*25
          .INPUTMASK='9999'
          .MAXLENGTH=4
     ENDWITH 
  THIS.ADDOBJECT('LBLF081','LABEL')&&截止箱號
     WITH THIS.LBLF081
          .VISIBLE=.T.
          .LEFT=INT_015*97
          .TOP=INT_015*136
          .WIDTH=INT_015*12
          .CAPTION='至'          
     ENDWITH   
  THIS.ADDOBJECT('TXTF081','TEXTBOX')     
     WITH THIS.TXTF081
          .VISIBLE=.T.
          .LEFT=INT_015*116
          .TOP=INT_015*130
          .WIDTH=INT_015*35
          .HEIGHT=INT_015*25
           .INPUTMASK='9999'
          .MAXLENGTH=4
     ENDWITH     
THIS.ADDOBJECT('LBLF12','LABEL')&&客戶品號
     WITH THIS.LBLF12
         .VISIBLE=.T.
         .LEFT=INT_015*10
         .TOP=INT_015*161
         .WIDTH=INT_015*50
         .CAPTION='客戶品號'
ENDWITH
THIS.ADDOBJECT('TXTF12','TEXTBOX')          
     WITH THIS.TXTF12
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*155
          .WIDTH=INT_015*240
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
ENDWITH 
THIS.ADDOBJECT('LBLF19','LABEL')&&客戶品號
     WITH THIS.LBLF19
         .VISIBLE=.T.
         .LEFT=INT_015*350
         .TOP=INT_015*161
         .WIDTH=INT_015*50
         .CAPTION='其他序號'
ENDWITH
THIS.ADDOBJECT('TXTF19','TEXTBOX')          
     WITH THIS.TXTF19
          .VISIBLE=.T.
          .LEFT=INT_015*400
          .TOP=INT_015*155
          .WIDTH=INT_015*120
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
ENDWITH 
THIS.ADDOBJECT('LBLF13','LABEL')&&客  戶 P/O
     WITH THIS.LBLF13
         .VISIBLE=.T.
         .LEFT=INT_015*10
         .TOP=INT_015*186
         .WIDTH=INT_015*50
         .CAPTION='客 戶P/O'
ENDWITH
THIS.ADDOBJECT('TXTF13','TEXTBOX')          
     WITH THIS.TXTF13
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*180
          .WIDTH=INT_015*120
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
ENDWITH
THIS.ADDOBJECT('LBLF07','LABEL')&&單價
     WITH THIS.LBLF07
         .VISIBLE=.T.
         .LEFT=INT_015*10
         .TOP=INT_015*211
         .WIDTH=INT_015*50
         .CAPTION='單        價'
ENDWITH
THIS.ADDOBJECT('TXTF07','TEXTBOX')          
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*205
          .WIDTH=INT_015*80
          .HEIGHT=INT_015*25
          .INPUTMASK='9999999.999999'
ENDWITH
THIS.ADDOBJECT('LBLF15','LABEL')&&產地
     WITH THIS.LBLF15
         .VISIBLE=.T.
         .LEFT=INT_015*10
         .TOP=INT_015*236
         .WIDTH=INT_015*50
         .CAPTION='產        地'
ENDWITH
THIS.ADDOBJECT('TXTF15','TEXTBOX')          
     WITH THIS.TXTF15
          .VISIBLE=.T.
          .LEFT=INT_015*60
          .TOP=INT_015*230
          .WIDTH=INT_015*120
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
ENDWITH
THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
          .VISIBLE=.T.
          .LEFT=INT_015*385
          .TOP=INT_015*230
          .WIDTH=INT_015*50
          .CAPTION='安全資料'          
     ENDWITH
 THIS.ADDOBJECT('LBLF141','LABEL')
     WITH THIS.LBLF141
          .VISIBLE=.T.
          .LEFT=INT_015*435
          .TOP=INT_015*230
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH                                               
ENDPROC 
******************設定PAGE1之動態動作******************        
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
     R=0
     SELECT C28       
     IF THISFORM.SHRGROUP.VISIBLE=.F.
         THISFORM.GRID1.ENABLED=.T.   
        THISFORM.GRID1.SETFOCUS 
         THISFORM.KEY_LIST.ENABLED=.T.
     ELSE
        THISFORM.KEY_LIST.ENABLED=.F.   
     ENDIF          
   IF  THISFORM.GRID1.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.LBLF031.CAPTION=''
       THISFORM.PAGEFRAME1.PAGE1.LBLF151.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.  
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限 
        THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T. 
     ENDIF
    THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GP='*',.T.,.F.)
 ENDPROC
*****************設定PAGE2之動態動作****************** 
 PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
      SELE C29   
     IF THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.GRID2.READONLY=.T.     
        THISFORM.GRID2.SETFOCUS   
     ENDIF 
     IF THISFORM.GRID2.ACTIVEROW=0  .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION='' 
       THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.LBLF141.CAPTION=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=''
    ELSE 
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限 
	THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
     ENDIF   
     R=RECNO('&AREA1')
     THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
     THISFORM.GRID1.ENABLED=.F.     
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)   &&判斷有無新增的權限
     THISFORM.KEY_LIST.ENABLED=.F. 
  ENDPROC 
 ******************屬性設定******************
  PROC INIT
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9    
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)   &&判斷有無新增的權限
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(RECCOUNT('C28')=0,.F.,IIF(GM='*',.T.,.F.))  &&判斷有無修改的權限
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(RECCOUNT('C28')=0,.F.,IIF(GP='*',.T.,.F.))  &&判斷有無列印的權限       
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')       
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')          
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='PACKING單號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='出貨單號'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C28.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C28.F03'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C28.F04'
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='品號'  
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='數量'
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='包裝量'
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='毛重'
       THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='總毛重'
       THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='淨重'
       THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='總淨重'
       THISFORM.GRID2.COLUMN8.HEADER1.CAPTION='箱號'
       THISFORM.GRID2.COLUMN9.HEADER1.CAPTION='客戶品號'
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='C29.F02'
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE='C29.F09'
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE='C29.F04'
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE='C29.F05'
       THISFORM.GRID2.COLUMN5.CONTROLSOURCE='C29.F10'
       THISFORM.GRID2.COLUMN6.CONTROLSOURCE='C29.F06'
       THISFORM.GRID2.COLUMN7.CONTROLSOURCE='C29.F11'
       THISFORM.GRID2.COLUMN8.CONTROLSOURCE='C29.F08'
       THISFORM.GRID2.COLUMN9.CONTROLSOURCE='C29.F12'
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*130
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*70
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN5.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN6.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN7.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN8.WIDTH=INT_015*60
       THISFORM.GRID2.COLUMN9.WIDTH=INT_015*200
       THISFORM.GRID1.READONLY=.T.      
       THISFORM.GRID2.READONLY=.T.            
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
            THISFORM.CMDGROUP.ENABLED=.F.
            THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
       ELSE
             THISFORM.CMDGROUP.ENABLED=.T. 
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限 
             THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限      
       ENDIF          
       THISFORM.KEY_LIST.DISPLAYVALUE='依PACKING單號排列'       
       JK='PACKING單號'
       SELE C28
*!*	       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C28.F01
       *GO TOP
       GO BOTTOM
  ENDPROC            
***************GRID1動態改變*********
 PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX 
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C28.F01
       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=C28.F02
       THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE=C28.F03
       THISFORM.PAGEFRAME1.PAGE1.LBLF031.CAPTION=IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE),'C01'),C01.F05,'')
       THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=C28.F04
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=C28.F05
       THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=C28.F06
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=C28.F07
       THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=C28.F08
       THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE=C28.F09
       THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=C28.F10
       THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=C28.F11
       THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=C28.F12
       THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE=C28.F13
       THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE=C28.F14
       THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE=C28.F16
       THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE=C28.F17
       THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=C28.F18
       THISFORM.PAGEFRAME1.PAGE1.LBLF151.CAPTION=C28.F15
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       IF THIS.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 
       ENDIF   
       CHK=''
*!*	       THISFORM.REFRESH
  ENDPROC     
***************GRID2動態改變*************** 
PROC GRID2.AFTERROWCOLCHANGE
      LPARAMETERS NCOLINDEXIIF
       THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=C29.F02
       THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=C29.F16
       THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=C29.F04
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=C29.F05
       THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=C29.F10
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=C29.F06
       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=C29.F11
       THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=IIF(AT("-",C29.F08)<>0,LEFT(C29.F08,AT("-",C29.F08)-1),C29.F08)
       THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE=IIF(AT("-",C29.F08)<>0,RIGHT(C29.F08,LEN(C29.F08)-AT("-",C29.F08)),'')
       THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=C29.F09
       THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=C29.F12
       THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=C29.F13
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=C29.F07
       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=C29.F15
       THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE=C29.F19
       THISFORM.PAGEFRAME1.PAGE2.LBLF141.CAPTION=C29.F14
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
          THISFORM. CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ENDIF
*!*	       THISFORM.REFRESH   
  ENDPROC 
**************************************            
 PROC KEY_LIST.INIT 
       WITH THIS
           .ADDITEM('依PACKING單號排列') 
           .ADDITEM('依客戶編號排列')
           .ADDITEM('依出貨單號排列')
       ENDWITH      
  ENDPROC  
****************************  
PROC KEY_LIST.INTERACTIVECHANGE                 
  SELE C28
       DO CASE
          CASE THIS.DISPLAYVALUE='依PACKING單號排列'
                SET ORDER TO C281
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='PACKING單號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C28.F01'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C28.F03'
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='出貨單號'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C28.F04'
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80                       
       	  CASE THIS.DISPLAYVALUE='依客戶編號排列'
                SET ORDER TO C282
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C28.F03'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='PACKING單號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C28.F01'
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='出貨單號'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C28.F04'
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80                 
       	  CASE THIS.DISPLAYVALUE='依出貨單號排列'
                SET ORDER TO C283
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='出貨單號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C28.F04'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='PACKING單號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C28.F01'
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN3.CONTROLSOURCE='C28.F03'
               THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50             
       	ENDCASE
       	THISFORM.GRID1.SETFOCUS     
  ENDPROC
**************新增鍵******************  
PROCEDURE ORPGROUP.NEW_BOTT.CLICK 
     THISFORM.KEY_LIST.ENABLED=.F.
   IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
       THISFORM.GRID2.RECORDSOURCE=''   &&處理表頭新增
       THISFORM.GRID2.CHILDORDER=''
        THISFORM.GRID1.ENABLED=.F.   
        THISFORM.GRID2.ENABLED=.F.    
       THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX')  
       THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
          HD='C023 '+SUBSTR(DTOS(DATE()),3,4)
          DO ODR_CRT
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=PO_NO
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.REFRESH    		    
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.READONLY=.T.		                          
       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=DATE()
       THISFORM.PAGEFRAME1.PAGE1.TXTF03.READONLY=.F.
       THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.LBLF031.CAPTION=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF04.READONLY=.F.
       THISFORM.PAGEFRAME1.PAGE1.TXTF04.SETFOCUS
       THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=DATE()
       THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE='TOK'
       THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE='TAIWAN'
       THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF13.VISIBLE=.F.
       THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE=THISFORM.PAGEFRAME1.PAGE1.FROM13.DISPLAYVALUE
       THISFORM.PAGEFRAME1.PAGE1.FROM13.VISIBLE=.T.
       THISFORM.PAGEFRAME1.PAGE1.FROM13.VALUE=1
       THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.LBLF151.CAPTION=''
    ELSE
    	THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.              &&處理表身新增
        THISFORM.GRID2.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF02.READONLY=.F.
        THISFORM.PAGEFRAME1.PAGE2.TXTF02.SETFOCUS 
        THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.F.
        THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=INT(VAL(''))
        THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.F.
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=INT(VAL(''))
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF06.READONLY=.F.
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=INT(VAL(''))
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=''
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE=''
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF09.READONLY=.F.
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=INT(VAL(''))
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=INT(VAL(''))
 	    THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=INT(VAL(''))
        THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=0
        THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF141.CAPTION=''
    ENDIF  
ENDPROC 
***********************新增之確認******************** 
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
    THISFORM.GRID2.RECORDSOURCE='C29'
    THISFORM.GRID2.CHILDORDER='C291'
    THISFORM.GRID2.COLUMN1.CONTROLSOURCE='C29.F02'
    THISFORM.GRID2.COLUMN2.CONTROLSOURCE='C29.F09'
    THISFORM.GRID2.COLUMN3.CONTROLSOURCE='C29.F04'
    THISFORM.GRID2.COLUMN4.CONTROLSOURCE='C29.F05'
    THISFORM.GRID2.COLUMN5.CONTROLSOURCE='C29.F10'
    THISFORM.GRID2.COLUMN6.CONTROLSOURCE='C29.F06'
    THISFORM.GRID2.COLUMN7.CONTROLSOURCE='C29.F11'
    THISFORM.GRID2.COLUMN8.CONTROLSOURCE='C29.F08'
    THISFORM.GRID2.COLUMN9.CONTROLSOURCE='C29.F12'
    SELECT C28
    COD=SYS(21)
    SET ORDER TO C281
    IF SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'C28')=.T.&&若有發生單號重複
       SELECT MAX(F01) FROM C28 INTO ARRAY GB NOWAIT
       HD='C023 '+SUBSTR(DTOS(DATE()),3,4)+THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
       DO ODR_RPT
		      THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=PO_NO
		      THISFORM.PAGEFRAME1.PAGE1.TXTF01.REFRESH                                        
      ENDIF      
      IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE,'C01')=.F. .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE)
  	   =MESSAGEBOX('客戶基本主檔中無此編號請先建立!',0+64,'提示訊息視窗')
  	   THISFORM.PAGEFRAME1.PAGE1.TXTF03.SETFOCUS
  	   THISFORM.GRID2.RECORDSOURCE=''  
   	   THISFORM.GRID2.CHILDORDER=''
  	   SET ORDER TO &COD
  	   RETURN       		
      ENDIF  
 ****   
  IF   LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE),2)='BC'  .AND.  LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE))=10
          S1='20'+SUBSTR(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE),3,2)&&B04檔名之年份
     	  S2=SUBSTR(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE),5,2)&&B04檔名之月份
     	  B04='B04'+S1+S2 &&出貨單
	  IF FILE(B04+'.DBF')=.T.
       	      IF USED('&B04')
                  SELE B04
              ELSE
                  SELE 2 
                  USE (B04) ALIA B04
              ENDIF
              SET ORDER TO 1
           ELSE
	      =MESSAGEBOX('無'+S1+'年'+S2+'月份之出貨單,請查明後再輸入!',0+64,'提示訊息視窗')
	      THISFORM.PAGEFRAME1.PAGE1.TXTF04.SETFOCUS
              THISFORM.GRID2.RECORDSOURCE=''  
       	      THISFORM.GRID2.CHILDORDER=''
	      RETURN
           ENDIF
              SELECT C28
              SET ORDER TO C283
              IF  SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE),'C28')=.T. &&判斷此出貨單號是否已重複開單過
                    =MESSAGEBOX('此出貨單號已開過PACKING LIST請重新確認!',0+48,'提示訊息視窗')
		   THISFORM.PAGEFRAME1.PAGE1.TXTF04.SETFOCUS
		   THISFORM.GRID2.RECORDSOURCE=''  
	       	   THISFORM.GRID2.CHILDORDER=''
	       	   SELE C28
	       	   SET ORDER TO C281
	       	   SELE B04
	       	   USE
                   RETURN
             ENDIF 
              IF SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE),'B04')=.F. &&判斷此出貨單號是否存在
                   MESSAGEBOX('查無此出貨單號!',0+48,'提示訊息視窗')
		   THISFORM.PAGEFRAME1.PAGE1.TXTF04.SETFOCUS
		   THISFORM.GRID2.RECORDSOURCE=''  
	       	   THISFORM.GRID2.CHILDORDER=''
	       	   SELE C28
	       	   SET ORDER TO C281
	       	   SELE B04
	       	   USE
                   RETURN
             ENDIF
             IF IIF(SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE,'B04'),B04.F06,'')<>THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE  &&判斷該出貨單之客戶編號是否為該INVOICE之客戶編號
	            =MESSAGEBOX('您所輸入的客戶編號,與此出貨單之客戶編號不符!',0+48,'提示訊息視窗')
		    THISFORM.PAGEFRAME1.PAGE1.TXTF03.SETFOCUS
		    THISFORM.GRID2.RECORDSOURCE=''  
	       	    THISFORM.GRID2.CHILDORDER=''
	       	    SELE C28
	       	    SET ORDER TO C281
	       	    SELE B04
	       	    USE
	            RETURN
            ENDIF
             SELECT F01,F03,F04,F06,F07 FROM B04 WHERE F01=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE)  INTO CURSOR B04A
             SELECT B04A
             GO TOP
             SELECT  F03,SUM(F04),F07 FROM B04A ORDER BY F03 GROUP BY F03 INTO CURSOR C29_1 &&將相同料號之數量作匯總
             SELECT C29_1
             GO TOP
             DO WHILE !EOF()
                    PW=IIF(SEEK(C29_1.F03,'C20'),C20.F11,0) &&包裝量
	            GW=IIF(SEEK(C29_1.F03,'C20'),C20.F13,0) &&毛重
	            NW=IIF(SEEK(C29_1.F03,'C20'),C20.F14,0) &&淨重
	            PN=IIF(PW<=0 .OR. PW>=C29_1.SUM_F04,'1',ALLTRIM(STR(INT(C29_1.SUM_F04/PW))))&&單裝箱數
              	    STARN=ALLTRIM(STR(1+VAL(ENDN))) &&開始箱號
		    ENDN=ALLTRIM(STR(VAL(PN)+VAL(ENDN))) &&結束箱號
	            SELECT C29	
	            APPEND BLANK
	            REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
	            REPLACE F02 WITH C29_1.F03 &&品號
	            
	            REPLACE F03 WITH C29_1.SUM_F04 &&出貨總數量	
	            REPLACE F04 WITH PW &&包裝量
	            REPLACE F05 WITH GW &&毛重
	            REPLACE F06 WITH NW&&淨重
*!*			    REPLACE F07 WITH ALLTRIM(STR(VAL(ENDN)-VAL(STARN)+1)) &&起使箱號
	            REPLACE F08 WITH IIF(PW>=C29_1.SUM_F04 .OR. PW<=0,STARN,IIF(INT(C29_1.SUM_F04/PW)=1,PADL(STARN,3,' '),PADL(STARN,3,' ')+'-'+PADL(ENDN,3,' '))) &&截止箱號
	            REPLACE F09 WITH IIF(PW>=C29_1.SUM_F04 .OR. PW<=0,C29_1.SUM_F04,PW*INT(C29_1.SUM_F04/PW)) &&合計數量
	            REPLACE F10 WITH IIF(PW>C29_1.SUM_F04 .AND. PW>0,(GW/PW)*C29_1.SUM_F04,IIF(PW<=0,0,GW*INT(C29_1.SUM_F04/PW))) &&合計毛重
	            REPLACE F11 WITH IIF(PW>C29_1.SUM_F04 .AND. PW>0,(NW/PW)*C29_1.SUM_F04,IIF(PW<=0,0,NW*INT(C29_1.SUM_F04/PW))) &&合計淨重
	            REPLACE F12 WITH  IIF(SEEK(C29_1.F07+C29_1.F03,'C04'),C04.F17,'')  &&客戶品號
	            REPLACE F14 WITH DTCX(DATE())+GSYS
	            REPLACE F16 WITH IIF(SEEK(C29_1.F07+C29_1.F03,'C04'),C04.F25,IIF(SEEK(C29_1.F03,'B01'),B01.F02,''))  &&客戶指定品名規格
		         ****************混裝數量
		    IF  IIF(PW!=0 .AND. PW<C29_1.SUM_F04 .AND. PW>0,IIF(MOD(C29_1.SUM_F04,PW)!=0,.T.,.F.),.F.)
	       		 PN='1' 
			 STARN=ALLTRIM(STR(1+VAL(ENDN)))
			 ENDN=ALLTRIM(STR(VAL(PN)+VAL(ENDN)))
	                 APPEND BLANK
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
		         REPLACE F02 WITH C29_1.F03 &&品號
		         REPLACE F16 WITH IIF(SEEK(C29_1.F03,'B01','B011'),B01.F02,'')
		         REPLACE F03 WITH C29_1.SUM_F04&&出貨總數量
		         REPLACE F04 WITH PW &&包裝量
		         REPLACE F05 WITH GW &&毛重
		         REPLACE F06 WITH NW&&淨重
*!*						 REPLACE F07 WITH ALLTRIM(STR(VAL(ENDN)-VAL(STARN)+1)) &&總箱數
		         REPLACE F08 WITH PADL(STARN,3,' ') &&起止箱號
		         REPLACE F09 WITH C29_1.SUM_F04-(PW*INT(C29_1.SUM_F04/PW)) &&合計數量
		         REPLACE F10 WITH (GW/PW)*(C29_1.SUM_F04-(PW*INT(C29_1.SUM_F04/PW))) &&合計毛重
		         REPLACE F11 WITH (NW/PW)*(C29_1.SUM_F04-(PW*INT(C29_1.SUM_F04/PW)))&&合計淨重
		         REPLACE F12 WITH IIF(SEEK(C29_1.F07+C29_1.F03,'C04'),C04.F17,'')  &&客戶品號
		         REPLACE F14 WITH DTCX(DATE())+GSYS
		         REPLACE F16 WITH IIF(SEEK(C29_1.F07+C29_1.F03,'C04'),C04.F25,IIF(SEEK(C29_1.F03,'B01'),B01.F02,''))  &&客戶指定品名規格
		         
	          ENDIF
		  SELECT C29_1
	   	  SKIP
	    ENDDO
	    SELE C28
   	    APPEND BLANK
   	    LOCK()
            IF  RLOCK()			&&寫入至表頭C28
                 REPLACE F01 WITH PO_NO
                 REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
                 REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE
                 REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
    	         REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
    	         REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE
    	         REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
    	         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
    	         REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE
    	         REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE
    	         REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE
    	         REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE
    	         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE
    	         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE
    	         REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE
    	         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE
    	         REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE
    	         REPLACE F15 WITH DTCX(DATE())+GSYS
    	    ENDIF
	   UNLOCK
	   SELECT B04 
	   USE 
	   SELE C28
	   SET ORDER TO C281  
	   THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
   	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F. 
   	   THISFORM.ORPGROUP.NEW_BOTT.CLICK
   	   THISFORM.REFRESH
     ELSE  &&出貨單號為空白或非出貨單號之編號  
            SELE C28
   	    APPEND BLANK
   	    LOCK()
	    IF  RLOCK()			&&寫入至表頭C28
	        REPLACE F01 WITH PO_NO
                REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
                REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE
                REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
    	        REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
    	        REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE
    	        REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
    	        REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
    	        REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE
    	        REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE
    	        REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE
    	        REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE
    	        REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE
    	        REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE
    	        REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE
    	        REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE
    	        REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE
    	        REPLACE F15 WITH DTCX(DATE())+GSYS
            ENDIF
     	    UNLOCK
            THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
            THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.  
            THISFORM.PAGEFRAME1.ACTIVEPAGE=2
            THISFORM.ORPGROUP.NEW_BOTT.CLICK
   	    THISFORM.REFRESH
     ENDIF
  *********** 	   
   ELSE &&表身新增
     	  IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)     
                       =MESSAGEBOX('料品編號不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF02.SETFOCUS
                      RETURN  
          ENDIF
         IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)     
                       =MESSAGEBOX('數量不得為零!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF09.SETFOCUS
                      RETURN  
          ENDIF  
          IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE)     
                       =MESSAGEBOX('總毛重不得為零!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
                      RETURN  
          ENDIF
          IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)     
                       =MESSAGEBOX('總數量不得為零!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
                      RETURN  
          ENDIF
         IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)     
                       =MESSAGEBOX('起始箱號不得為零!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
                      RETURN  
          ENDIF
          IF !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE)     
             IF PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE),4,' ')<PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE),4,' ')
                 =MESSAGEBOX('截止箱號不得小於起始箱號!',0+64,'提示視窗')
      		    THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
                RETURN  
             ENDIF   
          ENDIF          
  	      SELE C29 &&表身新增
          APPEND BLANK
          LOCK()
          IF RLOCK()
              BW=THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE &&數量(含單箱合計數量)
              PW= THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE &&包裝量
              NW=THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE &&淨重
              GW=THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE &&毛重
              REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
              REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE
              REPLACE F03 WITH BW
              REPLACE F04 WITH PW
              REPLACE F05 WITH GW
              REPLACE F06 WITH NW
 	          REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE
              REPLACE F08 WITH IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE),PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE),4,' '),PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE),4,' ')+'-'+PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE),4,' ')) &&起止箱號
              REPLACE F09 WITH BW &&合計數量
              REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE &&合計毛重
	         REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE &&合計淨重
*!*	              REPLACE F09 WITH IIF(PW>=BW .OR. PW<=0,BW,PW*INT(BW/PW)) &&合計數量
*!*	              REPLACE F10 WITH IIF(PW>=BW .AND. PW>0,(GW/PW)*BW,IIF(PW<=0,0,GW*INT(BW/PW))) &&合計毛重
*!*		      REPLACE F11 WITH IIF(PW>=BW .AND. PW>0,(NW/PW)*BW,IIF(PW<=0,0,NW*INT(BW/PW))) &&合計淨重
              REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE &&客戶品號
              REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
              REPLACE F14 WITH DTCX(DATE())+GSYS
              REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE
              REPLACE F19 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE
              REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION
   	      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
   	      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T. 
              THISFORM.ORPGROUP.NEW_BOTT.CLICK
              THISFORM.REFRESH
              UNLOCK
         ENDIF  
          UNLOCK
   ENDIF         
 ENDPROC
 *****************修改***********
PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
    THISFORM.KEY_LIST.ENABLED=.F.
    THISFORM.GRID1.ENABLED=.F. 
    THISFORM.GRID2.ENABLED=.F. 
     IF    THISFORM.PAGEFRAME1.ACTIVEPAGE=1
     	    THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
	    THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX')
	    THISFORM.PAGEFRAME1.PAGE1.TXTF01.READONLY=.T.
	    THISFORM.PAGEFRAME1.PAGE1.TXTF03.READONLY=.F.
	    THISFORM.PAGEFRAME1.PAGE1.TXTF03.SETFOCUS
	    THISFORM.PAGEFRAME1.PAGE1.LBLF031.CAPTION=IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE),'C01'),C01.F05,'')
	    THISFORM.PAGEFRAME1.PAGE1.TXTF04.READONLY=.F.
	    THISFORM.PAGEFRAME1.PAGE1.TXTF13.VISIBLE=.F.
	    THISFORM.PAGEFRAME1.PAGE1.FROM13.VISIBLE=.T.
            THISFORM.PAGEFRAME1.PAGE1.FROM13.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE     
	    THISFORM.PAGEFRAME1.PAGE1.LBLF151.CAPTION=''
	    LOCK()
	    IF !RLOCK()
	         DO FILE_IMPACT
	         RETURN
	    ENDIF 
   ELSE
    	THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
        THISFORM.PAGEFRAME1.PAGE2.TXTF02.READONLY=.T.
        THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.F.
        THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.F.
        THISFORM.PAGEFRAME1.PAGE2.TXTF06.READONLY=.F.
        THISFORM.PAGEFRAME1.PAGE2.TXTF09.READONLY=.F.
*!*	        THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
*!*	        THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.T.
*!*	        THISFORM.PAGEFRAME1.PAGE2.TXTF06.READONLY=.T.
*!*	        THISFORM.PAGEFRAME1.PAGE2.TXTF09.READONLY=.T.
    	 LOCK()     
         IF !RLOCK()
              DO FILE_IMPACT
              RETURN
         ENDIF          
   ENDIF                  	                  	                                               	                            
 ENDPROC 
 *****************修改之確認***********
 PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK 
 IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
      SELECT C28&&表頭修改確認
      IF  RLOCK() 
           IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE,'C01')=.F. .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE)
	  	=MESSAGEBOX('客戶基本主檔中無此編號請先建立!',0+64,'提示訊息視窗')
	  	THISFORM.PAGEFRAME1.PAGE1.TXTF03.SETFOCUS
	        THISFORM.GRID2.RECORDSOURCE=''  
	        THISFORM.GRID2.CHILDORDER=''
	        SET ORDER TO &COD
	        RETURN       		
           ENDIF  
	  REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
	  REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE
	  REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
	  REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
	  REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE
	  REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
	  REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
	  REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE
	  REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE
	  REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE
	  REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE
	  REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.FROM13.DISPLAYVALUE
	  REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE
	  REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE
	  REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE
	  REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE
	  REPLACE F15 WITH DTCX(DATE())+GSYS
     ELSE 
         DO     FILE_IMPACT
         RETURN
      ENDIF
  ELSE        &&表身修改確認
         IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)     
            =MESSAGEBOX('起始箱號不得為零!',0+64,'提示視窗')
      		THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
            RETURN  
          ENDIF  
        IF !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE)     
           IF PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE),4,' ')<PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE),4,' ')
              =MESSAGEBOX('截止箱號不得小於起始箱號!',0+64,'提示視窗')
      		    THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
               RETURN  
            ENDIF   
         ENDIF          
       SELE C29   
      IF  RLOCK()
       	   REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE	    
       	   REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE	    
       	   REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE	    
       	   REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE
           REPLACE F08 WITH IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE),PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE),4,' '),PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE),4,' ')+'-'+PADL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE),4,' ')) &&起止箱號
           REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE
           REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
	       REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
           REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE 
           REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
           REPLACE F14 WITH DTCX(DATE())+GSYS
           REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE 
           REPLACE F19 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE 
       ELSE 
           DO FILE_IMPACT
           RETURN
       ENDIF
  ENDIF    	      
 THISFORM.SHRGROUP.ABANDON_BOTT.CLICK   
ENDPROC             	             
 *****************刪除***********
PROCEDURE ORPGROUP.DEL_BOTT.CLICK
 IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1     
    IF MESSAGEBOX('是否確定要刪除此筆之所有資料',4+32+256,'請確認')=6
       IF ALIA()='C28'           &&刪除整張訂單
           SELECT C28
	   LOCK()
	   IF  RLOCK()
	        PO_NO=ALLTRIM(C28.F01)
	        DELETE FROM C29 WHERE PO_NO=C29.F01
      	        DELE
                UNLOCK
                SKIP -1
                IF BOF()
                    GO TOP
                ENDIF
                UNLOCK ALL
                IF INT_099=.T. .AND. SUBSTR(PO_NO,3,4)=SUBSTR(DTOS(DATE()),3,4)
                    HD='C023 '+SUBSTR(DTOS(DATE()),3,4)+PO_NO
                    DO ODR_RJT
                 ENDIF  
          ELSE
                 DO FILE_IMPACT                  
          ENDIF
          THISFORM.GRID1.SETFOCUS
          IF  THISFORM.GRID1.ACTIVEROW=0
                THISFORM.SETALL('VALUE','','TEXTBOX')
                THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
                THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
                THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
                THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
                THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
                THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
                THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
         ELSE
                THISFORM.CMDGROUP.ENABLED=.T. 
                THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
                THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限 
                THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限     
        ENDIF
     ENDIF
   ENDIF
  ELSE
    IF  MESSAGEBOX('是否確定要刪除此料品編號之所有資料',4+32+256,'請確認')=6 
        SELE C29 
        LOCK()
        IF  RLOCK()
             DELE
             UNLOCK
             SKIP -1
             IF   BOF()
                   GO TOP
             ENDIF
        ELSE
            DO FILE_IMPACT    
        ENDIF         
        THISFORM.GRID2.SETFOCUS
        IF THISFORM.GRID2.ACTIVEROW=0
             THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
             THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
             THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
             THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
             THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        ELSE
             THISFORM.CMDGROUP.ENABLED=.T. 
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
             THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限
        ENDIF
     ENDIF           
  ENDIF    
ENDPROC 
**************************放棄***************
PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)   &&判斷有無新增的權限
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(RECCOUNT('C28')=0,.F.,IIF(GM='*',.T.,.F.))  &&判斷有無修改的權限
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(RECCOUNT('C28')=0,.F.,IIF(GP='*',.T.,.F.))  &&判斷有無列印的權限
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE1.TXTF03.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE1.TXTF04.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE1.FROM13.VISIBLE=.F.
      THISFORM.PAGEFRAME1.PAGE1.TXTF13.VISIBLE=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF02.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF02.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF09.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF09.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF06.READONLY=.T.
    IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
           THISFORM.GRID1.ENABLED=.T.
           THISFORM.GRID2.ENABLED=.T. 
           THISFORM.GRID1.SETFOCUS
           THISFORM.KEY_LIST.ENABLED=.T.
           THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T. 
      ELSE
           THISFORM.GRID1.ENABLED=.F.
           THISFORM.GRID2.ENABLED=.T.
           THISFORM.GRID2.SETFOCUS
           THISFORM.GRID1.READONLY=.T.   
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T. 
            IF THISFORM.GRID2.ACTIVEROW=0
               HD='C023 '+SUBSTR(DTOS(DATE()),3,4)+PO_NO
               DO ODR_RJT
                 SELE C28              
                 DELE
                 SKIP -1
                 IF BOF()
                     GO TOP
                 ENDIF               
	         THISFORM.PAGEFRAME1.ACTIVEPAGE=1
	         THISFORM.REFRESH
          ENDIF   
      ENDIF    
    UNLOCK ALL
 ENDPROC
 ***************************完成***********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
      IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
           IF THISFORM.GRID2.RECORDSOURCE<>'C29'
	       THISFORM.GRID2.RECORDSOURCE='C29'
	       THISFORM.GRID2.CHILDORDER='C291'
	       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='C29.F02'
	       THISFORM.GRID2.COLUMN2.CONTROLSOURCE='C29.F09'
	       THISFORM.GRID2.COLUMN3.CONTROLSOURCE='C29.F04'
	       THISFORM.GRID2.COLUMN4.CONTROLSOURCE='C29.F05'
	       THISFORM.GRID2.COLUMN5.CONTROLSOURCE='C29.F10'
	       THISFORM.GRID2.COLUMN6.CONTROLSOURCE='C29.F06'
	       THISFORM.GRID2.COLUMN7.CONTROLSOURCE='C29.F11'
	       THISFORM.GRID2.COLUMN8.CONTROLSOURCE='C29.F08'
	       THISFORM.GRID2.COLUMN9.CONTROLSOURCE='C29.F12'
	   ENDIF     
            HD='C023 '+SUBSTR(DTOS(DATE()),3,4)+PO_NO
            DO ODR_RJT
            SELE C28
            DO CASE 
                  CASE THISFORM.KEY_LIST.DISPLAYVALUE='依PACKING單號排列'
                             SET ORDER TO C281
	          CASE THISFORM.KEY_LIST.DISPLAYVALUE='依客戶編號排列'
	                     SET ORDER TO C282
	          CASE THISFORM.KEY_LIST.DISPLAYVALUE='依出貨單號排列'
	                     SET ORDER TO C283
            ENDCASE   
     ENDIF  
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC 
  PROCEDURE XLS_BOTT.CLICK
       EXCL_CHK=CREATEOBJECT("EXCL_CHK")  
       EXCL_CHK.SHOW    
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
          SELECT C28
          THISFORM.GRID1.SETFOCUS
       ELSE
         SELECT C29
         THISFORM.GRID2.SETFOCUS
       ENDIF
  
  ENDPROC  
  
ENDDEFINE  
 *************************************************************列印
PROCEDURE PNT_PRC
  BK=''
  PACKNUM=''
  LK=C28.F01  
  IF SEEK(C28.F04,'C24')
      IF MESSAGEBOX('INVOICE表身中的其他備註是否一起列出',4+32+256,'請確認')=6
         BK='A'
      ENDIF
  ENDIF
 
  IF MESSAGEBOX('客戶品號是否要一併列出',4+32+256,'請確認')=6
   	 CHK1='1'
  ELSE
  	 CHK1=''
  ENDIF 		
  SELECT  *  FROM C29 ORDER BY F08 WHERE C29.F01=LK NOWAIT INTO CURSOR C29AB
    IF _TALLY >0
       SELECT C29AB
       GO BOTTOM 
       PACKNUM=IIF(EMPTY(RIGHT(F08,4)),LEFT(F08,4),RIGHT(F08,4))

     REPORT FORM ALLTRIM(INT_116)+'C23'+BK TO PRINT PROMPT PREVIEW
     SELECT C29AB
     USE
  ENDIF
ENDPROC
***************************************************出貨處(FROM)設定
DEFINE CLASS FROM13 AS COMBOBOX
  HEIGHT=INT_015*25
 WIDTH=INT_015*140
  TOP=INT_015*84
  LEFT=INT_015*418
  FONTSIZE=INT_015*9
  BOUNDCOLUMN=1
  COLUMNCOUNT=1
  WIDTH=INT_015*84
  ROWSOURCETYPE=1
  STYLE=0
  NAME='FROM13'
  ROWSOURCE=ALLTRIM(INT_162)
PROCEDURE INTERACTIVECHANGE
    THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE=THIS.DISPLAYVALUE
    THISFORM.PAGEFRAME1.PAGE1.TXTF13.REFRESH
 ENDPROC
ENDDEFINE
*********************出貨單號
DEFINE CLASS TXTF04 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=10
  FONTSIZE=INT_015*9  
  PROCEDURE INTERACTIVECHANGE 
    IF  LEFT(ALLTRIM(THIS.VALUE),2)='BC' AND LEN(ALLTRIM(THIS.VALUE))=10
    	 THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=THIS.VALUE
    ENDIF
    IF  LEFT(ALLTRIM(THIS.VALUE),2)!='BC' AND LEN(ALLTRIM(THIS.VALUE))=8
    	 THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE='BC'+ALLTRIM(THIS.VALUE)
   ENDIF 	 
   ENDPROC
ENDDEFINE
***************************************************特殊輸入欄位設定-----------客戶或廠商
DEFINE CLASS TXTF03 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=5
  FONTSIZE=INT_015*9  
  PROCEDURE INTERACTIVECHANGE
    IF AT('?',ALLTRIM(THIS.VALUE))<>0 
       IF AT('?',ALLTRIM(THIS.VALUE))>1          
          IF EMPTY(A02.F12)
             SELECT F02,F01,F04 FROM C01 INTO CURSOR VDR ORDER BY F02 WHERE LEFT(F02,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) &&AND F18=SYS_OPER
          ELSE
             SELECT F02,F01,F04 FROM C01 INTO CURSOR VDR ORDER BY F02 WHERE LEFT(F02,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1)
          ENDIF
       ELSE
          IF EMPTY(A02.F12)
             SELECT F02,F01,F04 FROM C01 INTO CURSOR VDR ORDER BY F02 &&WHERE F18=SYS_OPER   
          ELSE   
            SELECT F02,F01,F04 FROM C01 INTO CURSOR VDR ORDER BY F02 
          ENDIF   
       ENDIF          
       VDR_SEEK=CREATEOBJECT("VDR_SEEK")  
       VDR_SEEK.SHOW  
       THIS.VALUE=FLG
       THIS.REFRESH
       FLG='0'        
    ELSE
       IF LEN(ALLTRIM(THIS.VALUE))=4
          SELECT F02,F01,F04 FROM C01 INTO CURSOR VDR ORDER BY F02 WHERE F02=ALLTRIM(THIS.VALUE)
          DO CASE
             CASE _TALLY=1
                  THIS.VALUE=VDR.F01
                  THIS.REFRESH
             CASE _TALLY>1
                  VDR_SEEK=CREATEOBJECT("VDR_SEEK")  
                  VDR_SEEK.SHOW    
                  THIS.VALUE=FLG
                  THIS.REFRESH
                  FLG='0'        
          ENDCASE      
       ENDIF
    ENDIF      
     THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=IIF(SEEK(ALLTRIM(THIS.VALUE),'C01'),IIF(EMPTY(C01.F08),C01.F07,C01.F08),'')  
     THISFORM.PAGEFRAME1.PAGE1.TXTF06.REFRESH
     THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE=IIF(SEEK(ALLTRIM(THIS.VALUE),'C01'),C01.F34,'')  
     THISFORM.PAGEFRAME1.PAGE1.TXTF17.REFRESH
     THISFORM.PAGEFRAME1.PAGE1.LBLF031.CAPTION=IIF(SEEK(ALLTRIM(THIS.VALUE),'C01'),C01.F05,'')
     THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=IIF(SEEK(ALLTRIM(THIS.VALUE),'C01'),IIF(EMPTY(C01.F09),C01.F04,C01.F09),'')
     THISFORM.PAGEFRAME1.PAGE1.TXTF05.REFRESH
     THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=IIF(SEEK(ALLTRIM(THIS.VALUE),'C01'),C01.F24,'')
     THISFORM.PAGEFRAME1.PAGE1.TXTF08.REFRESH     
  ENDPROC
ENDDEFINE
************************************************特殊輸入欄位的設定----料號
DEFINE CLASS TXTF02 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=20
  FONTSIZE=INT_015*9
  PROCEDURE INTERACTIVECHANGE
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F02 FROM B01 INTO CURSOR MTR ORDER BY F01 WHERE LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1)    
       ELSE
          SELECT F01,F02 FROM B01 INTO CURSOR MTR ORDER BY F01   
       ENDIF 
       IF _TALLY>0  
          MAN_SEEK=createobject("MTR_SEEK")  
          MAN_SEEK.SHOW    
          THIS.VALUE=FLG
          THIS.REFRESH
          FLG='0'        
       ENDIF    
    ENDIF  
       THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=IIF(SEEK(THIS.VALUE,'B01'),B01.F02,'')  
       IF !EMPTY(THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION)
             THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE,'C20'),C20.F11,0)
             THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE,'C20'),C20.F13,0)
             THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE,'C20'),C20.F14,0)
       ELSE      
             THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=''
             THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''
             THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''
       ENDIF    
       THISFORM.PAGEFRAME1.PAGE2.TXTF04.REFRESH
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.REFRESH
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.REFRESH
  ENDPROC
ENDDEFINE
**************************數量變動跟著變化毛淨重
DEFINE CLASS TXTF0I AS TextBox 
       READONLY=.T.             
       FONTSIZE=INT_015*9
       PROCEDURE INTERACTIVECHANGE
          IF THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE>0 AND THIS.Value>0
             THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=THIS.VALUE*THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE/THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
             THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=THIS.VALUE*THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE/THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
          ENDIF
       ENDPROC
ENDDEFINE
********************************************************&&包裝量改變
DEFINE CLASS TXTF0D AS TextBox 
       READONLY=.T.
       FONTSIZE=INT_015*9
       PROCEDURE INTERACTIVECHANGE
           IF THIS.VALUE>0 AND THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE>0
              THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE*THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE/THIS.VALUE
              THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE*THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE/THIS.VALUE
           ENDIF
       ENDPROC
ENDDEFINE
********************************************************&&單裝合計毛重
DEFINE CLASS TXTF0E AS TextBox 
       READONLY=.T.
       FONTSIZE=INT_015*9
       PROCEDURE INTERACTIVECHANGE
           IF THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE>0 AND THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE>0
              THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE*THIS.VALUE/THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
           ENDIF
       ENDPROC
ENDDEFINE
********************************************************單裝合計淨重
DEFINE CLASS TXTF0F AS TextBox
       READONLY=.T.
       FONTSIZE=INT_015*9
       PROCEDURE INTERACTIVECHANGE
           IF THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE>0 AND THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE>0
              THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE*THIS.VALUE/THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
           ENDIF
       ENDPROC
ENDDEFINE
********************************************************
DEFINE CLASS EXCL_CHK AS FORM
  AUTOCENTER=.T.
  CAPTION='請選擇轉出內容'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*110
  WIDTH=INT_015*245
  FONTSIZE=INT_015*9
  CLOSABLE=.F.
  CONTROLBOX=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='EXCL_CHK'
ADD OBJECT DATA_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*17,;
      TOP=INT_015*20,;
      AUTOSIZE=.T.,;
      FONTSIZE=INT_015*12,;
      BUTTONCOUNT=2,;
      OPTION1.CAPTION='包裝箱號排序明細資料',;
      OPTION1.TOP=INT_015*0,;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='客戶品號排序明細資料',;
      OPTION2.TOP=INT_015*40,;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.AUTOSIZE=.T.,; 
      NAME='DATA_OPTION'   
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*175,;     
      TOP=INT_015*23,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<Y.確定',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*175,;
      TOP=INT_015*61,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'     
  *****      
 PROC INIT  

 ENDPROC  
 PROCEDURE CMND1.CLICK     
     LK=C28.F01

        DO CASE
  	       CASE THISFORM.DATA_OPTION.VALUE=1   
  	            SELECT C28.F04 出貨單號,C29.F02 料品編號,C29.F08 箱號,C29.F11 淨重,C29.F10 毛重,C29.F13 客戶單號,C29.F12 客戶品號,C29.F09 數量,C29.F07 單價,C29.F15 產地;
                FROM C29,C28 WHERE C29.F01=LK AND C28.F01=LK  ORDER BY 箱號 NOWAIT 
                IF _TALLY>0
                    
	                GCDELIMFILE=PUTFILE('儲存路徑',LK,'XLS')
	                IF EMPTY(GCDELIMFILE)  && ESC PRESSED
	                   RETURN
	                ELSE
	                  ON ERROR DO FILE_IMPACT
	                  COPY TO (GCDELIMFILE) TYPE XL5
	                  =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗')
	                ENDIF                    
                ENDIF
           CASE THISFORM.DATA_OPTION.VALUE=2
		        CREATE CURSOR C23T;
		        (SPLPTN C(43), CSTNM C(15),CSTPTN C(30),SHPQTY N(12),PRICE N(12,6),CRNCY C(4),ORIGN C(4),ETA D(8),INVNO C(10),NETWGT N(11,4),GRSWGT N(11,4),CRTNQTY N(3))
		        SELECT C28.F04 出貨單號,C29.F02 料品編號,C29.F08 箱號,C29.F11 淨重,C29.F10 毛重,C29.F13 客戶單號,C29.F12 客戶品號,C29.F09 數量,C29.F07 單價,C29.F15 產地;
                FROM C29,C28 WHERE C29.F01=LK AND C28.F01=LK  ORDER BY 料品編號,客戶品號,箱號 NOWAIT INTO CURSOR C23B
                IF _TALLY>0
                   JOG=SPACE(74)
		           SELECT C23B
		           GO TOP
		           DO WHILE !EOF()
			          SELECT C23T
			          IF JOG<>C23B.料品編號+C23B.客戶品號
			              APPEND BLANK
			              REPLACE SPLPTN WITH C23B.料品編號
			              REPLACE CSTPTN WITH C23B.客戶品號
			              REPLACE INVNO WITH C23B.出貨單號		          
			              REPLACE PRICE WITH C23B.單價      
			              REPLACE ETA WITH C28.F02
			              REPLACE ORIGN WITH ICASE(AT('JAPAN',C23B.產地)>0,'JP',AT('KOREA',C23B.產地)>0,'KR',AT('INDONESIA',C23B.產地)>0,'ID',AT('CHINA',C23B.產地)>0,'CN',AT('MALAYSIA',C23B.產地)>0,'MY','TW')
			          ENDIF    
			          REPLACE SHPQTY WITH SHPQTY+C23B.數量			  
			          REPLACE NETWGT WITH NETWGT+C23B.淨重       
			          REPLACE GRSWGT WITH GRSWGT+C23B.毛重 
                      REPLACE CRTNQTY WITH CRTNQTY+IIF(EMPTY(RIGHT(C23B.箱號,3)) OR LEFT(C23B.箱號,3)=RIGHT(C23B.箱號,3),1,VAL(RIGHT(C23B.箱號,3))-VAL(LEFT(C23B.箱號,3))+1)
			          SELECT C23B
			          JOG=C23B.料品編號+C23B.客戶品號
			          SKIP
	              ENDDO
		          SELECT C23B
		          USE
		          SELECT C23T

		          	 GCDELIMFILE=PUTFILE('儲存路徑',LK,'XLS')
	                 IF EMPTY(GCDELIMFILE)  && ESC PRESSED
	                    RETURN
	                 ELSE
	                   ON ERROR DO FILE_IMPACT
	                   COPY TO (GCDELIMFILE) TYPE XL5
	                   =MESSAGEBOX('儲存成功',0+48,'提示訊息視窗')
	                 ENDIF                    
		             SELECT C23T 
		             USE

                ENDIF
        ENDCASE      
     
     
     THISFORM.RELEASE  
 ENDPROC   
 ***** 
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE 