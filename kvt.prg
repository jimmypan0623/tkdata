&&¥bºI§ì®w¦s
SET DEFAULT TO \\pdc\ctmis
SET dele on
SET excl off
CLOSE ALL 
CLEAR ALL
SELECT 0
USE B26200602 ALIAS B26
SET ORDER TO 1
SELECT 0
USE B25200602 ALIAS B25
SET ORDER TO 1
SELECT 0
USE B01
SET ORDER TO 1
SELECT F01,F02,SUM(F04) FROM B26 GROUP BY F02,F01 ORDER BY F02,F01 WHERE F03 <'25' INTO CURSOR KVT NOWAIT
CREATE CURSOR ;
OVT(F01 C(5),F02 C(35),F03 N(16,4))
INDEX ON F01+F02 TAG OVT
SET ORDER TO 1
SELECT KVT
GO TOP
DO WHILE !EOF()
       SELECT OVT
       APPEND BLANK
       REPLACE F01 WITH KVT.F02
       REPLACE F02 WITH KVT.F01
       REPLACE F03 WITH KVT.SUM_F04
       SELE KVT
       SKIP
ENDDO
SELECT B25
GO TOP
DO WHILE !EOF()
       SELECT OVT
       SEEK B25.F01+B25.F02
       IF FOUND()
            REPLACE F03 WITH F03+B25.F03
       ELSE
            APPEND BLANK
            REPLACE F01 WITH B25.F01
            REPLACE F02 WITH B25.F02
            REPLACE F03 WITH B25.F03
      ENDIF
      SELECT B25
      SKIP            
ENDDO
SELECT OVT.*,B01.F37 FROM OVT,B01 WHERE B01.F01=OVT.F02 AND OVT.F03<>0 ORDER BY OVT.F01,OVT.F02
SET DEFAULT TO c:\tkmis