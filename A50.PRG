***程式名稱:A50.公司員工基本資料
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
R=0
AREA1='A50'
AREA2='A51_A'
IF !USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'A50'       
IF !USED('A14')
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141     
IF !USED('A50')
   SELE 0
   USE A50 INDE A50
ELSE
   SELE A50
ENDIF
SELECT F01,F02 FROM A50  WHERE F07='1' INTO CURSOR A50A_TEMP
INDE ON F01 TAG A50A_TEMP1
SET ORDER TO A50A_TEMP1
SELECT A50
SET FILTER TO A50.F07<>'1'
SET ORDER TO A501 
IF !USED('A51')
   SELE 0
   USE A51 INDE A51
ELSE
   SELE A51
ENDIF
SET ORDER TO A511 
IF !USED('A52')
   SELE 0
   USE A52 INDE A52
ELSE
   SELE A52
ENDIF
SET ORDER TO A521 
******A.學歷資料
CREATE CURSOR A51_A;
(F01 C(4),F02 C(10),F03 C(40),F04 C(20),F05 D(8),F06 D(8),F07 C(1),F99 C(17))
INDE ON F01+F03 TAG A51_A1
INDE ON F02+F03 TAG A51_A2
SELECT  F01,F02,F03,F04,F05,F06,F07,F99 FROM A51 WHERE F98='A' INTO CURSOR A51_TEMP
SELECT A51_TEMP
GO TOP
DO WHILE !EOF()
       SELECT A51_A
       APPEND BLANK
       REPLACE A51_A.F01 WITH A51_TEMP.F01
       REPLACE A51_A.F02 WITH A51_TEMP.F02
       REPLACE A51_A.F03 WITH A51_TEMP.F03
       REPLACE A51_A.F04 WITH A51_TEMP.F04
       REPLACE A51_A.F05 WITH A51_TEMP.F05
       REPLACE A51_A.F06 WITH A51_TEMP.F06
       REPLACE A51_A.F07 WITH A51_TEMP.F07
       REPLACE A51_A.F99 WITH A51_TEMP.F99
       SELECT A51_TEMP
       SKIP
ENDDO
SELECT A51_A
SET ORDER TO A51_A1
SELECT A51_TEMP
USE
******B.專業技能
CREATE CURSOR A51_B;
(F01 C(4),F02 C(10),F08 C(1),F09 C(40),F10 C(1),F99 C(17))
INDE ON F01+F08+F09 TAG A51_B1
INDE ON F02+F08+F09 TAG A51_B2
SELECT  F01,F02,F08,F09,F10,F99 FROM A51 WHERE F98='B' INTO CURSOR A51_TEMP
SELECT A51_TEMP
GO TOP
DO WHILE !EOF()
       SELECT A51_B
       APPEND BLANK
       REPLACE A51_B.F01 WITH A51_TEMP.F01
       REPLACE A51_B.F02 WITH A51_TEMP.F02
       REPLACE A51_B.F08 WITH A51_TEMP.F08
       REPLACE A51_B.F09 WITH A51_TEMP.F09
       REPLACE A51_B.F10 WITH A51_TEMP.F10
       REPLACE A51_B.F99 WITH A51_TEMP.F99
       SELECT A51_TEMP
       SKIP
ENDDO
SELECT A51_B
SET ORDER TO A51_B1
SELECT A51_TEMP
USE
*******C.工作經歷
CREATE CURSOR A51_C;
(F01 C(4),F02 C(10),F11 C(40),F12 D(8),F13 D(8),F14 C(20),F15 C(50),F99 C(17))
INDE ON F01+F11 TAG A51_C1
INDE ON F02+F11 TAG A51_C2
SELECT  F01,F02,F11,F12,F13,F14,F15,F99 FROM A51 WHERE F98='C' INTO CURSOR A51_TEMP
SELECT A51_TEMP
GO TOP
DO WHILE !EOF()
       SELECT A51_C
       APPEND BLANK
       REPLACE A51_C.F01 WITH A51_TEMP.F01
       REPLACE A51_C.F02 WITH A51_TEMP.F02
       REPLACE A51_C.F11 WITH A51_TEMP.F11
       REPLACE A51_C.F12 WITH A51_TEMP.F12
       REPLACE A51_C.F13 WITH A51_TEMP.F13
       REPLACE A51_C.F14 WITH A51_TEMP.F14
       REPLACE A51_C.F15 WITH A51_TEMP.F15
       REPLACE A51_C.F99 WITH A51_TEMP.F99
       SELECT A51_TEMP
       SKIP
ENDDO
SELECT A51_C
SET ORDER TO A51_C1
SELECT A51_TEMP
USE
******D.家庭狀況
CREATE CURSOR A51_D;
(F01 C(4),F02 C(10),F16 C(10),F17 C(10),F18 N(3),F19 C(1),F20 C(20),F99 C(17))
INDE ON F01+F16+F17 TAG A51_D1
INDE ON F02+F16+F17 TAG A51_D2
SELECT  F01,F02,F16,F17,F18,F19,F20,F99 FROM A51 WHERE F98='D' INTO CURSOR A51_TEMP
SELECT A51_TEMP
GO TOP
DO WHILE !EOF()
       SELECT A51_D
       APPEND BLANK
       REPLACE A51_D.F01 WITH A51_TEMP.F01
       REPLACE A51_D.F02 WITH A51_TEMP.F02
       REPLACE A51_D.F16 WITH A51_TEMP.F16
       REPLACE A51_D.F17 WITH A51_TEMP.F17
       REPLACE A51_D.F18 WITH A51_TEMP.F18
       REPLACE A51_D.F19 WITH A51_TEMP.F19
       REPLACE A51_D.F20 WITH A51_TEMP.F20
       REPLACE A51_D.F99 WITH A51_TEMP.F99
       SELECT A51_TEMP
       SKIP
ENDDO
SELECT A51_D
SET ORDER TO A51_D1
SELECT A51_TEMP
USE
SELECT A50
GO TOP
********
A50FORM=CREATEOBJECT("TKA50")
A50FORM.SHOW  
DEFINE CLASS TKA50 AS FORM
  CAPTION='A50.公司員工基本資料'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=3 
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKA50'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.     
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*518,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='harrow.cur',;        
      PAGECOUNT=6,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='員工基本資料設定',;      
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='學歷資料',;   
      PAGE3.NAME='PAGE3',;
      PAGE3.VISIBLE=.T.,;
      PAGE3.CAPTION='專業技能',;        
      PAGE4.NAME='PAGE4',;
      PAGE4.VISIBLE=.T.,;
      PAGE4.CAPTION='工作經歷',;    
      PAGE5.NAME='PAGE5',;
      PAGE5.VISIBLE=.T.,;
      PAGE5.CAPTION='家庭狀況',;      
      PAGE6.NAME='PAGE6',;
      PAGE6.VISIBLE=.T.,;
      PAGE6.CAPTION='備註事項'               
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*215
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='A50',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=6,;            
      RECORDSOURCE='A51_A',; 
      LINKMASTER='A50',;
      RELATIONALEXPR='F01',;
      CHILDORDER='A51_A1',;  
      VISIBLE=.F.,;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
	AUTOSIZE=.T. 
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
	AUTOSIZE=.T.             
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*481,;
      LEFT=INT_015*560          
  ADD OBJECT CHANG_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*66,;      
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='harrow.cur',;        
      CAPTION='\<C.人員異動',;
      NAME='CHANG_BOTT'      
 ADD OBJECT PHOTO_BOTT AS COMMANDBUTTON WITH;
     TOP=INT_015*490,;
      LEFT=INT_015*83,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*61,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='harrow.cur',;        
      CAPTION='\<I.修改照片',;
      NAME='PHOTO_BOTT '       
ADD OBJECT IMAGE1 AS IMAGE WITH;
      LEFT=INT_015*660,;    
      TOP=INT_015*40,;
      HEIGHT=INT_015*130,;
      WIDTH=INT_015*100,;     
      STRETCH=1 
**************  A.員工基本資料設定    
 PROCEDURE PAGEFRAME1.PAGE1.INIT    
   THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*21
          .WIDTH=INT_015*50
          .CAPTION='員工編號'          
     ENDWITH
  THIS.ADDOBJECT('TXTF01','TEXTBOX')          
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*14
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
     ENDWITH         
   THIS.ADDOBJECT('LBLF02','LABEL')
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*47
          .WIDTH=INT_015*50
          .CAPTION='中文姓名' 
     ENDWITH
  THIS.ADDOBJECT('TXTF02','TEXTBOX')          
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*40
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH
   THIS.ADDOBJECT('LBLF03','LABEL')
     WITH THIS.LBLF03
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*73
          .WIDTH=INT_015*50
          .CAPTION='英文姓名' 
     ENDWITH
  THIS.ADDOBJECT('TXTF03','TEXTBOX')          
     WITH THIS.TXTF03
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*66
          .WIDTH=INT_015*110
          .HEIGHT=INT_015*25
          .MAXLENGTH=15
     ENDWITH     
   THIS.ADDOBJECT('LBLF04','LABEL')
     WITH THIS.LBLF04
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*99
          .WIDTH=INT_015*50
          .CAPTION='到職日期' 
     ENDWITH
  THIS.ADDOBJECT('TXTF04','TEXTBOX')          
     WITH THIS.TXTF04
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*92
          .WIDTH=INT_015*65
          .HEIGHT=INT_015*25
     ENDWITH   
   THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*125
          .WIDTH=INT_015*50
          .CAPTION='所屬部門' 
     ENDWITH
   THIS.ADDOBJECT('LBLF051','LABEL')
     WITH THIS.LBLF051
          .VISIBLE=.T.
          .LEFT=INT_015*125
          .TOP=INT_015*125
          .AUTOSIZE=.T.
          .CAPTION='' 
     ENDWITH     
  THIS.ADDOBJECT('TXTF05','TEXTBOX')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*118
          .WIDTH=INT_015*55
          .HEIGHT=INT_015*25
          .MAXLENGTH=5
     ENDWITH          
  THIS.ADDOBJECT('COMBOBOX05','COMBOBOX05') 
     WITH THIS.COMBOBOX05 
          .VISIBLE=.F.
          .LEFT=INT_015*64
          .TOP=INT_015*118
     ENDWITH         
   THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*151
          .WIDTH=INT_015*50
          .CAPTION='職務名稱' 
     ENDWITH  
  THIS.ADDOBJECT('TXTF06','TEXTBOX')          
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*144
          .WIDTH=INT_015*110
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH     
   THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*177
          .WIDTH=INT_015*50
          .CAPTION='任職狀況' 
     ENDWITH  
  THIS.ADDOBJECT('TXTF07','TEXTBOX')          
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*170
          .WIDTH=INT_015*110
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH       
  THIS.ADDOBJECT('COMBOBOX07','COMBOBOX07') 
     WITH THIS.COMBOBOX07 
          .VISIBLE=.F.
          .LEFT=INT_015*64
          .TOP=INT_015*170
     ENDWITH      
   THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*204
          .WIDTH=INT_015*50
          .CAPTION='異動日期' 
     ENDWITH  
  THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*197
          .WIDTH=INT_015*65
          .HEIGHT=INT_015*25
     ENDWITH
   THIS.ADDOBJECT('LBLF09','LABEL')
     WITH THIS.LBLF09
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*230
          .WIDTH=INT_015*50
          .CAPTION='雇用性質' 
     ENDWITH  
  THIS.ADDOBJECT('TXTF09','TEXTBOX')          
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*223
          .WIDTH=INT_015*65
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH     
   THIS.ADDOBJECT('LBLF11','LABEL')
     WITH THIS.LBLF11
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*256
          .WIDTH=INT_015*50
          .CAPTION='退伍日期' 
     ENDWITH  
  THIS.ADDOBJECT('TXTF11','TEXTBOX')          
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*249
          .WIDTH=INT_015*65
          .HEIGHT=INT_015*25
     ENDWITH                   
**************
   THIS.ADDOBJECT('LBLF13','LABEL')
     WITH THIS.LBLF13
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*21
          .WIDTH=INT_015*50
          .CAPTION='身份字號'          
     ENDWITH
  THIS.ADDOBJECT('TXTF13','TEXTBOX')          
     WITH THIS.TXTF13
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*14
          .WIDTH=INT_015*120
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH         
   THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*47
          .WIDTH=INT_015*50
          .CAPTION='出生日期' 
     ENDWITH
   THIS.ADDOBJECT('LBLF141','LABEL')
     WITH THIS.LBLF141
          .VISIBLE=.T.
          .LEFT=INT_015*340
          .TOP=INT_015*47
          .AUTOSIZE=.T.
          .CAPTION='' 
     ENDWITH     
  THIS.ADDOBJECT('TXTF14','TXTF14')          
     WITH THIS.TXTF14
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*40
     ENDWITH
   THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*73
          .WIDTH=INT_015*50
          .CAPTION='性        別' 
     ENDWITH
  THIS.ADDOBJECT('OPTIONGROUP15','OPTIONGROUP15')
     WITH THIS.OPTIONGROUP15
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*66
     ENDWITH         
   THIS.ADDOBJECT('LBLF16','LABEL')
     WITH THIS.LBLF16
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*99
          .AUTOSIZE=.T.
          .CAPTION='身        高                公分' 
     ENDWITH
  THIS.ADDOBJECT('TXTF16','TEXTBOX')          
     WITH THIS.TXTF16
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*92
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*25
          .INPUTMASK='999.9'
          .MAXLENGTH=5
     ENDWITH   
   THIS.ADDOBJECT('LBLF17','LABEL')
     WITH THIS.LBLF17
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*125
          .AUTOSIZE=.T.
          .CAPTION='體        重                公斤' 
     ENDWITH 
  THIS.ADDOBJECT('TXTF17','TEXTBOX')          
     WITH THIS.TXTF17
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*118
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*25
          .INPUTMASK='999.9'
          .MAXLENGTH=5
     ENDWITH          
   THIS.ADDOBJECT('LBLF18','LABEL')
     WITH THIS.LBLF18
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*151
          .WIDTH=INT_015*50
          .CAPTION='血        型' 
     ENDWITH  
  THIS.ADDOBJECT('OPTIONGROUP18','OPTIONGROUP')
     WITH THIS.OPTIONGROUP18
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*144
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*140
	  .BUTTONCOUNT=4
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP18'
	  .OPTION1.CAPTION='A'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='B'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*35
	  .OPTION2.NAME='OPTION2'         
	  .OPTION3.CAPTION='O'
	  .OPTION3.TOP=INT_015*5
	  .OPTION3.FONTSIZE=INT_015*9	  
	  .OPTION3.AUTOSIZE=.T.
	  .OPTION3.LEFT=INT_015*65
	  .OPTION3.NAME='OPTION3'  	  
	  .OPTION4.CAPTION='AB'
	  .OPTION4.TOP=INT_015*5
	  .OPTION4.FONTSIZE=INT_015*9	  
	  .OPTION4.AUTOSIZE=.T.
	  .OPTION4.LEFT=INT_015*95
	  .OPTION4.NAME='OPTION4'  	  
     ENDWITH          
   THIS.ADDOBJECT('LBLF19','LABEL')
     WITH THIS.LBLF19
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*177
          .WIDTH=INT_015*50
          .CAPTION='婚姻狀況' 
     ENDWITH  
  THIS.ADDOBJECT('OPTIONGROUP19','OPTIONGROUP')
     WITH THIS.OPTIONGROUP19
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*170
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*190
	  .BUTTONCOUNT=4
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP19'
	  .OPTION1.CAPTION='已婚'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='未婚'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*50
	  .OPTION2.NAME='OPTION2'         
	  .OPTION3.CAPTION='離婚'
	  .OPTION3.TOP=INT_015*5
	  .OPTION3.FONTSIZE=INT_015*9	  
	  .OPTION3.AUTOSIZE=.T.
	  .OPTION3.LEFT=INT_015*95
	  .OPTION3.NAME='OPTION3'  	  
	  .OPTION4.CAPTION='喪偶'
	  .OPTION4.TOP=INT_015*5
	  .OPTION4.FONTSIZE=INT_015*9	  
	  .OPTION4.AUTOSIZE=.T.
	  .OPTION4.LEFT=INT_015*140
	  .OPTION4.NAME='OPTION4'  	  
     ENDWITH         
   THIS.ADDOBJECT('LBLF20','LABEL')
     WITH THIS.LBLF20
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*204
          .WIDTH=INT_015*50
          .CAPTION='籍        貫' 
     ENDWITH  
  THIS.ADDOBJECT('TXTF20','TEXTBOX')          
     WITH THIS.TXTF20
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*197
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*25
           .MAXLENGTH=20
     ENDWITH     
   THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*230
          .WIDTH=INT_015*50
          .CAPTION='兵役狀況' 
     ENDWITH  
  THIS.ADDOBJECT('OPTIONGROUP10','OPTIONGROUP')
     WITH THIS.OPTIONGROUP10
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*223
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*140
	  .BUTTONCOUNT=3
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP10'
	  .OPTION1.CAPTION='役畢'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='未役'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*50
	  .OPTION2.NAME='OPTION2'         
	  .OPTION3.CAPTION='免役'
	  .OPTION3.TOP=INT_015*5
	  .OPTION3.FONTSIZE=INT_015*9	  
	  .OPTION3.AUTOSIZE=.T.
	  .OPTION3.LEFT=INT_015*95
	  .OPTION3.NAME='OPTION3'  	  	  
     ENDWITH         
   THIS.ADDOBJECT('LBLF12','LABEL')
     WITH THIS.LBLF12
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*256
          .WIDTH=INT_015*50
          .CAPTION='兵役種類' 
     ENDWITH  
  THIS.ADDOBJECT('TXTF12','TEXTBOX')          
     WITH THIS.TXTF12
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*249
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH        
*********
*********
   THIS.ADDOBJECT('LBLF21','LABEL')
     WITH THIS.LBLF21
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*282
          .WIDTH=INT_015*50
          .CAPTION='戶籍地址'          
     ENDWITH
  THIS.ADDOBJECT('TXTF21','TXTF21')          
     WITH THIS.TXTF21
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*275
     ENDWITH 
   THIS.ADDOBJECT('LBLF22','LABEL')
     WITH THIS.LBLF22
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*308
          .WIDTH=INT_015*50
          .CAPTION='戶籍電話'          
     ENDWITH
  THIS.ADDOBJECT('TXTF22','TXTF22')          
     WITH THIS.TXTF22
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*301
     ENDWITH
   THIS.ADDOBJECT('LBLF23','LABEL')
     WITH THIS.LBLF23
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*334
          .WIDTH=INT_015*50
          .CAPTION='通訊地址'          
     ENDWITH
  THIS.ADDOBJECT('TXTF23','TEXTBOX') 
     WITH THIS.TXTF23
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*327
          .WIDTH=INT_015*450
          .HEIGHT=INT_015*25
          .MAXLENGTH=80
     ENDWITH
   THIS.ADDOBJECT('LBLF24','LABEL')
     WITH THIS.LBLF24
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*361
          .WIDTH=INT_015*50
          .CAPTION='通訊電話'          
     ENDWITH
  THIS.ADDOBJECT('TXTF24','TEXTBOX')          
     WITH THIS.TXTF24
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*354
          .WIDTH=INT_015*120
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH     
   THIS.ADDOBJECT('LBLF25','LABEL')
     WITH THIS.LBLF25
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*387
          .WIDTH=INT_015*50
          .CAPTION='行動電話'          
     ENDWITH
  THIS.ADDOBJECT('TXTF25','TEXTBOX')          
     WITH THIS.TXTF25
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*380
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH 
   THIS.ADDOBJECT('LBLF26','LABEL')
     WITH THIS.LBLF26
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*387
          .WIDTH=INT_015*50
          .CAPTION='電子郵件'          
     ENDWITH
  THIS.ADDOBJECT('TXTF26','TEXTBOX')          
     WITH THIS.TXTF26
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*380
          .WIDTH=INT_015*200
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH 
   THIS.ADDOBJECT('LBLF27','LABEL')
     WITH THIS.LBLF27
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*408
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .WORDWRAP=.T.
          .CAPTION='緊        急連  絡  人'          
     ENDWITH
  THIS.ADDOBJECT('TXTF27','TEXTBOX')          
     WITH THIS.TXTF27
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*406
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH     
   THIS.ADDOBJECT('LBLF28','LABEL')
     WITH THIS.LBLF28
          .VISIBLE=.T.
          .LEFT=INT_015*150
          .TOP=INT_015*413
          .WIDTH=INT_015*50
          .CAPTION='關        係'          
     ENDWITH
  THIS.ADDOBJECT('TXTF28','TEXTBOX')          
     WITH THIS.TXTF28
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*406
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH         
   THIS.ADDOBJECT('LBLF29','LABEL')
     WITH THIS.LBLF29
          .VISIBLE=.T.
          .LEFT=INT_015*320
          .TOP=INT_015*413
          .WIDTH=INT_015*50
          .CAPTION='聯絡電話'          
     ENDWITH
  THIS.ADDOBJECT('TXTF29','TEXTBOX')          
     WITH THIS.TXTF29
          .VISIBLE=.T.
          .LEFT=INT_015*370
          .TOP=INT_015*406
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH         
   THIS.ADDOBJECT('LBLF30','LABEL')
     WITH THIS.LBLF30
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*439
          .WIDTH=INT_015*50
          .CAPTION='聯絡地址'          
     ENDWITH
  THIS.ADDOBJECT('TXTF30','TEXTBOX')          
     WITH THIS.TXTF30
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*432
          .WIDTH=INT_015*450
          .HEIGHT=INT_015*25
          .MAXLENGTH=80
     ENDWITH  
   THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*465
          .WIDTH=INT_015*50
          .CAPTION='安全資料'          
     ENDWITH
   THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*465
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH                                                
  ENDPROC  
***********A.學歷資料
 PROCEDURE PAGEFRAME1.PAGE2.INIT    
   THIS.ADDOBJECT('LBLF03','LABEL')
     WITH THIS.LBLF03
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*21
          .WIDTH=INT_015*50
          .CAPTION='學校名稱'          
     ENDWITH
  THIS.ADDOBJECT('TXTF03','TEXTBOX')          
     WITH THIS.TXTF03
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*14
          .WIDTH=INT_015*200
          .HEIGHT=INT_015*25
          .MAXLENGTH=40
     ENDWITH     
   THIS.ADDOBJECT('LBLF04','LABEL')
     WITH THIS.LBLF04
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*47
          .WIDTH=INT_015*50
          .CAPTION='科系名稱'          
     ENDWITH
  THIS.ADDOBJECT('TXTF04','TEXTBOX')          
     WITH THIS.TXTF04
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*40
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH      
   THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*73
          .WIDTH=INT_015*50
          .CAPTION='入校日期'          
     ENDWITH
  THIS.ADDOBJECT('TXTF05','TEXTBOX')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*66
          .WIDTH=INT_015*65
          .HEIGHT=INT_015*25
     ENDWITH            
   THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*99
          .WIDTH=INT_015*50
          .CAPTION='離校日期'          
     ENDWITH
  THIS.ADDOBJECT('TXTF06','TEXTBOX')          
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*92
          .WIDTH=INT_015*65
          .HEIGHT=INT_015*25
     ENDWITH   
   THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*125
          .WIDTH=INT_015*50
          .CAPTION='畢業狀況'          
     ENDWITH
  THIS.ADDOBJECT('OPTIONGROUP07','OPTIONGROUP')
     WITH THIS.OPTIONGROUP07
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*118
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*125
	  .BUTTONCOUNT=2
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP07'
	  .OPTION1.CAPTION='畢業'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='肄業'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*70
	  .OPTION2.NAME='OPTION2'     	  	  
     ENDWITH               
   THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*151
          .WIDTH=INT_015*50
          .CAPTION='安全資料'          
     ENDWITH     
   THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*151
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH          
ENDPROC   
*********** B.專業技能
 PROCEDURE PAGEFRAME1.PAGE3.INIT    
   THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*21
          .WIDTH=INT_015*50
          .CAPTION='專業類別'          
     ENDWITH
  THIS.ADDOBJECT('OPTIONGROUP08','OPTIONGROUP08')
     WITH THIS.OPTIONGROUP08
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*14	  
     ENDWITH         
   THIS.ADDOBJECT('LBLF09','LABEL')
     WITH THIS.LBLF09
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*47
          .WIDTH=INT_015*50
          .CAPTION='專業項目'          
     ENDWITH
  THIS.ADDOBJECT('TXTF09','TEXTBOX')          
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*40
          .WIDTH=INT_015*160
          .HEIGHT=INT_015*25
           .MAXLENGTH=40
     ENDWITH            
   THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*73
          .WIDTH=INT_015*50
          .CAPTION='程度內容'          
     ENDWITH
  THIS.ADDOBJECT('OPTIONGROUP10','OPTIONGROUP')
     WITH THIS.OPTIONGROUP10
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*66
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*160
	  .BUTTONCOUNT=3
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP10'
	  .OPTION1.CAPTION='精通'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='通'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*55
	  .OPTION2.NAME='OPTION2'     	  
	  .OPTION3.CAPTION='略通'
	  .OPTION3.TOP=INT_015*5
	  .OPTION3.FONTSIZE=INT_015*9	  
	  .OPTION3.AUTOSIZE=.T.
	  .OPTION3.LEFT=INT_015*105
	  .OPTION3.NAME='OPTION3' 	  	  	  
     ENDWITH             
   THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*151
          .WIDTH=INT_015*50
          .CAPTION='安全資料'          
     ENDWITH     
   THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*151
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH                 
ENDPROC
***********C.工作經歷
 PROCEDURE PAGEFRAME1.PAGE4.INIT    
   THIS.ADDOBJECT('LBLF11','LABEL')
     WITH THIS.LBLF11
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*21
          .WIDTH=INT_015*50
          .CAPTION='任職機關'          
     ENDWITH
  THIS.ADDOBJECT('TXTF11','TEXTBOX')          
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*14
          .WIDTH=INT_015*200
          .HEIGHT=INT_015*25
          .MAXLENGTH=40
     ENDWITH     
   THIS.ADDOBJECT('LBLF12','LABEL')
     WITH THIS.LBLF12
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*47
          .WIDTH=INT_015*50
          .CAPTION='到職日期'          
     ENDWITH
  THIS.ADDOBJECT('TXTF12','TEXTBOX')          
     WITH THIS.TXTF12
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*40
          .WIDTH=INT_015*65
          .HEIGHT=INT_015*25
     ENDWITH            
   THIS.ADDOBJECT('LBLF13','LABEL')
     WITH THIS.LBLF13
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*73
          .WIDTH=INT_015*50
          .CAPTION='離職日期'          
     ENDWITH
  THIS.ADDOBJECT('TXTF13','TEXTBOX')          
     WITH THIS.TXTF13
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*66
          .WIDTH=INT_015*65
          .HEIGHT=INT_015*25
     ENDWITH   
   THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*99
          .WIDTH=INT_015*50
          .CAPTION='擔任職務'          
     ENDWITH
  THIS.ADDOBJECT('TXTF14','TEXTBOX')          
     WITH THIS.TXTF14
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*92
          .WIDTH=INT_015*160
          .HEIGHT=INT_015*25
          .MAXLENGTH=20
     ENDWITH      
   THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*125
          .WIDTH=INT_015*50
          .CAPTION='離職原因'          
     ENDWITH        
  THIS.ADDOBJECT('TXTF15','TEXTBOX')          
     WITH THIS.TXTF15
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*118
          .WIDTH=INT_015*200
          .HEIGHT=INT_015*25
           .MAXLENGTH=50
     ENDWITH      
   THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*151
          .WIDTH=INT_015*50
          .CAPTION='安全資料'          
     ENDWITH     
   THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*151
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH          
ENDPROC   
***********D.家庭狀況
 PROCEDURE PAGEFRAME1.PAGE5.INIT    
   THIS.ADDOBJECT('LBLF16','LABEL')
     WITH THIS.LBLF16
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*21
          .WIDTH=INT_015*50
          .CAPTION='稱        謂'          
     ENDWITH
  THIS.ADDOBJECT('TXTF16','TEXTBOX')          
     WITH THIS.TXTF16
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*14
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH     
   THIS.ADDOBJECT('LBLF17','LABEL')
     WITH THIS.LBLF17
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*47
          .WIDTH=INT_015*50
          .CAPTION='姓        名'          
     ENDWITH
  THIS.ADDOBJECT('TXTF17','TEXTBOX')          
     WITH THIS.TXTF17
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*40
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=10
     ENDWITH               
   THIS.ADDOBJECT('LBLF18','LABEL')
     WITH THIS.LBLF18
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*73
          .WIDTH=INT_015*50
          .CAPTION='年        齡'          
     ENDWITH
  THIS.ADDOBJECT('TXTF18','TEXTBOX')          
     WITH THIS.TXTF18
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*66
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*25
          .MAXLENGTH=3
          .INPUTMASK='999'
     ENDWITH      
   THIS.ADDOBJECT('LBLF19','LABEL')
     WITH THIS.LBLF19
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*99
          .WIDTH=INT_015*50
          .CAPTION='存  ／  歿'          
     ENDWITH
  THIS.ADDOBJECT('OPTIONGROUP19','OPTIONGROUP')
     WITH THIS.OPTIONGROUP19
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*92
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*120
	  .BUTTONCOUNT=2
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP19'
	  .OPTION1.CAPTION='存'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='歿'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*70
	  .OPTION2.NAME='OPTION2'     	  	  	  
     ENDWITH          
   THIS.ADDOBJECT('LBLF20','LABEL')
     WITH THIS.LBLF20
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*125
          .WIDTH=INT_015*50
          .CAPTION='職        業'          
     ENDWITH        
  THIS.ADDOBJECT('TXTF20','TEXTBOX')          
     WITH THIS.TXTF20
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*118
          .WIDTH=INT_015*120
          .HEIGHT=INT_015*25
           .MAXLENGTH=20
     ENDWITH      
   THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*151
          .WIDTH=INT_015*50
          .CAPTION='安全資料'          
     ENDWITH     
   THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*151
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH          
ENDPROC  
***********備註事項
 PROCEDURE PAGEFRAME1.PAGE6.INIT 
   THIS.ADDOBJECT('LBLF31','LABEL')
     WITH THIS.LBLF31
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*21
          .WIDTH=INT_015*50
          .CAPTION='備註事項'          
     ENDWITH
   THIS.ADDOBJECT('EDITBOX31','EDITBOX')
     WITH THIS.EDITBOX31
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*40
          .WIDTH=INT_015*300
          .HEIGHT=INT_015*110
          .READONLY=.T.
          .NAME='EDITBOX31'       
      ENDWITH            
 ENDPROC 
********  
  PROC INIT       
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9   
       THISFORM.PAGEFRAME1.PAGE3.FONTSIZE=INT_015*9      
       THISFORM.PAGEFRAME1.PAGE4.FONTSIZE=INT_015*9  
       THISFORM.PAGEFRAME1.PAGE5.FONTSIZE=INT_015*9  
       THISFORM.PAGEFRAME1.PAGE6.FONTSIZE=INT_015*9   
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')           
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A50.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A50.F02'
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55    
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')     
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='學校名稱'    
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='科系名稱'       
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='入學日期'
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='離校日期'
       THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='畢業狀況'
       THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='安全資料'
       THISFORM.GRID2.LINKMASTER='A50'
       THISFORM.GRID2.RELATIONALEXPR='F01'
       THISFORM.GRID2.RECORDSOURCE='A51_A'
       THISFORM.GRID2.CHILDORDER='A51_A1'
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A51_A.F03'
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A51_A.F04'       
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A51_A.F05'
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A51_A.F06'
       THISFORM.GRID2.COLUMN5.CONTROLSOURCE="IIF(A51_A.F07='1','畢業','肄業')"
       THISFORM.GRID2.COLUMN6.CONTROLSOURCE='A51_A.F99'
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*150      
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*100        
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*90
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*90
       THISFORM.GRID2.COLUMN5.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN6.WIDTH=INT_015*100
       THISFORM.PHOTO_BOTT.VISIBLE=.T.
       THISFORM.CHANG_BOTT.VISIBLE=.T.
       THISFORM.GRID1.READONLY=.T.      
       THISFORM.GRID2.READONLY=.T.            
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
       	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
           THISFORM.CHANG_BOTT.ENABLED=.F.
           THISFORM.PHOTO_BOTT.ENABLED=.F.         
       ELSE
       	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE3.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE4.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE5.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE6.ENABLED=.T.
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
           THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  &&判斷有無刪除的權限
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限   
           THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) 
           THISFORM.PHOTO_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&修改照片
       ENDIF          
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
       JK='員工編號'
       SELE A50
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A50.F01
  ENDPROC           
***********
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
        R=0
	SELECT A50
        DO CASE
               CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                          SET ORDER TO A501
               CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
              		  SET ORDER TO A502
         ENDCASE      
	THISFORM.SHRGROUP.TOP=INT_015*481
	THISFORM.SHRGROUP.LEFT=INT_015*560	
	THISFORM.PAGEFRAME1.PAGE1.TXTF14.READONLY=.T.
	THISFORM.PAGEFRAME1.PAGE1.TXTF21.READONLY=.T.
	THISFORM.PAGEFRAME1.PAGE1.TXTF22.READONLY=.T. 	
	THISFORM.PHOTO_BOTT.VISIBLE=.T.
	THISFORM.CHANG_BOTT.VISIBLE=.T.
	THISFORM.GRID2.VISIBLE=.F.	  
        THISFORM.GRID2.ENABLED=.F.  
        THISFORM.GRID1.SETFOCUS
         IF  THISFORM.GRID1.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.	
              THISFORM.KEY_LIST.ENABLED=.T.
	      THISFORM.PHOTO_BOTT.ENABLED=.F.
	      THISFORM.CHANG_BOTT.ENABLED=.F.
              THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","","COLUMN") 
              THISFORM.GRID1.ENABLED=.T.  
         ELSE    
              THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) 
	      THISFORM.PHOTO_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)   &&修改照片       	      	
         ENDIF
         THISFORM.GRID1.SETFOCUS
         THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限 
*!*	        THISFORM.REFRESH    
  ENDPROC     
***********
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE      
        AREA2='A51_A'  
        SELECT A51_A
	SET ORDER TO A51_A1
	SET FILTER TO F01=A50.F01
	GO TOP        
        THISFORM.GRID2.RECORDSOURCE=''
        THISFORM.GRID2.CHILDORDER=''
        THISFORM.GRID2.RECORDSOURCE='A51_A'
        THISFORM.GRID2.CHILDORDER='A51_A1'
	THISFORM.KEY_LIST.ENABLED=.F.   
	THISFORM.GRID2.VISIBLE=.T. 	
	THISFORM.GRID2.ENABLED=.T.
        THISFORM.GRID2.SETFOCUS       
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='學校名稱'    
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='科系名稱'       
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='入學日期'
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='離校日期'
        THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='畢業狀況'
        THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='安全資料'
        THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A51_A.F03'
        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A51_A.F04'       
        THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A51_A.F05'
        THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A51_A.F06'
        THISFORM.GRID2.COLUMN5.CONTROLSOURCE="IIF(A51_A.F07='1','畢業','肄業')"
        THISFORM.GRID2.COLUMN6.CONTROLSOURCE='A51_A.F99'
        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*150      
        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*100        
        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*90
        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*90
        THISFORM.GRID2.COLUMN5.WIDTH=INT_015*50
        THISFORM.GRID2.COLUMN6.WIDTH=INT_015*100           
	THISFORM.SHRGROUP.TOP=INT_015*165
	THISFORM.SHRGROUP.LEFT=INT_015*560 
	THISFORM.PHOTO_BOTT.VISIBLE=.F.
	THISFORM.CHANG_BOTT.VISIBLE=.F.
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       	 
        IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	 
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.      
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''
	 ELSE
	      IF THISFORM.GRID2.ACTIVEROW=0  .AND. THISFORM.SHRGROUP.ENABLED=.F.  
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	           THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
	           THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''	           		   
	      ELSE
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限
		   THISFORM.GRID2.AFTERROWCOLCHANGE  		      
	      ENDIF 
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)      &&判斷有無新增的權限         
	ENDIF            
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
*!*	       THISFORM.REFRESH   	                    
  ENDPROC     
***********
  PROCEDURE PAGEFRAME1.PAGE3.ACTIVATE
        AREA2='A51_B'  
	SELECT A51_B
	SET ORDER TO A51_B1
	SET FILTER TO F01=A50.F01
	GO TOP
        THISFORM.GRID2.RECORDSOURCE=''
        THISFORM.GRID2.CHILDORDER=''
        THISFORM.GRID2.RECORDSOURCE='A51_B'
        THISFORM.GRID2.CHILDORDER='A51_B1'
	THISFORM.KEY_LIST.ENABLED=.F.   	
	THISFORM.GRID2.VISIBLE=.T.
        THISFORM.GRID2.ENABLED=.T.  
        THISFORM.GRID2.SETFOCUS    	
	THISFORM.SHRGROUP.TOP=INT_015*165
	THISFORM.SHRGROUP.LEFT=INT_015*560	        
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='專業類別'    
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='專業項目'              
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='程度內容'
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='安全資料'     
        THISFORM.GRID2.COLUMN5.HEADER1.CAPTION=''   
        THISFORM.GRID2.COLUMN6.HEADER1.CAPTION=''     
        THISFORM.GRID2.COLUMN1.CONTROLSOURCE="IIF(A51_B.F08='1','語言',IIF(A51_B.F08='2','專長','證照'))"
        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A51_B.F09'
        THISFORM.GRID2.COLUMN3.CONTROLSOURCE="IIF(A51_B.F10='1','精通',IIF(A51_B.F10='2','通',IIF(A51_B.F10='3','略通','')))"
        THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A51_B.F99'
        THISFORM.GRID2.COLUMN5.CONTROLSOURCE=''
        THISFORM.GRID2.COLUMN6.CONTROLSOURCE=''
        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*55     
        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*150
        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*150
        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*100     
	THISFORM.PHOTO_BOTT.VISIBLE=.F.
	THISFORM.CHANG_BOTT.VISIBLE=.F.
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.     
        IF   EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	       
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.PAGEFRAME1.PAGE3.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''
	 ELSE
	      IF  THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F. 
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.  
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	           THISFORM.PAGEFRAME1.PAGE3.SETALL('VALUE','','TEXTBOX')
	           THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''	           		   
	      ELSE
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限	   
	           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)    &&判斷有無列印的權限 
	           THISFORM.GRID2.AFTERROWCOLCHANGE		      
	      ENDIF 
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)	    &&判斷有無新增的權限         
       ENDIF   
       R=RECNO('&AREA1')
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.        
*!*	       THISFORM.REFRESH     
  ENDPROC        
***********
  PROCEDURE PAGEFRAME1.PAGE4.ACTIVATE
        AREA2='A51_C'  
	SELECT A51_C
	SET ORDER TO A51_C1
	SET FILTER TO F01=A50.F01
	GO TOP	        
	THISFORM.KEY_LIST.ENABLED=.F.   
	THISFORM.PHOTO_BOTT.VISIBLE=.F.	
	THISFORM.CHANG_BOTT.VISIBLE=.F.
	THISFORM.GRID2.VISIBLE=.T. 	
	THISFORM.GRID2.ENABLED=.T.
        THISFORM.GRID2.RECORDSOURCE=''
        THISFORM.GRID2.CHILDORDER=''
        THISFORM.GRID2.RECORDSOURCE='A51_C'
        THISFORM.GRID2.CHILDORDER='A51_C1'      
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='任職機關'    
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='到職日期'
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='離職日期'
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='擔任職務'
        THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='離職原因'
        THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='安全資料'
        THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A51_C.F11'
        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A51_C.F12'
        THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A51_C.F13'
        THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A51_C.F14'
        THISFORM.GRID2.COLUMN5.CONTROLSOURCE='A51_C.F15'
        THISFORM.GRID2.COLUMN6.CONTROLSOURCE='A51_C.F99'
        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*100       
        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*60
        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*60
        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*50
        THISFORM.GRID2.COLUMN5.WIDTH=INT_015*150
        THISFORM.GRID2.COLUMN6.WIDTH=INT_015*100         
	THISFORM.SHRGROUP.TOP=INT_015*165
	THISFORM.SHRGROUP.LEFT=INT_015*560 
	THISFORM.GRID2.SETFOCUS 
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       	 
        IF   EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	 
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.      
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.PAGEFRAME1.PAGE4.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE4.LBLF991.CAPTION=''
	 ELSE
	      IF  THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.  
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	           THISFORM.PAGEFRAME1.PAGE4.SETALL('VALUE','','TEXTBOX')
	           THISFORM.PAGEFRAME1.PAGE4.LBLF991.CAPTION=''	           		   
	      ELSE
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 		      
		   THISFORM.GRID2.AFTERROWCOLCHANGE 
	      ENDIF 
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)      &&判斷有無新增的權限         
	ENDIF            
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
*!*	       THISFORM.REFRESH   	                    
  ENDPROC  
***********
  PROCEDURE PAGEFRAME1.PAGE5.ACTIVATE
        AREA2='A51_D'  
	SELECT A51_D
	SET ORDER TO A51_D1
	SET FILTER TO F01=A50.F01
	GO TOP
        THISFORM.GRID2.RECORDSOURCE=''
        THISFORM.GRID2.CHILDORDER=''
        THISFORM.GRID2.RECORDSOURCE=''
        THISFORM.GRID2.CHILDORDER=''
        THISFORM.GRID2.RECORDSOURCE='A51_D'
        THISFORM.GRID2.CHILDORDER='A51_D1'
	THISFORM.KEY_LIST.ENABLED=.F.   
	THISFORM.GRID2.VISIBLE=.T. 	
	THISFORM.GRID2.ENABLED=.T.
        THISFORM.GRID2.SETFOCUS       
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='稱        謂'    
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='姓        名'
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='年        齡'
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='存  ／  歿'
        THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='職        業'
        THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='安全資料'
        THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A51_D.F16'
        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A51_D.F17'
        THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A51_D.F18'
        THISFORM.GRID2.COLUMN4.CONTROLSOURCE="IIF(A51_D.F19='1','存','歿')"
        THISFORM.GRID2.COLUMN5.CONTROLSOURCE='A51_D.F20'
        THISFORM.GRID2.COLUMN6.CONTROLSOURCE='A51_D.F99'
        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*55    
        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*55
        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*55
        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*55
        THISFORM.GRID2.COLUMN5.WIDTH=INT_015*150
        THISFORM.GRID2.COLUMN6.WIDTH=INT_015*100         
	THISFORM.SHRGROUP.TOP=INT_015*165
	THISFORM.SHRGROUP.LEFT=INT_015*560 
	THISFORM.PHOTO_BOTT.VISIBLE=.F.
	THISFORM.CHANG_BOTT.VISIBLE=.F.
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       	 
        IF   EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	 
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.      
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.PAGEFRAME1.PAGE5.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE5.LBLF991.CAPTION=''
	 ELSE
	      IF  THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.  
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	           THISFORM.PAGEFRAME1.PAGE5.SETALL('VALUE','','TEXTBOX')
	           THISFORM.PAGEFRAME1.PAGE5.LBLF991.CAPTION=''	           		   
	      ELSE
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 	
		   THISFORM.GRID2.AFTERROWCOLCHANGE	      
	      ENDIF 
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)      &&判斷有無新增的權限         
	ENDIF            
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
*!*	       THISFORM.REFRESH   	                    
  ENDPROC        
***********
  PROCEDURE PAGEFRAME1.PAGE6.ACTIVATE
        AREA2='A51'  
        THISFORM.GRID2.RECORDSOURCE=''
        THISFORM.GRID2.CHILDORDER=''
        THISFORM.GRID2.RECORDSOURCE=''
        THISFORM.GRID2.CHILDORDER=''
	THISFORM.KEY_LIST.ENABLED=.F.   
	THISFORM.GRID2.VISIBLE=.T. 	
	THISFORM.GRID2.ENABLED=.F.   
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION=''    
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION=''
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION=''
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION=''
        THISFORM.GRID2.COLUMN5.HEADER1.CAPTION=''
        THISFORM.GRID2.COLUMN6.HEADER1.CAPTION=''   
	THISFORM.SHRGROUP.TOP=INT_015*165
	THISFORM.SHRGROUP.LEFT=INT_015*560 
	THISFORM.PHOTO_BOTT.VISIBLE=.F.
	THISFORM.CHANG_BOTT.VISIBLE=.F.
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       	 
	THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.	
	THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.SETFOCUS 
        IF   EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	 
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.      
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	 ELSE
	      IF  EMPTY(THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.VALUE) .AND. THISFORM.SHRGROUP.ENABLED=.F.  
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.    
		   THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)      &&判斷有無新增的權限           		   
	      ELSE
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
		   THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	     
	      ENDIF    
	ENDIF            
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
*!*	       THISFORM.REFRESH   	                    
  ENDPROC              
**********    
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依員工編號排列')
           .ADDITEM('依員工姓名排列')
           .VALUE=1
       ENDWITH             
  ENDPROC
********* 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE A50
       DO CASE
          CASE THIS.DISPLAYVALUE='依員工編號排列'
               SET ORDER TO A501 
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A50.F01'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A50.F02'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55 
          CASE THIS.DISPLAYVALUE='依員工姓名排列'
               SET ORDER TO A502
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A50.F02'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A50.F01'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50                                                                
       ENDCASE 
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
***********  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       	THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A50.F01
       	THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=A50.F02
       	THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE=A50.F03
       	THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=A50.F04
       	THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=A50.F05
       	THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=A50.F06
       	THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=BILL_MODE(A50.F07)
       	THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=A50.F08
       	THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE=A50.F09
       	THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=A50.F11
       	THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=A50.F12
       	THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE=A50.F13
       	THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE=A50.F14
       	THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE=A50.F16
       	THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE=A50.F17
       	THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE=A50.F20
       	THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE=A50.F21
       	THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=A50.F22
       	THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=A50.F23
       	THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE=A50.F24
       	THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=A50.F25
       	THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE=A50.F26
       	THISFORM.PAGEFRAME1.PAGE1.TXTF27.VALUE=A50.F27
       	THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=A50.F28
       	THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=A50.F29
       	THISFORM.PAGEFRAME1.PAGE1.TXTF30.VALUE=A50.F30
       	THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.VALUE=VAL(A50.F10)
       	THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=VAL(A50.F15)
       	THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP18.VALUE=VAL(A50.F18)
       	THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP19.VALUE=VAL(A50.F19)
       	THISFORM.PAGEFRAME1.PAGE1.LBLF051.CAPTION=IIF(SEEK(A50.F05,'A14'),A14.F02,'')
       	THISFORM.PAGEFRAME1.PAGE1.LBLF141.CAPTION='現年'+ALLTRIM(STR(VAL(LEFT(DTOS(DATE()),4))-VAL(LEFT(DTOS(A50.F14),4))))+'歲'
       	THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=A50.F99        
       	THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.VALUE=A50.F31  
        IF EMPTY(A50.F98)<>.T. .AND. FILE(ALLTRIM(A50.F98))
            THISFORM.IMAGE1.PICTURE=ALLTRIM(A50.F98)
            THISFORM.PHOTO_BOTT.CAPTION='\<I.修改照片'
        ELSE    
       	    THISFORM.IMAGE1.PICTURE=''
       	    THISFORM.PHOTO_BOTT.CAPTION='\<I.新增照片'             
       ENDIF       	
	THISFORM.PHOTO_BOTT.VISIBLE=.T.
	THISFORM.CHANG_BOTT.VISIBLE=.T.
	IF THISFORM.GRID1.ACTIVEROW=0 
             THISFORM.PAGEFRAME1.PAGE1.SETALL('VALUE','','TEXTBOX') 
             THISFORM.PAGEFRAME1.PAGE1.SETALL('VALUE',1,'OPTIONGROUP')   
             THISFORM.PAGEFRAME1.PAGE1.SETALL('CAPTION','','LABEL')  	             
	     THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	     THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	     THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	     THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	     THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	     THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	     THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	     THISFORM.CHANG_BOTT.ENABLED=.F.
	     THISFORM.PHOTO_BOTT.ENABLED=.F.	             
 	 ELSE
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 	 	        
	       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)   &&判斷有無修改的權限
	       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)    &&判斷有無刪除的權限
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)    &&判斷有無列印的權限 	       
	       THISFORM.PHOTO_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)   &&修改照片
	       THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)
         ENDIF	      
         THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)	&&判斷有無新增的權限   
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION  
         IF THIS.ACTIVEROW=0
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
         ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
         ENDIF   
         CHK=''     
*!*	       THISFORM.REFRESH
  ENDPROC     
**********  
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       DO CASE
              CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A51_A.F03
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A51_A.F04
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=A51_A.F05
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=A51_A.F06
       			 THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=VAL(A51_A.F07)
       			 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=A51_A.F99 
              CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3
           		 THISFORM.PAGEFRAME1.PAGE3.LBLF10.VISIBLE=IIF(A51_B.F08='3',.F.,.T.)
           		 THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VISIBLE=IIF(A51_B.F08='3',.F.,.T.)
       			 THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE=A51_B.F09
       			 THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE=VAL(A51_B.F08)       			 
       			 THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VALUE=VAL(A51_B.F10)
       			 THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=A51_B.F99    
              CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=4
       			 THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE=A51_C.F11
       			 THISFORM.PAGEFRAME1.PAGE4.TXTF12.VALUE=A51_C.F12
       			 THISFORM.PAGEFRAME1.PAGE4.TXTF13.VALUE=A51_C.F13
       			 THISFORM.PAGEFRAME1.PAGE4.TXTF14.VALUE=A51_C.F14
       			 THISFORM.PAGEFRAME1.PAGE4.TXTF15.VALUE=A51_C.F15
       			 THISFORM.PAGEFRAME1.PAGE4.LBLF991.CAPTION=A51_C.F99    
              CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=5
       			 THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE=A51_D.F16
       			 THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE=A51_D.F17
       			 THISFORM.PAGEFRAME1.PAGE5.TXTF18.VALUE=A51_D.F18
       			 THISFORM.PAGEFRAME1.PAGE5.TXTF20.VALUE=A51_D.F20
       			 THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.VALUE=VAL(A51_D.F19)
       			 THISFORM.PAGEFRAME1.PAGE5.LBLF991.CAPTION=A51_D.F99    
       ENDCASE       			    			 
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=A51.F01
*       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE 
*       THISFORM.REFRESH
  ENDPROC 
***********
PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
    THISFORM.KEY_LIST.ENABLED=.F. 
    THISFORM.GRID1.ENABLED=.F.  
    THISFORM.GRID2.ENABLED=.F.  
    THISFORM.CHANG_BOTT.ENABLED=.F.
    THISFORM.PHOTO_BOTT.ENABLED=.F.
    DO CASE
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1             
		     THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.	
		     THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.	
		     THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.	
		     THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX')   
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.ENABLED=.T.     		     
		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.ENABLED=.T. 
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP18.ENABLED=.T.   
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP19.ENABLED=.T. 
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VISIBLE=.T.	
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VISIBLE=.T.	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF05.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF07.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF14.READONLY=.F.		     
		     THISFORM.PAGEFRAME1.PAGE1.TXTF21.READONLY=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF22.READONLY=.F. 		     
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.VALUE=1	   
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1	 
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP18.VALUE=1	 
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP19.VALUE=1	 
      		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VALUE=1 
      		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VALUE=1 
      		     THISFORM.IMAGE1.PICTURE=''		   		     	     	     		     
		     THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''       
		     THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE=''  
		     THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=CTOD('')
		     THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''  
		     THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=''  
		     THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=''	     	     
		     THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=DATE()
		     THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE='全職人員' 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=CTOD('')
		     THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE='' 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE=CTOD('')
		     THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE=0
		     THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE=0
		     THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE=''		
		     THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF27.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF30.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.LBLF051.CAPTION=''
		     THISFORM.PAGEFRAME1.PAGE1.LBLF141.CAPTION=''
		     THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2    
		     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.	   
		     THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.       
		     THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'TEXTBOX')      
		     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.T. 
		     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=1
		     THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=CTOD('')	
		     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=CTOD('')     
		     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''    
		     THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS	
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3    	
		     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.	   
		     THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.       
		     THISFORM.PAGEFRAME1.PAGE3.SETALL('READONLY',.F.,'TEXTBOX')      
           	     THISFORM.PAGEFRAME1.PAGE3.LBLF10.VISIBLE=.T.
           	     THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VISIBLE=.T.     		     
		     THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.ENABLED=.T. 
		     THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.ENABLED=.T. 
		     THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE=1
		     THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VALUE=1
		     THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE=''	    
		     THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''    
		     THISFORM.PAGEFRAME1.PAGE3.TXTF09.SETFOCUS	
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=4    
		     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.	   
		     THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.     
		     THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.  
		     THISFORM.PAGEFRAME1.PAGE4.SETALL('READONLY',.F.,'TEXTBOX')      
		     THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE4.TXTF12.VALUE=CTOD('')	
		     THISFORM.PAGEFRAME1.PAGE4.TXTF13.VALUE=CTOD('')
		     THISFORM.PAGEFRAME1.PAGE4.TXTF14.VALUE=''	  
		     THISFORM.PAGEFRAME1.PAGE4.TXTF15.VALUE=''	   
		     THISFORM.PAGEFRAME1.PAGE4.LBLF991.CAPTION=''    
		     THISFORM.PAGEFRAME1.PAGE4.TXTF11.SETFOCUS	
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=5   
		     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.	   
		     THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.   
		     THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.     
		     THISFORM.PAGEFRAME1.PAGE5.SETALL('READONLY',.F.,'TEXTBOX')      
		     THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.ENABLED=.T. 
		     THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.VALUE=1
		     THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE5.TXTF18.VALUE=0
		     THISFORM.PAGEFRAME1.PAGE5.TXTF20.VALUE=''	     
		     THISFORM.PAGEFRAME1.PAGE5.LBLF991.CAPTION=''    
		     THISFORM.PAGEFRAME1.PAGE5.TXTF16.SETFOCUS
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=6   
		     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.	   
		     THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.   
		     THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.     
		     THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.READONLY=.F.
		     THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.VALUE=''  
		     THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.SETFOCUS			     			     		     	           	     
   ENDCASE
  ENDPROC
*************  
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK               &&新增確認
    DO CASE
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1  
    	             SELECT  A50
                     COD=SYS(21)
                     SET ORDER TO A501 
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
          		  =MESSAGEBOX('員工編號不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF  	 	     
	             IF INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'1',.F.,'A50','A501')=.T.
	           	  =MESSAGEBOX('此員工編號已存在,請查明後再輸入!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
	          	  SET ORDER TO &COD
	          	  RETURN            
	       	     ENDIF
	             IF SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'A50A_TEMP')=.T.
	           	  =MESSAGEBOX('此員工編號已存在於離職員工編號中,請查明後再輸入!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
	          	  SET ORDER TO &COD
	          	  RETURN            
	       	     ENDIF	       	     
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
          		  =MESSAGEBOX('中文姓名不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF02.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
          		  =MESSAGEBOX('所屬部門不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF05.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF 
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE)
          		  =MESSAGEBOX('身份證字號不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF13.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF   
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE)
          		  =MESSAGEBOX('出生日期不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF14.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF     
		     IF  DATE()-THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE<0
          		  =MESSAGEBOX('此出生日期不正確,請重新輸入!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF14.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF   
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE)
*!*	          		  =MESSAGEBOX('聯絡地址不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF23.SETFOCUS
*!*	          		  SET ORDER TO &COD
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF  
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE)
*!*	          		  =MESSAGEBOX('聯絡電話不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF23.SETFOCUS
*!*	          		  SET ORDER TO &COD
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF     
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF27.VALUE)
*!*	          		  =MESSAGEBOX('緊急連絡人不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF27.SETFOCUS
*!*	          		  SET ORDER TO &COD
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF   
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE)
*!*	          		  =MESSAGEBOX('關係不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF28.SETFOCUS
*!*	          		  SET ORDER TO &COD
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF    	 	     
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE)
*!*	          		  =MESSAGEBOX('緊急連絡電話不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF29.SETFOCUS
*!*	          		  SET ORDER TO &COD
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF    	 	  
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF30.VALUE)
*!*	          		  =MESSAGEBOX('緊急連絡地址不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF30.SETFOCUS
*!*	          		  SET ORDER TO &COD
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF    	 	          	 	     	 	       	 	       	 	      	 	        	 	     	       	     
 	             SELECT A50
 	             APPEND BLANK
 	             LOCK()
 	             IF RLOCK()
 	                 REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
 	                 REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
 	                 REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE
 	                 REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
 	                 REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
 	                 REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE
 	                 DO CASE
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VALUE=1
 	                        	    REPLACE F07 WITH 'A'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VALUE=2
 	                        	    REPLACE F07 WITH 'B'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VALUE=3
 	                        	    REPLACE F07 WITH 'C' 	                        	     	                        	    
 	                 ENDCASE
 	                 REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
 	                 REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE
 	                 REPLACE F10 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.VALUE)) 
 	                 REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE
 	                 REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE
 	                 REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE
 	                 REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE
 	                 REPLACE F15 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE)) 
 	                 REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE
 	                 REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE
 	                 REPLACE F18 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP18.VALUE)) 
 	                 REPLACE F19 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP19.VALUE)) 
 	                 REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE
 	                 REPLACE F21 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE
 	                 REPLACE F22 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE
 	                 REPLACE F23 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE
 	                 REPLACE F24 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE
 	                 REPLACE F25 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE
 	                 REPLACE F26 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE
 	                 REPLACE F27 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF27.VALUE
 	                 REPLACE F28 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE
 	                 REPLACE F29 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE
 	                 REPLACE F30 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF30.VALUE
 	                 REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
 	              ENDIF   
 	               IF  MESSAGEBOX('是否要新增此人員之照片',4+32+256,'請確認')=6 
			     IMAGE_DIR=GETPICT("","開啟來源檔案","開啟")
			     IF EMPTY(IMAGE_DIR)<>.T.
			      	   SELECT A50
			       	   REPLACE  A50.F98 WITH  ALLTRIM(IMAGE_DIR)
			      ENDIF   	                     
 	               ENDIF
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2  
    	             SELECT  A51_A
                     COD=SYS(21)
                     SET ORDER TO A51_A1     	  
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE)
          		  =MESSAGEBOX('學校名稱不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF    	    
		     IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE,'A51_A')=.T.
          		  =MESSAGEBOX('此學校名稱已存在,請重新輸入!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF    	 
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE)
*!*	          		  =MESSAGEBOX('科系名稱不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE2.TXTF04.SETFOCUS
*!*	          		  SET ORDER TO &COD
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF    	 	     	          	        	 	      	  
		     SELECT  A51        
		     APPEND BLANK
		     LOCK()
		     IF RLOCK()
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
		         REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
		         REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
		         REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
		         REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE)) 
		         REPLACE F98 WITH 'A'
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ENDIF
		     SELECT  A51_A        
		     APPEND BLANK
		     LOCK()
		     IF RLOCK()
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
		         REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
		         REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
		         REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
		         REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE)) 
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ENDIF		     	
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3 
    	             SELECT  A51_B
                     COD=SYS(21)
                     SET ORDER TO A51_B1     	    	   
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE)
          		  =MESSAGEBOX('專業項目不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE3.TXTF09.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF     	
		     IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE))+THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE,'A51_B')=.T.
          		  =MESSAGEBOX('此專業類別及專業項目已存在,請重新輸入!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE3.TXTF09.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF      	 	      	            	        	 	      	  
		     SELECT  A51        
		     APPEND BLANK
		     LOCK()
		     IF RLOCK()
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F08 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE)) 
		         REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE
		         REPLACE F10 WITH IIF(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE=3,'',ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VALUE)))
		         REPLACE F98 WITH 'B'
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ENDIF    
		     SELECT  A51_B        
		     APPEND BLANK
		     LOCK()
		     IF RLOCK()
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F08 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE)) 
		         REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE
		         REPLACE F10 WITH IIF(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE=3,'',ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VALUE)))
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ENDIF  		     	
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=4 
    	             SELECT  A51_C
                     COD=SYS(21)
                     SET ORDER TO A51_C1     	  
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE)
          		  =MESSAGEBOX('任職機關不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE4.TXTF11.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF  
		     IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE,'A51_C')=.T.
          		  =MESSAGEBOX('此任職機關已存在,請重新輸入!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE4.TXTF11.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN      	  
    	 	     ENDIF     	 	       	          	        	 	      	  
		     SELECT  A51        
		     APPEND BLANK
		     LOCK()
		     IF RLOCK()
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE
		         REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF12.VALUE
		         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF13.VALUE
		         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF14.VALUE
		         REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF15.VALUE
		         REPLACE F98 WITH 'C'
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		    
		     ENDIF	
		     SELECT  A51_C        
		     APPEND BLANK
		     LOCK()
		     IF RLOCK()
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE
		         REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF12.VALUE
		         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF13.VALUE
		         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF14.VALUE
		         REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF15.VALUE
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		    
		     ENDIF		     
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=5 
    	             SELECT  A51_D
                     COD=SYS(21)
                     SET ORDER TO A51_D1     	  
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE)
          		  =MESSAGEBOX('稱謂不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE5.TXTF16.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF 
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE)
          		  =MESSAGEBOX('姓名不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE5.TXTF17.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF     	 	     
		     IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE+THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE,'A51_D')=.T.
          		  =MESSAGEBOX('此稱謂及姓名已存在,請重新輸入!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE5.TXTF16.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF     	 	        	          	        	 	      	  
		     SELECT  A51        
		     APPEND BLANK
		     LOCK()
		     IF RLOCK()
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE
		         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE
		         REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF18.VALUE
		         REPLACE F19 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.VALUE))
		         REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF20.VALUE
		         REPLACE F98 WITH 'D'
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ENDIF	
		     SELECT  A51_D        
		     APPEND BLANK
		     LOCK()
		     IF RLOCK()
		         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE
		         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE
		         REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF18.VALUE
		         REPLACE F19 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.VALUE))
		         REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF20.VALUE
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ENDIF	
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=6
		     SELECT  A50
		     LOCK()
		     IF RLOCK()
		         REPLACE F31 WITH THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.VALUE	
		     ENDIF    	  		     	     	     	     	    	    	 	         	 	     	            	         	         		         		         		         		         		         		         	         		         		            	 	     	      		      
    ENDCASE 
    UNLOCK ALL
*!*	    SELECT A50
*!*	    SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    THISFORM.REFRESH
    IF THISFORM.PAGEFRAME1.ACTIVEPAGE<>6
        THISFORM.ORPGROUP.NEW_BOTT.CLICK
    ELSE     
        THISFORM.SHRGROUP.ABANDON_BOTT.CLICK   
    ENDIF
  ENDPROC  
***********    
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK 
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.F.   
     THISFORM.GRID2.ENABLED=.F.  
     THISFORM.CHANG_BOTT.ENABLED=.F.
     THISFORM.PHOTO_BOTT.ENABLED=.F.
     DO CASE
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1
         	      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
         	      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
         	      THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.
         	      THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.	
         	      THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.  
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.ENABLED=.T. 
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.ENABLED=.T.    
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP18.ENABLED=.T.   
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP19.ENABLED=.T.   		      
		      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX')    		      
		      THISFORM.PAGEFRAME1.PAGE1.TXTF01.READONLY=.T.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF07.READONLY=.T.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF08.READONLY=.T.	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF14.READONLY=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF21.READONLY=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF22.READONLY=.F.      
		      THISFORM.PAGEFRAME1.PAGE1.TXTF05.VISIBLE=.F.	      		
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VISIBLE=.T.  
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.DISPLAYVALUE=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)+SPACE(5)+ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF051.CAPTION)
		      THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF02.SETFOCUS
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2       
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.	
		      THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F. 
		      THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.           
		      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.T. 
		      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''	  
		      THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS         
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3   
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.	
		      THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.  
		      THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.          
		      THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.ENABLED=.T.  
		      THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.ENABLED=.T. 
		      THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''	 
		      THISFORM.PAGEFRAME1.PAGE3.TXTF09.SETFOCUS                
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=4   
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.	
		      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.     
		      THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.       
		      THISFORM.PAGEFRAME1.PAGE4.LBLF991.CAPTION=''	 
		      THISFORM.PAGEFRAME1.PAGE4.TXTF11.SETFOCUS   
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=5  
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.	
		      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.      
		      THISFORM.PAGEFRAME1.PAGE6.ENABLED=.F.       
		      THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.ENABLED=.T.  
		      THISFORM.PAGEFRAME1.PAGE5.LBLF991.CAPTION=''	 
		      THISFORM.PAGEFRAME1.PAGE5.TXTF16.SETFOCUS   	
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=6  
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.	
		      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.      
		      THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.   
		      THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.READONLY=.F.    
		      THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.SETFOCUS  		      	      		       		      	      
    ENDCASE		      
    LOCK()
    IF !RLOCK()
         DO FILE_IMPACT
         RETURN
    ENDIF   
  ENDPROC    
**************
PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK   &&修改確認                 
  DO CASE    
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=1
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
          		  =MESSAGEBOX('中文姓名不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF02.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
          		  =MESSAGEBOX('所屬部門不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF05.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF 
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE)
          		  =MESSAGEBOX('身份證字號不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF13.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF   
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE)
          		  =MESSAGEBOX('出生日期不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF14.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF     
		     IF  DATE()-THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE<0
          		  =MESSAGEBOX('此出生日期不正確,請重新輸入!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF14.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF 
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE)
*!*	          		  =MESSAGEBOX('聯絡地址不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF23.SETFOCUS
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF  
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE)
*!*	          		  =MESSAGEBOX('聯絡電話不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF23.SETFOCUS
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF     
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF27.VALUE)
*!*	          		  =MESSAGEBOX('緊急連絡人不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF27.SETFOCUS
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF   
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE)
*!*	          		  =MESSAGEBOX('關係不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF28.SETFOCUS
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF    	 	     
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE)
*!*	          		  =MESSAGEBOX('緊急連絡電話不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF29.SETFOCUS
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF    	 	  
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF30.VALUE)
*!*	          		  =MESSAGEBOX('緊急連絡地址不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF30.SETFOCUS
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF 	
    	 	     IF  A50.F02<>THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
    	 	     	  SELECT A51
		          REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE FOR ALLTRIM(F01)=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE) ALL
    	 	     	  SELECT A52
		          REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE FOR ALLTRIM(F01)=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE) ALL		          
     	     	     ENDIF
		     SELECT  A50 
		     IF RLOCK()
 	                 REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
 	                 REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE
 	                 REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
 	                 REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
 	                 REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE
 	                 REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
 	                 REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE
 	                 REPLACE F10 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.VALUE)) 
 	                 REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE
 	                 REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE
 	                 REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE
 	                 REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE
 	                 REPLACE F15 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE)) 
 	                 REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE
 	                 REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF17.VALUE
 	                 REPLACE F18 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP18.VALUE)) 
 	                 REPLACE F19 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP19.VALUE)) 
 	                 REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE
 	                 REPLACE F21 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE
 	                 REPLACE F22 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE
 	                 REPLACE F23 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE
 	                 REPLACE F24 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE
 	                 REPLACE F25 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE
 	                 REPLACE F26 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE
 	                 REPLACE F27 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF27.VALUE
 	                 REPLACE F28 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE
 	                 REPLACE F29 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE
 	                 REPLACE F30 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF30.VALUE
 	                 REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
		     ELSE
		         DO FILE_IMPACT
		         RETURN   
		     ENDIF   
		     THISFORM.GRID1.SETFOCUS 
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=2   	  	
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE)
          		  =MESSAGEBOX('學校名稱不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF    
    	 	     IF  THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE<>A51_A.F03
		           IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A'+THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE,.F.,'A51','A511')=.T.
          		        =MESSAGEBOX('此學校名稱已存在,請重新輸入!',0+64,'提示訊息視窗')
          		        THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
          		        RETURN  
          		   ENDIF          	  
    	 	     ENDIF   
*!*			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE)
*!*	          		  =MESSAGEBOX('科系名稱不得空白!',0+64,'提示訊息視窗')
*!*	          		  THISFORM.PAGEFRAME1.PAGE2.TXTF04.SETFOCUS
*!*	          		  RETURN        	  
*!*	    	 	     ENDIF    	 	       	 	     
		     SELECT  A51    
		     SET ORDER TO A511
		     SEEK  A50.F01+'A'+A51_A.F03
		     IF FOUND()
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
		         REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
		         REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
		         REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
		         REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE)) 
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			     
		     ENDIF
		     SELECT A51_A
		     IF RLOCK()	    	
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
		         REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
		         REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
		         REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
		         REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE)) 
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ELSE
		         DO FILE_IMPACT
		         RETURN   
		     ENDIF 
		    THISFORM.GRID2.SETFOCUS 
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=3     
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE)
          		  =MESSAGEBOX('專業項目不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE3.TXTF09.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF        
    	 	     IF  ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE))<>A51_B.F08 .OR. THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE<>A51_B.F09
		          IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'B'+ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE))+THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE,.F.,'A51','A512')=.T.
          		       =MESSAGEBOX('此專業類別及專業項目已存在,請重新輸入!',0+64,'提示訊息視窗')
          		       THISFORM.PAGEFRAME1.PAGE3.TXTF09.SETFOCUS
          		       RETURN
          		  ENDIF             	  
    	 	     ENDIF       	 	      	 	    
		     SELECT  A51  
		     SET ORDER TO A512
		     SEEK A50.F01+'B'+A51_B.F08+A51_B.F09     
		     IF FOUND()
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F08 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE)) 
		         REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE
		         REPLACE F10 WITH IIF(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE=3,'',ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VALUE)))
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			     
		     ENDIF
		     SELECT A51_B
		     IF RLOCK()	    
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F08 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE)) 
		         REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE
		         REPLACE F10 WITH IIF(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE=3,'',ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VALUE)))
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ELSE
		         DO FILE_IMPACT
		         RETURN   
		     ENDIF	   
		    THISFORM.GRID2.SETFOCUS 	
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=4    
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE)
          		  =MESSAGEBOX('任職機關不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE4.TXTF11.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF       
    	 	     IF  ALLTRIM(THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE)<>ALLTRIM(A51_C.F11)
		           IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C'+THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE,.F.,'A51','A513')=.T.
          		       =MESSAGEBOX('此任職機關已存在,請重新輸入!',0+64,'提示訊息視窗')
          		       THISFORM.PAGEFRAME1.PAGE4.TXTF11.SETFOCUS
          		       RETURN 
          		   ENDIF            	  
    	 	     ENDIF      	 	   
		     SELECT  A51   
		     SET ORDER TO A513
		     SEEK A50.F01+'C'+A51_C.F11
		     IF FOUND()   
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE
		         REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF12.VALUE
		         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF13.VALUE
		         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF14.VALUE
		         REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF15.VALUE
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			      
		     ENDIF    	 	           
		     SELECT A51_C
		     IF RLOCK()	    
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE
		         REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF12.VALUE
		         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF13.VALUE
		         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF14.VALUE
		         REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE4.TXTF15.VALUE
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			         		    
		     ELSE
		         DO FILE_IMPACT
		         RETURN   
		     ENDIF		        
		    THISFORM.GRID2.SETFOCUS 	
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=5     
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE)
          		  =MESSAGEBOX('稱謂不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE5.TXTF16.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF         
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE)
          		  =MESSAGEBOX('姓名不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE5.TXTF17.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF     	 
    	 	     IF  THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE	<>A51_D.F16 .OR.   THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE	<>A51_D.F17  
		           IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'D'+THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE+THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE,.F.,'A51','A514')=.T.
          		        =MESSAGEBOX('此稱謂及姓名已存在,請重新輸入!',0+64,'提示訊息視窗')
          		        THISFORM.PAGEFRAME1.PAGE5.TXTF16.SETFOCUS
          		        RETURN 
          		   ENDIF            	  
    	 	     ENDIF         	 	     	 	    
		     SELECT  A51   
		     SET ORDER TO A514
		     SEEK A50.F01+'D'+A51_D.F16+A51_D.F17
		     IF FOUND()
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE
		         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE
		         REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF18.VALUE
		         REPLACE F19 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.VALUE))
		         REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF20.VALUE
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			     
		     ENDIF
		     SELECT A51_D
		     IF RLOCK()	    
		         REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
		         REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE
		         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE
		         REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF18.VALUE
		         REPLACE F19 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.VALUE))
		         REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE5.TXTF20.VALUE
		         REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		     ELSE
		         DO FILE_IMPACT
		         RETURN   
		     ENDIF	   
		    THISFORM.GRID2.SETFOCUS 	
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=6
		     SELECT  A50
		     LOCK()
		     IF RLOCK()
		         REPLACE F31 WITH THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.VALUE	
		     ELSE
		         DO FILE_IMPACT
		         RETURN   
		     ENDIF
		     THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.SETFOCUS 		    		    		    	      		          	    
   ENDCASE		              
   THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
ENDPROC   
*************
PROC ORPGROUP.DEL_BOTT.CLICK                    &&刪除資料程序
 IF  MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認')=6 
      DO CASE 
            CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1
          	       DELETE FROM A51_A WHERE A51_A.F01=A50.F01  
          	       DELETE FROM A51_B WHERE A51_B.F01=A50.F01 
          	       DELETE FROM A51_C WHERE A51_C.F01=A50.F01 
           	       DELETE FROM A51_D WHERE A51_D.F01=A50.F01   
    	   	       DELETE FROM A51 WHERE A51.F01=A50.F01    
    	   	       DELETE FROM A52 WHERE A52.F01=A50.F01   
	               SELECT A50
	               LOCK()
	               IF RLOCK()
	                   DELETE 
	                   UNLOCK
	                   SKIP -1
	                   IF BOF()
	                       GO TOP
	                   ENDIF  
		       ELSE
		           DO FILE_IMPACT
		       ENDIF
		       THISFORM.GRID1.SETFOCUS   
	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2      
		        SELECT A51
		        SET ORDER TO A511
		        SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A'+THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
		        IF FOUND()
		            DELETE 
		        ENDIF
		        SELECT A51_A
		        LOCK()
		        IF  RLOCK()
			     DELETE 
			     UNLOCK
			     SKIP -1
			     IF BOF()
			         GO TOP
			     ENDIF  
			ELSE
			     DO FILE_IMPACT
			ENDIF  
		       THISFORM.GRID2.SETFOCUS 
	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3      
		        SELECT A51
		        SET ORDER TO A512
		        SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'B'+ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.VALUE))+THISFORM.PAGEFRAME1.PAGE3.TXTF09.VALUE
		        IF FOUND()
		            DELETE 
		        ENDIF
		        SELECT A51_B
		        LOCK()
		        IF  RLOCK()
			     DELETE 
			     UNLOCK
			     SKIP -1
			     IF BOF()
			         GO TOP
			     ENDIF  
			ELSE
			     DO FILE_IMPACT
			ENDIF  
		       THISFORM.GRID2.SETFOCUS 	
	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=4     
		        SELECT A51
		        SET ORDER TO A513
		        SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C'+THISFORM.PAGEFRAME1.PAGE4.TXTF11.VALUE
		        IF FOUND()
		            DELETE 
		        ENDIF
		        SELECT A51_C
		        LOCK()
		        IF  RLOCK()
			     DELETE 
			     UNLOCK
			     SKIP -1
			     IF BOF()
			         GO TOP
			     ENDIF  
			ELSE
			     DO FILE_IMPACT
			ENDIF  
		       THISFORM.GRID2.SETFOCUS 	
	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=5      
		        SELECT A51
		        SET ORDER TO A514
		        SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'D'+THISFORM.PAGEFRAME1.PAGE5.TXTF16.VALUE+THISFORM.PAGEFRAME1.PAGE5.TXTF17.VALUE
		        IF FOUND()
		            DELETE 
		        ENDIF
		        SELECT A51_D
		        LOCK()
		        IF  RLOCK()
			     DELETE 
			     UNLOCK
			     SKIP -1
			     IF BOF()
			         GO TOP
			     ENDIF  
			ELSE
			     DO FILE_IMPACT
			ENDIF  
		       THISFORM.GRID2.SETFOCUS 	
	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=6
	    	        SELECT A50
	    	        SET ORDER TO A501	       
	    	        SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE	
	    	        IF FOUND()	       	       	       	
	    	            REPLACE F31 WITH ' '
	    	        ENDIF
	    	        THISFORM.SHRGROUP.ABANDON_BOTT.CLICK  
	    	        THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.SETFOCUS		       	       	       	       	
       ENDCASE
  ENDIF
*!*	  THISFORM.REFRESH	       
ENDPROC  
****************
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.SETALL('VISIBLE',.T.,'TEXTBOX')       		          		                            
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.T.    
      THISFORM.PAGEFRAME1.PAGE4.ENABLED=.T.  
      THISFORM.PAGEFRAME1.PAGE5.ENABLED=.T.    
      THISFORM.PAGEFRAME1.PAGE6.ENABLED=.T. 
      THISFORM.GRID2.ENABLED=.T.    
      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	
      THISFORM.PHOTO_BOTT.VISIBLE=.T.
      THISFORM.PHOTO_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)   &&修改照片
      THISFORM.CHANG_BOTT.VISIBLE=.T.
      THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)
       DO CASE 
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1  
       	      		THISFORM.PAGEFRAME1.PAGE1.ACTIVATE  
       	                THISFORM.GRID1.ENABLED=.T.
			THISFORM.PAGEFRAME1.PAGE1.TXTF05.VISIBLE=.T.
			THISFORM.PAGEFRAME1.PAGE1.TXTF07.VISIBLE=.T.
		        THISFORM.PAGEFRAME1.PAGE1.TXTF07.READONLY=.T.
		        THISFORM.PAGEFRAME1.PAGE1.TXTF08.READONLY=.T.
		        THISFORM.PAGEFRAME1.PAGE1.TXTF14.READONLY=.T.
			THISFORM.PAGEFRAME1.PAGE1.TXTF21.READONLY=.T.
			THISFORM.PAGEFRAME1.PAGE1.TXTF22.READONLY=.T. 		        
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.ENABLED=.F. 
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.ENABLED=.F.     
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP18.ENABLED=.F.
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP19.ENABLED=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=A50.F99
		        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	
		        THISFORM.GRID1.SETFOCUS    
      			THISFORM.KEY_LIST.ENABLED=.T.  	
      			 IF THISFORM.GRID1.ACTIVEROW=0
      			      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
	                      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
	                      THISFORM.PAGEFRAME1.PAGE4.ENABLED=.F.
	                      THISFORM.PAGEFRAME1.PAGE5.ENABLED=.F.
	                ENDIF      	        
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2
       	                THISFORM.PAGEFRAME1.PAGE2.ACTIVATE  
       	     	        THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.F.	 
		   	THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=A51_A.F99 
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3
       	                THISFORM.PAGEFRAME1.PAGE3.ACTIVATE  
       	                THISFORM.PAGEFRAME1.PAGE3.LBLF10.VISIBLE=IIF(A51_B.F08='3',.F.,.T.)
           		THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VISIBLE=IIF(A51_B.F08='3',.F.,.T.)     
       	     	        THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP08.ENABLED=.F.	
       	     	        THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.ENABLED=.F. 
		   	THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=A51_B.F99 
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=4
		   	THISFORM.PAGEFRAME1.PAGE4.ACTIVATE  
		   	THISFORM.PAGEFRAME1.PAGE4.LBLF991.CAPTION=A51_C.F99 
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=5
       	     	        THISFORM.PAGEFRAME1.PAGE5.ACTIVATE  
       	     	        THISFORM.PAGEFRAME1.PAGE5.OPTIONGROUP19.ENABLED=.F.	 
		   	THISFORM.PAGEFRAME1.PAGE5.LBLF991.CAPTION=A51_D.F99 	
	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=6		   	
	                THISFORM.PAGEFRAME1.PAGE6.ACTIVATE  
		   	THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.READONLY=.T.	 
		   	THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.VALUE=A50.F31 
		   	THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.SETFOCUS   
		   	THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      		THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	                THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	                THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.		 
                        THISFORM.CHANG_BOTT.VISIBLE=.F.
                        THISFORM.PHOTO_BOTT.VISIBLE=.F.	                  	
		   	IF  EMPTY(THISFORM.PAGEFRAME1.PAGE6.EDITBOX31.VALUE)
		   	     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)	
		   	     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.    
		   	     THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
		   	ELSE
		   	     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
		   	     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)   
		   	     THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
		   	ENDIF 	   						        
      ENDCASE	    
      IF  THISFORM.PAGEFRAME1.ACTIVEPAGE<>1  .AND. THISFORM.PAGEFRAME1.ACTIVEPAGE<>6
            THISFORM.CHANG_BOTT.VISIBLE=.F.
            THISFORM.PHOTO_BOTT.VISIBLE=.F.
            THISFORM.GRID2.SETFOCUS 
      ENDIF
*!*	      THISFORM.REFRESH   
      UNLOCK ALL          
  ENDPROC
**********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
    SELECT A50
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO A501
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO A502
         ENDCASE   
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC
   ************************照片新增或修改**********
  PROC PHOTO_BOTT.CLICK  
       THISFORM.IMAGE1.PICTURE=''
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.GRID1.ENABLED=.F.
       THISFORM.KEY_LIST.ENABLED=.F.          
       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.
       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
       THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
       THISFORM.CHANG_BOTT.ENABLED=.F.
       THISFORM.PHOTO_BOTT.ENABLED=.F.
       IMAGE_DIR=GETPICT("","開啟來源檔案","開啟")
       IF EMPTY(IMAGE_DIR)<>.T.
       	   SELECT A50
       	   REPLACE  A50.F98 WITH  ALLTRIM(IMAGE_DIR)
       	   =MESSAGEBOX('照片修新增 / 修改 成功!',0+64,'提示訊息視窗')
       ENDIF    
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK  
    ENDPROC
************     人員異動
  PROC CHANG_BOTT.CLICK     
      	SELECT  A50
      	LOCK()
      	PO=A50.F01
   	CHANG_CHK=CREATEOBJECT("CHANG_CHK")  
   	CHANG_CHK.SHOW
   	THISFORM.GRID1.SETFOCUS 
  ENDPROC     
ENDDEFINE
********************************************************
DEFINE CLASS CHANG_CHK AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入異動內容   員工姓名 '+A50.F02
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*135
  WIDTH=INT_015*230
  FONTSIZE=INT_015*9
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='CHANG_CHK'
  ADD OBJECT LABELA AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*20,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.,;
      BACKCOLOR=RGB(255,255,0),;
      CAPTION='異動之人員可以更改新的員工編號'      
  ADD OBJECT LABEL1 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*41,;
      WIDTH=INT_015*50,;
      CAPTION='員工編號'          
  ADD OBJECT TXTF1 AS TEXTBOX WITH;           
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*34,;
       WIDTH=INT_015*75,;
       HEIGHT=INT_015*25,;
       MAXLENGTH=4
  ADD OBJECT LABEL8 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*70,;
      WIDTH=INT_015*50,;
      CAPTION='異動日期'          
  ADD OBJECT TXTF8 AS TEXTBOX WITH;           
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*64,;
       WIDTH=INT_015*75,;
       HEIGHT=INT_015*25          
  ADD OBJECT LABEL7 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*99,;
      WIDTH=INT_015*50,;
      CAPTION='異動項目'                
  ADD OBJECT COMBOBOX7 AS COMBOBOX WITH;
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*93,;       
       HEIGHT=INT_015*25,;
       WIDTH=INT_015*75,;
       FONTSIZE=INT_015*9,;   
       BOUNDCOLUMN=1,;
       ROWSOURCETYPE=1,;
       STYLE=2,;    
       VALUE=1,;
       ROWSOURCE='離        職,留職停薪,留職復職,職務調整,升遷',;
       NAME='COMBOBOX7'
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*50,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      CAPTION='\<Y.確定',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;
      TOP=INT_015*96,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'     
  *****    
 PROC INIT   
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')     
       THISFORM.TXTF1.VALUE=PO
       THISFORM.TXTF8.VALUE=CTOD('')
       THISFORM.COMBOBOX7.VALUE=1
       THISFORM.TXTF8.SETFOCUS 
 ENDPROC
 *******   
 PROCEDURE CMND1.CLICK   
     IF  MESSAGEBOX('是否確定要異動此人員資料',4+32+256,'請確認')=6 
 	  IF  EMPTY(THISFORM.TXTF1.VALUE)
  		=MESSAGEBOX('員工編號不得空白!',0+64,'提示訊息視窗')
  		THISFORM.TXTF1.SETFOCUS   
  		RETURN	  
    	  ENDIF    
  	  IF SEEK(ALLTRIM(THISFORM.TXTF1.VALUE),'A50A_TEMP')=.T.	
  	       =MESSAGEBOX('此員工編號已存在,請重新輸入!',0+64,'提示訊息視窗')
  	      THISFORM.TXTF1.SETFOCUS   
  	       RETURN	    	   
  	  ENDIF     
 	  IF  EMPTY(THISFORM.TXTF8.VALUE)
  		=MESSAGEBOX('異動日期不得空白!',0+64,'提示訊息視窗')
  		THISFORM.TXTF8.SETFOCUS   
  		RETURN	  
    	  ENDIF        	  
          SELECT A50
          IF RLOCK()      
              REPLACE F01 WITH  THISFORM.TXTF1.VALUE
              REPLACE F08 WITH  THISFORM.TXTF8.VALUE
              REPLACE F99 WITH  DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
              DO CASE
                     CASE THISFORM.COMBOBOX7.VALUE=1
                                REPLACE F07 WITH '1'
                                SELECT A50A_TEMP
                                USE
				SELECT F01,F02 FROM A50  WHERE F07='1' INTO CURSOR A50A_TEMP
				INDE ON F01 TAG A50A_TEMP1
				SET ORDER TO A50A_TEMP1                                
                     CASE THISFORM.COMBOBOX7.VALUE=2
                                REPLACE F07 WITH '3'
                     CASE THISFORM.COMBOBOX7.VALUE=3
                                REPLACE F07 WITH '4'       
                     CASE THISFORM.COMBOBOX7.VALUE=4
                                REPLACE F07 WITH '5'               
                     CASE THISFORM.COMBOBOX7.VALUE=5
                                REPLACE F07 WITH '6'                                                                                                              
              ENDCASE  
              SELECT A51  
	      REPLACE F01 WITH  ALLTRIM(THISFORM.TXTF1.VALUE) FOR ALLTRIM(F01)=ALLTRIM(PO) ALL    
              SELECT A52  
	      REPLACE F01 WITH  ALLTRIM(THISFORM.TXTF1.VALUE) FOR ALLTRIM(F01)=ALLTRIM(PO) ALL 	                
              THISFORM.CMND2.CLICK
          ENDIF              
     ENDIF  
   THISFORM.TXTF8.SETFOCUS          
  ENDPROC
 ***** 
  PROCEDURE CMND2.CLICK
       SELECT A50
       UNLOCK ALL 
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE        
***********************************************列印程序
PROCEDURE PNT_PRC   
  IF  MESSAGEBOX('是否只要列印員工基本資料空白表格',4+32+256,'請確認')=6 
        REPORT FORM ALLTRIM(INT_116)+'A50_B'   TO PRINT PROMPT   PREVIEW    
        CLEAR
  ELSE     
      LK=A50.F01
      CREATE CURSOR A51_TEMP;
         (F98 C(3),F03 C(40),F04 C(20),F05 D(8),F06 D(8),F07 C(4),F08 C(4),F09 C(30),F10 C(10),F11 C(50),;
          F12 D(8),F13 D(8),F14 C(20),F15 C(50),F16 C(10),F17 C(10),F18 N(3),F19 C(2),F20 C(20))
          INDE ON F98 TAG A51_TEMP1   
      SELECT * FROM A51 WHERE F01=LK  .AND. F98='A'  INTO CURSOR A51A
      SELECT A51A
      GO TOP
      DO WHILE !EOF()
      	     SELECT A51_TEMP
      	     APPEND BLANK
      	     REPLACE A51_TEMP.F98 WITH ALLTRIM(IIF(RECNO('A51A')>9,'A'+ALLTRIM(STR((RECNO('A51A')))),'A0'+ALLTRIM(STR((RECNO('A51A'))))))
      	     REPLACE A51_TEMP.F03 WITH A51A.F03
      	     REPLACE A51_TEMP.F04 WITH A51A.F04
      	     REPLACE A51_TEMP.F05 WITH A51A.F05
      	     REPLACE A51_TEMP.F06 WITH A51A.F06
      	     REPLACE A51_TEMP.F07 WITH IIF(A51A.F07='1','畢業','肄業')
	     SELECT A51A
	     SKIP
      ENDDO	      
      SELECT A51A
      USE 
      *****
      SELECT * FROM A51 WHERE F01=LK  .AND. F98='B'  INTO CURSOR A51B
      SELECT A51B
      GO TOP
      DO WHILE !EOF()
      	     SELECT A51_TEMP
      	     APPEND BLANK
      	     REPLACE A51_TEMP.F98 WITH ALLTRIM(IIF(RECNO('A51B')>9,'B'+ALLTRIM(STR((RECNO('A51B')))),'B0'+ALLTRIM(STR((RECNO('A51B'))))))
      	     REPLACE A51_TEMP.F08 WITH IIF(A51B.F08='1','語言',IIF(A51B.F08='2','專長','證照'))
      	     REPLACE A51_TEMP.F09 WITH A51B.F09
      	     REPLACE A51_TEMP.F10 WITH IIF(A51B.F10='1','精通',IIF(A51B.F10='2','通',IIF(A51B.F10='3','略通','')))
	     SELECT A51B
	     SKIP
      ENDDO      
      SELECT A51B
      USE 
      ****
      SELECT * FROM A51 WHERE F01=LK  .AND. F98='C'  INTO CURSOR A51C
      SELECT A51C
      GO TOP
      DO WHILE !EOF()
      	     SELECT A51_TEMP
      	     APPEND BLANK
      	     REPLACE A51_TEMP.F98 WITH ALLTRIM(IIF(RECNO('A51C')>9,'C'+ALLTRIM(STR((RECNO('A51C')))),'C0'+ALLTRIM(STR((RECNO('A51C'))))))
      	     REPLACE A51_TEMP.F11 WITH A51C.F11
      	     REPLACE A51_TEMP.F12 WITH A51C.F12
      	     REPLACE A51_TEMP.F13 WITH A51C.F13
      	     REPLACE A51_TEMP.F14 WITH A51C.F14
      	     REPLACE A51_TEMP.F15 WITH A51C.F15
	     SELECT A51C
	     SKIP
      ENDDO
      SELECT A51C
      USE 
      ***
      SELECT * FROM A51 WHERE F01=LK  .AND. F98='D'  INTO CURSOR A51D
      SELECT A51D
      GO TOP
      DO WHILE !EOF()
      	     SELECT A51_TEMP
      	     APPEND BLANK
      	     REPLACE A51_TEMP.F98 WITH ALLTRIM(IIF(RECNO('A51D')>9,'D'+ALLTRIM(STR((RECNO('A51D')))),'D0'+ALLTRIM(STR((RECNO('A51D'))))))
      	     REPLACE A51_TEMP.F16 WITH A51D.F16
      	     REPLACE A51_TEMP.F17 WITH A51D.F17
      	     REPLACE A51_TEMP.F18 WITH A51D.F18
      	     REPLACE A51_TEMP.F19 WITH IIF(A51D.F19='1','存','歿')
      	     REPLACE A51_TEMP.F20 WITH A51D.F20
	     SELECT A51D
	     SKIP
      ENDDO
      SELECT A51D
      USE             
      SELECT A51_TEMP
      SET ORDER TO A51_TEMP1
      GO TOP
*!*	      IF  _TALLY> 0
           REPORT FORM ALLTRIM(INT_116)+'A50_A' TO PRINT PROMPT   PREVIEW
           SELECT A51_TEMP
           USE
*!*	      ELSE
*!*	             =MESSAGEBOX('查無此員工之相關資料,請查明後在列印',0+48,'警示')
*!*	             RETURN     
*!*	      ENDIF     
     CLEAR
   ENDIF
ENDPROC
***************************************************部門
DEFINE CLASS COMBOBOX05 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*55
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX05'
 PROCEDURE INIT    
       SELECT F01,F02 FROM A14 WHERE  LEN(ALLTRIM(F01))=4  ORDER BY F01 INTO CURSOR A14_TEMP
       SELECT A14_TEMP
       GO TOP
       THIS.ADDITEM(' ')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(A14_TEMP.F01)+SPACE(5)+ALLTRIM(A14_TEMP.F02))
      	      SELECT  A14_TEMP
      	      SKIP
       ENDDO
       SELECT A14_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=LEFT(THIS.DISPLAYVALUE,5)
       THISFORM.PAGEFRAME1.PAGE1.LBLF051.CAPTION=RIGHT(ALLTRIM(THIS.DISPLAYVALUE),LEN(ALLTRIM(THIS.DISPLAYVALUE))-9)
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.REFRESH  
  ENDPROC       
ENDDEFINE
***************************************************任職狀況
DEFINE CLASS COMBOBOX07 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*80
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX07'
 PROCEDURE INIT    
       THIS.ADDITEM('新進人員') 
       THIS.ADDITEM('資料補登') 
       THIS.ADDITEM('在        職')      
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=THIS.DISPLAYVALUE
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.REFRESH  
  ENDPROC       
ENDDEFINE
***************************************************出生日期
DEFINE CLASS TXTF14 AS TEXTBOX
       HEIGHT=INT_015*25
       WIDTH=INT_015*65
       FONTSIZE=INT_015*9   
       NAME='TXTF14 '
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.LBLF141.CAPTION='現年'+ALLTRIM(STR(VAL(LEFT(DTOS(DATE()),4))-VAL(LEFT(DTOS(THIS.VALUE),4))))+'歲'
       THISFORM.PAGEFRAME1.PAGE1.TXTF14.REFRESH 
  ENDPROC       
ENDDEFINE
******************************************性別
DEFINE CLASS OPTIONGROUP15 AS OPTIONGROUP
       HEIGHT=INT_015*25
       WIDTH=INT_015*105
       FONTSIZE=INT_015*9   
       BUTTONCOUNT=2
       VALUE=1
       ENABLED=.F.       
       NAME='OPTIONGROUP15'
       OPTION1.CAPTION='男'
       OPTION1.TOP=INT_015*5
       OPTION1.FONTSIZE=INT_015*9	  
       OPTION1.AUTOSIZE=.T.
       OPTION1.LEFT=INT_015*5
       OPTION1.NAME='OPTION1'
       OPTION2.CAPTION='女'
       OPTION2.TOP=INT_015*5
       OPTION2.FONTSIZE=INT_015*9	  
       OPTION2.AUTOSIZE=.T.
       OPTION2.LEFT=INT_015*60
       OPTION2.NAME='OPTION2'            
   PROCEDURE INTERACTIVECHANGE
       IF THIS.VALUE=1
            THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.VALUE=1
       ELSE
            THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP10.VALUE=3 
       ENDIF
  ENDPROC       
ENDDEFINE
***************************************************戶籍地址
DEFINE CLASS TXTF21 AS TEXTBOX
       HEIGHT=INT_015*25
       WIDTH=INT_015*450
       MAXLENGTH=80
       FONTSIZE=INT_015*9   
       NAME='TXTF21 '
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=THIS.VALUE
       THISFORM.PAGEFRAME1.PAGE1.TXTF21.REFRESH 
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.REFRESH 
  ENDPROC       
ENDDEFINE
***************************************************戶籍電話
DEFINE CLASS TXTF22 AS TEXTBOX
       HEIGHT=INT_015*25
       WIDTH=INT_015*120
       MAXLENGTH=20
       FONTSIZE=INT_015*9   
       NAME='TXTF21 '
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE=THIS.VALUE
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.REFRESH 
       THISFORM.PAGEFRAME1.PAGE1.TXTF24.REFRESH 
  ENDPROC       
ENDDEFINE
***************************************************專業類別
DEFINE CLASS OPTIONGROUP08 AS OPTIONGROUP
      VISIBLE=.T.
      HEIGHT=INT_015*25
      WIDTH=INT_015*160
      BUTTONCOUNT=3
      VALUE=1
      ENABLED=.F.
      NAME='OPTIONGROUP08'
      OPTION1.CAPTION='語言'
      OPTION1.TOP=INT_015*5
      OPTION1.FONTSIZE=INT_015*9	  
      OPTION1.AUTOSIZE=.T.
      OPTION1.LEFT=INT_015*5
      OPTION1.NAME='OPTION1'
      OPTION2.CAPTION='專長'
      OPTION2.TOP=INT_015*5
      OPTION2.FONTSIZE=INT_015*9	  
      OPTION2.AUTOSIZE=.T.
      OPTION2.LEFT=INT_015*55
      OPTION2.NAME='OPTION2'     	  
      OPTION3.CAPTION='證照'
      OPTION3.TOP=INT_015*5
      OPTION3.FONTSIZE=INT_015*9	  
      OPTION3.AUTOSIZE=.T.
      OPTION3.LEFT=INT_015*105
      OPTION3.NAME='OPTION3'  	  
   PROCEDURE INTERACTIVECHANGE
       IF THIS.VALUE=3
           THISFORM.PAGEFRAME1.PAGE3.LBLF10.VISIBLE=.F. 
           THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VISIBLE=.F. 
       ELSE
           THISFORM.PAGEFRAME1.PAGE3.LBLF10.VISIBLE=.T. 
           THISFORM.PAGEFRAME1.PAGE3.OPTIONGROUP10.VISIBLE=.T.    
       ENDIF
  ENDPROC       
ENDDEFINE
*********************************************A50.F07任職狀況
FUNC BILL_MODE
     PARA JUKK
     JOO=''
     DO CASE
        CASE JUKK='A'
             JOO='新進人員'
        CASE JUKK='B'
             JOO='資料補登'     
        CASE JUKK='C'
             JOO='在        職'                       
        CASE JUKK='1'
             JOO='已  離  職'
        CASE JUKK='2'
             JOO='離職復職'
        CASE JUKK='3'
             JOO='留職停薪'           
        CASE JUKK='4'
             JOO='留職復職'            
        CASE JUKK='5'
             JOO='職務調整'       
        CASE JUKK='6'
             JOO='升        遷'                                                             
     ENDCASE
     RETURN JOO  
