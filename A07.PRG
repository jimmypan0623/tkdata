****程式名稱 A07 程式授權管理
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
R=0
AREA1='A01'
AREA2='A02'
IF ! USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
SEEK SYS_OPER
GK=F03
IF !USED('A03')
   SELE 0
   USE A03
ELSE 
   SELE A03
ENDIF
SET ORDER TO A03
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE 
   SELE A02
ENDIF
SET ORDER TO A021   
SEEK SYS_OPER+'A07'
GL=F04
GM=F05
GN=F06
GP=F07
GC=F08
SET RELA TO F03 INTO A03        
********* 
A07FORM=CREATEOBJECT("TKA07")
A07FORM.SHOW  
DEFINE CLASS TKA07 AS FORM
  CAPTION='A07.程式授權管理'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKA07'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*200,;
      FONTSIZE=INT_015*9,;      
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='依人員編號搜尋紀錄',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='詳細資料內容'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='A01',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'      
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=11,;            
      RECORDSOURCE='A02',;
      LINKMASTER='A01',;
      RELATIONALEXPR='F01',;
      CHILDORDER='A021',; 
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10',;
      COLUMN11.NAME='COLUMN11'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOSIZE=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*173,;
      LEFT=INT_015*558          
    ADD OBJECT COPY_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      FONTSIZE=INT_015*9,;
      WIDTH=INT_015*90,;      
      CAPTION='\<C.比照人員授權',;
      NAME='COPY_BOTT'     
 ************     
  PROCEDURE PAGEFRAME1.PAGE1.INIT     
     THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*27
          .WIDTH=INT_015*50
          .CAPTION='人員編號'          
     ENDWITH
     THIS.ADDOBJECT('LBLF011','LABEL')     
     WITH THIS.LBLF011
          .VISIBLE=.T.
          .LEFT=INT_015*125
          .TOP=INT_015*27
          .AUTOSIZE=.T.  
     ENDWITH            
     THIS.ADDOBJECT('TXTF01','TEXTBOX')     
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*23
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=5          
     ENDWITH        
  ENDPROC   
  ****
  PROCEDURE PAGEFRAME1.PAGE2.INIT
    THIS.ADDOBJECT('LBLF01','LABEL')
    WITH THIS.LBLF01
         .LEFT=INT_015*14
         .TOP=INT_015*17
         .CAPTION='人員編號'
         .WIDTH=INT_015*50
    ENDWITH
    THIS.ADDOBJECT('LBLF011','LABEL')
    WITH THIS.LBLF011
         .LEFT=INT_015*125
         .TOP=INT_015*17
         .AUTOSIZE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF01','TXTF01')
    WITH THIS.TXTF01
         .LEFT=INT_015*65
         .TOP=INT_015*13
         .WIDTH=INT_015*50   
         .BACKCOLOR=RGB(255,255,100)
  	 .MOUSEPOINTER=99
  	 .MOUSEICON='BMPS\harrow.cur'                    
         .NAME='TXTF01'
    ENDWITH     
    THIS.ADDOBJECT('LBLF03','LABEL')
    WITH THIS.LBLF03
         .LEFT=INT_015*14
         .TOP=INT_015*17
         .CAPTION='程式代號'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('LBLF031','LABEL')
    WITH THIS.LBLF031
         .LEFT=INT_015*125
         .TOP=INT_015*17
         .AUTOSIZE=.T.
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF03','TXTF03')
    WITH THIS.TXTF03
         .LEFT=INT_015*65
         .TOP=INT_015*13
         .WIDTH=INT_015*50
         .BACKCOLOR=RGB(255,255,100)
  	 .MOUSEPOINTER=99
  	 .MOUSEICON='BMPS\harrow.cur'                    
         .MAXLENGTH=3
         .VISIBLE=.T.
    ENDWITH     
	THIS.ADDOBJECT('CHKF04','CHECKBOX')
	WITH THIS.CHKF04  
         .LEFT=INT_015*14
         .TOP=INT_015*53
         .CAPTION='新增'
    ENDWITH  
    THIS.ADDOBJECT('CHKF05','CHECKBOX')
    WITH THIS.CHKF05
         .LEFT=INT_015*328
	     .TOP=INT_015*53
	     .CAPTION='修改'
	ENDWITH     
    THIS.ADDOBJECT('CHKF06','CHECKBOX')
    WITH THIS.CHKF06        
	     .LEFT=INT_015*14
	     .TOP=INT_015*78
	     .CAPTION='刪除'
	ENDWITH     
    THIS.ADDOBJECT('CHKF07','CHECKBOX')
    WITH THIS.CHKF07
         .LEFT=INT_015*328
         .TOP=INT_015*78
         .CAPTION='列印'        
    ENDWITH     
    THIS.ADDOBJECT('CHKF08','CHECKBOX')
    WITH THIS.CHKF08    
         .LEFT=INT_015*14
         .TOP=INT_015*103
         .CAPTION='附一'       
    ENDWITH     
    THIS.ADDOBJECT('CHKF09','CHECKBOX')      
    WITH THIS.CHKF09
         .LEFT=INT_015*328
         .TOP=INT_015*103
         .CAPTION='附二'
    ENDWITH     
    THIS.ADDOBJECT('CHKF10','CHECKBOX')
    WITH THIS.CHKF10
         .LEFT=INT_015*14
         .TOP=INT_015*128
         .CAPTION='附三'
    ENDWITH     
    THIS.ADDOBJECT('CHKF11','CHECKBOX')
    WITH THIS.CHKF11
         .LEFT=INT_015*328
         .TOP=INT_015*128
         .CAPTION='附四'
    ENDWITH     
    THIS.ADDOBJECT('CHKF12','CHECKBOX')
    WITH THIS.CHKF12
         .LEFT=INT_015*14
         .TOP=INT_015*153
         .CAPTION='附五'               
    ENDWITH  
    THIS.ADDOBJECT('LBLF13','LABEL')
    WITH THIS.LBLF13
         .VISIBLE=.T.           
         .LEFT=INT_015*328
         .TOP=INT_015*153
         .WIDTH=INT_015*50
         .CAPTION='安全資料'          
         .VISIBLE=.T.
    ENDWITH     
    THIS.ADDOBJECT('LBLF131','LABEL')
    WITH THIS.LBLF131
         .VISIBLE=.T.           
         .LEFT=INT_015*380
         .TOP=INT_015*153
         .AUTOSIZE=.T.          
         .VISIBLE=.T.
    ENDWITH     
  ENDPROC     
 ************   
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
     R=0
     IF THISFORM.KEY_LIST.DISPLAYVALUE='依人員編號排列'
        SELE A01
     ELSE
        SELE A03
     ENDIF      
     SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE          
     THISFORM.GRID1.ENABLED=.T.          
     THISFORM.GRID1.SETFOCUS     
     IF THISFORM.GRID1.ACTIVEROW=0
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
     ENDIF   
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
     THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
     THISFORM.KEY_LIST.ENABLED=.T.
     IF  THISFORM.KEY_LIST.VALUE=1
     	   THISFORM.COPY_BOTT.ENABLED=IIF(GC='*',.T.,.F.) &&判斷有無比照人員權限設定的權限 
     ELSE
     	   THISFORM.COPY_BOTT.ENABLED=.F.
     ENDIF	   
  ENDPROC
 ********** 
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
     SELE A02
     IF THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.GRID2.SETFOCUS 
        THISFORM.GRID2.READONLY=.T.
     ENDIF   
     IF THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
        THISFORM.COPY_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限        
         THISFORM.COPY_BOTT.ENABLED=.F.
     ENDIF   
     R=RECNO('&AREA1')
     THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
     THISFORM.GRID1.ENABLED=.F.     
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)   &&判斷有無新增的權限
     THISFORM.KEY_LIST.ENABLED=.F.     
  ENDPROC   
**********
  PROC INIT
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9                
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限      
       THISFORM.PAGEFRAME1.FONTSIZE=INT_015*9  
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('READONLY',.T.,'CHECKBOX')
       THISFORM.SETALL('AUTOSIZE',.T.,'CHECKBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'CHECKBOX')       
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER') 
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)      
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='人員編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='人員姓名'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A01.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A01.F03'
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')       
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='程式編號'
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='程式名稱'
	   THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='新增'
	   THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='修改'
	   THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='刪除'
	   THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='列印'
	   THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='附一'
	   THISFORM.GRID2.COLUMN8.HEADER1.CAPTION='附二'
	   THISFORM.GRID2.COLUMN9.HEADER1.CAPTION='附三'       	   
	   THISFORM.GRID2.COLUMN10.HEADER1.CAPTION='附四'       	   
	   THISFORM.GRID2.COLUMN11.HEADER1.CAPTION='附五' 	 
	   THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A02.F03'
	   THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A03.F02'
	   THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A02.F04'
	   THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A02.F05'
	   THISFORM.GRID2.COLUMN5.CONTROLSOURCE='A02.F06'
	   THISFORM.GRID2.COLUMN6.CONTROLSOURCE='A02.F07'
	   THISFORM.GRID2.COLUMN7.CONTROLSOURCE='A02.F08'
	   THISFORM.GRID2.COLUMN8.CONTROLSOURCE='A02.F09'
	   THISFORM.GRID2.COLUMN9.CONTROLSOURCE='A02.F10'
	   THISFORM.GRID2.COLUMN10.CONTROLSOURCE='A02.F11'
	   THISFORM.GRID2.COLUMN11.CONTROLSOURCE='A02.F12'
	   THISFORM.GRID2.COLUMN1.WIDTH=INT_015*50
	   THISFORM.GRID2.COLUMN2.WIDTH=INT_015*119
	   THISFORM.GRID2.COLUMN3.WIDTH=INT_015*30
	   THISFORM.GRID2.COLUMN4.WIDTH=INT_015*30
	   THISFORM.GRID2.COLUMN5.WIDTH=INT_015*30
	   THISFORM.GRID2.COLUMN6.WIDTH=INT_015*30
	   THISFORM.GRID2.COLUMN7.WIDTH=INT_015*30
	   THISFORM.GRID2.COLUMN8.WIDTH=INT_015*30
	   THISFORM.GRID2.COLUMN9.WIDTH=INT_015*30
	   THISFORM.GRID2.COLUMN10.WIDTH=INT_015*30
	   THISFORM.GRID2.COLUMN11.WIDTH=INT_015*30
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID2.READONLY=.T.           
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.      
       ENDIF          
       THISFORM.KEY_LIST.DISPLAYVALUE='依人員編號排列'       
       JK='人員編號'
       SELE A01
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A01.F01
       THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=A01.F03
  ENDPROC     
***********   
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依人員編號排列')
           .ADDITEM('依程式編號排列')
       ENDWITH      
  ENDPROC 
 *********** 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE A01
       SET RELA OFF INTO A02
       SELE A03
       SET RELA OFF INTO A02
       SELE A02
       SET RELA OFF INTO A01
       SET RELA OFF INTO A03       
       THISFORM.GRID1.RECORDSOURCE=''
       THISFORM.GRID1.CHILDORDER=''
       DO CASE
          CASE THIS.DISPLAYVALUE='依人員編號排列'
               THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照人員編號搜尋紀錄'
               SELE A01
               GO TOP
               AREA1='A01'
               SELE A02
               SET ORDER TO A021     
               SET RELA TO F03 INTO A03       
               THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='人員編號'
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.MAXLENGTH=5
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A01.F01
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=A01.F03
               THISFORM.PAGEFRAME1.PAGE2.LBLF01.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF011.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF03.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF031.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF03.CAPTION='程式編號'
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A02.F03
               THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=A03.F02 
               THISFORM.PAGEFRAME1.PAGE2.LBLF031.LEFT=INT_015*116
               THISFORM.GRID1.RECORDSOURCE='A01'
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='人員編號'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='人員姓名'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A01.F01'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A01.F03'   
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID2.LINKMASTER='A01'
               THISFORM.GRID2.RELATIONALEXPR='F01'
               THISFORM.GRID2.CHILDORDER='A021'            
               THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='程式編號'
               THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A02.F03'
               THISFORM.GRID2.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='程式名稱'
               THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A03.F02'   
               THISFORM.GRID2.COLUMN2.WIDTH=INT_015*119                  
          CASE THIS.DISPLAYVALUE='依程式編號排列'
               THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照程式編號搜尋紀錄'          
               SELE A03
               GO TOP
               AREA1='A03'
               SELE A02
               SET ORDER TO A022
               SET RELA TO F01 INTO A01
               THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='程式編號'
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.MAXLENGTH=3
               THISFORM.PAGEFRAME1.PAGE2.LBLF01.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF011.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF03.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF031.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VISIBLE=.F.  
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A03.F01
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=A03.F02 
               THISFORM.PAGEFRAME1.PAGE2.LBLF01.CAPTION='人員編號'
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=A02.F01
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.WIDTH=INT_015*50
               THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=A01.F03
               THISFORM.PAGEFRAME1.PAGE2.LBLF011.LEFT=INT_015*116                                                                                
               THISFORM.GRID1.RECORDSOURCE='A03'
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='程式編號'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='程式名稱'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A03.F01'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A03.F02'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*149   
               THISFORM.GRID2.LINKMASTER='A03'
               THISFORM.GRID2.RELATIONALEXPR='F01'
               THISFORM.GRID2.CHILDORDER='A022'  
               THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='人員編號'
               THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A02.F01'
               THISFORM.GRID2.COLUMN1.WIDTH=INT_015*50               
               THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='人員姓名'
               THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A01.F03'       
               THISFORM.GRID2.COLUMN2.WIDTH=INT_015*50                            
       ENDCASE 
        THISFORM.PAGEFRAME1.ACTIVEPAGE=2
        THISFORM.PAGEFRAME1.ACTIVEPAGE=1
        SELE &AREA1
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
  **********
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       IF THISFORM.KEY_LIST.DISPLAYVALUE='依人員編號排列'
          THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A01.F01
          THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=A01.F03
       ELSE          
          THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A03.F01
          THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=A03.F02
       ENDIF
       IF THIS.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
          IF AREA1='A03'             
             THISFORM.PAGEFRAME1.PAGE2.CHKF04.VISIBLE=IIF(A03.F04='0',.F.,.T.)
             THISFORM.PAGEFRAME1.PAGE2.CHKF05.VISIBLE=IIF(A03.F05='0',.F.,.T.)
             THISFORM.PAGEFRAME1.PAGE2.CHKF06.VISIBLE=IIF(A03.F06='0',.F.,.T.)
             THISFORM.PAGEFRAME1.PAGE2.CHKF07.VISIBLE=IIF(A03.F07='0',.F.,.T.)
             THISFORM.PAGEFRAME1.PAGE2.CHKF08.CAPTION='附一('+ALLTRIM(A03.F08)+')'
             THISFORM.PAGEFRAME1.PAGE2.CHKF09.CAPTION='附二('+ALLTRIM(A03.F09)+')'
             THISFORM.PAGEFRAME1.PAGE2.CHKF10.CAPTION='附三('+ALLTRIM(A03.F10)+')'
             THISFORM.PAGEFRAME1.PAGE2.CHKF11.CAPTION='附四('+ALLTRIM(A03.F11)+')'
             THISFORM.PAGEFRAME1.PAGE2.CHKF12.CAPTION='附五('+ALLTRIM(A03.F12)+')'
             THISFORM.PAGEFRAME1.PAGE2.CHKF08.VISIBLE=IIF(EMPTY(A03.F08),.F.,.T.)
             THISFORM.PAGEFRAME1.PAGE2.CHKF09.VISIBLE=IIF(EMPTY(A03.F09),.F.,.T.)
             THISFORM.PAGEFRAME1.PAGE2.CHKF10.VISIBLE=IIF(EMPTY(A03.F10),.F.,.T.)
             THISFORM.PAGEFRAME1.PAGE2.CHKF11.VISIBLE=IIF(EMPTY(A03.F11),.F.,.T.)
             THISFORM.PAGEFRAME1.PAGE2.CHKF12.VISIBLE=IIF(EMPTY(A03.F12),.F.,.T.)         
          ENDIF
       ENDIF   
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION         
       CHK=''     
       THISFORM.REFRESH
  ENDPROC     
  ***********
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       IF AREA1='A01'
          THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=F03
          THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=A03.F02       
          THISFORM.PAGEFRAME1.PAGE2.CHKF04.VISIBLE=IIF(A03.F04='0',.F.,.T.)
          THISFORM.PAGEFRAME1.PAGE2.CHKF05.VISIBLE=IIF(A03.F05='0',.F.,.T.)
          THISFORM.PAGEFRAME1.PAGE2.CHKF06.VISIBLE=IIF(A03.F06='0',.F.,.T.)
          THISFORM.PAGEFRAME1.PAGE2.CHKF07.VISIBLE=IIF(A03.F07='0',.F.,.T.)
          THISFORM.PAGEFRAME1.PAGE2.CHKF08.CAPTION='附一('+ALLTRIM(A03.F08)+')'
          THISFORM.PAGEFRAME1.PAGE2.CHKF09.CAPTION='附二('+ALLTRIM(A03.F09)+')'
          THISFORM.PAGEFRAME1.PAGE2.CHKF10.CAPTION='附三('+ALLTRIM(A03.F10)+')'
          THISFORM.PAGEFRAME1.PAGE2.CHKF11.CAPTION='附四('+ALLTRIM(A03.F11)+')'
          THISFORM.PAGEFRAME1.PAGE2.CHKF12.CAPTION='附五('+ALLTRIM(A03.F12)+')'
          THISFORM.PAGEFRAME1.PAGE2.CHKF08.VISIBLE=IIF(EMPTY(A03.F08),.F.,.T.)
          THISFORM.PAGEFRAME1.PAGE2.CHKF09.VISIBLE=IIF(EMPTY(A03.F09),.F.,.T.)
          THISFORM.PAGEFRAME1.PAGE2.CHKF10.VISIBLE=IIF(EMPTY(A03.F10),.F.,.T.)
          THISFORM.PAGEFRAME1.PAGE2.CHKF11.VISIBLE=IIF(EMPTY(A03.F11),.F.,.T.)
          THISFORM.PAGEFRAME1.PAGE2.CHKF12.VISIBLE=IIF(EMPTY(A03.F12),.F.,.T.)
       ELSE
          THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=F01
          THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=A01.F03
       ENDIF                 
       THISFORM.PAGEFRAME1.PAGE2.CHKF04.VALUE=IIF(A02.F04='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.CHKF05.VALUE=IIF(A02.F05='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.CHKF06.VALUE=IIF(A02.F06='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.CHKF07.VALUE=IIF(A02.F07='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.CHKF08.VALUE=IIF(A02.F08='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.CHKF09.VALUE=IIF(A02.F09='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.CHKF10.VALUE=IIF(A02.F10='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.CHKF11.VALUE=IIF(A02.F11='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.CHKF12.VALUE=IIF(A02.F12='*',1,0)
       THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=F13
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
          THISFORM. CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ENDIF   
  ENDPROC 
  ***********
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
     THISFORM.GRID2.ENABLED=.F. 
     IF AREA1='A01'
         THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F. 
         THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
         THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''          
         THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
     ELSE
         THISFORM.PAGEFRAME1.PAGE2.TXTF01.READONLY=.F. 
         THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
         THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=''          
         THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=''
     ENDIF   
     THISFORM.PAGEFRAME1.PAGE2.CHKF04.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.CHKF05.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.CHKF06.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.CHKF07.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.CHKF08.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.CHKF09.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.CHKF10.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.CHKF11.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.CHKF12.VISIBLE=.F.         
     THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'CHECKBOX')          
     THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE',0,'CHECKBOX')     
  ENDPROC  
  *********
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
     THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'CHECKBOX')     
     THISFORM.GRID1.ENABLED=.F.
     THISFORM.GRID2.ENABLED=.F.
     IF AREA1='A01'
          THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
     ELSE
          THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
     ENDIF     
     LOCK()
     IF !RLOCK()
        DO FILE_IMPACT
        RETURN
     ENDIF
  ENDPROC      
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK
     IF MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	      
        SELE A02   
        LOCK()
        IF RLOCK()
           DELE
           UNLOCK
           SKIP -1
           IF BOF()
              GO TOP
           ENDIF   
           THISFORM.GRID2.SETFOCUS
           IF THISFORM.GRID2.ACTIVEROW=0
              THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
              THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE',.F.,'CHECKBOX')
              THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
              THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
              THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
              THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
              THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
           ELSE
              THISFORM.CMDGROUP.ENABLED=.T. 
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限
              THISFORM.COPY_BOTT.ENABLED=.F.
           ENDIF
        ELSE
           DO FILE_IMPACT    
        ENDIF         
     ENDIF   
  ENDPROC  
  *********
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK    
       IF AREA1='A01'
            DO CASE
               CASE SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE,'A03')=.F.
                    =MESSAGEBOX('無此程式編號!',0+48,'提示訊息視窗')
                    THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
                    RETURN
               CASE SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)+THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE,'A02')=.T.    
                   =MESSAGEBOX('此程式已授權!',0+48,'提示訊息視窗')
                   THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
                   RETURN               
            OTHERWISE
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE   
            ENDCASE                 
       ELSE
            DO CASE
               CASE SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE,'A01')=.F. 
                    =MESSAGEBOX('人員基本主檔無此編號!',0+48,'提示訊息視窗')
                    THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
                    RETURN
               CASE SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE,'A02')=.T.       
                    =MESSAGEBOX('此人員已授權!',0+48,'提示訊息視窗')
                    THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
                    RETURN                           
               OTHERWISE
                    THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE    
            ENDCASE
       ENDIF           
    SELE A02
    APPEND BLANK
    LOCK()
    IF RLOCK()
       IF AREA1='A01'       
          REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
          REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE     
       ELSE
          REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
          REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE       
       ENDIF   
       REPLACE F04 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF04.VALUE=1,'*','')
       REPLACE F05 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF05.VALUE=1,'*','')
       REPLACE F06 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF06.VALUE=1,'*','')
       REPLACE F07 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF07.VALUE=1,'*','')
       REPLACE F08 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF08.VALUE=1,'*','')
       REPLACE F09 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF09.VALUE=1,'*','')       
       REPLACE F10 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF10.VALUE=1,'*','') 
       REPLACE F11 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF11.VALUE=1,'*','')             
       REPLACE F12 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF12.VALUE=1,'*','')
       REPLACE F13 WITH DTOC(DATE())+' '+GK
       REPLACE F14 WITH .T.
    ENDIF
    UNLOCK
    IF AREA1='A01'
       SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
    ELSE
       SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE
    ENDIF   
    THISFORM.GRID2.ENABLED=.T.    
    THISFORM.GRID2.SETFOCUS    
    THISFORM.ORPGROUP.NEW_BOTT.CLICK            
  ENDPROC
  *********
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
    IF AREA1='A01'
       THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    ELSE
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    ENDIF      
    SELE A02
    IF RLOCK()
       REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE
       REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
       REPLACE F04 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF04.VALUE=1,'*','')
       REPLACE F05 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF05.VALUE=1,'*','')
       REPLACE F06 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF06.VALUE=1,'*','')
       REPLACE F07 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF07.VALUE=1,'*','')
       REPLACE F08 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF08.VALUE=1,'*','')
       REPLACE F09 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF09.VALUE=1,'*','')       
       REPLACE F10 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF10.VALUE=1,'*','') 
       REPLACE F11 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF11.VALUE=1,'*','')             
       REPLACE F12 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.CHKF12.VALUE=1,'*','')       
       REPLACE F13 WITH DTOC(DATE())+' '+GK       
    ELSE
      DO FILE_IMPACT
      RETURN   
    ENDIF   
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC 
  **********  
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)   &&判斷有無新增的權限      
      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限      
      THISFORM.COPY_BOTT.ENABLED=.F.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.PAGEFRAME1.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF01.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.T.,'CHECKBOX')
      UNLOCK ALL
      SELE A02
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.GRID2.ENABLED=.T.
      THISFORM.GRID2.SETFOCUS    
      UNLOCK ALL
  ENDPROC
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
       SELE A02
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
 **************比照人員授權
PROC COPY_BOTT.CLICK
   SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 &&WHERE EMPTY(F06)
   MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
   MAN_SEEK.SHOW    
   IF !EMPTY(FLG)
       IF MESSAGEBOX(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION+'之權限設定是否要與'+IIF(SEEK(FLG,'A01'),A01.F03,'')+'之權限設定完全相同',4+32+256,'請確認') = 6
           SELECT A02
           SET ORDER TO A021
	   SELECT F03,F04,F05,F06,F07,F08,F09,F10,F11,F12 FROM A02 WHERE  A02.F01=FLG INTO CURSOR A02_TEMP
	   SELECT A02_TEMP
	   GO TOP
	   DO WHILE !EOF()
	         SELECT A02
	         SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+A02_TEMP.F03
	         IF FOUND()
	             SELECT A02
		     REPLACE F04 WITH A02_TEMP.F04
		     REPLACE F05 WITH A02_TEMP.F05
		     REPLACE F06 WITH A02_TEMP.F06
		     REPLACE F07 WITH A02_TEMP.F07
		     REPLACE F08 WITH A02_TEMP.F08
		     REPLACE F09 WITH A02_TEMP.F09
		     REPLACE F10 WITH A02_TEMP.F10
		     REPLACE F11 WITH A02_TEMP.F11
		     REPLACE F12 WITH A02_TEMP.F12
		     REPLACE F13 WITH DTOC(DATE())+' '+GK	
		     REPLACE F14 WITH .T.            
	        ELSE
		     SELECT A02
		     APPEND BLANK
		     REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE 
		     REPLACE F03 WITH A02_TEMP.F03
		     REPLACE F04 WITH A02_TEMP.F04
		     REPLACE F05 WITH A02_TEMP.F05
		     REPLACE F06 WITH A02_TEMP.F06
		     REPLACE F07 WITH A02_TEMP.F07
		     REPLACE F08 WITH A02_TEMP.F08
		     REPLACE F09 WITH A02_TEMP.F09
		     REPLACE F10 WITH A02_TEMP.F10
		     REPLACE F11 WITH A02_TEMP.F11
		     REPLACE F12 WITH A02_TEMP.F12
		     REPLACE F13 WITH DTOC(DATE())+' '+GK
		     REPLACE F14 WITH .T.
		ENDIF     
	   	SELECT A02_TEMP
	   	SKIP
	ENDDO
		=MESSAGEBOX('已完成權限之設定!',0+64,'提示訊息視窗')
	ENDIF
   ENDIF
   SELECT A02
   FLG='0'
   THISFORM.REFRESH
ENDPROC
ENDDEFINE       
***********************************************列印程序
PROCEDURE PNT_PRC  
  
ENDPROC     
**************************************************特殊欄位設定-----------人員編號
DEFINE CLASS TXTF01 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=5
  HEIGHT=INT_015*25
  FONTSIZE=INT_015*9
  PROCEDURE DBLCLICK
      SELECT A02.F01 FROM A02 WHERE ALLTRIM(A02.F03)=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)  GROUP BY A02.F01 INTO CURSOR A02_TEMP
      SELECT F01,F03 FROM A01 INTO CURSOR MAN READWRITE ORDER BY F01 WHERE EMPTY(F06)    
      INDE ON F01 TAG MAN1
      SELECT  MAN
      SET ORDER TO MAN1
      SELECT A02_TEMP
      GO TOP
      DO WHILE !EOF()
	     SELECT MAN
	     SEEK A02_TEMP.F01
	     IF FOUND()
		 DELETE 
             ENDIF
	     SELECT A02_TEMP
	     SKIP 
       ENDDO     
       SELECT  A02_TEMP  
       USE 
       SELECT MAN
       GO TOP
       IF _TALLY>0              
           MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
           MAN_SEEK.SHOW    
           THIS.VALUE=FLG
           THIS.REFRESH
           FLG='0'
       ELSE
           SELECT MAN
           USE
           =MESSAGEBOX('此程式編號已存在所有人員中!',0+64,'提示訊息視窗') 
	   THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
	   RETURN    
       ENDIF              
       THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=IIF(SEEK(THIS.VALUE,'A01'),A01.F03,'') 
  ENDPROC 
  ********
  PROCEDURE INTERACTIVECHANGE
    SELECT A02.F01 FROM A02 WHERE ALLTRIM(A02.F03)=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE) GROUP BY A02.F01 INTO CURSOR A02_TEMP
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
         IF AT('?',ALLTRIM(THIS.VALUE))>1             
             SELECT F01,F03 FROM A01 INTO CURSOR MAN READWRITE  ORDER BY F01 WHERE EMPTY(F06) AND LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1)
             INDE ON F01 TAG MAN1
         ELSE
            SELECT F01,F03 FROM A01 INTO CURSOR MAN READWRITE ORDER BY F01 WHERE EMPTY(F06)    
            INDE ON F01 TAG MAN1
         ENDIF   
	 SELECT  MAN
	 SET ORDER TO MAN1
	 SELECT A02_TEMP
	 GO TOP
	 DO WHILE !EOF()
	 	 SELECT MAN
	     	 SEEK A02_TEMP.F01
		 IF FOUND()
		       DELETE 
		 ENDIF
		 SELECT A02_TEMP
	   	 SKIP
	  ENDDO     
	  SELECT  A02_TEMP  
	  USE 
	  SELECT MAN
	  GO TOP
	  IF _TALLY>0              
              MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
              MAN_SEEK.SHOW    
              THIS.VALUE=FLG
              THIS.REFRESH
              FLG='0'
          ELSE
               SELECT MAN
               USE
               =MESSAGEBOX('此程式編號已存在所有人員中!',0+64,'提示訊息視窗') 
	       THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
	       RETURN    
          ENDIF              
    ENDIF   
    THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=IIF(SEEK(THIS.VALUE,'A01'),A01.F03,'')  
  ENDPROC
ENDDEFINE  
***************************************************特殊輸入欄位設定-----------程式編號
DEFINE CLASS TXTF03 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=3
  HEIGHT=INT_015*25
  FONTSIZE=INT_015*9
  NAME='TXTF03'
  PROCEDURE DBLCLICK 
    SELECT A02 .F03 FROM A02 WHERE ALLTRIM(A02.F01)=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE) ORDER BY A02 .F03 INTO CURSOR A02_TEMP
    SELECT F01,F02,F04,F05,F06,F07,F08,F09,F10,F11,F12 FROM A03 WHERE A03.F14<>.F. ORDER BY A03.F01 INTO CURSOR PRGS READWRITE 
    INDE ON F01 TAG PRGS1  
    SELECT  PRGS
    SET ORDER TO PRGS1
    SELECT A02_TEMP
    GO TOP
    DO WHILE !EOF()
   	   SELECT PRGS 
     	   SEEK A02_TEMP.F03
	   IF FOUND()
	       DELETE 
	   ENDIF
	   SELECT A02_TEMP
   	   SKIP
    ENDDO     
    SELECT  A02_TEMP  
    USE 
    SELECT PRGS
    GO TOP
    IF _TALLY>0     
       PRG_SEEK=CREATEOBJECT("PRG_SEEK")  
       PRG_SEEK.SHOW
       THIS.VALUE=FLG 
       THIS.REFRESH 
       FLG='0'     
       AREA1='A01'   
       SELECT PRGS
       USE        
       THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=IIF(SEEK(THIS.VALUE,'A03'),A03.F02,'')  
       THISFORM.PAGEFRAME1.PAGE2.CHKF04.VISIBLE=IIF(A03.F04='0',.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE2.CHKF05.VISIBLE=IIF(A03.F05='0',.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE2.CHKF06.VISIBLE=IIF(A03.F06='0',.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE2.CHKF07.VISIBLE=IIF(A03.F07='0',.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE2.CHKF08.CAPTION='附一('+ALLTRIM(A03.F08)+')'
       THISFORM.PAGEFRAME1.PAGE2.CHKF09.CAPTION='附二('+ALLTRIM(A03.F09)+')'
       THISFORM.PAGEFRAME1.PAGE2.CHKF10.CAPTION='附三('+ALLTRIM(A03.F10)+')'
       THISFORM.PAGEFRAME1.PAGE2.CHKF11.CAPTION='附四('+ALLTRIM(A03.F11)+')'
       THISFORM.PAGEFRAME1.PAGE2.CHKF12.CAPTION='附五('+ALLTRIM(A03.F12)+')'
       THISFORM.PAGEFRAME1.PAGE2.CHKF08.VISIBLE=IIF(EMPTY(A03.F08),.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE2.CHKF09.VISIBLE=IIF(EMPTY(A03.F09),.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE2.CHKF10.VISIBLE=IIF(EMPTY(A03.F10),.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE2.CHKF11.VISIBLE=IIF(EMPTY(A03.F11),.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE2.CHKF12.VISIBLE=IIF(EMPTY(A03.F12),.F.,.T.)             
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS     	                   
  ELSE
         SELECT PRGS
         USE
         =MESSAGEBOX('已無程式作業可選取!',0+64,'提示訊息視窗') 
	 THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
	 RETURN    
  ENDIF               
ENDPROC  
  ********
  PROCEDURE INTERACTIVECHANGE
    SELECT A02 .F03 FROM A02 WHERE ALLTRIM(A02.F01)=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE) ORDER BY A02 .F03 INTO CURSOR A02_TEMP
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
         IF AT('?',ALLTRIM(THIS.VALUE))>1                          
             SELECT F01,F02,F04,F05,F06,F07,F08,F09,F10,F11,F12 FROM A03 WHERE A03.F14<>.F.  AND LEFT(A03.F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1)  ORDER BY A03.F01  INTO CURSOR PRGS READWRITE 
             INDE ON F01 TAG PRGS1
         ELSE
             SELECT F01,F02,F04,F05,F06,F07,F08,F09,F10,F11,F12 FROM A03 WHERE A03.F14<>.F. ORDER BY A03.F01 INTO CURSOR PRGS READWRITE 
             INDE ON F01 TAG PRGS1 
         ENDIF   
         SELECT  PRGS
         SET ORDER TO PRGS1
	 SELECT A02_TEMP
	 GO TOP
	 DO WHILE !EOF()
		SELECT PRGS 
		SEEK A02_TEMP.F03
	        IF FOUND()
		     DELETE 
		ENDIF
		SELECT A02_TEMP
		SKIP
          ENDDO     
          SELECT  A02_TEMP  
          USE 
          SELECT PRGS
          GO TOP
          IF _TALLY>0
              PRG_SEEK=CREATEOBJECT("PRG_SEEK")  
              PRG_SEEK.SHOW
              THIS.VALUE=FLG 
	      THIS.REFRESH 
	      FLG='0'     
	      AREA1='A01'   
	      SELECT PRGS
	      USE                     	                   
          ELSE
                SELECT PRGS
                USE
                =MESSAGEBOX('已無程式作業可選取!',0+64,'提示訊息視窗') 
	        THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
	        RETURN    
          ENDIF    
    ENDIF
    THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=IIF(SEEK(THIS.VALUE,'A03'),A03.F02,'')  
    THISFORM.PAGEFRAME1.PAGE2.CHKF04.VISIBLE=IIF(A03.F04='0',.F.,.T.)
    THISFORM.PAGEFRAME1.PAGE2.CHKF05.VISIBLE=IIF(A03.F05='0',.F.,.T.)
    THISFORM.PAGEFRAME1.PAGE2.CHKF06.VISIBLE=IIF(A03.F06='0',.F.,.T.)
    THISFORM.PAGEFRAME1.PAGE2.CHKF07.VISIBLE=IIF(A03.F07='0',.F.,.T.)
    THISFORM.PAGEFRAME1.PAGE2.CHKF08.CAPTION='附一('+ALLTRIM(A03.F08)+')'
    THISFORM.PAGEFRAME1.PAGE2.CHKF09.CAPTION='附二('+ALLTRIM(A03.F09)+')'
    THISFORM.PAGEFRAME1.PAGE2.CHKF10.CAPTION='附三('+ALLTRIM(A03.F10)+')'
    THISFORM.PAGEFRAME1.PAGE2.CHKF11.CAPTION='附四('+ALLTRIM(A03.F11)+')'
    THISFORM.PAGEFRAME1.PAGE2.CHKF12.CAPTION='附五('+ALLTRIM(A03.F12)+')'
    THISFORM.PAGEFRAME1.PAGE2.CHKF08.VISIBLE=IIF(EMPTY(A03.F08),.F.,.T.)
    THISFORM.PAGEFRAME1.PAGE2.CHKF09.VISIBLE=IIF(EMPTY(A03.F09),.F.,.T.)
    THISFORM.PAGEFRAME1.PAGE2.CHKF10.VISIBLE=IIF(EMPTY(A03.F10),.F.,.T.)
    THISFORM.PAGEFRAME1.PAGE2.CHKF11.VISIBLE=IIF(EMPTY(A03.F11),.F.,.T.)
    THISFORM.PAGEFRAME1.PAGE2.CHKF12.VISIBLE=IIF(EMPTY(A03.F12),.F.,.T.)  
    THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS      
  ENDPROC
ENDDEFINE 
***** 
