&&為昌海德通抓取2005年整年度客戶月份產品別接單分析
CLOSE ALL
CLEAR ALL
SELECT 0
USE B01
SET ORDER TO 1
SELECT 0
USE C00
SET ORDER TO 1

SELECT 0
USE C01
SET ORDER TO 1

SELECT 0
USE BOO EXCLUSIVE
ZAP
SET ORDER TO 1
SELECT 0
USE C04
SET ORDER TO 1
SET ORDER TO 1
SELECT C04.f02,C04.F03,C04.f04,C04.f07,C04.f06,C04.F07*(C04.f15-C04.f21) FROM C04 WHERE F03>='CA05010001' AND F03<'CA06010001' AND LEN(ALLTRIM(C04.F03))=10 AND C04.F07*(C04.f15-C04.f21)>0 ORDER BY C04.f02,C04.f04 INTO CURSOR OPK NOWAIT
SELECT OPK
GO TOP
DO WHILE !EOF()
       SELECT BOO
       SEEK OPK.F02
       IF !FOUND()
            APPEND BLANK
            REPLACE A WITH OPK.F02
            REPLACE B WITH IIF(SEEK(OPK.F02,'C01'),C01.F04,'')     
       ENDIF
       H=FIELD(2*VAL(SUBSTR(OPK.F03,5,2))+1)
       K=FIELD(2*VAL(SUBSTR(OPK.F03,5,2))+2)
       IF IIF(SEEK(OPK.F04,'B01'),B01.F97,'')='Y'
           REPLACE &K WITH &K+OPK.EXP_6*IIF(SEEK(OPK.F06,'C00'),C00.F02,1)
        ELSE
          REPLACE &H WITH &H+OPK.EXP_6*IIF(SEEK(OPK.F06,'C00'),C00.F02,1)        
        ENDIF   
        SELECT OPK
        SKIP
ENDDO
SELECT BOO
FOR I=1 TO 12
H=FIELD(2*I+1)
K=FIELD(2*I+2)
CALCULATE SUM(&H) TO BK1
?H,BK1
CALCULATE SUM(&K) TO BK2
?K,BK2
ENDFOR