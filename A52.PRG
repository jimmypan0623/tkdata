***************A52.人事訓練登錄資料****************
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
DEP=''
POS=''
R=0
AREA1='A50'
AREA2='A52'
***************開起相關基本檔***************
IF !USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
SEEK SYS_OPER
GK=F03
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE 
   SELE A02
ENDIF
SET ORDER TO A021
SEEK SYS_OPER+'A52'
GL=F04 &&新增欄位之權限
GM=F05 &&修改欄位之權限
GN=F06 &&刪除欄位之權限
GP=F07 &&列印欄位之權限
IF !USED('A14')
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141  
IF !USED('A50')
   SELE 0
   USE A50  INDE A50
ELSE 
   SELE A50
ENDIF
SET ORDER TO A501
SET RELATION TO F05 INTO A14
IF !USED('A52')
   SELE 0
   USE A52  INDE A52
ELSE 
   SELE A52
ENDIF
SET ORDER TO A521
*************************建立表單A20FORM*************************         
A52FORM=CREATEOBJECT("TKA52")
A52FORM.SHOW  
DEFINE CLASS TKA52 AS FORM
  CAPTION='A52.人事訓練登錄資料'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKA52'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH; &&編輯區
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH; &&瀏覽區
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH; &&操作按鈕
      AUTOCENTER=.T.
*****************************設定PAGEFRAME**********************
ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*200,;
      FONTSIZE=INT_015*9,;      
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='表頭資料',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='詳細資料內容'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH; &&目前資料排序
      AUTOCENTER=.T.
******************************設定GRID1************************ 
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='A50',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2' 
******************************設定GRID2************************       
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=4,;            
      RECORDSOURCE='A52',;
      LINKMASTER='A50',;
      RELATIONALEXPR='F01',;
      CHILDORDER='A521',; 
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH; &&搜尋或指向資料之按鈕
      AUTOSIZE=.T.
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;  &&操作鍵   
      AUTOSIZE=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH; &&確認鍵
      TOP=INT_015*165,;
      LEFT=INT_015*670
********************************設定PAGE1***************************    
PROCEDURE PAGEFRAME1.PAGE1.INIT
 THIS.ADDOBJECT('IMAGE1','IMAGE')
    WITH THIS.IMAGE1
       .VISIBLE=.T.
      .LEFT=INT_015*350 
      .TOP=INT_015*15
      .HEIGHT=INT_015*130
      .WIDTH=INT_015*100     
      .STRETCH=2
    ENDWITH   
  THIS.ADDOBJECT('LBLF01','LABEL') &&秀出人員編號
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*27
          .WIDTH=INT_015*50
          .CAPTION='員工編號'          
     ENDWITH
  THIS.ADDOBJECT('TXTF01','TEXTBOX')      
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*23
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*20    
     ENDWITH
  THIS.ADDOBJECT('LBLF02','LABEL') 
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*56
          .WIDTH=INT_015*50
          .CAPTION='員工姓名'          
     ENDWITH
 THIS.ADDOBJECT('TXTF02','TEXTBOX')      
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*52
          .WIDTH=INT_015*60
          .HEIGHT=INT_015*20    
     ENDWITH
THIS.ADDOBJECT('LBLF05','LABEL') 
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*86
          .WIDTH=INT_015*50
          .CAPTION='所屬部門'          
     ENDWITH
 THIS.ADDOBJECT('TXTF05','TEXTBOX')      
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*82
          .WIDTH=INT_015*60
          .HEIGHT=INT_015*20    
     ENDWITH      
  THIS.ADDOBJECT('LBLF06','LABEL') 
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*116
          .WIDTH=INT_015*50
          .CAPTION='職        務'    
     ENDWITH     
  THIS.ADDOBJECT('TXTF06','TEXTBOX')     
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*112
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*20
     ENDWITH
  THIS.ADDOBJECT('LBLF07','LABEL') 
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*145
          .WIDTH=INT_015*50
          .CAPTION='任職狀況'          
     ENDWITH
  THIS.ADDOBJECT('LBLF071','LABEL') &&任職狀況
     WITH THIS.LBLF071
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*145
          .AUTOSIZE=.T.
          .BACKCOLOR=RGB(255,255,0)
          .CAPTION=''          
     ENDWITH     
********************************設定PAGE2***************************    
  PROCEDURE PAGEFRAME1.PAGE2.INIT
  THIS.ADDOBJECT('LBLF03','LABEL') &&秀出受訓名稱
    WITH THIS.LBLF03
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .CAPTION='受訓名稱'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
    ENDWITH
  THIS.ADDOBJECT('TXTF03','TEXTBOX') 
    WITH THIS.TXTF03
         .LEFT=INT_015*66
         .TOP=INT_015*16
         .WIDTH=INT_015*157     
         .HEIGHT=INT_015*20
         .MAXLENGTH=40
         .VISIBLE=.T.
     ENDWITH 
  THIS.ADDOBJECT('LBLF041','LABEL') &&秀出受訓日期
    WITH THIS.LBLF041
         .LEFT=INT_015*15
         .TOP=INT_015*50
         .CAPTION='受訓日期'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF041','TEXTBOX') 
    WITH THIS.TXTF041
         .LEFT=INT_015*66
         .TOP=INT_015*46
         .WIDTH=INT_015*70   
         .HEIGHT=INT_015*20
         .VISIBLE=.T.
     ENDWITH
   THIS.ADDOBJECT('LBLF042','LABEL') 
    WITH THIS.LBLF042
         .LEFT=INT_015*138
         .TOP=INT_015*50
         .CAPTION='至'
         .WIDTH=INT_015*15
         .VISIBLE=.T.
     ENDWITH    
  THIS.ADDOBJECT('TXTF042','TEXTBOX') 
    WITH THIS.TXTF042
         .LEFT=INT_015*153
         .TOP=INT_015*46
         .WIDTH=INT_015*70    
         .HEIGHT=INT_015*20
         .VISIBLE=.T.
     ENDWITH
 THIS.ADDOBJECT('LBLF051','LABEL') &&秀出受訓時間
    WITH THIS.LBLF051
         .LEFT=INT_015*15
         .TOP=INT_015*80
         .CAPTION='受訓時間'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF051','TEXTBOX') 
    WITH THIS.TXTF051
         .LEFT=INT_015*66
         .TOP=INT_015*76
         .WIDTH=INT_015*70    
         .HEIGHT=INT_015*20
         .MAXLENGTH=4
         .INPUTMASK='99:99'
         .VISIBLE=.T.
     ENDWITH
   THIS.ADDOBJECT('LBLF052','LABEL') 
    WITH THIS.LBLF052
         .LEFT=INT_015*138
         .TOP=INT_015*80
         .CAPTION='至'
         .WIDTH=INT_015*15
         .VISIBLE=.T.
     ENDWITH    
  THIS.ADDOBJECT('TXTF052','TEXTBOX') 
    WITH THIS.TXTF052
         .LEFT=INT_015*153
         .TOP=INT_015*76
         .WIDTH=INT_015*70    
         .HEIGHT=INT_015*20
         .MAXLENGTH=4
         .INPUTMASK='99:99'
         .VISIBLE=.T.
     ENDWITH  
 THIS.ADDOBJECT('LBLF06','LABEL') &&秀出受訓內容
    WITH THIS.LBLF06
         .LEFT=INT_015*15
         .TOP=INT_015*110
         .CAPTION='受訓內容'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF06','TEXTBOX') 
    WITH THIS.TXTF06
         .LEFT=INT_015*66
         .TOP=INT_015*106
         .WIDTH=INT_015*200    
         .HEIGHT=INT_015*20
         .MAXLENGTH=50
         .VISIBLE=.T.
     ENDWITH
 THIS.ADDOBJECT('LBLF07','LABEL') &&安全資料
    WITH THIS.LBLF07
         .VISIBLE=.T.           
         .LEFT=INT_015*365
         .TOP=INT_015*110
         .WIDTH=INT_015*50
         .CAPTION='安全資料'          
         .VISIBLE=.T.
    ENDWITH     
   THIS.ADDOBJECT('LBLF071','LABEL') 
    WITH THIS.LBLF071
         .LEFT=INT_015*416
         .TOP=INT_015*110
         .AUTOSIZE=.T.     
         .VISIBLE=.T.
    ENDWITH  
  ENDPROC
******************設定物件屬性****************
PROC INIT
       THISFORM.PAGEFRAME1.FONTSIZE=INT_015*9        
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')        
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A50.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A50.F02'
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')
           THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='受訓名稱'                                         
           THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='受訓日期'
           THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='受訓時間'   
           THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='受訓內容' 
	   THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A52.F03'
	   THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A52.F04'
	   THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A52.F05'
	   THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A52.F06'  
	   THISFORM.GRID2.COLUMN1.WIDTH=INT_015*120
	   THISFORM.GRID2.COLUMN2.WIDTH=INT_015*110
	   THISFORM.GRID2.COLUMN3.WIDTH=INT_015*90
	   THISFORM.GRID2.COLUMN4.WIDTH=INT_015*170
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID2.READONLY=.T.           
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.      
       ENDIF          
       THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'       
       JK='員工編號'
       SELE A50
        GO TOP     
  ENDPROC  
******************設定PAGE1之動態動作******************        
PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE                                         
     R=0
     SELE A50
     THISFORM.GRID1.ENABLED=.T.       
     THISFORM.GRID1.SETFOCUS
     THISFORM.KEY_LIST.ENABLED=.T. 
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
     THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
    IF THISFORM.GRID1.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.LBLF071.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE=''   
        THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F. 
    ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.) &&判斷有無列印的權限        
        THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
    ENDIF 
ENDPROC
*****************設定PAGE2之動態動作***********
PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
     SELE A52 
     IF THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.GRID2.READONLY=.T.   
	THISFORM.GRID2.SETFOCUS        
     ENDIF 
    IF THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
    ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.) &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.) &&判斷有無刪除的權限 
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.) &&判斷有無列印的權限               
    ENDIF 
	R=RECNO('&AREA1')  
	THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
        THISFORM.GRID1.ENABLED=.F. 
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.) &&判斷有無新增的權限
        THISFORM.KEY_LIST.ENABLED=.F.     
ENDPROC
***************GRID1動態改變*********        
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       SELECT A50
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A50.F01
       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=A50.F02
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=A14.F02   
       THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=A50.F06  
       THISFORM.PAGEFRAME1.PAGE1.LBLF071.CAPTION=BILL_MODE(A50.F07)+SPACE(4)+IIF(A50.F07='1','離職日期：'+DTOC(A50.F08),'')
        IF EMPTY(A50.F98)<>.T. .AND. FILE(ALLTRIM(A50.F98))
            THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE=ALLTRIM(A50.F98)
        ELSE    
       	    THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE=''   
       ENDIF          
       DEP=A14.F02
       POS=A50.F06
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.) &&判斷有無列印的權限               
       IF THIS.ACTIVEROW=0
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
       ENDIF   
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION  
       CHK=''     
       THISFORM.REFRESH
  ENDPROC
 ***************GRID2動態改變***************       
 PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex      
       SELECT A52
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A52.F03
       THISFORM.PAGEFRAME1.PAGE2.TXTF041.VALUE=CTOD(LEFT(ALLTRIM(A52.F04),8))
       THISFORM.PAGEFRAME1.PAGE2.TXTF042.VALUE=CTOD(RIGHT(ALLTRIM(A52.F04),8))
       THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE=LEFT(ALLTRIM(A52.F05),5)
       THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE=RIGHT(ALLTRIM(A52.F05),5)
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=A52.F06
       THISFORM.PAGEFRAME1.PAGE2.LBLF071.CAPTION=A52.F07   
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ENDIF
*!*	        THISFORM.REFRESH
  ENDPROC
 ********************************************      
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依員工編號排列')
           .ADDITEM('依員工姓名排列')
       ENDWITH      
  ENDPROC
  ****************************************** 
PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE A50
       DO CASE
          CASE THIS.DISPLAYVALUE='依員工編號排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A50.F01'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A50.F02'      
               SET ORDER TO A501
          CASE THIS.DISPLAYVALUE='依員工姓名排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工姓名'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A50.F02'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A50.F01'      
               SET ORDER TO A502
      ENDCASE 
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC 
*******************新增資料*********************** 
PROCEDURE ORPGROUP.NEW_BOTT.CLICK
   THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F. 
   THISFORM.KEY_LIST.ENABLED=.F.
   THISFORM.GRID1.ENABLED=.F.   
   THISFORM.GRID2.ENABLED=.F.  
   THISFORM.SETALL('READONLY',.F.,'TEXTBOX')
   THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
   THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
   THISFORM.PAGEFRAME1.PAGE2.TXTF041.VALUE=CTOD('')
   THISFORM.PAGEFRAME1.PAGE2.TXTF042.VALUE=CTOD('')
   THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE=''
   THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE=''
   THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='' 
   THISFORM.PAGEFRAME1.PAGE2.LBLF071.CAPTION=''
ENDPROC
***********************新增之確認********************  
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
DO CASE	 
    	    CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE)     
                       =MESSAGEBOX('訓練名稱不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
                      RETURN
            CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF041.VALUE)     
                       =MESSAGEBOX('受訓開始日期不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF041.SETFOCUS
                      RETURN
             CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF042.VALUE)     
                       =MESSAGEBOX('受訓結束日期不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF042.SETFOCUS
                      RETURN
             CASE THISFORM.PAGEFRAME1.PAGE2.TXTF041.VALUE>THISFORM.PAGEFRAME1.PAGE2.TXTF042.VALUE     
                       =MESSAGEBOX('受訓之開始日期不得大於結束日期!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF041.SETFOCUS
                      RETURN        
              CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE)     
                       =MESSAGEBOX('受訓開始時間不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
                      RETURN
             CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE)     
                       =MESSAGEBOX('受訓結束時間不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF052.SETFOCUS
                      RETURN 
             CASE LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE))<4     
                       =MESSAGEBOX('受訓開始時間長度不得小於4碼!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
                      RETURN
             CASE LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE))<4     
                       =MESSAGEBOX('受訓結束時間長度不得小於4碼!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF052.SETFOCUS
                      RETURN
            CASE VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))<0 OR VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))>23
                       =MESSAGEBOX('受訓開始時間之小時數應在0~23之範圍內!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
                      RETURN                  
             CASE VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))<0 OR VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))>23
                       =MESSAGEBOX('受訓結束時間之小時數應在0~23之範圍內!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF052.SETFOCUS
                      RETURN
             CASE VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))<0 OR VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))>59
                       =MESSAGEBOX('受訓開始時間之分鍾數應在0~59之範圍內!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
                      RETURN
            CASE VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))<0 OR VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))>59
                       =MESSAGEBOX('受訓結束之分鐘數應在0~59之範圍內!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF052.SETFOCUS
                      RETURN
*!*	            CASE VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2)+RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))>VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2)+RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))
*!*	                       =MESSAGEBOX('受訓之開始時間不得大於結束時間!',0+64,'提示視窗')
*!*	      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
*!*	                      RETURN           
           CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)     
                       =MESSAGEBOX('受訓內容不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF06.SETFOCUS
                      RETURN                                                 
ENDCASE
SELE A52
APPEND BLANK
LOCK()
IF RLOCK()
    REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
    REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
    REPLACE F04 WITH DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF041.VALUE)+' 至 ' +DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF042.VALUE)
    REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE+' 至 ' +THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE
    REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
    REPLACE F07 WITH DTOC(DATE())+' '+GK
ENDIF 
   UNLOCK
   THISFORM.GRID1.ENABLED=.T.
   THISFORM.GRID1.SETFOCUS
   THISFORM.REFRESH    
   THISFORM.ORPGROUP.NEW_BOTT.CLICK    
ENDPROC
*****************修改***********
PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
   THISFORM.KEY_LIST.ENABLED=.F. 
   THISFORM.GRID1.ENABLED=.F. 
   THISFORM.GRID2.ENABLED=.F. 
   THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
   THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
   THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'TEXTBOX')
   LOCK()     
   IF !RLOCK()
         DO FILE_IMPACT
         RETURN
   ENDIF 
ENDPROC
*****************修改之確認***********
 PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
DO CASE	 
    	    CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE)     
                       =MESSAGEBOX('訓練名稱不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
                      RETURN
            CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF041.VALUE)     
                       =MESSAGEBOX('受訓開始日期不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF041.SETFOCUS
                      RETURN
             CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF042.VALUE)     
                       =MESSAGEBOX('受訓結束日期不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF042.SETFOCUS
                      RETURN
             CASE THISFORM.PAGEFRAME1.PAGE2.TXTF041.VALUE>THISFORM.PAGEFRAME1.PAGE2.TXTF042.VALUE     
                       =MESSAGEBOX('受訓之開始日期不得大於結束日期!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF041.SETFOCUS
                      RETURN        
              CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE)     
                       =MESSAGEBOX('受訓開始時間不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
                      RETURN
             CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE)     
                       =MESSAGEBOX('受訓結束時間不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF052.SETFOCUS
                      RETURN 
             CASE LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE))<4     
                       =MESSAGEBOX('受訓開始時間長度不得小於4碼!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
                      RETURN
             CASE LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE))<4     
                       =MESSAGEBOX('受訓結束時間長度不得小於4碼!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF052.SETFOCUS
                      RETURN
            CASE VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))<0 OR VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))>23
                       =MESSAGEBOX('受訓開始時間之小時數應在0~23之範圍內!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
                      RETURN                  
             CASE VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))<0 OR VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))>23
                       =MESSAGEBOX('受訓結束時間之小時數應在0~23之範圍內!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF052.SETFOCUS
                      RETURN
             CASE VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))<0 OR VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))>59
                       =MESSAGEBOX('受訓開始時間之分鍾數應在0~59之範圍內!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
                      RETURN
            CASE VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))<0 OR VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))>59
                       =MESSAGEBOX('受訓結束之分鐘數應在0~59之範圍內!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF052.SETFOCUS
                      RETURN
*!*	            CASE VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2)+RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE),2))>VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2)+RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE),2))
*!*	                       =MESSAGEBOX('受訓之開始時間不得大於結束時間!',0+64,'提示視窗')
*!*	      		      THISFORM.PAGEFRAME1.PAGE2.TXTF051.SETFOCUS
*!*	                      RETURN           
           CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)     
                       =MESSAGEBOX('受訓內容不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE2.TXTF06.SETFOCUS
                      RETURN                                                 
ENDCASE
      SELECT  A52
      IF  RLOCK()
            REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
            REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
            REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
            REPLACE F04 WITH DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF041.VALUE)+' 至 '+DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF042.VALUE)
            REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF051.VALUE+' 至 '+THISFORM.PAGEFRAME1.PAGE2.TXTF052.VALUE
            REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
            REPLACE F07 WITH DTOC(DATE())+' '+GK
      ELSE
             DO FILE_IMPACT
             RETURN   
      ENDIF
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK   
ENDPROC
*****************刪除***********  
PROCEDURE ORPGROUP.DEL_BOTT.CLICK     
   IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
      IF MESSAGEBOX('是否確定要刪除此筆人員所有教育訓練之資料',4+32+256,'請確認')=6
         SELE A52
         LOCK()
         IF  RLOCK()
               DELETE FOR A52.F01=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
               UNLOCK
               SKIP -1
                  IF BOF()
                       GO TOP
                  ENDIF   
              THISFORM.GRID1.SETFOCUS
               IF  THISFORM.GRID1.ACTIVEROW=0
                    THISFORM.PAGEFRAME1.PAGE1.SETALL('VALUE','','TEXTBOX')
                    THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
                    THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
                    THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
                    THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
                    THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
                    THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
                    THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
               ELSE
                    THISFORM.CMDGROUP.ENABLED=.T. 
                    THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
		    THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(SEEK(A50.F01,'A52'),IIF(GN='*',.T.,.F.),.F.)&&判斷有無刪除的權限  
       		    THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(SEEK(A50.F01,'A52'),IIF(GP='*',.T.,.F.),.F.) &&判斷有無列印的權
       	        ENDIF            
         ELSE
            DO FILE_IMPACT
         ENDIF
      ENDIF  
   ELSE
     IF  MESSAGEBOX('是否確定要刪除此筆訓練之資料',4+32+256,'請確認')=6  
        SELE A52 
        LOCK()
        IF  RLOCK()
             DELE
             UNLOCK
             SKIP -1
             IF   BOF()
                   GO TOP
             ENDIF   
             THISFORM.GRID2.SETFOCUS
               IF THISFORM.GRID2.ACTIVEROW=0
                   THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
                   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
                   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
                   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
                   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
                   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
                   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
                   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
                ELSE
                    THISFORM.CMDGROUP.ENABLED=.T. 
                    THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.) &&判斷有無修改的權限
		    THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)&&判斷有無刪除的權限  
       		    THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)&&判斷有無列印的權限
                ENDIF
        ELSE
           DO FILE_IMPACT    
        ENDIF 
     ENDIF           
  ENDIF
  THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.) &&判斷有無列印的權限
 THISFORM.REFRESH   
  ENDPROC                         
**************************放棄***************
PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)&&判斷有無刪除的權限  
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.) &&判斷有無列印的權限
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
           THISFORM.GRID1.ENABLED=.T.
           THISFORM.GRID2.ENABLED=.T.
           THISFORM.GRID1.SETFOCUS
           THISFORM.KEY_LIST.ENABLED=.T.
           THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
      ELSE
           THISFORM.GRID1.ENABLED=.F.
           THISFORM.GRID2.ENABLED=.T.
           THISFORM.GRID2.SETFOCUS
           THISFORM.GRID1.ENABLED=.F.
           THISFORM.KEY_LIST.ENABLED=.F.
           THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)&&判斷有無新增的權限      
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
      ENDIF    
    UNLOCK ALL
  ENDPROC
 ************************完成***********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
      SELE A52
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC
ENDDEFINE
*************************************************************列印
PROCEDURE PNT_PRC  
  LK=A50.F01
   SELECT * FROM A52 WHERE F01=LK NOWAIT
   REPORT   FORM  ALLTRIM(INT_116)+'A52' TO PRINT PROMPT PREVIEW
   CLEAR     
ENDPROC  
************************        
*********************************************A50.F07任職狀況
FUNC BILL_MODE
     PARA JUKK
     JOO=''
     DO CASE
        CASE JUKK='A'
             JOO='新進人員'
        CASE JUKK='B'
             JOO='資料補登'     
        CASE JUKK='C'
             JOO='在        職'                       
        CASE JUKK='1'
             JOO='已  離  職'
        CASE JUKK='2'
             JOO='離職復職'
        CASE JUKK='3'
             JOO='留職停薪'           
        CASE JUKK='4'
             JOO='留職復職'            
        CASE JUKK='5'
             JOO='職務調整'       
        CASE JUKK='6'
             JOO='升        遷'                                                             
     ENDCASE
     RETURN JOO 