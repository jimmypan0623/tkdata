q00form=createobject("tkq00")
q00form.show  
define class tkq00 as form
  caption='ºÞ¨î¹Ï'
  autocenter=.t.
  BORDERSTYLE=3  
  CONTROLBOX=.F.
  MOVABLE=.F.
  controlcount=57
  fontsize=9
  height=550
  showtips=.t.
  showwindow=1
  width=789
  windowtype=1
  NAME='TKq00'
  ADD OBJECT LBLGD AS LABEL WITH;
      LEFT=18,;
      TOP=510,;
      HEIGHT=17,;
      AUTOSIZE=.T.,;
      CAPTION=''
  ADD OBJECT LBLXUB AS LABEL WITH;
      HEIGHT=17,;
      AUTOSIZE=.T.
  ADD OBJECT LBLXCB AS LABEL WITH;
      HEIGHT=17,;
      AUTOSIZE=.T.
  ADD OBJECT LBLXLB AS LABEL WITH;
      HEIGHT=17,;
      AUTOSIZE=.T.
  ADD OBJECT LBLRUB AS LABEL WITH;
      HEIGHT=17,;
      AUTOSIZE=.T.
  ADD OBJECT LBLRCB AS LABEL WITH;
      HEIGHT=17,;
      AUTOSIZE=.T. 
  ADD OBJECT LBLRLB AS LABEL WITH;
      HEIGHT=17,;
      AUTOSIZE=.T.                       
  proc init
       CALC MAX(AVG_F04) TO TMP4
       CALC MIN(AVG_F04) TO TMP5
       CALC MAX(MAX_F04-MIN_F04) TO TMP6
       CALC MIN(MAX_F04-MIN_F04) TO TMP7       
       IF TMP('AVG_F04')+SAM1.A2*TMP('MAX_F04-MIN_F04')>TMP4
          TMP4=TMP('AVG_F04')+SAM1.A2*TMP('MAX_F04-MIN_F04')
       ENDIF
       IF TMP('AVG_F04')-SAM1.A2*TMP('MAX_F04-MIN_F04')<TMP5
          TMP5=TMP('AVG_F04')-SAM1.A2*TMP('MAX_F04-MIN_F04')   
       ENDIF
       IF TMP('MAX_F04-MIN_F04')*SAM1.D4>TMP6
          TMP6=TMP('MAX_F04-MIN_F04')*SAM1.D4
       ENDIF    
       IF TMP('MAX_F04-MIN_F04')*SAM1.D3<TMP7
          TMP7=TMP('MAX_F04-MIN_F04')*SAM1.D3
       ENDIF     
       RANGE1=200/(TMP4-TMP5)
       RANGE2=200/(TMP6-TMP7)
*       RANGE1=200/TMP4
*       RANGE2=200/TMP6
       UXBAR=RANGE1*((TMP('AVG_F04')+SAM1.A2*TMP('MAX_F04-MIN_F04'))-TMP5)
       LXBAR=RANGE1*((TMP('AVG_F04')-SAM1.A2*TMP('MAX_F04-MIN_F04'))-TMP5)
       CXBAR=RANGE1*(TMP('AVG_F04')-TMP5)
       URBAR=RANGE2*((TMP('MAX_F04-MIN_F04')*SAM1.D4)-TMP7)
       LRBAR=RANGE2*((TMP('MAX_F04-MIN_F04')*SAM1.D3)-TMP7)
       CRBAR=RANGE2*(TMP('MAX_F04-MIN_F04')-TMP7)
       thisform.line(0,505,800,505)
*!*	       thisform.line(390,0,390,570)       
       THISFORM.LINE(0,250-CXBAR,800,250-CXBAR)
       THISFORM.LINE(0,490-CRBAR,800,490-CRBAR)
       THISFORM.FORECOLOR=255
       THISFORM.LINE(0,250-UXBAR,800,250-UXBAR)
       THISFORM.LINE(0,250-LXBAR,800,250-LXBAR)    
       THISFORM.LINE(0,490-URBAR,800,490-URBAR)
       THISFORM.LINE(0,490-LRBAR,800,490-LRBAR)
       SELE ANSPT1
       GO TOP
       DO WHILE !EOF()
          THISFORM.FORECOLOR=65535
          THISFORM.CIRCLE(2,RECNO()*20+10,250-RANGE1*(ANSPT1.AVG_F04-TMP5))
          THISFORM.CIRCLE(2,RECNO()*20+10,490-RANGE2*((ANSPT1.MAX_F04-ANSPT1.MIN_F04)-TMP7))
          THISFORM.FORECOLOR=0
          THISFORM.LINE(RECNO()*20+10,505,RECNO()*20+10,0)
          OH=ALLTRIM(STR(RECNO()))
          IF LEN(OH)=1
             OH='0'+OH
          ENDIF   
          THISFORM.LBLGD.CAPTION=THISFORM.LBLGD.CAPTION+'  '+OH
          IF RECNO()>1
             THISFORM.FORECOLOR=65280
             THISFORM.LINE(RKK,FKK,RECNO()*20+10,250-RANGE1*(ANSPT1.AVG_F04-TMP5))
             THISFORM.LINE(RKK,GKK,RECNO()*20+10,490-RANGE2*((ANSPT1.MAX_F04-ANSPT1.MIN_F04)-TMP7))
          ENDIF    
          RKK=RECNO()*20+10
          FKK=250-RANGE1*(ANSPT1.AVG_F04-TMP5)
          GKK=490-RANGE2*((ANSPT1.MAX_F04-ANSPT1.MIN_F04)-TMP7)
          SKIP
       ENDDO   
       THISFORM.LBLXUB.CAPTION=TRANSFORM(TMP('AVG_F04')+SAM1.A2*TMP('MAX_F04-MIN_F04'),'99999999.99')
       THISFORM.LBLXUB.TOP=250-UXBAR-5
       THISFORM.LBLXCB.CAPTION=TRANSFORM(TMP('AVG_F04'),'99999999.99')
       THISFORM.LBLXCB.TOP=250-CXBAR-5
       THISFORM.LBLXLB.CAPTION=TRANSFORM(TMP('AVG_F04')-SAM1.A2*TMP('MAX_F04-MIN_F04'),'99999999.99')
       THISFORM.LBLXLB.TOP=250-LXBAR-5
       THISFORM.LBLRUB.CAPTION=TRANSFORM(TMP('MAX_F04-MIN_F04')*SAM1.D4,'99999999.99')
       THISFORM.LBLRUB.TOP=490-URBAR-5
       THISFORM.LBLRCB.CAPTION=TRANSFORM(TMP('MAX_F04-MIN_F04'),'99999999.99')
       THISFORM.LBLRCB.TOP=490-CRBAR-5
       THISFORM.LBLRLB.CAPTION=TRANSFORM(TMP('MAX_F04-MIN_F04')*SAM1.D3,'99999999.99')
       THISFORM.LBLRLB.TOP=490-LRBAR-5       
  endproc
  PROC click
       thisform.release
  ENDPROC     
enddefine