***************S52.人事訓練登錄資料****************
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
DEP=''
POS=''
R=0
AREA1='S50'
AREA2='S52'
***************開起相關基本檔***************
IF !USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
SEEK SYS_OPER
GK=F03
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE 
   SELE A02
ENDIF
SET ORDER TO A021
SEEK SYS_OPER+'S52'
IF !USED('A14')
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141  
IF !USED('S50')
   SELE 0
   USE S50  INDE S50
ELSE 
   SELE S50
ENDIF
SET ORDER TO S501
SET RELATION TO F05 INTO A14
IF !USED('S52')
   SELE 0
   USE S52  INDE S52
ELSE 
   SELE S52
ENDIF
SET ORDER TO S521
SELECT  S50
GO TOP   
****************   
S52FORM=CREATEOBJECT("TKS52")
S52FORM.SHOW  
DEFINE CLASS TKS52 AS FORM
  CAPTION='S52.人事訓練登錄資料'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKS52'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH; &&編輯區
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH; &&瀏覽區
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH; &&操作按鈕
      AUTOCENTER=.T.
*****************************設定PAGEFRAME**********************
ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*200,;
      FONTSIZE=INT_015*9,;    
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;             
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='表頭資料',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='詳細資料內容'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH; &&目前資料排序
      AUTOCENTER=.T.
******************************設定GRID1************************ 
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='S50',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2' 
******************************設定GRID2************************       
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=4,;            
      RECORDSOURCE='S52',;
      LINKMASTER='S50',;
      RELATIONALEXPR='F01',;
      CHILDORDER='S521',; 
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH; &&搜尋或指向資料之按鈕
      AUTOSIZE=.T.
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;  &&操作鍵   
      AUTOSIZE=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH; &&確認鍵
      TOP=INT_015*165,;
      LEFT=INT_015*670
********************************設定PAGE1***************************    
PROCEDURE PAGEFRAME1.PAGE1.INIT
 THIS.ADDOBJECT('IMAGE1','IMAGE')
    WITH THIS.IMAGE1
       .VISIBLE=.T.
      .LEFT=INT_015*350 
      .TOP=INT_015*15
      .HEIGHT=INT_015*130
      .WIDTH=INT_015*100     
      .STRETCH=2
    ENDWITH   
  THIS.ADDOBJECT('LBLF01','LABEL') &&人員編號
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*29
          .WIDTH=INT_015*50
          .CAPTION='員工編號'          
     ENDWITH
  THIS.ADDOBJECT('TXTF01','TEXTBOX')      
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*23
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*20    
     ENDWITH
  THIS.ADDOBJECT('LBLF02','LABEL') 
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*54
          .WIDTH=INT_015*50
          .CAPTION='員工姓名'          
     ENDWITH
 THIS.ADDOBJECT('TXTF02','TEXTBOX')      
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*48
          .WIDTH=INT_015*60
          .HEIGHT=INT_015*20    
     ENDWITH
THIS.ADDOBJECT('LBLF05','LABEL') 
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*79
          .WIDTH=INT_015*50
          .CAPTION='所屬部門'          
     ENDWITH
 THIS.ADDOBJECT('TXTF05','TEXTBOX')      
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*73
          .WIDTH=INT_015*60
          .HEIGHT=INT_015*20    
     ENDWITH      
  THIS.ADDOBJECT('LBLF06','LABEL') 
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*104
          .WIDTH=INT_015*50
          .CAPTION='職        務'    
     ENDWITH     
  THIS.ADDOBJECT('TXTF06','TEXTBOX')     
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*98
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*20
     ENDWITH
  THIS.ADDOBJECT('LBLF07','LABEL') 
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*132
          .WIDTH=INT_015*50
          .CAPTION='任職狀況'          
     ENDWITH
  THIS.ADDOBJECT('LBLF071','LABEL') &&任職狀況
     WITH THIS.LBLF071
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*132
          .AUTOSIZE=.T.
          .BACKCOLOR=RGB(255,255,0)
          .CAPTION=''          
     ENDWITH     
********************************設定PAGE2***************************    
  PROCEDURE PAGEFRAME1.PAGE2.INIT
  THIS.ADDOBJECT('LBLF03','LABEL') &&秀出受訓名稱
    WITH THIS.LBLF03
         .LEFT=INT_015*15
         .TOP=INT_015*29
         .CAPTION='受訓名稱'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
    ENDWITH
  THIS.ADDOBJECT('TXTF03','TEXTBOX') 
    WITH THIS.TXTF03
         .LEFT=INT_015*66
         .TOP=INT_015*23
         .WIDTH=INT_015*162     
         .HEIGHT=INT_015*20
         .MAXLENGTH=40
         .VISIBLE=.T.
     ENDWITH 
  THIS.ADDOBJECT('LBLF04','LABEL') &&受訓起始日期
    WITH THIS.LBLF04
         .LEFT=INT_015*15
         .TOP=INT_015*54
         .CAPTION='受訓日期                          至'
         .AUTOSIZE=.T.
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF04','TEXTBOX') 
    WITH THIS.TXTF04
         .LEFT=INT_015*66
         .TOP=INT_015*48
         .WIDTH=INT_015*70   
         .HEIGHT=INT_015*20
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF05','TEXTBOX') &&受訓截止日期
    WITH THIS.TXTF05
         .LEFT=INT_015*158
         .TOP=INT_015*48
         .WIDTH=INT_015*70    
         .HEIGHT=INT_015*20
         .VISIBLE=.T.
     ENDWITH
 THIS.ADDOBJECT('LBLF06','LABEL') &&受訓起始時間
    WITH THIS.LBLF06
         .LEFT=INT_015*15
         .TOP=INT_015*79
         .CAPTION='受訓時間                          至'
         .AUTOSIZE=.T.
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF06','TEXTBOX') 
    WITH THIS.TXTF06
         .LEFT=INT_015*66
         .TOP=INT_015*73
         .WIDTH=INT_015*70    
         .HEIGHT=INT_015*20
         .MAXLENGTH=5
         .INPUTMASK='99:99'
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF07','TEXTBOX') &&受訓截止時間
    WITH THIS.TXTF07
         .LEFT=INT_015*158
         .TOP=INT_015*73
         .WIDTH=INT_015*70    
         .HEIGHT=INT_015*20
         .MAXLENGTH=5
         .INPUTMASK='99:99'
         .VISIBLE=.T.
     ENDWITH  
 THIS.ADDOBJECT('LBLF08','LABEL') &&受訓內容
    WITH THIS.LBLF08
         .LEFT=INT_015*15
         .TOP=INT_015*104
         .CAPTION='受訓內容'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF08','TEXTBOX') 
    WITH THIS.TXTF08
         .LEFT=INT_015*66
         .TOP=INT_015*98
         .WIDTH=INT_015*250    
         .HEIGHT=INT_015*20
         .MAXLENGTH=60
         .VISIBLE=.T.
     ENDWITH
 THIS.ADDOBJECT('LBLF99','LABEL') &&安全資料
    WITH THIS.LBLF99
         .VISIBLE=.T.           
         .LEFT=INT_015*15
         .TOP=INT_015*132
         .WIDTH=INT_015*50
         .CAPTION='安全資料'          
         .VISIBLE=.T.
    ENDWITH     
   THIS.ADDOBJECT('LBLF991','LABEL') 
    WITH THIS.LBLF991
         .LEFT=INT_015*66
         .TOP=INT_015*132
         .AUTOSIZE=.T.  
         .CAPTION=''     
         .VISIBLE=.T.
    ENDWITH  
  ENDPROC
******************設定物件屬性****************
PROC INIT
       THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
       THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)           
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*10   
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*10       
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')        
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)   
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)          
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S50.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S50.F02'
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='受訓名稱'                                         
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='受訓日期'
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='受訓時間'   
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='受訓內容' 
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='S52.F03'
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE="DTOC(S52.F04)+' 至 '+DTOC(S52.F05)"
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE="S52.F06+' 至 '+S52.F07"
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE='S52.F08'  
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*120
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*115
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*85
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*170
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID2.READONLY=.T.           
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.         
	   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F. 
           THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
           THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''
           THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''
           THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=''
           THISFORM.PAGEFRAME1.PAGE1.LBLF071.CAPTION=''
           THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE=''   	   	
       ELSE
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	         
	   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND IIF(INDEXSEEK(S50.F01,.F.,'S52','S521'),.T.,.F.) &&判斷有無刪除的權限 
	   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.) AND IIF(INDEXSEEK(S50.F01,.F.,'S52','S521'),.T.,.F.)
       ENDIF  
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.           
       THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'       
       JK='員工編號'  
  ENDPROC  
******************        
PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE                                         
     R=0
     SELECT  S50
     DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                       SET ORDER TO S501
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                       SET ORDER TO S502
     ENDCASE          
     THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
     THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)
     THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
     THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)    
     THISFORM.KEY_LIST.ENABLED=.T. 
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.T.       
     THISFORM.GRID1.SETFOCUS
    IF THISFORM.GRID1.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.         
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.LBLF071.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE=''  
    ELSE
        THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.    
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.) AND IIF(INDEXSEEK(S50.F01,.F.,'S52','S521'),.T.,.F.) &&判斷有無列印的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND IIF(INDEXSEEK(S50.F01,.F.,'S52','S521'),.T.,.F.)  &&判斷有無刪除的權限         
    ENDIF 
ENDPROC
*****************
PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
     SELECT  S52 
     THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
     THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
     THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.T.
     THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,255)          
     IF THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.GRID2.READONLY=.T.   
	THISFORM.GRID2.SETFOCUS        
     ENDIF 
    IF THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
    ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) &&判斷有無刪除的權限 
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.) &&判斷有無列印的權限               
    ENDIF 
	R=RECNO('&AREA1')  
	THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
        THISFORM.GRID1.ENABLED=.F. 
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.) &&判斷有無新增的權限
        THISFORM.KEY_LIST.ENABLED=.F.     
ENDPROC
***************GRID1動態改變*********        
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       SELECT S50
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S50.F01
       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=S50.F02
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=A14.F02   
       THISFORM.PAGEFRAME1.PAGE1.TXTF06.VALUE=S50.F06  
       THISFORM.PAGEFRAME1.PAGE1.LBLF071.CAPTION=BILL_MODE(S50.F07)+SPACE(4)+IIF(S50.F07='1','異動日期：'+DTOC(S50.F08),'')
        IF EMPTY(S50.F98)<>.T. .AND. FILE(ALLTRIM(S50.F98))
            THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE=ALLTRIM(S50.F98)
        ELSE    
       	    THISFORM.PAGEFRAME1.PAGE1.IMAGE1.PICTURE=''   
       ENDIF          
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
       IF THIS.ACTIVEROW=0
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
       ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
            THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND IIF(INDEXSEEK(S50.F01,.F.,'S52','S521'),.T.,.F.) &&判斷有無刪除的權限 
            THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.) AND IIF(INDEXSEEK(S50.F01,.F.,'S52','S521'),.T.,.F.)&&判斷有無列印的權限  
       ENDIF   
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION  
       CHK=''     
       THISFORM.REFRESH
  ENDPROC
 ***************GRID2動態改變***************       
 PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex      
       SELECT S52
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=S52.F03
       THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=S52.F04
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=S52.F05
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=S52.F06
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S52.F07
       THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S52.F08
       THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S52.F99  
        IF THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
            THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
            THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
            THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
            THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	    THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
	    THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=''
	    THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''
	    THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''
	    THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''
	    THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=''
	    THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''
       ELSE
            THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
            THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
            THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
            THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
            THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) &&判斷有無修改的權限
            THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) &&判斷有無刪除的權限 
            THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.) &&判斷有無列印的權限               
       ENDIF       
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.) &&判斷有無新增的權限  
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
            THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
       ENDIF
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE       
*!*	        THISFORM.REFRESH
  ENDPROC
 ********************************************      
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依員工編號排列')
           .ADDITEM('依員工姓名排列')
       ENDWITH      
  ENDPROC
  ****************************************** 
PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE S50
       DO CASE
          CASE THIS.DISPLAYVALUE='依員工編號排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S50.F01'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S50.F02'      
               SET ORDER TO S501
          CASE THIS.DISPLAYVALUE='依員工姓名排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工姓名'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S50.F02'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S50.F01'      
               SET ORDER TO S502
      ENDCASE 
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC 
*******************新增資料*********************** 
PROCEDURE ORPGROUP.NEW_BOTT.CLICK
   THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F. 
   THISFORM.KEY_LIST.ENABLED=.F.
   THISFORM.GRID1.ENABLED=.F.   
   THISFORM.GRID2.ENABLED=.F.  
   THISFORM.SETALL('READONLY',.F.,'TEXTBOX')
   THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
   THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=CTOD('')
   THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=CTOD('')
   THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''
   THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''
   THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE='' 
   THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''
   THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS   
ENDPROC
***********************新增之確認********************  
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK	 
    IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE)     
         =MESSAGEBOX('訓練名稱不得空白!',0+64,'提示視窗')
      	 THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
         RETURN
    ENDIF     
    IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE)     
         =MESSAGEBOX('受訓開始日期不得空白!',0+64,'提示視窗')
         THISFORM.PAGEFRAME1.PAGE2.TXTF04.SETFOCUS
         RETURN
    ENDIF     
    IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)     
         =MESSAGEBOX('受訓結束日期不得空白!',0+64,'提示視窗')
         THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
         RETURN
    ENDIF     
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE>THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE     
         =MESSAGEBOX('受訓之開始日期不得大於受訓結束日期!',0+64,'提示視窗')
      	 THISFORM.PAGEFRAME1.PAGE2.TXTF04.SETFOCUS
         RETURN  
    ENDIF      
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE<THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE     
         =MESSAGEBOX('受訓之結束日期不得小於受訓開始日期!',0+64,'提示視窗')
      	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
         RETURN  
    ENDIF    
    IF EMPTY(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,2))) AND;
        EMPTY(ALLTRIM(RIGHT(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,2))) 
         =MESSAGEBOX('受訓之開始時間不得空白!',0+64,'提示視窗')     
         THISFORM.PAGEFRAME1.PAGE2.TXTF06.SETFOCUS
         RETURN       
    ENDIF          
    IF LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE))>1 
        IF LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE))<>5 OR ;
             LEN(ALLTRIM(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE),2)))=1 OR;
             LEN(ALLTRIM(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE),2)))=1 OR;
             VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE),2))>23 OR;
             VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE),2))>59
              =MESSAGEBOX('受訓之開始時間格式不正確!',0+64,'提示視窗')     
             THISFORM.PAGEFRAME1.PAGE2.TXTF06.SETFOCUS
              RETURN
        ENDIF        
    ENDIF      
    IF EMPTY(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE,2))) AND;
        EMPTY(ALLTRIM(RIGHT(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE,2))) 
         =MESSAGEBOX('受訓之結束時間不得空白!',0+64,'提示視窗')     
         THISFORM.PAGEFRAME1.PAGE2.TXTF07.SETFOCUS
         RETURN       
    ENDIF   
    IF LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE))>1 
        IF LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE))<>5 OR ;
             LEN(ALLTRIM(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE),2)))=1 OR;
             LEN(ALLTRIM(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE),2)))=1 OR;
             VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE),2))>23 OR;
             VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE),2))>59
              =MESSAGEBOX('受訓之結束時間格式不正確!',0+64,'提示視窗')     
             THISFORM.PAGEFRAME1.PAGE2.TXTF07.SETFOCUS
              RETURN
        ENDIF        
    ENDIF      
    IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)     
         =MESSAGEBOX('受訓內容不得空白!',0+64,'提示視窗')
      	 THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
         RETURN
    ENDIF                                                               
    SELECT  S52
    APPEND BLANK
    LOCK()
    IF RLOCK()
	REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
	REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
	REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
	REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
	REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
	REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
	REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE
	REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ENDIF 
    UNLOCK ALL
    THISFORM.GRID1.ENABLED=.T.
    THISFORM.GRID1.SETFOCUS
    THISFORM.REFRESH    
    THISFORM.ORPGROUP.NEW_BOTT.CLICK    
ENDPROC
*****************修改***********
PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
   THISFORM.KEY_LIST.ENABLED=.F. 
   THISFORM.GRID1.ENABLED=.F. 
   THISFORM.GRID2.ENABLED=.F. 
   THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
   THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'TEXTBOX') 
   THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
   THISFORM.PAGEFRAME1.PAGE2.TXTF04.SETFOCUS
   SELECT S52
   LOCK()     
   IF !RLOCK()
         DO FILE_IMPACT
         RETURN
   ENDIF 
ENDPROC
*****************修改之確認***********
 PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
    IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE)     
         =MESSAGEBOX('受訓開始日期不得空白!',0+64,'提示視窗')
         THISFORM.PAGEFRAME1.PAGE2.TXTF04.SETFOCUS
         RETURN
    ENDIF     
    IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)     
         =MESSAGEBOX('受訓結束日期不得空白!',0+64,'提示視窗')
         THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
         RETURN
    ENDIF     
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE>THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE     
         =MESSAGEBOX('受訓之開始日期不得大於受訓結束日期!',0+64,'提示視窗')
      	 THISFORM.PAGEFRAME1.PAGE2.TXTF04.SETFOCUS
         RETURN  
    ENDIF      
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE<THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE     
         =MESSAGEBOX('受訓之結束日期不得小於受訓開始日期!',0+64,'提示視窗')
      	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
         RETURN  
    ENDIF    
    IF EMPTY(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,2))) AND;
        EMPTY(ALLTRIM(RIGHT(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,2))) 
         =MESSAGEBOX('受訓之開始時間不得空白!',0+64,'提示視窗')     
         THISFORM.PAGEFRAME1.PAGE2.TXTF06.SETFOCUS
         RETURN       
    ENDIF          
    IF LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE))>1 
        IF LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE))<>5 OR ;
             LEN(ALLTRIM(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE),2)))=1 OR;
             LEN(ALLTRIM(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE),2)))=1 OR;
             VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE),2))>23 OR;
             VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE),2))>59
              =MESSAGEBOX('受訓之開始時間格式不正確!',0+64,'提示視窗')     
             THISFORM.PAGEFRAME1.PAGE2.TXTF06.SETFOCUS
              RETURN
        ENDIF        
    ENDIF      
    IF EMPTY(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE,2))) AND;
        EMPTY(ALLTRIM(RIGHT(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE,2))) 
         =MESSAGEBOX('受訓之結束時間不得空白!',0+64,'提示視窗')     
         THISFORM.PAGEFRAME1.PAGE2.TXTF07.SETFOCUS
         RETURN       
    ENDIF   
    IF LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE))>1 
        IF LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE))<>5 OR ;
             LEN(ALLTRIM(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE),2)))=1 OR;
             LEN(ALLTRIM(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE),2)))=1 OR;
             VAL(LEFT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE),2))>23 OR;
             VAL(RIGHT(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE),2))>59
              =MESSAGEBOX('受訓之結束時間格式不正確!',0+64,'提示視窗')     
             THISFORM.PAGEFRAME1.PAGE2.TXTF07.SETFOCUS
              RETURN
        ENDIF        
    ENDIF     
    IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)     
         =MESSAGEBOX('受訓內容不得空白!',0+64,'提示視窗')
      	 THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
         RETURN
    ENDIF             
    SELECT  S52
    IF  RLOCK()
         REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
	 REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
	 REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
	 REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
	 REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
	 REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
	 REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE
	 REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
	 REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
     ELSE
         DO FILE_IMPACT
         RETURN   
     ENDIF
     THISFORM.SHRGROUP.ABANDON_BOTT.CLICK   
ENDPROC
*****************刪除***********  
PROCEDURE ORPGROUP.DEL_BOTT.CLICK     
   IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
        IF MESSAGEBOX('是否確定要刪除此筆人員所有教育訓練之資料',4+32+256,'請確認')=6
             SELECT  S52
             DELETE FOR S52.F01=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
             THISFORM.GRID1.SETFOCUS 
       	     =MESSAGEBOX('此人員所有教育訓練資料刪除成功!',0+64,'提示視窗')        
         ENDIF
   ELSE
         IF MESSAGEBOX('是否確定要刪除此筆訓練之資料',4+32+256,'請確認')=6  
              SELECT  S52 
              LOCK()
              IF RLOCK()
                  DELETE 
                  UNLOCK
                  SKIP -1
                  IF  BOF()
                       GO TOP
                  ENDIF   
                 THISFORM.GRID2.SETFOCUS
              ELSE
                  DO FILE_IMPACT    
              ENDIF 
         ENDIF           
   ENDIF
*!*	  THISFORM.REFRESH   
  ENDPROC                         
**************************放棄***************
PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
           THISFORM.GRID1.ENABLED=.T.
           THISFORM.GRID2.ENABLED=.T.
           THISFORM.GRID1.SETFOCUS
           THISFORM.KEY_LIST.ENABLED=.T.
      ELSE
           THISFORM.GRID1.ENABLED=.F.
           THISFORM.GRID2.ENABLED=.T.
           THISFORM.GRID2.SETFOCUS
           THISFORM.GRID1.ENABLED=.F.
           THISFORM.KEY_LIST.ENABLED=.F.
      ENDIF    
    UNLOCK ALL
  ENDPROC
 ************************完成***********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
      SELECT  S52
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC
ENDDEFINE
*************************************************************列印
PROCEDURE PNT_PRC  
  LK=S50.F01
   SELECT * FROM S52 WHERE F01=LK NOWAIT
   IF  _TALLY> 0
       REPORT   FORM  ALLTRIM(INT_116)+'S52' TO PRINT PROMPT PREVIEW
   ELSE
       =MESSAGEBOX('查無此員工之教育訓練資料,請查明後在列印',0+48,'警示')
       RETURN            
   ENDIF    
   CLEAR     
ENDPROC  
