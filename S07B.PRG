***程式名稱:S07B.部門調薪修改作業
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
CHK_NULL='' 	&&判定GRID1資料是否為空
R=0
AREA1='A14'
AREA2='S07'
IF !USED('A01')	&&操作人員資料設定
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')	&&權限設定檔
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'S07'         
IF !USED('A14')	&&部門設定檔
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET FILTER TO LEN(ALLTRIM(F01))=4
SET ORDER TO A141     
IF !USED('S01')	&&薪資資料設定
   SELE 0
   USE S01 
ELSE
   SELE S01
ENDIF
SET ORDER TO S011
IF !USED('S06')	&&薪資項目及扣款項目
   SELE 0
   USE S06 
ELSE
   SELE S06
ENDIF
SET ORDER TO S063
IF !USED('S07')	&&S07 調薪修改作業
   SELE 0
   USE S07 
ELSE
   SELE S07
ENDIF
SET FILTER TO F15='2'		&&人員/部門判別:1:人員  2:部門  3:從部門中新增之人員
SET ORDER TO S072
GO TOP
********
S07BFORM=CREATEOBJECT("TKS07B")
S07BFORM.SHOW  
DEFINE CLASS TKS07B AS FORM
  CAPTION='S07B.部門調薪修改作業'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKS07B'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.  
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*515,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='調薪修改部門',;      
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='調薪修改內容'        
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*215
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='A14',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'
  ADD OBJECT GRID2 AS GRID2 WITH;
      TOP=INT_015*175,;
      HEIGHT=INT_015*340,;
      COLUMNCOUNT=8,;            
      RECORDSOURCE='S07',; 
      LINKMASTER='A14',;
      RELATIONALEXPR="ALLTRIM(F01)",;
      CHILDORDER='S072',;   
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
	AUTOSIZE=.T. 
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
	AUTOSIZE=.T.             
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*140,;
      LEFT=INT_015*640          
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*45,;      
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<A.確認',;
      NAME='ANS_BOTT'      
  ADD OBJECT  INVERSE_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*62,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*50,;      
      FONTSIZE=INT_015*9,;
      CAPTION='\<I.反確認',;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      NAME='INVERSE_BOTT'        
  ADD OBJECT COMBOBOX09 AS COMBOBOX09 WITH;&&薪資項目
      TOP=INT_015*140,;
      LEFT=INT_015*302    
**************         
PROCEDURE PAGEFRAME1.PAGE1.INIT  
  THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION='部門編號'
     ENDWITH   
  THIS.ADDOBJECT('LBLF011','LABEL')
     WITH THIS.LBLF011
         .VISIBLE=.T.
         .LEFT=INT_015*120
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION=''
     ENDWITH        
 THIS.ADDOBJECT('TXTF01','TEXTBOX')          
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*14
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
      ENDWITH                      
 ENDPROC
**************************************      
PROCEDURE PAGEFRAME1.PAGE2.INIT 
  THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION='變更日期'
     ENDWITH        
 THIS.ADDOBJECT('TXTF05','TEXTBOX')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*14
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8
      ENDWITH  
  THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION='變更方式'
     ENDWITH        
 THIS.ADDOBJECT('OPTIONGROUP06','OPTIONGROUP')          
     WITH THIS.OPTIONGROUP06 
	 .VISIBLE=.T.
	 .LEFT=INT_015*65
	 .TOP=INT_015*39
	 .HEIGHT=INT_015*25
	 .WIDTH=INT_015*175
	 .BUTTONCOUNT=2
	 .VALUE=1
	 .ENABLED=.F.
	 .NAME='OPTIONGROUP06'
	 .OPTION1.CAPTION='調薪'
	 .OPTION1.TOP=INT_015*5
	 .OPTION1.FONTSIZE=INT_015*9
	 .OPTION1.AUTOSIZE=.T.
	 .OPTION1.LEFT=INT_015*5
	 .OPTION1.NAME='OPTION1'
	 .OPTION2.CAPTION='修改'
	 .OPTION2.TOP=INT_015*5
	 .OPTION2.FONTSIZE=INT_015*9
	 .OPTION2.AUTOSIZE=.T.
	 .OPTION2.LEFT=INT_015*80
	 .OPTION2.NAME='OPTION2'     
      ENDWITH   
  THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*70
         .WIDTH=INT_015*50
         .CAPTION='變更項目'
     ENDWITH        
 THIS.ADDOBJECT('OPTIONGROUP07','OPTIONGROUP07')          
     WITH THIS.OPTIONGROUP07 
	 .VISIBLE=.T.
	 .LEFT=INT_015*65
	 .TOP=INT_015*64
      ENDWITH          
  THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*95
         .WIDTH=INT_015*50
         .CAPTION='變更說明'
     ENDWITH        
 THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*89
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
      ENDWITH 
 THIS.ADDOBJECT('COMBOBOX08','COMBOBOX08')          
     WITH THIS.COMBOBOX08
          .LEFT=INT_015*65
          .TOP=INT_015*89
      ENDWITH    
  THIS.ADDOBJECT('LBLF09','LABEL')
     WITH THIS.LBLF09 
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*120
         .WIDTH=INT_015*50
         .CAPTION='薪資項目'
     ENDWITH        
 THIS.ADDOBJECT('TXTF09','TEXTBOX')          
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*114
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
      ENDWITH 
 THIS.ADDOBJECT('COMBOBOX09','COMBOBOX09')          
     WITH THIS.COMBOBOX09
          .LEFT=INT_015*65
          .TOP=INT_015*117
      ENDWITH         
 THIS.ADDOBJECT('OPTIONGROUP10','OPTIONGROUP10')          
     WITH THIS.OPTIONGROUP10
          .LEFT=INT_015*300
          .TOP=INT_015*60
      ENDWITH                
  THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
         .VISIBLE=.T.
         .LEFT=INT_015*250
         .TOP=INT_015*68
         .WIDTH=INT_015*50
         .CAPTION='變       更'
     ENDWITH        
 THIS.ADDOBJECT('TXTF10','TEXTBOX')          &&變更比例
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*347
          .TOP=INT_015*62
          .WIDTH=INT_015*45
          .HEIGHT=INT_015*25             
          .MAXLENGTH=6
          .INPUTMASK='999.99'  
      ENDWITH
  THIS.ADDOBJECT('LBLF101','LABEL')
     WITH THIS.LBLF101
         .VISIBLE=.T.
         .LEFT=INT_015*397
         .TOP=INT_015*68
         .WIDTH=INT_015*15
         .CAPTION='％'
     ENDWITH          
 THIS.ADDOBJECT('TXTF11','TEXTBOX')          &&變更金額
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*465
          .TOP=INT_015*62
          .WIDTH=INT_015*55
          .HEIGHT=INT_015*25          
          .MAXLENGTH=7
          .INPUTMASK='9999999'  
      ENDWITH       
  THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
         .VISIBLE=.T.
         .LEFT=INT_015*250
         .TOP=INT_015*100
         .WIDTH=INT_015*50
         .CAPTION='狀        態'
     ENDWITH  
  THIS.ADDOBJECT('LBLF141','LABEL')
     WITH THIS.LBLF141
         .VISIBLE=.T.
         .LEFT=INT_015*305
         .TOP=INT_015*100
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH           
  THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*250
         .TOP=INT_015*125
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH  
  THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*305
         .TOP=INT_015*125
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH                                                             
ENDPROC                               
********  
  PROC INIT       
       THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
       THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)         
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*10
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*10 
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')     
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')         
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='部門編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='部門名稱'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A14.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A14.F02'
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55     
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(INDEXSEEK(ALLTRIM(A14.F01)+'N',.T.,'S07','S074'),IIF(EMPTY(S07.F01),RGB(255,0,0),''),'')","COLUMN")  &&若為有尚未確認之內容則呈現紅色
       THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF(S07.F14<>'Y',RGB(255,0,0),'')","COLUMN")    &&尚未確認顯示紅色
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')     
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='變更日期'    
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='變更方式'       
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='變更項目'         
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='變更說明'
       THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='薪資項目'
       THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='變更比例(％)'
       THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='變更金額'       
       THISFORM.GRID2.COLUMN8.HEADER1.CAPTION='安全資料'
       THISFORM.GRID2.LINKMASTER='A14'
       THISFORM.GRID2.RELATIONALEXPR="ALLTRIM(F01)"
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='S07.F05'
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE="IIF(S07.F06='1','調薪','修改')"
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE="IIF(S07.F07='1','所得項目','扣款項目')"       
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE='S07.F08'
       THISFORM.GRID2.COLUMN5.CONTROLSOURCE='S07.F09'
       THISFORM.GRID2.COLUMN6.CONTROLSOURCE="IIF(EMPTY(S07.F10),'',S07.F10)"
       THISFORM.GRID2.COLUMN7.CONTROLSOURCE="IIF(EMPTY(S07.F11),'',S07.F11)"
       THISFORM.GRID2.COLUMN8.CONTROLSOURCE='S07.F99'                                  
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*60       
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*130
       THISFORM.GRID2.COLUMN5.WIDTH=INT_015*130
       THISFORM.GRID2.COLUMN6.WIDTH=INT_015*70
       THISFORM.GRID2.COLUMN7.WIDTH=INT_015*55                              
       THISFORM.GRID2.COLUMN8.WIDTH=INT_015*100
       THISFORM.GRID1.READONLY=.T.      
       THISFORM.GRID2.READONLY=.T.            
       THISFORM.GRID1.SETFOCUS
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.       
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
       THISFORM.ANS_BOTT.ENABLED=.F.  
       THISFORM.INVERSE_BOTT.ENABLED=.F.    
       IF THISFORM.GRID1.ACTIVEROW=0
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.     
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.		     
           CHK_NULL='Y' 
       ELSE
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.       
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	
	   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 	   
           CHK_NULL='N'      
       ENDIF          
       JK='部門編號'
       SELE A14
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A14.F01
  ENDPROC     
  ***********
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
        R=0
        SELECT A14
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依部門編號排列'
                 SET ORDER TO A141
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依部門名稱排列'
                 SET ORDER TO A142
         ENDCASE     
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)                      
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.      	
       	THISFORM.ANS_BOTT.ENABLED=.F.      
       	THISFORM.INVERSE_BOTT.ENABLED=.F. 
         IF THISFORM.SHRGROUP.VISIBLE=.F.
              THISFORM.GRID1.ENABLED=.T. 
              THISFORM.GRID1.SETFOCUS 
              THISFORM.KEY_LIST.ENABLED=.T.
         ELSE
              THISFORM.KEY_LIST.ENABLED=.F. 	      	
         ENDIF                		                 
*!*	        THISFORM.REFRESH    
  ENDPROC     
**********             
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
	SELECT S07
        IF THISFORM.SHRGROUP.ENABLED=.F.
             THISFORM.GRID2.READONLY=.T.     
             THISFORM.GRID2.SETFOCUS   
        ENDIF  	 	
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,255)               
        IF  THISFORM.GRID2.ACTIVEROW=0 AND THISFORM.SHRGROUP.ENABLED=.F.	
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	          
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.ANS_BOTT.ENABLED=.F.
	      THISFORM.INVERSE_BOTT.ENABLED=.F.	      
	       IF CHK_NULL='Y' AND THISFORM.SHRGROUP.ENABLED=.F.
	           THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
	       ELSE
                   THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)  &&判斷有無新增的權限  	
               ENDIF		      
	      THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''  
	      THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=''  
	      THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=''  
	      THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''   
	      THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=''   
	      THISFORM.PAGEFRAME1.PAGE2.LBLF141.CAPTION=''       	            	      
   	      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''  	      	
	 ELSE
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.	
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.			   
              THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.		
              THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)	 &&判斷有無新增的權限	   	   
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S07.F14<>'Y'    &&判斷有無修改的權限
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S07.F14<>'Y'   &&判斷有無刪除的權限	   
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 		      
	      THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND S07.F14<>'Y'  
	      THISFORM.INVERSE_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.) AND S07.F14='Y'  
              THISFORM.GRID2.AFTERROWCOLCHANGE     
	  ENDIF          	
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
       THISFORM.KEY_LIST.ENABLED=.F.
*!*	        THISFORM.REFRESH    
  ENDPROC   
**********    
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依部門編號排列')
           .ADDITEM('依部門名稱排列')
           .VALUE=1
       ENDWITH             
  ENDPROC
********* 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELECT  A14
       DO CASE
          CASE THIS.DISPLAYVALUE='依部門編號排列'
               SET ORDER TO A141 
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='部門編號'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='部門名稱'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A14.F01'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A14.F02'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55 
          CASE THIS.DISPLAYVALUE='依部門名稱排列'
               SET ORDER TO A142
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='部門名稱'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='部門編號'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A14.F02'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A14.F01'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50                                                                
       ENDCASE 
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
*!*	***********  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
        SELECT A14
        THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(INDEXSEEK(ALLTRIM(A14.F01)+'N',.T.,'S07','S074'),IIF(EMPTY(S07.F01),RGB(255,0,0),''),'')","COLUMN") &&若為有尚未確認之內容則呈現紅色
        THISFORM.GRID1.TOOLTIPTEXT=IIF(INDEXSEEK(ALLTRIM(A14.F01)+'N',.T.,'S07','S074'),IIF(EMPTY(S07.F01),'尚有資料未確認',''),'')      
       	THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A14.F01
        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=A14.F02   
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.     	
       	THISFORM.ANS_BOTT.ENABLED=.F.
       	THISFORM.INVERSE_BOTT.ENABLED=.F.
       	IF THISFORM.GRID1.ACTIVEROW=0 
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.	 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''     
	       THISFORM.PAGEFRAME1.PAGE1.LBLF141.CAPTION=''             
 	 ELSE
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 	
         ENDIF	      
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION  
         IF THIS.ACTIVEROW=0
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
         ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
         ENDIF   
         CHK=''     
*!*	       THISFORM.REFRESH
  ENDPROC     
**********  
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
         THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF(S07.F14<>'Y',RGB(255,0,0),'')","COLUMN") 
         THISFORM.GRID2.TOOLTIPTEXT=IIF(S07.F14<>'Y','尚未確認','已確認')       
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=S07.F05
   	 THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.VALUE=IIF(S07.F06='1',1,2)
   	 THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=IIF(S07.F07='1',1,2)
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S07.F08  
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=S07.F09   
   	 THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=IIF(!EMPTY(S07.F10),1,2)   	  
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=IIF(!EMPTY(S07.F10),S07.F10,'')
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=IIF(!EMPTY(S07.F10),'',S07.F11)	
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF141.CAPTION=IIF(EMPTY(S07.F14),'',IIF(S07.F14<>'Y','尚未確認','已確認'))  	 
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF141.BACKCOLOR=IIF(S07.F14<>'Y',RGB(255,0,0),RGB(58,186,152))        	    	 	    	    	    	 		     			 
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S07.F99      	 
         IF THISFORM.PAGEFRAME1.ACTIVEPAGE<>2
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.      	 
	     THISFORM.ANS_BOTT.ENABLED=.F.  	 
	     THISFORM.INVERSE_BOTT.ENABLED=.F.
	 ELSE    
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S07.F14<>'Y'    &&判斷有無修改的權限
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S07.F14<>'Y'   &&判斷有無刪除的權限	               	 
	     THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND S07.F14<>'Y'   	  	
	     THISFORM.INVERSE_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.) AND S07.F14='Y'           
	 ENDIF			    			 
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION
         CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE 
        IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
            THISFORM. CMDGROUP.SEEK_BOTT.ENABLED=.F.
        ENDIF       
*       THISFORM.REFRESH
  ENDPROC 
***********新增
PROCEDURE ORPGROUP.NEW_BOTT.CLICK        
     IF  INDEXSEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE),.F.,'S06','S063')=.F.
          =MESSAGEBOX('S05.人事薪資基本檔中此部門並無員工薪資資料,請查明後再輸入!',0+64,'提示訊息視窗')
          THISFORM.GRID2.SETFOCUS		      		          	    	              
          THISFORM.SHRGROUP.ABANDON_BOTT.CLICK   
    ELSE         
	  THISFORM.KEY_LIST.ENABLED=.F. 
	  THISFORM.GRID1.ENABLED=.F.  
	  THISFORM.GRID2.ENABLED=.F.  
	  THISFORM.ANS_BOTT.ENABLED=.F.      
	  THISFORM.INVERSE_BOTT.ENABLED=.F.        
	  THISFORM.SETALL('READONLY',.F.,'TEXTBOX')  
	  THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.          
	  THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=.T.     
	  THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.F.   	       
	  THISFORM.PAGEFRAME1.PAGE2.TXTF08.VISIBLE=.F.	
	  THISFORM.PAGEFRAME1.PAGE2.TXTF09.VISIBLE=.F.     	      
	  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX08.VISIBLE=.T.      
	  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.ENABLED=.T.    
	  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.T.    
	  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.ENABLED=.T.     
	  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.VALUE=1   
	  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=1 
	  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX08.VALUE=1            
	  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=2 
	  THISFORM.COMBOBOX09.VISIBLE=.T.  
	  THISFORM.COMBOBOX09.CLICK      
	  THISFORM.COMBOBOX09.VALUE=1    
	  THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=DATE()
	  THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=''
	  THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=''          
	  THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''
	  THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=0   
	  THISFORM.PAGEFRAME1.PAGE2.LBLF141.CAPTION=''                 
	  THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''
	  THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
    ENDIF 
ENDPROC
*************  
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK               &&新增確認
    SELE S07
    SET ORDER TO S072  && F03+DTOS(F05)+F06+F08+F09+F15
    COD=SYS(21) 
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
         =MESSAGEBOX('變更日期不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	  SET ORDER TO &COD
  	  RETURN        	  
    ENDIF   
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)
         =MESSAGEBOX('變更說明不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX08.SETFOCUS
  	  SET ORDER TO &COD
  	  RETURN        	  
    ENDIF
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)
         =MESSAGEBOX('薪資項目不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.SETFOCUS
  	  SET ORDER TO &COD
  	  RETURN
    ENDIF
    IF SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE);
        +DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE);
        +ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.VALUE));
        +ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE);
        +SPACE(30-LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)));
        +ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE);
        +SPACE(30-LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)))+'2','S07')=.T.
         =MESSAGEBOX('此筆資料已存在,請查明後在輸入!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN 
    ENDIF
    IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=1
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE)
	      =MESSAGEBOX('調幅比例不得為零!',0+64,'提示訊息視窗')
	      THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
	      SET ORDER TO &COD
	      RETURN   
  	 ENDIF
    ELSE
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
	      =MESSAGEBOX('調幅金額不得為零!',0+64,'提示訊息視窗')
	      THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
	      SET ORDER TO &COD
	      RETURN   
  	 ENDIF    	       	  
    ENDIF
    SELECT S07
   APPEND BLANK
    LOCK()
    IF RLOCK()
    	REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    	REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION)
    	REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
    	REPLACE F06 WITH  ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.VALUE))
    	REPLACE F07 WITH  ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE))
    	REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE  
    	REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=1    	
    	     REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
    	ELSE
    	     REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
    	ENDIF
    	REPLACE F14 WITH  'N'
    	REPLACE F15 WITH  '2'
    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ENDIF
    UNLOCK ALL
    SELECT S07
    SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    THISFORM.ORPGROUP.NEW_BOTT.CLICK   
    THISFORM.REFRESH
  ENDPROC  
***********    
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK 
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.F.   
     THISFORM.GRID2.ENABLED=.F.               
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.         
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.ENABLED=.T.  
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.T.        
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.ENABLED=.T.             
     THISFORM.PAGEFRAME1.PAGE2.TXTF08.VISIBLE=.F.	
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VISIBLE=.F.     	      
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX08.VISIBLE=.T.  
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=IIF(!EMPTY(S07.F10),.F.,.T.)    
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=IIF(!EMPTY(S07.F11),.F.,.T.)         
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.VALUE=VAL(S07.F06)
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=VAL(S07.F07)
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX08.DISPLAYVALUE=S07.F08           
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=IIF(!EMPTY(S07.F10),1,2)    	      
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=IIF(!EMPTY(S07.F10),S07.F10,'')     
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=IIF(!EMPTY(S07.F11),S07.F11,'')      
     THISFORM.PAGEFRAME1.PAGE2.LBLF141.CAPTION=''                    		      	    
     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION='' 
     THISFORM.COMBOBOX09.VISIBLE=.T.  
     THISFORM.COMBOBOX09.CLICK     
     THISFORM.COMBOBOX09.DISPLAYVALUE=S07.F09      
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS 
     LOCK()
     IF !RLOCK()
          DO FILE_IMPACT
          RETURN
     ENDIF   
 ENDPROC    
**************
PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK   &&修改確認                 
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
         =MESSAGEBOX('變更日期不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	  RETURN        	  
    ENDIF  
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)
         =MESSAGEBOX('變更說明不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX08.SETFOCUS
  	  RETURN        	  
    ENDIF
    IF THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE<>S07.F05 OR ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)<>ALLTRIM(S07.F08) OR ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)<>ALLTRIM(S07.F09)
         IF INDEXSEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE);
             +DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE);
             +ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.VALUE));
             +ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE);
             +SPACE(30-LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)));
             +ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE);
             +SPACE(30-LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)))+'2',.F.,'S07','S072')=.T.
             =MESSAGEBOX('此筆資料已存在,請查明後在輸入!',0+64,'提示訊息視窗')
  	     THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	     RETURN        	  
  	  ENDIF   
    ENDIF       
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)
         =MESSAGEBOX('薪資項目不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.SETFOCUS
  	  RETURN        	  
    ENDIF   
    IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=1
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE)
	      =MESSAGEBOX('調幅比例不得為零!',0+64,'提示訊息視窗')
	      THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
	      RETURN   
  	 ENDIF
    ELSE
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
	      =MESSAGEBOX('調幅金額不得為零!',0+64,'提示訊息視窗')
	      THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
	      RETURN   
  	 ENDIF    	       	  
    ENDIF     
    SELECT  S07          
    IF RLOCK()	    
    	REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
    	REPLACE F06 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.VALUE))
    	REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE))
    	REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE  
    	REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=1    	
    	     REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
    	     REPLACE F11 WITH 0
    	ELSE
    	     REPLACE F10 WITH 0
    	     REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
    	ENDIF	    
    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ELSE
          DO FILE_IMPACT
          RETURN   
    ENDIF  
    THISFORM.GRID2.SETFOCUS		      		          	    	              
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
ENDPROC   
*************
PROC ORPGROUP.DEL_BOTT.CLICK                    &&刪除資料程序
 IF  MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認')=6 
       SELECT S07
       LOCK()
       IF RLOCK()
 	    IF S07.F14='Y'
 	       	 =MESSAGEBOX('此資料已確認,無法刪除!',0+64,'提示訊息視窗')
 	    ELSE
     	       DELETE 
     	       UNLOCK
     	       SKIP -1
     	       IF BOF()
     	           GO TOP
     	       ENDIF  
 	    ENDIF
       ELSE
           DO FILE_IMPACT
       ENDIF
       THISFORM.GRID2.SETFOCUS 	
       THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	      
  ENDIF
*!*	  THISFORM.REFRESH	       
ENDPROC  
****************
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.SETALL('VISIBLE',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.      
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.     
      THISFORM.COMBOBOX09.VISIBLE=.F.  
      THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.T.      
      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.ENABLED=.F. 
      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.F. 
      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.ENABLED=.F.    
      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX08.VISIBLE=.F.
      THISFORM.GRID2.ENABLED=.T. 	              
      THISFORM.GRID2.SETFOCUS 
      THISFORM.PAGEFRAME1.PAGE2.ACTIVATE  
*!*	      THISFORM.REFRESH   
      UNLOCK ALL          
  ENDPROC
**********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
       SELECT A14
       DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依部門編號排列'
                 SET ORDER TO A141
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依部門名稱排列'
                 SET ORDER TO A142
         ENDCASE   
         THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
****************薪資項目 
PROCEDURE COMBOBOX09.CLICK
    THISFORM.COMBOBOX09.CLEAR
    IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=1
        THIS.ADDITEM('')
        THIS.ADDITEM('底薪')
        THIS.ADDITEM('日薪')
        THIS.ADDITEM('時薪')
        THIS.ADDITEM('伙食費')
        THIS.ADDITEM('交通費')
        THIS.ADDITEM('全勤獎金')
        THIS.ADDITEM('職務津貼')
    ELSE
         THIS.ADDITEM('')
 	 THIS.ADDITEM('勞保費')
 	 THIS.ADDITEM('健保費')
 	 THIS.ADDITEM('所得稅')
    ENDIF 
 ENDPROC    
***************
 PROC ANS_BOTT.CLICK     &&確認作業     
     IF  MESSAGEBOX('您是否確認此筆變動之資料!',4+32+256,'請確認')=6
	  IF !USED('S05')	&&人事薪資基本檔
	       SELE 0
	       USE S05 
	  ELSE
	       SELE S05
	  ENDIF     
	  SET ORDER TO S051
          SELECT S07
          LOCK()
          IF RLOCK()
 	      IF S07.F14='Y'
 	          =MESSAGEBOX('此筆資料已確認過,請查明後再作確認!',0+64,'提示訊息視窗')
 	           THISFORM.GRID2.SETFOCUS
 	      ELSE        	      
 	          REPLACE S07.F14 WITH 'Y'  
    		  REPLACE S07.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')  
	      ***S06 薪資明細及扣款項目
                  SELECT  RECNO() FROM S06 WHERE ALLTRIM(S06.F03)=ALLTRIM(S07.F03) AND S06.F05=S07.F07 AND ALLTRIM(S06.F07)=ALLTRIM(S07.F09)  INTO ARRAY BK6              
                  JJ6=''                
                  IF _TALLY>0   
                      FOR I= 1 TO ALEN(BK6)
                              JJ6=JJ6+ALLTRIM(STR(BK6(I)))+','
                      ENDFOR    
                      KK6=STUFF(JJ6,RAT(',',JJ6,1),1,'')              
                      RLOCK(KK6,'S06')
                      LL6=RLOCK(KK6,'S06')
                  ELSE
                      LL6=.T.   
                  ENDIF                   
                  IF LL6=.T. AND LEN(ALLTRIM(JJ6))>0  	 	    
                      FOR I= 1 TO ALEN(BK6)            
                              SELECT S06          
                              GO BK6(I)
                              SELECT S05
	    		      SEEK S06.F01
	    		      IF FOUND() AND (S05.F28<>'1' OR S05.F28<>'3' OR S05.F28<>'7' OR S05.F28<>'8')      &&1:離職,3:留職停薪,7:退休,8:資遣接不可新增                         
		              **若符合則增加S07A員工調薪修改作業資料,且狀態為3:從部門中新增之人員
 			          SELECT S07			
		     	          APPEND BLANK
				  REPLACE S07.F01 WITH S06.F01
				  REPLACE S07.F02 WITH S06.F02
				  REPLACE S07.F03 WITH S06.F03
				  REPLACE S07.F04 WITH S06.F04
			          REPLACE S07.F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
			          REPLACE S07.F06 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP06.VALUE))
			          REPLACE S07.F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE))
			          REPLACE S07.F08 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)
			          REPLACE S07.F09 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)
			          REPLACE S07.F12 WITH S06.F08  
			          IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=1    			&&變更調幅比例
			               REPLACE S07.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE	
			               REPLACE S07.F13 WITH  S06.F08+ROUND(S06.F08*(S07.F10/100),0)			&&原金額+ROUND(原金額*調幅比例)
			          ELSE																	&&變更調幅金額
			               REPLACE S07.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE	
			               REPLACE S07.F13 WITH S06.F08+S07.F11								&&原金額+調幅金額
			          ENDIF            
	    		          REPLACE S07.F14 WITH 'Y'  
	    		          REPLACE S07.F15 WITH '3'		&&3:從部門中新增之人員
	    		          REPLACE S07.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')   
	    		          SELECT S06                              
			          IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP10.VALUE=1    			&&變更調幅比例
			               REPLACE S06.F08 WITH S06.F08+ROUND(S06.F08*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
			               REPLACE S06.F99 WITH  DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			          ELSE																	&&變更調幅金額
			              REPLACE S06.F08 WITH S06.F08+THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
			              REPLACE S06.F99 WITH  DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			          ENDIF   
			      ENDIF		               		               
		        ENDFOR 
		  ENDIF
		  SELECT S05
		  USE           	          
    		  =MESSAGEBOX('此筆資料確認成功!',0+64,'提示訊息視窗')	 
    		  THISFORM.GRID2.SETFOCUS    	      	                          
	      ENDIF
 	  ENDIF          
     ENDIF 
     RELEASE ALL LIKE BK* 
     UNLOCK  ALL 	
     SELECT S07
     THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	   
    ENDPROC
***************
 PROC INVERSE_BOTT.CLICK     &&反確認作業      
     IF  MESSAGEBOX('您是否反確認此筆已變動之資料!',4+32+256,'請確認')=6
          SELECT S07
          LOCK()
          IF RLOCK()
              IF S07.F14<>'Y'
 	          =MESSAGEBOX('此筆資料尚未確認過,請查明後再作反確認!',0+64,'提示訊息視窗')
 	          THISFORM.GRID2.SETFOCUS
 	      ELSE   
 	          SELECT S07
 	          REPLACE S07.F14 WITH 'N'
 	          REPLACE S07.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'') 
                  SELECT  RECNO() FROM S07 WHERE ALLTRIM(S07.F03)=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE);
 	                         AND IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE),S07.F11=THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,S07.F10=THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE);
 	                         AND S07.F05=THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE AND F14='Y' AND F15='3'    INTO ARRAY BK7              
                  JJ7=''                
                  IF _TALLY>0   
                      FOR I= 1 TO ALEN(BK7)
                              JJ7=JJ7+ALLTRIM(STR(BK7(I)))+','
                      ENDFOR    
                      KK7=STUFF(JJ7,RAT(',',JJ7,1),1,'')              
                      RLOCK(KK7,'S07')
                      LL7=RLOCK(KK7,'S07')
                  ELSE
                      LL7=.T.   
                  ENDIF                   
                  IF LL7=.T. AND LEN(ALLTRIM(JJ7))>0  
	              SELECT S06
                      SET ORDER TO S062   && F01+F07+F05                     
                      SELECT S07	 	    
                      FOR I= 1 TO ALEN(BK7)        
                             GO BK7(I)     	       
 	                     SELECT S06
 	                     SEEK S07.F01+S07.F09+S07.F07
 	                     IF FOUND()  AND ALLTRIM(S06.F03)=ALLTRIM(S07.F03)
 	                         REPLACE S06.F08 WITH S06.F08-(S07.F13-S07.F12)
 	                         REPLACE S06.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
 	                     ENDIF
			     SELECT S07
			     DELETE 
 	              ENDFOR                        
    		      =MESSAGEBOX('此筆資料反確認成功!',0+64,'提示訊息視窗') 
    		      THISFORM.GRID2.SETFOCUS   	      	                          
	          ENDIF
 	      ENDIF
 	  ENDIF              
     ENDIF           
     RELEASE ALL LIKE BK* 
     UNLOCK   ALL 	
     THISFORM.PAGEFRAME1.PAGE2.ACTIVATE      
    ENDPROC 
ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
   SELE S07
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW       
ENDPROC 
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
*!*	  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  TOP=INT_015*200
  LEFT=INT_015*250  
  HEIGHT=INT_015*120
  WIDTH=INT_015*280
  FONTSIZE=INT_015*9
  MOVABLE=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*30,;
      CAPTION='起始部門編號',;
      NAME='LABEL1'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      TOP=INT_015*24,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*60,; 
      MAXLENGTH=4,;
      NAME='TEXT1'      
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*61,;
      CAPTION='截止部門編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      TOP=INT_015*55,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,;   
      WIDTH=INT_015*60,;     
      MAXLENGTH=4,;   
      NAME='TEXT2'    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*190,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*70,;    
      TOP=INT_015*14,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<P.列         印',;
      TOOLTIPTEXT='列印所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*190,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*70,;    
      TOP=INT_015*45,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<E.轉EXCEL',;
      TOOLTIPTEXT='將資料轉至EXCEL格式!快速鍵->ALT+Y',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*190,;
      TOP=INT_015*76,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*70,; 
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<C.取        消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*10,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*10,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*10,'COMMANDBUTTON')   
      THISFORM.TEXT1.VALUE=A14.F01
      THISFORM.TEXT2.VALUE=A14.F01              
  ENDPROC    
  PROCEDURE CMND1.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始部門編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止部門編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
      SELECT  * FROM S07 WHERE F03>=THISFORM.TEXT1.VALUE AND F03<=THISFORM.TEXT2.VALUE AND  F14='Y'  AND  F15='2' ORDER BY F01,F05 NOWAIT
      IF  _TALLY >0
           REPORT FORM ALLTRIM(INT_116)+'S07B' TO PRINT PROMPT   PREVIEW
      ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.CMND3.CLICK
  ENDPROC    
  ***
  PROCEDURE CMND2.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始部門編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止部門編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
      SELECT F03 部門編號,F04 部門名稱,F05 變更日期,IIF(F06='1','調薪','修改') 變更方式,IIF(F07='1','所得項目','扣款項目') 變更項目,;
     		     F08 變更說明,F09 薪資項目,TRANSFORM(F10,'@R 999,999')+'%'  變更比例,IIF(!EMPTY(F10),'',TRANSFORM(F11,'@R 999,999,999,999')) 變更金額;
                     FROM S07 WHERE F03>=THISFORM.TEXT1.VALUE AND F03<=THISFORM.TEXT2.VALUE AND  F14='Y'  AND  F15='2' ORDER BY F01,F05 NOWAIT
      IF  _TALLY >0
           FILENAME='S07B 部門調薪修改資料'
	   GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
	   IF !EMPTY(GCDELIMFILE) 
	       ON ERROR DO FILE_IMPACT
	       COPY TO (GCDELIMFILE) TYPE XL5     
	      =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗')  
	   ELSE
              THISFORM.TEXT1.SETFOCUS
               RETURN		   
	   ENDIF  
      ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.CMND3.CLICK
  ENDPROC           
  *** 
  PROCEDURE CMND3.CLICK
      THISFORM.RELEASE
  ENDPROC      
  PROC CMND1.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND1.TOP=INT_015*15
             THISFORM.CMND1.LEFT=INT_015*191
  ENDPROC     
  PROC CMND1.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND1.TOP=INT_015*14
             THISFORM.CMND1.LEFT=INT_015*190                  
  ENDPROC     
  PROC CMND2.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND2.TOP=INT_015*46
             THISFORM.CMND2.LEFT=INT_015*191
  ENDPROC     
  PROC CMND2.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND2.TOP=INT_015*45
             THISFORM.CMND2.LEFT=INT_015*190                  
  ENDPROC     
  PROC CMND3.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND3.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND3.TOP=INT_015*77
             THISFORM.CMND3.LEFT=INT_015*191
  ENDPROC     
  PROC CMND3.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND3.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND3.TOP=INT_015*76
             THISFORM.CMND3.LEFT=INT_015*190                  
  ENDPROC      
ENDDEFINE    
*********************************************變更項目
DEFINE CLASS OPTIONGROUP07 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*25
   WIDTH=INT_015*175
   BUTTONCOUNT=2
   VALUE=1
   ENABLED=.F.	    
   NAME='OPTIONGROUP07'
   OPTION1.CAPTION='所得項目'
   OPTION1.TOP=INT_015*5
   OPTION1.FONTSIZE=INT_015*9
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='扣款項目'
   OPTION2.TOP=INT_015*5
   OPTION2.FONTSIZE=INT_015*9
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*80
   OPTION2.NAME='OPTION2'     
   PROCEDURE INTERACTIVECHANGE
	THISFORM.COMBOBOX09.CLICK
	THISFORM.COMBOBOX09.VALUE=1
  ENDPROC    
ENDDEFINE 
*********************************************變更說明
DEFINE CLASS COMBOBOX08 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX08'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='I'  ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       THIS.ADDITEM('其他')
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE2.TXTF08.REFRESH  
  ENDPROC       
ENDDEFINE
******************************** 薪資項目
DEFINE CLASS COMBOBOX09 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX09' 
   PROCEDURE INTERACTIVECHANGE
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=ALLTRIM(THIS.DISPLAYVALUE)    
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.REFRESH      
  ENDPROC       
ENDDEFINE
****************調幅方式
DEFINE CLASS OPTIONGROUP10 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*29
   WIDTH=INT_015*230
   BUTTONCOUNT=2
   VALUE=1
   ENABLED=.F.	   
   NAME='OPTIONGROUP10'
   OPTION1.CAPTION='比例'
   OPTION1.FONTSIZE=INT_015*9  
   OPTION1.TOP=INT_015*7
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='金額'
   OPTION2.FONTSIZE=INT_015*9 	   
   OPTION2.TOP=INT_015*7
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*118
   OPTION2.NAME='OPTION2'
   PROCEDURE INTERACTIVECHANGE
      IF THIS.VALUE=1
      	   THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=.F. 
      	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.T. 
	   THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=0
	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=''	   	      
      ELSE
      	   THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=.T. 
      	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.F. 
	   THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''
	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=0	  
      ENDIF    
  ENDPROC    
ENDDEFINE 
