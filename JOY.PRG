**程式名稱:JOY.採購舊系統之報價資料
SET EXCL OFF
CLOSE ALL
CLEAR 
AREA1='JOY'
FLG='0'
FCH=''
CHK=''
IF !USED('A01')
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'JOY' 
IF !USED('JOY')
   SELE 0
   USE JOY
ELSE 
   SELE JOY
ENDIF
SET ORDER TO JOY1  
*********************** 
JOYFORM=CREATEOBJECT("TKJOY")
JOYFORM.SHOW  
DEFINE CLASS TKJOY AS FORM
  CAPTION='JOY.採購舊系統之報價資料'
  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=3  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  ADD OBJECT REC_COUNT AS REC_COUNT  WITH;
      CAPTION=STR(RECCOUNT()),;
      TOP=INT_015*5
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=16,;            
      RECORDSOURCE='JOY',; 
      HEIGHT=INT_015*500,;     
      WIDTH=INT_015*780,;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',; 
      COLUMN4.NAME='COLUMN4',; 
      COLUMN5.NAME='COLUMN5',;             
      COLUMN6.NAME='COLUMN6',;       
      COLUMN7.NAME='COLUMN7',;       
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10',;
      COLUMN11.NAME='COLUMN11',;
      COLUMN12.NAME='COLUMN12',;
      COLUMN13.NAME='COLUMN13',; 
      COLUMN14.NAME='COLUMN14',;
      COLUMN15.NAME='COLUMN15',;
      COLUMN16.NAME='COLUMN16'  
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;      
      TOP=INT_015*0,;
      LEFT=INT_015*350              
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=INT_015*0,;
      LEFT=INT_015*250,;
      ENABLED=.T.,;
      VISIBLE=.T. 
 ***********************                        
  PROCEDURE INIT
       THISFORM.ORPGROUP.NEW_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.DEL_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.PNT_BOTT.VISIBLE=.F.
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')                                   
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*130
       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*40
       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*40
       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*100
       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*100
       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*100
       THISFORM.GRID1.COLUMN16.WIDTH=INT_015*65
       	   THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶簡稱'       
	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單號'	           
	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	   	   
	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='數量'
  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='單位'  	   
  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='單價'
  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='報價日期' 
  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='有效日' 
  	   THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='Your_Ref' 
  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='Our_Ref' 
  	   THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='交貨方式' 
  	   THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='付款方式' 
  	   THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='包裝方式' 
  	   THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='最少訂購量' 
  	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='JOY.Name' 
  	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='JOY.Cust_no' 	   
	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='JOY.Num'
	   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='JOY.Name1'
	   THISFORM.GRID1.COLUMN5.CONTROLSOURCE='JOY.Qty'
	   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='JOY.Pcs'
	   THISFORM.GRID1.COLUMN7.CONTROLSOURCE='JOY.Mon'
	   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='JOY.Nt'	   
	   THISFORM.GRID1.COLUMN9.CONTROLSOURCE='JOY.Date'
	   THISFORM.GRID1.COLUMN10.CONTROLSOURCE='JOY.Iss_date'
	   THISFORM.GRID1.COLUMN11.CONTROLSOURCE='JOY.Your_ref'
	   THISFORM.GRID1.COLUMN12.CONTROLSOURCE='JOY.Our_ref'
	   THISFORM.GRID1.COLUMN13.CONTROLSOURCE='JOY.Term'
	   THISFORM.GRID1.COLUMN14.CONTROLSOURCE='JOY.Pay'
	   THISFORM.GRID1.COLUMN15.CONTROLSOURCE='JOY.Package'
	   THISFORM.GRID1.COLUMN16.CONTROLSOURCE='JOY.Min_qty'   
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS
       JK='客戶簡稱'
  ENDPROC
**********************       
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依客戶簡稱+日期排列')
           .ADDITEM('依料        號+日期排列')
           .ADDITEM('依客戶簡稱+料號排列')                    
       ENDWITH      
  ENDPROC
************************   
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE JOY 
       DO CASE   
          CASE THIS.DISPLAYVALUE='依客戶簡稱+日期排列'
               SET ORDER TO JOY1 
	           THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶簡稱'       
		   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
		   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單號'	           
		   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	   	   
		   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='數量'
	  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='單位'  	   
	  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='單價'
	  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
	  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='報價日期' 
	  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='有效日' 
	  	   THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='Your_Ref' 
	  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='Our_Ref' 
	  	   THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='交貨方式' 
	  	   THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='付款方式' 
	  	   THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='包裝方式' 
	  	   THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='最少訂購量' 
	  	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='JOY.Name' 
	  	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='JOY.Cust_no' 	   
		   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='JOY.Num'
		   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='JOY.Name1'
		   THISFORM.GRID1.COLUMN5.CONTROLSOURCE='JOY.Qty'
		   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='JOY.Pcs'
		   THISFORM.GRID1.COLUMN7.CONTROLSOURCE='JOY.Mon'
		   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='JOY.Nt'	   
		   THISFORM.GRID1.COLUMN9.CONTROLSOURCE='JOY.Date'
		   THISFORM.GRID1.COLUMN10.CONTROLSOURCE='JOY.Iss_date'
		   THISFORM.GRID1.COLUMN11.CONTROLSOURCE='JOY.Your_ref'
		   THISFORM.GRID1.COLUMN12.CONTROLSOURCE='JOY.Our_ref'
		   THISFORM.GRID1.COLUMN13.CONTROLSOURCE='JOY.Term'
		   THISFORM.GRID1.COLUMN14.CONTROLSOURCE='JOY.Pay'
		   THISFORM.GRID1.COLUMN15.CONTROLSOURCE='JOY.Package'
		   THISFORM.GRID1.COLUMN16.CONTROLSOURCE='JOY.Min_qty' 
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*130
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*40
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*40
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN16.WIDTH=INT_015*65
          CASE THIS.DISPLAYVALUE='依料        號+日期排列'
               SET ORDER TO JOY2
               	   THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料        號' 
               	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='單號'                                    	                                           
		   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='客戶編號'
		   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='客戶簡稱' 	              	   
		   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='數量'
	  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='單位'  	   
	  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='單價'
	  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
	  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='報價日期' 
	  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='有效日' 
	  	   THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='Your_Ref' 
	  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='Our_Ref' 
	  	   THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='交貨方式' 
	  	   THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='付款方式' 
	  	   THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='包裝方式' 
	  	   THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='最少訂購量' 
	  	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='JOY.Name1'
		   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='JOY.Num'
		   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='JOY.Cust_no'
		   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='JOY.Name'  
		   THISFORM.GRID1.COLUMN5.CONTROLSOURCE='JOY.Qty'
		   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='JOY.Pcs'
		   THISFORM.GRID1.COLUMN7.CONTROLSOURCE='JOY.Mon'
		   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='JOY.Nt'	   
		   THISFORM.GRID1.COLUMN9.CONTROLSOURCE='JOY.Date'
		   THISFORM.GRID1.COLUMN10.CONTROLSOURCE='JOY.Iss_date'
		   THISFORM.GRID1.COLUMN11.CONTROLSOURCE='JOY.Your_ref'
		   THISFORM.GRID1.COLUMN12.CONTROLSOURCE='JOY.Our_ref'
		   THISFORM.GRID1.COLUMN13.CONTROLSOURCE='JOY.Term'
		   THISFORM.GRID1.COLUMN14.CONTROLSOURCE='JOY.Pay'
		   THISFORM.GRID1.COLUMN15.CONTROLSOURCE='JOY.Package'
		   THISFORM.GRID1.COLUMN16.CONTROLSOURCE='JOY.Min_qty' 
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*130
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*40
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*40
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN16.WIDTH=INT_015*65
        CASE THIS.DISPLAYVALUE='依客戶簡稱+料號排列'
               SET ORDER TO JOY3
               	   THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶簡稱' 
               	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料        號' 
               	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單號'                                    	                                           
		   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='客戶編號'              	   
		   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='數量'
	  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='單位'  	   
	  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='單價'
	  	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
	  	   THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='報價日期' 
	  	   THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='有效日' 
	  	   THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='Your_Ref' 
	  	   THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='Our_Ref' 
	  	   THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='交貨方式' 
	  	   THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='付款方式' 
	  	   THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='包裝方式' 
	  	   THISFORM.GRID1.COLUMN16.HEADER1.CAPTION='最少訂購量' 
	  	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='JOY.Name' 
	  	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='JOY.Name1'
		   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='JOY.Num'
		   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='JOY.Cust_no'
		   THISFORM.GRID1.COLUMN5.CONTROLSOURCE='JOY.Qty'
		   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='JOY.Pcs'
		   THISFORM.GRID1.COLUMN7.CONTROLSOURCE='JOY.Mon'
		   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='JOY.Nt'	   
		   THISFORM.GRID1.COLUMN9.CONTROLSOURCE='JOY.Date'
		   THISFORM.GRID1.COLUMN10.CONTROLSOURCE='JOY.Iss_date'
		   THISFORM.GRID1.COLUMN11.CONTROLSOURCE='JOY.Your_ref'
		   THISFORM.GRID1.COLUMN12.CONTROLSOURCE='JOY.Our_ref'
		   THISFORM.GRID1.COLUMN13.CONTROLSOURCE='JOY.Term'
		   THISFORM.GRID1.COLUMN14.CONTROLSOURCE='JOY.Pay'
		   THISFORM.GRID1.COLUMN15.CONTROLSOURCE='JOY.Package'
		   THISFORM.GRID1.COLUMN16.CONTROLSOURCE='JOY.Min_qty' 
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*130
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*40
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*40
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*100
		       THISFORM.GRID1.COLUMN16.WIDTH=INT_015*65          	                  
       ENDCASE 
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC
************************                  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.REFRESH
  ENDPROC       
ENDDEFINE        

