***F04材料用途表
close all
clear 
FLG='0'
FCH=''
CHK=''
R=0
AREA1='F02_1'
AREA2='F02'
IF !USED('E00')
   SELE 0
   USE E00
ELSE
   SELE E00
ENDIF
SET ORDER TO 1
IF ! USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK sys_oper+'F03'

IF !USED('B01')
   SELE 0
   USE B01 INDE B01
ELSE
   SELE B01
ENDIF
SET ORDER TO 1
SELE F01,F02 FROM B01 WHERE F97='Y' INTO CURSOR B01_2 ORDER BY F01
CREATE CURSOR B01_1;
(F01 C(43),F02 C(40))
INDE ON F01 TAG B01_11
SET ORDER TO B01_11
SELE B01_2
GO TOP
DO WHILE !EOF()
   SELE B01_1
   APPEND BLANK
   REPL F01 WITH B01_2.F01
   REPL F02 WITH B01_2.F02
   SELE B01_2
   SKIP
ENDDO 
SELE B01_2
USE
SELECT B01_1
SET ORDER TO 1
IF !USED('F02')
   SELE 0
   USE F02 
ELSE
   SELE F02
ENDIF
SET ORDER TO F022
SET RELATION TO F03 INTO E00 
SET RELATION TO F01 INTO B01_1 ADDI
SELECT F04,F05 FROM F02 GROUP BY F04,F05 INTO CURSOR F02_2 ORDER BY F04,F05
CREATE CURSOR F02_1;
(F04 C(43),F05 C(3))
INDEX ON F04+F05 TAG F02_1
SET ORDER TO 1
SELECT F02_2
GO TOP
DO WHILE !EOF()
       SELECT F02_1
       APPEND BLANK
       REPLACE F04 WITH F02_2.F04
       REPLACE F05 WITH F02_2.F05
       SELECT F02_2
      SKIP
ENDDO
SELECT F02_2
USE
SELECT F02_1
SET RELATION TO F04 INTO B01 
F04form=createobject("tkF04")
F04form.show  
define class tkF04 as form
  caption='F04.材料用途表'
  controlbox=.F.
  BORDERSTYLE=3  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  controlcount=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  showtips=.t.
  showwindow=1
  WIDTH=INT_015*789
  windowtype=1
  NAME='TKF03'
  add object shape1 as shape1 with;
      autocenter=.t.
  ADD OBJECT LBL_REC AS LBL_REC WITH;
      AUTOCENTER =.T.
  ADD OBJECT REC_COUNT AS REC_COUNT  with;
      caption=str(reccount())        
  add object shape2 as shape2 with;
      autocenter=.t.
  add object shape3 as shape3 with;
      autocenter=.t.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*200,;
      FONTSIZE=INT_015*9,;
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='表頭資料',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='表身詳細資料內容'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT grid1 AS grid1 WITH;
      columncount=2,;            
      RECORDSOURCE='F02_1',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'      
  ADD OBJECT grid2 AS grid2 WITH;
      columncount=7,;            
      RECORDSOURCE='F02',;
      LINKMASTER='F02_1',;
      RELATIONALEXPR='F04+F05',;
      CHILDORDER='F022',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.              
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOSIZE=.T.              

  PROCEDURE PAGEFRAME1.PAGE1.INIT     
     THIS.ADDOBJECT('LBLF04','LABEL')
     WITH THIS.LBLF04
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*27
          .WIDTH=INT_015*50
          .CAPTION='材料品號'          
     ENDWITH
     THIS.AddObject('LBLF041','LABEL')
     WITH THIS.LBLF041
                 .VISIBLE=.T.
                 .LEFT=INT_015*14
                 .TOP=INT_015*52
                 .WIDTH=INT_015*50
                 .CAPTION='品名規格'
     ENDWITH
     THIS.ADDOBJECT('LBLF042','LABEL')     
     WITH THIS.LBLF042
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*52
          .AUTOSIZE=.T.  
     ENDWITH            
     THIS.AddObject('LBLF05','LABEL')
     WITH THIS.LBLF05
              .VISIBLE=.T.
              .LEFT=INT_015*14
              .WIDTH=INT_015*50
              .TOP=INT_015*77
              .CAPTION='版        次'
      ENDWITH        
     THIS.ADDOBJECT('TXTF04','TEXTBOX')     
     WITH THIS.TXTF04
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*23
          .WIDTH=INT_015*216
          .HEIGHT=INT_015*25
          .MAXLENGTH=43
     ENDWITH        
     THIS.ADDOBJECT('TXTF05','TEXTBOX')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*73
          .WIDTH=INT_015*25
          .HEIGHT=INT_015*25
          .MAXLENGTH=3
     ENDWITH             
  ENDPROC   
  PROCEDURE PAGEFRAME1.PAGE2.INIT
    THIS.ADDOBJECT('LBLF01','LABEL')
    WITH THIS.LBLF01
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*14
         .WIDTH=INT_015*50
         .CAPTION='組成品號'          
    ENDWITH       
     THIS.AddObject('LBLF02','LABEL')
     WITH THIS.LBLF02
              .VISIBLE=.T.
              .LEFT=INT_015*14
              .WIDTH=INT_015*50
              .TOP=INT_015*39
              .CAPTION='版        次'
      ENDWITH            
    THIS.ADDOBJECT('LBLF011','LABEL')
    WITH THIS.LBLF011
         .VISIBLE=.T.           
         .LEFT=INT_015*313
         .TOP=INT_015*14
         .AUTOSIZE=.T.          
    ENDWITH         
    THIS.ADDOBJECT('LBLF03','LABEL')
    WITH THIS.LBLF03
         .VISIBLE=.T.
	     .LEFT=INT_015*248
	     .TOP=INT_015*64
	     .WIDTH=INT_015*50
	     .CAPTION='投入製程'
	ENDWITH     
    THIS.ADDOBJECT('LBLF031','Label')
    WITH THIS.LBLF031
         .VISIBLE=.T.
         .LEFT=INT_015*354
         .TOP=INT_015*64
         .AUTOSIZE=.T.
    ENDWITH     
    THIS.ADDOBJECT('LBLF06','LABEL')
    WITH THIS.LBLF06
         .VISIBLE=.T.    
         .LEFT=INT_015*14
         .TOP=INT_015*64
         .WIDTH=INT_015*50
         .CAPTION='供料方式'       
    ENDWITH     
    THIS.ADDOBJECT('LBLF061','LABEL')
    WITH THIS.LBLF061
         .VISIBLE=.T.    
         .LEFT=INT_015*80
         .TOP=INT_015*64
         .WIDTH=INT_015*50
    ENDWITH         
    THIS.ADDOBJECT('LBLF07','LABEL')      
    WITH THIS.LBLF07
         .VISIBLE=.T.       
         .LEFT=INT_015*14
         .TOP=INT_015*89
         .WIDTH=INT_015*50
         .CAPTION='單位用量'
    ENDWITH         
    THIS.ADDOBJECT('LBLF12','LABEL')      
    WITH THIS.LBLF12
         .VISIBLE=.T.       
         .LEFT=INT_015*14
         .TOP=INT_015*114
         .WIDTH=INT_015*50
         .CAPTION='耗損率%'
    ENDWITH     
    THIS.ADDOBJECT('LBLF08','LABEL')
    WITH THIS.LBLF08  
              .VISIBLE=.T.
              .LEFT=INT_015*14
              .TOP=INT_015*139
	      .WIDTH=INT_015*50
              .CAPTION='備註說明'
    ENDWITH  
	THIS.ADDOBJECT('TXTF01','TEXTBOX')  
	WITH THIS.TXTF01
	     .VISIBLE=.T.
	     .LEFT=INT_015*65
	     .TOP=INT_015*10
	     .WIDTH=INT_015*241
	     .HEIGHT=INT_015*25
	     .MAXLENGTH=43
	     .NAME='TXTF01'  
	ENDWITH         
	THIS.ADDOBJECT('TXTF02','TEXTBOX')  
	WITH THIS.TXTF02
	     .VISIBLE=.T.
	     .LEFT=INT_015*65
	     .TOP=INT_015*35
	     .WIDTH=INT_015*25
	     .HEIGHT=INT_015*25
	     .MAXLENGTH=3
	     .NAME='TXTF02'  
	ENDWITH         	
	THIS.ADDOBJECT('TXTF03','TEXTBOX')
	WITH THIS.TXTF03
	     .VISIBLE=.T.
	     .LEFT=INT_015*299
	     .TOP=INT_015*60
	     .WIDTH=INT_015*40
	     .HEIGHT=INT_015*25
	     .MAXLENGTH=4
	     .NAME='TXTF03'	    
	ENDWITH     
    THIS.ADDOBJECT('TXTF06','TEXTBOX')
    WITH THIS.TXTF06
         .VISIBLE=.T.
         .LEFT=INT_015*65
         .TOP=INT_015*60
         .WIDTH=INT_015*10         
         .NAME='TXTF06'
    ENDWITH     
    THIS.ADDOBJECT('TXTF07','TEXTBOX')
    WITH THIS.TXTF07
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*85
         .WIDTH=INT_015*80
         .HEIGHT=INT_015*25
         .INPUTMASK='999999999.9999'
         .ALIGNMENT=1
         .NAME='TXTF07'                            
    ENDWITH         
    THIS.ADDOBJECT('TXTF12','TEXTBOX')
    WITH THIS.TXTF12
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*110
         .WIDTH=INT_015*60
         .HEIGHT=INT_015*25
         .INPUTMASK='99.99'
         .ALIGNMENT=1         
         .NAME='TXTF12'                            
    ENDWITH     
	THIS.ADDOBJECT('TXTF08','TEXTBOX')  
	WITH THIS.TXTF08
	     .VISIBLE=.T.
	     .LEFT=INT_015*65
	     .TOP=INT_015*135
	     .WIDTH=INT_015*160
	     .HEIGHT=INT_015*25
	     .MAXLENGTH=20
	     .NAME='TXTF08'  
	ENDWITH     
  ENDPROC       
  PROCEDURE PAGEFRAME1.PAGE1.activate
     R=0    
     SELE F02_1 
     SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE     
     THISFORM.GRID1.ENABLED=.T.          
     THISFORM.GRID1.SETFOCUS     
     IF THISFORM.GRID1.ACTIVEROW=0

        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.LBLF042.CAPTION=''
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
     ENDIF   
     THISFORM.KEY_LIST.ENABLED=.T.
  ENDPROC
  PROCEDURE PAGEFRAME1.PAGE2.activate
       SELE F02 
         THISFORM.GRID2.SETFOCUS                     
     IF THISFORM.GRID2.ACTIVEROW=0 
         THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
         THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
         THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
         THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
         THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
         THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
         THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=''
         THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
         THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
         THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=''         
         THISFORM.PAGEFRAME1.PAGE2.LBLF061.CAPTION=''                  
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限  
     ENDIF   
     R=RECNO('&AREA1')
     THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
     THISFORM.GRID1.ENABLED=.F.     
     THISFORM.KEY_LIST.ENABLED=.F.     
  ENDPROC   

  PROC INIT              
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9    
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.        
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.                   
       THISFORM.ORPGROUP.NEW_BOTT.VISIBLE=.F.        
       THISFORM.ORPGROUP.EDIT_BOTT.VISIBLE=.F.               
       THISFORM.ORPGROUP.DEL_BOTT.VISIBLE=.F.                          
       thisform.setall('height',INT_015*25,'textbox')
       thisform.setall('height',INT_015*17,'label')
       thisform.setall('FONTSIZE',INT_015*9,'textbox')
       thisform.setall('FONTSIZE',INT_015*9,'label')       
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*149
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*30
       thisform.GRID1.setall('FONTSIZE',INT_015*9,'COLUMN')
       thisform.GRID1.setall('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='材料品號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='版次'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='F02_1.F04'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='F02_1.F05'
       THISFORM.grid2.COLUMN1.HEADER1.CAPTION='組成品號'
       THISFORM.grid2.COLUMN2.HEADER1.CAPTION='版次'
	   THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='供料方式'
	   THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='單位用量'
	   THISFORM.grid2.COLUMN5.HEADER1.CAPTION='耗損率%'
	   THISFORM.grid2.COLUMN6.HEADER1.CAPTION=' 投入製程'
	   THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='備註說明'	   
       thisform.GRID2.setall('FONTSIZE',INT_015*9,'COLUMN')
       thisform.GRID2.setall('FONTSIZE',INT_015*9,'HEADER')	        	   
	   THISFORM.grid2.COLUMN1.CONTROLSOURCE='F02.F01'
	   THISFORM.grid2.COLUMN2.CONTROLSOURCE='F02.F02'
	   THISFORM.grid2.COLUMN3.CONTROLSOURCE="IIF(F02.F06='1','廠內供料',IIF(F02.F06='2','委外自備','客戶提供'))"
	   THISFORM.grid2.COLUMN4.CONTROLSOURCE='F02.F07'
	   THISFORM.grid2.COLUMN5.CONTROLSOURCE='F02.F12'
	   THISFORM.grid2.COLUMN6.CONTROLSOURCE='E00.F04'
	   THISFORM.grid2.COLUMN7.CONTROLSOURCE='F02.F08'	   
	   THISFORM.grid2.COLUMN1.WIDTH=INT_015*211
	   THISFORM.GRID2.COLUMN2.WIDTH=INT_015*30
           THISFORM.GRID2.COLUMN3.WIDTH=INT_015*65
           THISFORM.GRID2.COLUMN4.WIDTH=INT_015*65    
           THISFORM.GRID2.COLUMN5.WIDTH=INT_015*40
           THISFORM.GRID2.COLUMN6.WIDTH=INT_015*80
           THISFORM.GRID2.COLUMN7.WIDTH=INT_015*126           
       THISFORM.grid1.READONLY=.T.  
       THISFORM.GRID2.READONLY=.T.     
       THISFORM.grid1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.      
       ENDIF          
       THISFORM.KEY_LIST.DISPLAYVALUE='依材料品號排列'       
       JK='材料品號'
       SELE F02_1
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=F02_1.F04
       THISFORM.PAGEFRAME1.PAGE1.LBLF042.CAPTION=B01.F02
  ENDPROC     
  PROC KEY_LIST.INIT 
       with this 
           .additem('依材料品號排列')
       endwith      
  ENDPROC 
  PROC grid1.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
          THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=F02_1.F04
          THISFORM.PAGEFRAME1.PAGE1.LBLF042.CAPTION=B01.F02
          THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=F02_1.F05                    
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION  
       IF THIS.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
       ENDIF   
       CHK=''     
       thisform.refresh
  ENDPROC     
  PROC grid2.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=F02.F06
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=F02.F03
       THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=E00.F04
       THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=F02.F08
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=F02.F07
       THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=F02.F12
       THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=F02.F01
       THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=F02.F02
       THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=B01_1.F02       
       THISFORM.PAGEFRAME1.PAGE2.LBLF061.CAPTION=IIF(F02.F06='1','廠內供料',IIF(F02.F06='2','委外自備','客戶提供'))
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
       if thisform.pageframe1.activepage=1
          thisform. CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ENDIF   
  ENDPROC 
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
        THISFORM.SETALL('READONLY',.F.,'TEXTBOX')       
        THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
        THISFORM.GRID2.ENABLED=.F. 
        THISFORM.PAGEFRAME1.PAGE2.TXTF06.READONLY=.F.    
        THISFORM.PAGEFRAME1.PAGE2.TXTF07.SETFOCUS     
        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=0        

        THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=0
        THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=''
  ENDPROC  

ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
     LK=F02_1.F04      
     BK=F02_1.F05
  SELECT   F02.F01,;
            F02.F02,;
            F02.F03,;      
            F02.F06,;    
            F02.F07,;
            F02.F08,;
            F02.F12,;     
            B01.F02,;
            B01_1.F02;            
     FROM F02,B01_1,B01;
     WHERE F02.F04=LK  AND B01.F01=LK AND B01_1.F01=F02.F01 ORDER BY F02.F01,F02.F02 NOWAIT
     IF _tally >0
        REPORT FORM ALLTRIM(INT_116)+'F04' PREVIEW 
*         REPORT FORM ALLTRIM(INT_116)+'F07A' TO PRINTER PROMPT 
     ENDIF
             
ENDPROC
