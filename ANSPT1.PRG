
AREA1='ANSPT1'
IF !USED('SAM1')
   SELE 0
   USE SAM1
ELSE
   SELE SAM1
ENDIF
SET ORDER TO SAM1      
SEEK RK
SELE ANSPT1
ANSPT1form=createobject("TKANSPT1")
ANSPT1form.show  
define class TKANSPT1 as form
  caption='資料分析'
  autocenter=.t.
  BORDERSTYLE=3  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CONTROLBOX=.F.
  controlcount=57
  fontsize=INT_015*9
  height=INT_015*550
  showtips=.t.
  showwindow=1
  width=INT_015*789
  windowtype=1
  NAME='TKANSPT1'
  add object shape2 as shape2 with;
      autocenter=.t.,;
      WIDTH=INT_015*780
  add object shape3 as shape3 with;  
      autocenter=.t.
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      LEFT=INT_015*590,;
      TOP=INT_015*30,;
      WIDTH=INT_015*190,;
      HEIGHT=INT_015*415    
  ADD OBJECT LBLF011 AS LABEL WITH;
      LEFT=INT_015*118,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.,;
      FONTUNDERLINE=.T.,;
      CAPTION='料品編號:'    
  ADD OBJECT LBLF01 AS LABEL WITH;
      LEFT=INT_015*170,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.,;
      FORECOLOR=RGB(0,0,255)

   ADD OBJECT LBLF02 AS LABEL WITH;
      LEFT=INT_015*320,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.,;
      FORECOLOR=RGB(0,0,255)
  ADD OBJECT LBLRNG AS LABEL WITH;
      LEFT=INT_015*618,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.,;
      FONTUNDERLINE=.T.,;
      CAPTION='資料範圍:'    
  ADD OBJECT LBLDTE AS LABEL WITH;
      LEFT=INT_015*669,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.     
  ADD OBJECT LBLTAVG AS LABEL WITH; 
      LEFT=INT_015*35,;
      TOP=INT_015*420,;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*17,;
      CAPTION='各數據總平均:'        
  ADD OBJECT TXTAVG1 AS TEXTBOX WITH; 
      READONLY=.T.,;
      LEFT=INT_015*119,;
      TOP=INT_015*415,;
      DISABLEDBACKCOLOR=RGB(128,255,255)
  ADD OBJECT TXTAVG2 AS TEXTBOX WITH; 
      LEFT=INT_015*195,;
      TOP=INT_015*415,;
      DISABLEDBACKCOLOR=RGB(128,255,255)
  ADD OBJECT TXTAVG3 AS TEXTBOX WITH; 
      LEFT=INT_015*271,;
      TOP=INT_015*415,;
      DISABLEDBACKCOLOR=RGB(128,255,255)
  ADD OBJECT TXTAVG4 AS TEXTBOX WITH; 
      LEFT=INT_015*347,;
      TOP=INT_015*415,;
      DISABLEDBACKCOLOR=RGB(128,255,255)
  ADD OBJECT TXTAVG5 AS TEXTBOX WITH; 
      LEFT=INT_015*423,;
      TOP=INT_015*415,;
      DISABLEDBACKCOLOR=RGB(255,255,128)
  ADD OBJECT TXTAVG6 AS TEXTBOX WITH; 
      LEFT=INT_015*499,;
      TOP=INT_015*415,;
      DISABLEDBACKCOLOR=RGB(128,255,128)
  ADD OBJECT LBLSAY1 AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*35,;
      FONTUNDERLINE=.T.,;
      AUTOSIZE=.T.    
  ADD OBJECT LBLSTD1 AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*60,;
      AUTOSIZE=.T.      
  ADD OBJECT LBLSTDXU AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*85,;
      AUTOSIZE=.T.
  ADD OBJECT LBLSTDXC AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*110,;
      AUTOSIZE=.T.
  ADD OBJECT LBLSTDXL AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*135,;
      AUTOSIZE=.T.
  ADD OBJECT LBLSTDRU AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*160,;
      AUTOSIZE=.T.
  ADD OBJECT LBLSTDRC AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*185,;
      AUTOSIZE=.T.
  ADD OBJECT LBLSTDRL AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*210,;
      AUTOSIZE=.T.
  ADD OBJECT TXTSTD1 AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*57,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(128,255,255)      
  ADD OBJECT TXTSTDXU AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*82,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,0,0)
  ADD OBJECT TXTSTDXC AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*107,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,255,128)
  ADD OBJECT TXTSTDXL AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*132,;
      INPUTMASK='9999999.99',;
      DISABLEDBACKCOLOR=RGB(255,0,0)
  ADD OBJECT TXTSTDRU AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*157,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,0,0)
  ADD OBJECT TXTSTDRC AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*183,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(128,255,128)
  ADD OBJECT TXTSTDRL AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*207,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,0,0)       
  ADD OBJECT LBLSAY2 AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*242,;
      FONTUNDERLINE=.T.,;
      AUTOSIZE=.T.              
  ADD OBJECT LBLSTD2 AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*270,;
      AUTOSIZE=.T. 
       
  ADD OBJECT LBLAVGXU AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*295,;
      AUTOSIZE=.T.
  ADD OBJECT LBLAVGXC AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*320,;
      AUTOSIZE=.T.
  ADD OBJECT LBLAVGXL AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*345,;
      AUTOSIZE=.T.
  ADD OBJECT LBLAVGRU AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*370,;
      AUTOSIZE=.T.
  ADD OBJECT LBLAVGRC AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*395,;
      AUTOSIZE=.T.
  ADD OBJECT LBLAVGRL AS LABEL WITH; 
      LEFT=INT_015*595,;
      TOP=INT_015*420,;
      AUTOSIZE=.T.
  ADD OBJECT TXTSTD2 AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*267,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(128,255,255)                 
  ADD OBJECT TXTAVGXU AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*292,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,0,0)
  ADD OBJECT TXTAVGXC AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*317,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,255,128)
  ADD OBJECT TXTAVGXL AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*342,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,0,0)
  ADD OBJECT TXTAVGRU AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*367,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,0,0)
  ADD OBJECT TXTAVGRC AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*392,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(128,255,128)
  ADD OBJECT TXTAVGRL AS TEXTBOX WITH; 
      LEFT=INT_015*700,;
      TOP=INT_015*417,;
      INPUTMASK='99999999.99',;
      DISABLEDBACKCOLOR=RGB(255,0,0)    
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*107,;
      TOOLTIPTEXT='管制圖之選擇'     
  ADD OBJECT GRID1 AS GRID1 WITH;
      columncount=8,;            
      RECORDSOURCE='ANSPT1',;
      WIDTH=INT_015*580,;  
      SCROLLBARS=2,;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8',;
      COLUMN7.backcolor=rgb(255,255,128),;
      COLUMN8.backcolor=rgb(128,255,128)
   ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=INT_015*455,;
      LEFT=INT_015*10,;
      ENABLED=.T.,;
      VISIBLE=.T.      
   ADD OBJECT DRW_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*99,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      CAPTION='\<L.做圖',;
      FONTSIZE=INT_015*9,;
      NAME='DRW_BOTT'                                  
   ADD OBJECT PNT_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*141,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      CAPTION='\<P.列印',;
      FONTSIZE=INT_015*9,;      
      NAME='PNT_BOTT'                           
   ADD OBJECT OUT_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*183,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      CAPTION='\<X.離開',;
      FONTSIZE=INT_015*9,;      
      NAME='OUT_BOTT'                                
  PROC INIT
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',25,'TEXTBOX')
       THISFORM.SETALL('WIDTH',75,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',17,'LABEL')
       thisform.cmdgroup.seek_bott.enabled=.f.
       THISFORM.LBLF01.CAPTION=B01.F01
       THISFORM.LBLF02.CAPTION=B01.F02
       THISFORM.LBLDTE.CAPTION=LK
       THISFORM.LBLSAY1.CAPTION='動作秒數標準管制界線'
       THISFORM.LBLSTD1.CAPTION='動作秒數之標準差:'
       THISFORM.LBLSTDXU.CAPTION='平均--平均值上限:'
       THISFORM.LBLSTDXC.CAPTION='平均--平均值中線:'
       THISFORM.LBLSTDXL.CAPTION='平均--平均值下限:'
       THISFORM.LBLSTDRU.CAPTION='全距--平均值上限:'
       THISFORM.LBLSTDRC.CAPTION='全距--平均值中線:'
       THISFORM.LBLSTDRL.CAPTION='全距--平均值下限:'
       THISFORM.LBLSAY2.CAPTION='動作秒數測試值管制界線'              
       THISFORM.LBLSTD2.CAPTION='動作秒數之標準差:'
       THISFORM.LBLAVGXU.CAPTION='平均--平均值上限:'
       THISFORM.LBLAVGXC.CAPTION='平均--平均值中線:'
       THISFORM.LBLAVGXL.CAPTION='平均--平均值下限:'
       THISFORM.LBLAVGRU.CAPTION='全距--平均值上限:'
       THISFORM.LBLAVGRC.CAPTION='全距--平均值中線:'
       THISFORM.LBLAVGRL.CAPTION='全距--平均值下限:'
       THISFORM.TXTAVG1.VALUE=TMP('AVG_F04')
       THISFORM.TXTAVG2.VALUE=TMP('MAX_F04-MIN_F04')
       THISFORM.TXTAVG3.VALUE=TMP('AVG_F05')       
       THISFORM.TXTAVG4.VALUE=TMP('MAX_F05-MIN_F05')
       THISFORM.TXTAVG5.VALUE=TMP('AVG_F06')
       THISFORM.TXTAVG6.VALUE=TMP('MAX_F06-MIN_F06')
       THISFORM.TXTSTDXU.VALUE=CHK_STR+SAM1.A*FTR_STR
       THISFORM.TXTSTDXC.VALUE=CHK_STR
       THISFORM.TXTSTDXL.VALUE=CHK_STR-SAM1.A*FTR_STR
       THISFORM.TXTSTDRU.VALUE=SAM1.D2*FTR_STR
       THISFORM.TXTSTDRC.VALUE=SAM1.DS2*FTR_STR
       THISFORM.TXTSTDRL.VALUE=SAM1.D1*FTR_STR
       THISFORM.TXTAVGXU.VALUE=THISFORM.TXTAVG5.VALUE+SAM1.A2*THISFORM.TXTAVG6.VALUE
       THISFORM.TXTAVGXC.VALUE=THISFORM.TXTAVG5.VALUE
       THISFORM.TXTAVGXL.VALUE=THISFORM.TXTAVG5.VALUE-SAM1.A2*THISFORM.TXTAVG6.VALUE
       THISFORM.TXTAVGRU.VALUE=SAM1.D4*THISFORM.TXTAVG6.VALUE
       THISFORM.TXTAVGRC.VALUE=THISFORM.TXTAVG6.VALUE
       THISFORM.TXTAVGRL.VALUE=SAM1.D3*THISFORM.TXTAVG6.VALUE
       
             
       IF CHK_STR=0
          THISFORM.LBLSAY1.VISIBLE=.F.       
          THISFORM.LBLSTD1.VISIBLE=.F.       
          THISFORM.LBLSTDXU.VISIBLE=.F.
          THISFORM.LBLSTDXC.VISIBLE=.F.
          THISFORM.LBLSTDXL.VISIBLE=.F.
          THISFORM.LBLSTDRU.VISIBLE=.F.
          THISFORM.LBLSTDRC.VISIBLE=.F.
          THISFORM.LBLSTDRL.VISIBLE=.F.
          THISFORM.TXTSTD1.VISIBLE=.F.
          THISFORM.TXTSTDXU.VISIBLE=.F.
          THISFORM.TXTSTDXC.VISIBLE=.F.
          THISFORM.TXTSTDXL.VISIBLE=.F.
          THISFORM.TXTSTDRU.VISIBLE=.F.
          THISFORM.TXTSTDRC.VISIBLE=.F.
          THISFORM.TXTSTDRL.VISIBLE=.F.          
       ENDIF       
       thisform.grid1.column1.WIDTH=INT_015*25
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='組別'
	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='測試日期'
	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='室內溫度平均'
	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='室內溫度全距'
	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='測試壓力平均'	   
  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='測試壓力全距'
	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='動作秒數平均'	   	   	   
	   THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='動作秒數全距' 
	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='RECNO()'
	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='ANSPT1.F02'
	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='ANSPT1.AVG_F04'	   	   
	   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='ANSPT1.MAX_F04-ANSPT1.MIN_F04'
	   THISFORM.GRID1.COLUMN5.CONTROLSOURCE='ANSPT1.AVG_F05'	   	   	   
	   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='ANSPT1.MAX_F05-ANSPT1.MIN_F05'	   	   	   
	   THISFORM.GRID1.COLUMN7.CONTROLSOURCE='ANSPT1.AVG_F06'	   	   	   	   
  	   THISFORM.GRID1.COLUMN8.CONTROLSOURCE='ANSPT1.MAX_F06-ANSPT1.MIN_F06'	   	   	     
  	      IF THISFORM.TXTSTDXC.VALUE=0   
  	         THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(AVG_F06>THISFORM.TXTAVGXU.VALUE;
 	         .OR. AVG_F06<THISFORM.TXTAVGXL.VALUE;
  	         .OR. (MAX_F06-MIN_F06)>THISFORM.TXTAVGRU.VALUE;
  	         .OR. (MAX_F06-MIN_F06)<THISFORM.TXTAVGRL.VALUE,RGB(255,0,0),'')","COLUMN")
  	      ELSE
              THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(AVG_F06>THISFORM.TXTSTDXU.VALUE;
 	         .OR. AVG_F06<THISFORM.TXTSTDXL.VALUE;
  	         .OR. (MAX_F06-MIN_F06)>THISFORM.TXTSTDRU.VALUE;
  	         .OR. (MAX_F06-MIN_F06)<THISFORM.TXTSTDRL.VALUE,RGB(255,0,0),'')","COLUMN")  	      
  	      ENDIF             
  	   SELE STDCLC
  	   calc std(f06) to tmp3
       THISFORM.TXTSTD2.VALUE=tmp3
       THISFORM.TXTSTD1.VALUE=FTR_STR
       SELE ANSPT1   
       THISFORM.KEY_LIST.DISPLAYVALUE='平均值--全距  '
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS
       THISFORM.REFRESH
  ENDPROC     
  PROC KEY_LIST.INIT 
       with this            
           .additem('平均值--全距  ')
           .additem('平均值--標準差')           
       endwith      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE
       IF THIS.DISPLAYVALUE='平均值--全距  '    	
    	  THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='室內溫度全距'
  	      THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='測試壓力全距'
  	      THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='動作秒數全距' 
	      THISFORM.GRID1.COLUMN4.CONTROLSOURCE='ANSPT1.MAX_F04-ANSPT1.MIN_F04'
	      THISFORM.GRID1.COLUMN6.CONTROLSOURCE='ANSPT1.MAX_F05-ANSPT1.MIN_F05'	   	   	   
  	      THISFORM.GRID1.COLUMN8.CONTROLSOURCE='ANSPT1.MAX_F06-ANSPT1.MIN_F06'	   	   	
          THISFORM.LBLSTDRU.CAPTION='全距--平均值上限:'
          THISFORM.LBLSTDRC.CAPTION='全距--平均值值中線:'
          THISFORM.LBLSTDRL.CAPTION='全距-平均值值下限:'
          THISFORM.LBLAVGRU.CAPTION='全距--平均值值上限:'
          THISFORM.LBLAVGRC.CAPTION='全距--平均值值中線:'
          THISFORM.LBLAVGRL.CAPTION='全距--平均值值下限:'
          THISFORM.TXTAVG2.VALUE=TMP('MAX_F04-MIN_F04')
          THISFORM.TXTAVG4.VALUE=TMP('MAX_F05-MIN_F05')          
          THISFORM.TXTAVG6.VALUE=TMP('MAX_F06-MIN_F06')
          THISFORM.TXTSTDXU.VALUE=CHK_STR+SAM1.A*FTR_STR
          THISFORM.TXTSTDXC.VALUE=CHK_STR
          THISFORM.TXTSTDXL.VALUE=CHK_STR-SAM1.A*FTR_STR
          THISFORM.TXTSTDRU.VALUE=SAM1.D2*FTR_STR
          THISFORM.TXTSTDRC.VALUE=SAM1.DS2*FTR_STR
          THISFORM.TXTSTDRL.VALUE=SAM1.D1*FTR_STR
          THISFORM.TXTAVGXU.VALUE=THISFORM.TXTAVG5.VALUE+SAM1.A2*THISFORM.TXTAVG6.VALUE
          THISFORM.TXTAVGXC.VALUE=THISFORM.TXTAVG5.VALUE
          THISFORM.TXTAVGXL.VALUE=THISFORM.TXTAVG5.VALUE-SAM1.A2*THISFORM.TXTAVG6.VALUE
          THISFORM.TXTAVGRU.VALUE=SAM1.D4*THISFORM.TXTAVG6.VALUE
          THISFORM.TXTAVGRC.VALUE=THISFORM.TXTAVG6.VALUE
          THISFORM.TXTAVGRL.VALUE=SAM1.D3*THISFORM.TXTAVG6.VALUE         
  	      IF THISFORM.TXTSTDXC.VALUE=0   
  	         THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(AVG_F06>THISFORM.TXTAVGXU.VALUE;
 	         .OR. AVG_F06<THISFORM.TXTAVGXL.VALUE;
  	         .OR. (MAX_F06-MIN_F06)>THISFORM.TXTAVGRU.VALUE;
  	         .OR. (MAX_F06-MIN_F06)<THISFORM.TXTAVGRL.VALUE,RGB(255,0,0),'')","COLUMN")
  	      ELSE
              THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(AVG_F06>THISFORM.TXTSTDXU.VALUE;
 	         .OR. AVG_F06<THISFORM.TXTSTDXL.VALUE;
  	         .OR. (MAX_F06-MIN_F06)>THISFORM.TXTSTDRU.VALUE;
  	         .OR. (MAX_F06-MIN_F06)<THISFORM.TXTSTDRL.VALUE,RGB(255,0,0),'')","COLUMN")  	      
  	      ENDIF             
       ELSE
    	  THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='室內溫度標準差'
  	      THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='測試壓力標準差'
  	      THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='動作秒數標準差' 
	      THISFORM.GRID1.COLUMN4.CONTROLSOURCE='ANSPT1.EXP_12'
	      THISFORM.GRID1.COLUMN6.CONTROLSOURCE='ANSPT1.EXP_13'	   	   	   
  	      THISFORM.GRID1.COLUMN8.CONTROLSOURCE='ANSPT1.EXP_14'	   	   	   
          THISFORM.LBLSTDRU.CAPTION='標準差--平均值上限:'
          THISFORM.LBLSTDRC.CAPTION='標準差--平均值中線:'
          THISFORM.LBLSTDRL.CAPTION='標準差--平均值下限:'
          THISFORM.LBLAVGRU.CAPTION='標準差--平均值上限:'
          THISFORM.LBLAVGRC.CAPTION='標準差--平均值中線:'
          THISFORM.LBLAVGRL.CAPTION='標準差--平均值下限:'
          THISFORM.TXTAVG2.VALUE=TMP('EXP_12')
          THISFORM.TXTAVG4.VALUE=TMP('EXP_13')          
          THISFORM.TXTAVG6.VALUE=TMP('EXP_14')
          THISFORM.TXTSTDXU.VALUE=CHK_STR+SAM1.A*FTR_STR
          THISFORM.TXTSTDXC.VALUE=CHK_STR
          THISFORM.TXTSTDXL.VALUE=CHK_STR-SAM1.A*FTR_STR
          THISFORM.TXTSTDRU.VALUE=SAM1.B2*FTR_STR
          THISFORM.TXTSTDRC.VALUE=SAM1.C2*FTR_STR
          THISFORM.TXTSTDRL.VALUE=SAM1.B1*FTR_STR
          THISFORM.TXTAVGXU.VALUE=THISFORM.TXTAVG5.VALUE+SAM1.A1*THISFORM.TXTAVG6.VALUE
          THISFORM.TXTAVGXC.VALUE=THISFORM.TXTAVG5.VALUE
          THISFORM.TXTAVGXL.VALUE=THISFORM.TXTAVG5.VALUE-SAM1.A1*THISFORM.TXTAVG6.VALUE
          THISFORM.TXTAVGRU.VALUE=SAM1.B4*THISFORM.TXTAVG6.VALUE
          THISFORM.TXTAVGRC.VALUE=THISFORM.TXTAVG6.VALUE
          THISFORM.TXTAVGRL.VALUE=SAM1.B3*THISFORM.TXTAVG6.VALUE           
  	      IF THISFORM.TXTSTDXC.VALUE=0
  	         THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(AVG_F06>THISFORM.TXTAVGXU.VALUE;
 	         .OR. AVG_F06<THISFORM.TXTAVGXL.VALUE;
  	         .OR. (EXP_14)>THISFORM.TXTAVGRU.VALUE;
  	         .OR. (EXP_14)<THISFORM.TXTAVGRL.VALUE,RGB(255,0,0),'')","COLUMN")
  	      ELSE
  	         THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(AVG_F06>THISFORM.TXTSTDXU.VALUE;
 	         .OR. AVG_F06<THISFORM.TXTSTDXL.VALUE;
  	         .OR. (EXP_14)>THISFORM.TXTSTDRU.VALUE;
  	         .OR. (EXP_14)<THISFORM.TXTSTDRL.VALUE,RGB(255,0,0),'')","COLUMN")  	      
  	      ENDIF                  
       ENDIF
       THISFORM.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC     
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       FCH=THISFORM.ACTIVECONTROL.NAME
       thisform.refresh
  ENDPROC
  PROCEDURE DRW_BOTT.CLICK
     R2=RECNO()
     do case
        case thisform.key_list.displayvalue='平均值--全距  ' 
              DO Q0A 
        case thisform.key_list.displayvalue='平均值--標準差' 
              DO Q0B 
     endcase         
     GO R2
     THISFORM.GRID1.SETFOCUS      
  ENDPROC
  PROCEDURE PNT_BOTT.CLICK  
     IF THISFORM.KEY_LIST.DISPLAYVALUE='平均值--全距  '
        REPORT FORM ALLTRIM(INT_116)+'ANSPT1A' PREVIEW
     ELSE   
        REPORT FORM ALLTRIM(INT_116)+'ANSPT1B' PREVIEW
     ENDIF   
     THISFORM.GRID1.SETFOCUS      
  ENDPROC    
      
  PROCEDURE OUT_BOTT.CLICK
     CLEAR
     AREA1='B01'
     THISFORM.RELEASE
  ENDPROC          
ENDDEFINE  
******************自定函數--各數據總平均
FUNCTION TMP
PARAMETERS maverage
   K=maverage
   SELECT AVG(&K) INTO ARRAY TMP1 FROM ANSPT1 
  return tmp1(1) 


  