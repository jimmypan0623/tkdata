CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
R=0
AREA1='C01'
AREA2='C19'
IF !USED('D00')
   SELE 0
   USE D00
ELSE
   SELE D00
ENDIF
SET ORDER TO D001
IF !USED('D10')
   SELECT 0
   USE D10
ELSE 
   SELECT D10
ENDIF
SET ORDER TO D104      
IF ! USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'C03'

IF !USED('B01')
   SELE 0
   USE B01 INDE B01
ELSE
   SELE B01
ENDIF
SET ORDER TO 1
IF !USED('C01')
   SELE 0
   USE C01 
ELSE
   SELE C01
ENDIF
SET ORDER TO C011
IF !USED('C19')
   SELE 0
   USE C19
ELSE
   SELE C19
ENDIF
SET ORDER TO C191
SET RELA TO F03 INTO B01
C19FORM=CREATEOBJECT("TKC19")
C19FORM.SHOW  
DEFINE CLASS TKC19 AS FORM
  CAPTION='C03.產品售價資料設定'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKC19'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT LBL_REC AS LBL_REC WITH;
      AUTOCENTER =.T.
  ADD OBJECT REC_COUNT AS REC_COUNT  WITH;
      CAPTION=STR(RECCOUNT())        
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*225,;
      FONTSIZE=INT_015*9,;
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='依照客戶搜尋紀錄',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='詳細資料內容'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='C01',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'      
  ADD OBJECT GRID2 AS GRID2 WITH;
      TOP=INT_015*227,;
      HEIGHT=INT_015*293,;
      COLUMNCOUNT=10,;            
      RECORDSOURCE='C19',;
      LINKMASTER='C01',;
      RELATIONALEXPR='F01',;
      CHILDORDER='C191',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=INT_015*415,;
      LEFT=INT_015*10,;
      ENABLED=.T.,;
      VISIBLE=.T.                    
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      TOP=INT_015*455,;
      LEFT=INT_015*10
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*173,;
      LEFT=INT_015*558          
  PROCEDURE PAGEFRAME1.PAGE1.INIT     
     THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*27
          .WIDTH=INT_015*50
          .CAPTION='客戶編號'          
     ENDWITH
     THIS.ADDOBJECT('LBLF011','LABEL')     
     WITH THIS.LBLF011
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*27
          .AUTOSIZE=.T.  
     ENDWITH            
     THIS.ADDOBJECT('TXTF01','TEXTBOX')     
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*23
          .WIDTH=INT_015*74
          .HEIGHT=INT_015*25
          .MAXLENGTH=5
     ENDWITH        
     THIS.ADDOBJECT('LBLFDT','LABEL')
     WITH THIS.LBLFDT
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*52
          .WIDTH=INT_015*60
          .CAPTION='最後進貨日'          
     ENDWITH
     THIS.ADDOBJECT('TXTFDT','TEXTBOX')
     WITH THIS.TXTFDT
          .VISIBLE=.T.
          .LEFT=INT_015*76
          .TOP=INT_015*48
          .WIDTH=INT_015*80     
     ENDWITH    

  ENDPROC   
***************  
  PROCEDURE PAGEFRAME1.PAGE2.INIT
	THIS.ADDOBJECT('LBLF01','LABEL')
	WITH THIS.LBLF01  
         .LEFT=INT_015*14
         .TOP=INT_015*8
	 .WIDTH=INT_015*50
         .CAPTION='客戶編號'
    ENDWITH  
    THIS.ADDOBJECT('LBLF011','LABEL')
    WITH THIS.LBLF011
         .LEFT=INT_015*126
	     .TOP=INT_015*8
	     .AUTOSIZE=.T.
	ENDWITH     
    THIS.ADDOBJECT('LBLF03','LABEL')
    WITH THIS.LBLF03
         .VISIBLE=.T.
	     .LEFT=INT_015*14
	     .TOP=INT_015*8
	     .WIDTH=INT_015*50
	     .CAPTION='品        號'
	ENDWITH     
    THIS.ADDOBJECT('LBLF031','LABEL')
    WITH THIS.LBLF031
         .VISIBLE=.T.
         .LEFT=INT_015*327
         .TOP=INT_015*8
         .WIDTH=INT_015*144         
    ENDWITH     
    THIS.ADDOBJECT('LBLF04','LABEL')
    WITH THIS.LBLF04
         .VISIBLE=.T.    
         .LEFT=INT_015*14
         .TOP=INT_015*33
         .WIDTH=INT_015*50
         .CAPTION='客戶品號'       
    ENDWITH     
    THIS.ADDOBJECT('LBLF02','LABEL')      
    WITH THIS.LBLF02
         .VISIBLE=.T.       
         .LEFT=INT_015*328
         .TOP=INT_015*33
         .WIDTH=INT_015*50
         .CAPTION='報價日期'
    ENDWITH     
    THIS.ADDOBJECT('LBLF05','LABEL')
    WITH THIS.LBLF05
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*58
         .WIDTH=INT_015*50
         .CAPTION='單        位'
    ENDWITH     
     THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
          .VISIBLE=.T.
          .LEFT=INT_015*174
          .TOP=INT_015*58
          .WIDTH=INT_015*60
          .CAPTION='有效日期'          
     ENDWITH
    THIS.ADDOBJECT('LBLF06','LABEL')
    WITH THIS.LBLF06
         .VISIBLE=.T.           
         .LEFT=INT_015*328
         .TOP=INT_015*58
         .WIDTH=INT_015*50
         .CAPTION='幣        別'
    ENDWITH     
    THIS.ADDOBJECT('LBLF13','LABEL')
    WITH THIS.LBLF13
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*83
         .WIDTH=INT_015*50
         .CAPTION='最少出貨'               
    ENDWITH  
    THIS.ADDOBJECT('LBLF08','LABEL')
    WITH THIS.LBLF08
        .VISIBLE=.T.           
        .LEFT=INT_015*328
        .TOP=INT_015*83
        .WIDTH=INT_015*50
        .CAPTION='銷售單價'         
    ENDWITH    
    THIS.ADDOBJECT('LBLF12','LABEL')
    WITH THIS.LBLF12
        .VISIBLE=.T.           
        .LEFT=INT_015*328
        .TOP=INT_015*108
        .WIDTH=INT_015*50
        .CAPTION='特價描述'         
    ENDWITH        
    THIS.ADDOBJECT('LBLF09','LABEL')
    WITH THIS.LBLF09
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*158
         .WIDTH=INT_015*50
         .CAPTION='毛     利%'                  
    ENDWITH     
    THIS.ADDOBJECT('LBLF091','LABEL')
    WITH THIS.LBLF091
         .VISIBLE=.T.
         .LEFT=INT_015*75
         .TOP=INT_015*158
         .AUTOSIZE=.T.
    ENDWITH     
    THIS.ADDOBJECT('LBLF15','LABEL')
    WITH THIS.LBLF15
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*183
         .WIDTH=INT_015*50
         .CAPTION='其他備註'                  
    ENDWITH     
    THIS.ADDOBJECT('LBLF10','LABEL')
    WITH THIS.LBLF10
         .VISIBLE=.T.           
         .LEFT=INT_015*328
         .TOP=INT_015*133
         .WIDTH=INT_015*50
         .CAPTION='備註說明'         
    ENDWITH     
    THIS.ADDOBJECT('LBLF38','LABEL')
    WITH THIS.LBLF38
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*108
         .WIDTH=INT_015*50
         .CAPTION='銷售成本'          
    ENDWITH     
    THIS.ADDOBJECT('LBLF381','LABEL')
    WITH THIS.LBLF381
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*108
         .AUTOSIZE=.T.          
    ENDWITH         
    THIS.ADDOBJECT('LBLF37','LABEL')
    WITH THIS.LBLF37
         .VISIBLE=.T.           
         .LEFT=INT_015*14
         .TOP=INT_015*133
         .WIDTH=INT_015*50
         .CAPTION='平均成本'          
    ENDWITH     
    THIS.ADDOBJECT('LBLF371','LABEL')
    WITH THIS.LBLF371
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*133
         .AUTOSIZE=.T.          
    ENDWITH             
    THIS.ADDOBJECT('LBLF11','LABEL')
    WITH THIS.LBLF11
         .VISIBLE=.T.           
         .LEFT=INT_015*328
         .TOP=INT_015*158
         .WIDTH=INT_015*50
         .CAPTION='安全資料'          
    ENDWITH     
    THIS.ADDOBJECT('LBLF111','LABEL')
    WITH THIS.LBLF111
         .VISIBLE=.T.           
         .LEFT=INT_015*378
         .TOP=INT_015*158
         .AUTOSIZE=.T.          
    ENDWITH     
	THIS.ADDOBJECT('TXTF01','TXTF01')
	WITH THIS.TXTF01      
	     .LEFT=INT_015*65
	     .TOP=INT_015*4
	     .WIDTH=INT_015*60
	     .HEIGHT=INT_015*25
	     .MAXLENGTH=5
	     .NAME='TXTF01'  
	ENDWITH     
	THIS.ADDOBJECT('TXTF03','TXTF03')
	WITH THIS.TXTF03
	     .VISIBLE=.T.
	     .LEFT=INT_015*65
	     .TOP=INT_015*4
	     .WIDTH=INT_015*261
	     .HEIGHT=INT_015*25
	     .MAXLENGTH=43
	     .NAME='TXTF03'	    
	ENDWITH     
    THIS.ADDOBJECT('TXTF04','TEXTBOX')
    WITH THIS.TXTF04
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*29
         .WIDTH=INT_015*261
         .MAXLENGTH=30
         .NAME='TXTF04'
    ENDWITH     

    THIS.ADDOBJECT('TXTF02','TEXTBOX')
    WITH THIS.TXTF02
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*29
         .WIDTH=INT_015*74
         .HEIGHT=INT_015*25
         .NAME='TXTF02'                            
    ENDWITH     
    THIS.ADDOBJECT('TXTF05','TEXTBOX')
    WITH THIS.TXTF05     
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*54
         .WIDTH=INT_015*44
         .MAXLENGTH=4
         .NAME='TXTF05'
    ENDWITH     
     THIS.ADDOBJECT('TXTF14','TEXTBOX')
     WITH THIS.TXTF14
          .VISIBLE=.T.
          .LEFT=INT_015*225
          .TOP=INT_015*54
          .WIDTH=INT_015*80     
     ENDWITH                     
    THIS.ADDOBJECT('TXTF06','TEXTBOX')
    WITH THIS.TXTF06
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*54
         .WIDTH=INT_015*44
         .MAXLENGTH=4
         .NAME='TXTF06'                 
    ENDWITH     
    THIS.ADDOBJECT('CRCY','CRCY')     
    THIS.ADDOBJECT('TXTF13','TEXTBOX')
    WITH THIS.TXTF13
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*79
         .WIDTH=INT_015*118
         .INPUTMASK='99999999.99'
         .NAME='TXTF13'                       
    ENDWITH     
    THIS.ADDOBJECT('TXTF08','TEXTBOX')
    WITH THIS.TXTF08
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*79
         .WIDTH=INT_015*118
         .INPUTMASK='999999999.999999'
         .NAME='TXTF08'
    ENDWITH     
    THIS.ADDOBJECT('TXTF12','TEXTBOX')
    WITH THIS.TXTF12
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*104
         .WIDTH=INT_015*180      
         .MAXLENGTH=30
         .NAME='TXTF12'                   
    ENDWITH    
    THIS.ADDOBJECT('TXTF10','TEXTBOX')
    WITH THIS.TXTF10
         .VISIBLE=.T.           
         .LEFT=INT_015*379
         .TOP=INT_015*129
         .WIDTH=INT_015*149         
         .MAXLENGTH=20
         .NAME='TXTF10'                   
    ENDWITH
    THIS.ADDOBJECT('TXTF15','TEXTBOX')
    WITH THIS.TXTF15
         .VISIBLE=.T.           
         .LEFT=INT_015*65
         .TOP=INT_015*179
         .WIDTH=INT_015*463    
         .MAXLENGTH=60
         .NAME='TXTF15'                   
    ENDWITH
  ENDPROC       
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
     R=0
     IF THISFORM.KEY_LIST.DISPLAYVALUE='依客戶編號排列'               
        SELE C01
        THISFORM.PAGEFRAME1.PAGE1.LBLFDT.VISIBLE=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTFDT.VISIBLE=.F.
     ELSE
        SELE B01
        THISFORM.PAGEFRAME1.PAGE1.LBLFDT.VISIBLE=.T.
        THISFORM.PAGEFRAME1.PAGE1.TXTFDT.VISIBLE=.T.
     ENDIF
     SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE                
     THISFORM.GRID1.ENABLED=.T.          
     THISFORM.GRID1.SETFOCUS     
     IF THISFORM.GRID1.ACTIVEROW=0
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
     ENDIF   
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
     THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
     THISFORM.KEY_LIST.ENABLED=.T.
  ENDPROC
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
       SELE C19
     IF THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.GRID2.READONLY=.T.   
        THISFORM.GRID2.SETFOCUS      
     ENDIF 
     IF THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF111.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF381.CAPTION='0'        
        THISFORM.PAGEFRAME1.PAGE2.LBLF371.CAPTION='0'                
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限  
     ENDIF   
     R=RECNO('&AREA1')
     THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
     THISFORM.GRID1.ENABLED=.F.     
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
     THISFORM.KEY_LIST.ENABLED=.F.     
  ENDPROC   
  PROC INIT       
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9    
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限  
       THISFORM.PAGEFRAME1.PAGE1.LBLFDT.VISIBLE=.F.
       THISFORM.PAGEFRAME1.PAGE1.TXTFDT.VISIBLE=.F.       
       THISFORM.PAGEFRAME1.PAGE2.LBLF01.VISIBLE=.F.
       THISFORM.PAGEFRAME1.PAGE2.LBLF011.VISIBLE=.F.
       THISFORM.PAGEFRAME1.PAGE2.TXTF01.VISIBLE=.F.
       THISFORM.PAGEFRAME1.PAGE2.TXTF01.ENABLED=.F.
       THISFORM.PAGEFRAME1.PAGE2.LBLF03.VISIBLE=.T.
       THISFORM.PAGEFRAME1.PAGE2.LBLF031.VISIBLE=.T.
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VISIBLE=.T.
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.ENABLED=.T.
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')       
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')      
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)   
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶簡稱'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F04'
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')       
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='料品編號'
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='品名規格'
	   THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='報價日期'
	   
	   THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='幣別'
	   THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='最少出貨'
	   THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='特價描述'
	   THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='銷售單價'	   	   
	   THISFORM.GRID2.COLUMN8.HEADER1.CAPTION='毛  利%'
	   THISFORM.GRID2.COLUMN9.HEADER1.CAPTION='備註說明'  
	   THISFORM.GRID2.COLUMN10.HEADER1.CAPTION='有效日期'      	   
	   THISFORM.GRID2.COLUMN1.CONTROLSOURCE='C19.F03'
	   THISFORM.GRID2.COLUMN2.CONTROLSOURCE='B01.F02'
	   THISFORM.GRID2.COLUMN3.CONTROLSOURCE='C19.F02'
	   
	   THISFORM.GRID2.COLUMN4.CONTROLSOURCE='C19.F06'
	   THISFORM.GRID2.COLUMN5.CONTROLSOURCE='C19.F13'
	   THISFORM.GRID2.COLUMN6.CONTROLSOURCE='C19.F12'
	   THISFORM.GRID2.COLUMN7.CONTROLSOURCE='C19.F08'	   	   
	   THISFORM.GRID2.COLUMN8.CONTROLSOURCE="TRAN((C19.F08*IIF(SEEK(C19.F06,'D00'),D00.F02,1)-B01.F38)/(C19.F08*IIF(SEEK(C19.F06,'D00'),D00.F02,1))*100, '####.##')"
	   THISFORM.GRID2.COLUMN9.CONTROLSOURCE='C19.F10'
	   THISFORM.GRID2.COLUMN10.CONTROLSOURCE='C19.F14'
	   THISFORM.GRID2.COLUMN1.WIDTH=INT_015*149
	   THISFORM.GRID2.COLUMN2.WIDTH=INT_015*100
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*65       
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*30
       THISFORM.GRID2.COLUMN5.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN6.WIDTH=INT_015*60
       THISFORM.GRID2.COLUMN7.WIDTH=INT_015*60              
       THISFORM.GRID2.COLUMN8.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN9.WIDTH=INT_015*149       
       THISFORM.GRID2.COLUMN9.ALIGNMENT=1
       THISFORM.GRID2.COLUMN10.WIDTH=INT_015*75
       THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF((C19.F08*IIF(SEEK(C19.F06,'D00'),D00.F02,1)-B01.F38)/(C19.F08*IIF(SEEK(C19.F06,'D00'),D00.F02,1))<0.08,RGB(255,0,0),'')","COLUMN") 
       THISFORM.KEY_LIST.INTERACTIVECHANGE
       THISFORM.GRID1.READONLY=.T.    
       THISFORM.GRID2.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.      
       ENDIF          
       THISFORM.KEY_LIST.DISPLAYVALUE='依客戶編號排列'       
       JK='客戶編號'
       SELE C01
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C01.F01
       THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=C01.F04
  ENDPROC         
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依客戶編號排列')
           .ADDITEM('依料品編號排列')
           .VALUE=1
       ENDWITH      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE C01
       SET RELA OFF INTO C19
       SELE B01
       SET RELA OFF INTO C19
       SELE C19
       SET RELA OFF INTO B01
       SET RELA OFF INTO C01       
       THISFORM.GRID1.RECORDSOURCE=''
       THISFORM.GRID1.CHILDORDER=''  
       THISFORM.GRID2.LINKMASTER=''
       THISFORM.GRID2.RELATIONALEXPR=''
       THISFORM.GRID2.CHILDORDER=''       
       DO CASE
          CASE THIS.DISPLAYVALUE='依客戶編號排列'
               THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照客戶搜尋紀錄'
               SELE C01
               GO TOP
               AREA1='C01'
               SELE C19
               SET ORDER TO C191 
               SET RELA TO F03 INTO B01
               THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='客戶編號'
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.WIDTH=INT_015*74
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.MAXLENGTH=5
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C01.F01
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.LEFT=INT_015*140
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=C01.F04
               THISFORM.PAGEFRAME1.PAGE2.LBLF01.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF011.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.ENABLED=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF03.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF031.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.ENABLED=.T.
               THISFORM.GRID1.RECORDSOURCE='C01'
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶簡稱'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F01'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F04'   
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
               THISFORM.GRID2.LINKMASTER='C01'
               THISFORM.GRID2.RELATIONALEXPR='F01'
               THISFORM.GRID2.CHILDORDER='C191'            
               THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='料品編號'
               THISFORM.GRID2.COLUMN1.CONTROLSOURCE='C19.F03'
               THISFORM.GRID2.COLUMN1.WIDTH=INT_015*149
               THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='品名規格'
               THISFORM.GRID2.COLUMN2.CONTROLSOURCE='B01.F02'   
               THISFORM.GRID2.COLUMN2.WIDTH=INT_015*100
          CASE THIS.DISPLAYVALUE='依料品編號排列'
               THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照料號搜尋紀錄'          
               SELE B01
               GO TOP
               AREA1='B01'
               SELE C19
               SET ORDER TO C192
               SET RELA TO F01 INTO C01 
               THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='料品編號'
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.WIDTH=INT_015*261
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.MAXLENGTH=43
               THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=B01.F01
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.LEFT=INT_015*337
               THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=B01.F02
               THISFORM.PAGEFRAME1.PAGE2.LBLF01.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF011.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VISIBLE=.T.
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.ENABLED=.T.
               THISFORM.PAGEFRAME1.PAGE2.LBLF03.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.LBLF031.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VISIBLE=.F.
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.ENABLED=.F.                
               THISFORM.GRID1.RECORDSOURCE='B01'
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料品編號'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='品名規格'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='B01.F01'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='B01.F02'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*149
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*149   
               THISFORM.GRID2.LINKMASTER='B01'
               THISFORM.GRID2.RELATIONALEXPR='F01'
               THISFORM.GRID2.CHILDORDER='C192'  
               THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='客戶編號'
               THISFORM.GRID2.COLUMN1.CONTROLSOURCE='C19.F01'
               THISFORM.GRID2.COLUMN1.WIDTH=INT_015*50               
               THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='客戶簡稱'
               THISFORM.GRID2.COLUMN2.CONTROLSOURCE='C01.F04'    
               THISFORM.GRID2.COLUMN2.WIDTH=INT_015*50                                        
       ENDCASE 
        THISFORM.PAGEFRAME1.ACTIVEPAGE=2
        THISFORM.PAGEFRAME1.ACTIVEPAGE=1
        SELE &AREA1
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       IF THISFORM.KEY_LIST.DISPLAYVALUE='依客戶編號排列'
          THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C01.F01
          THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=C01.F04
       ELSE          
          THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=B01.F01
          THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=B01.F02
          THISFORM.PAGEFRAME1.PAGE1.TXTFDT.VALUE=IIF(SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'D10'),D10.F03,'')
 
          
       ENDIF
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION  
       IF THIS.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
       ENDIF   
       CHK=''     
       THISFORM.REFRESH
  ENDPROC     
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
	       THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=F01
	       THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=C01.F04
	       THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=F02
	       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=F03
	       THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=LEFT(B01.F02,20)
	       THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=F04
	       THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=F05
	       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=F06
	       THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=F08
	       IF B01.F38<>0
	          THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=TRAN((F08*IIF(SEEK(F06,'D00'),D00.F02,1)-B01.F38)/(F08*IIF(SEEK(F06,'D00'),D00.F02,1))*100, '####.##')
	       ELSE
	          THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=''
	       ENDIF   
	       THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=F12
	       THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=F10
           THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=F15
 	       THISFORM.PAGEFRAME1.PAGE2.LBLF111.CAPTION=F11
	       THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=F13    
	       THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=F14
	       THISFORM.PAGEFRAME1.PAGE2.LBLF381.CAPTION=TRANSFORM(B01.F38,'@R 9999999.999999')
	       THISFORM.PAGEFRAME1.PAGE2.LBLF371.CAPTION=TRANSFORM(B01.F37,'@R 9999999.999999')
           FCH=THISFORM.ACTIVECONTROL.NAME
           JK=THIS.COLUMN1.HEADER1.CAPTION
           CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
           IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
              THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
           ENDIF   
  ENDPROC
  ****************新增 
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
    THISFORM.SETALL('READONLY',.F.,'TEXTBOX')       
    THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
    THISFORM.GRID2.ENABLED=.F. 
    THISFORM.PAGEFRAME1.PAGE2.CRCY.VISIBLE=.T.
    THISFORM.PAGEFRAME1.PAGE2.CRCY.DISPLAYVALUE=INT_011
    IF AREA1='C01'
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F.    
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS     
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
     ELSE
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.READONLY=.F. 
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=''     
     ENDIF   
     THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=DATE()
     THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=1
     THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=1
     THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=CTOD('')
     THISFORM.PAGEFRAME1.PAGE2.LBLF111.CAPTION=''
     THISFORM.PAGEFRAME1.PAGE2.LBLF381.CAPTION='0'     
     THISFORM.PAGEFRAME1.PAGE2.LBLF371.CAPTION='0'        
     THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=''  
  ENDPROC  
  *********修改
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
     THISFORM.GRID2.ENABLED=.F.
     THISFORM.PAGEFRAME1.PAGE2.CRCY.VISIBLE=.T.
     THISFORM.PAGEFRAME1.PAGE2.CRCY.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
     IF AREA1='C01'
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS     
     ELSE
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS     
     ENDIF   
     LOCK()
     IF !RLOCK()
        DO FILE_IMPACT
        RETURN
     ENDIF
  ENDPROC    
  ******刪除  
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK
     IF MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	      
        SELE C19   
        LOCK()
        IF RLOCK()
           DELE
           UNLOCK
           SKIP -1
           IF BOF()
              GO TOP
           ENDIF   
           THISFORM.GRID2.SETFOCUS
           IF THISFORM.GRID2.ACTIVEROW=0
              THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
              THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=''
              THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
              THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=''
              THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=''
              THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
              THISFORM.PAGEFRAME1.PAGE2.LBLF111.CAPTION=''
              THISFORM.PAGEFRAME1.PAGE2.LBLF381.CAPTION='0'                   
              THISFORM.PAGEFRAME1.PAGE2.LBLF371.CAPTION='0'                   
              THISFORM.CMDGROUP.ENABLED=.F.
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
           ELSE
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.T.
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限              
           ENDIF
        ELSE
          DO FILE_IMPACT    
        ENDIF      
     ENDIF
  ENDPROC
  *******新增確認
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
    DO CASE
       CASE AREA1='C01'
            IF SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE,'B01')=.F.
               =MESSAGEBOX('物料基本主檔中歸屬類別設定錯誤或是根本無此料號!',0+64,'提示訊息視窗')
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.SETFOCUS
               RETURN
            ELSE
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE   
            ENDIF   
       CASE AREA1='B01'
            IF SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE,'C01')=.F. 
               =MESSAGEBOX('客戶基本主檔中無此編號請先建立!',0+64,'提示訊息視窗')
               THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
               RETURN
            ELSE
               THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE    
            ENDIF
    ENDCASE           
    SELE C19
    APPEND BLANK
    LOCK()
    IF RLOCK()
       REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE
       REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
       REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
       REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
       REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.CRCY.DISPLAYVALUE
       REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
       REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
       REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE
       REPLACE F11 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
       REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
       REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
       REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE
    ENDIF
    UNLOCK
    IF AREA1='C01'
       SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
    ELSE
       SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE
    ENDIF   
    THISFORM.GRID2.ENABLED=.T.    
    THISFORM.GRID2.SETFOCUS        
    THISFORM.ORPGROUP.NEW_BOTT.CLICK            
  ENDPROC
  ******修改確認
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
    SELE C19
    IF RLOCK()  
*!*	       IF ALLTRIM(THISFORM.KEY_LIST.DISPLAYVALUE)='依客戶編號排列'
*!*	           REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
*!*	       ELSE
*!*	           REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
*!*	       ENDIF            
       REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE
       REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
       REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
       REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
       REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
       REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
       REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE
       REPLACE F11 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
       REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
       REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
       REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE
    ELSE
      DO FILE_IMPACT
      RETURN   
    ENDIF   
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC   
  *****放棄
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.CRCY.VISIBLE=.F.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.PAGEFRAME1.PAGE2.TXTF01.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
      UNLOCK ALL
      SELE C19
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.GRID2.ENABLED=.T.
      THISFORM.GRID2.SETFOCUS
      UNLOCK ALL
  ENDPROC
  ******完成
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
       SELE C19
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
   FLG='0'
   SELECT C19
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW    
   IF FLG<>'1'
       =MESSAGEBOX('無此範圍資料',0+48,'警示')
   ENDIF    
   FLG='0'        
ENDPROC
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
       AUTOCENTER=.T.
       CAPTION='請輸入列印日期範圍'
       FONTSIZE=INT_015*9
       HEIGHT=INT_015*160
       WIDTH=INT_015*480
       FONTSIZE=INT_015*9
       CONTROLBOX=.F.
       BORDERSTYLE=2
       SHOWTIPS=.T.
       SHOWWINDOW=1
       WINDOWTYPE=1
       NAME='ANS_RANGE'
       ADD OBJECT LABEL1 AS LABEL WITH;
           AUTOSIZE=.T.,;
           HEIGHT=INT_015*25,;
           LEFT=INT_015*30,;
           TOP=INT_015*35,;
           NAME='LABEL1'    
       ADD OBJECT LABEL2 AS LABEL WITH;
           AUTOSIZE=.T.,;
           HEIGHT=INT_015*25,;
           LEFT=INT_015*250,;
           TOP=INT_015*35,;
           NAME='LABEL2'       
       ADD OBJECT TEXT1 AS TEXTBOX WITH;
           AUTOSIZE=.T.,;
           TOP=INT_015*30,;
           LEFT=INT_015*80,;
           HEIGHT=INT_015*25,; 
           NAME='TEXT1'
       ADD OBJECT TEXT2 AS TEXTBOX WITH;
           AUTOSIZE=.T.,;
           TOP=INT_015*30,;
           LEFT=INT_015*300,;
           HEIGHT=INT_015*25,;         
           NAME='TEXT2'    
       ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
           AUTOSIZE=.T.,;
           LEFT=INT_015*120,;    
           HEIGHT=INT_015*25,;   
           TOP=INT_015*114,;  
           WIDTH=INT_015*80,;
           CAPTION='\<Y.執行',;
           TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
           NAME='CMND1'
       ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
           AUTOSIZE=.T.,;
           LEFT=INT_015*260,;
           TOP=INT_015*114,;
           HEIGHT=INT_015*25,;
           WIDTH=INT_015*80,;
           CAPTION='\<C.取消',;
           TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
           NAME='CMND2'
 *************          
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')            
      THISFORM.LABEL1.CAPTION='起始日期'
      THISFORM.LABEL2.CAPTION='截止日期'
      THISFORM.TEXT1.WIDTH=INT_015*70
      THISFORM.TEXT2.WIDTH=INT_015*70   
      THISFORM.TEXT1.MAXLENGTH=5              
      THISFORM.TEXT2.MAXLENGTH=5                                       
      THISFORM.TEXT1.VALUE=C19.F02
      THISFORM.TEXT2.VALUE=C19.F02   
  ENDPROC    
  PROCEDURE CMND1.CLICK 
  IF AREA1='C01'  
     LK=C01.F01   
     SELECT C19.F01,;
            C19.F02,;
            C19.F03,;          
            C19.F05,;
            C19.F06,;       
            C19.F08,;
            C19.F09,;
            C19.F10,;                       
            C19.F13,;
            (C19.F08*IIF(SEEK(C19.F06,'D00'),D00.F02,1)-B01.F38)/B01.F38*100,;
            B01.F02,;
            C01.F04;
     FROM C19,B01,C01;
     WHERE C19.F01=LK AND B01.F01=C19.F03  AND C01.F01=C19.F01 .AND.  C19.F02>=THISFORM.TEXT1.VALUE .AND. C19.F02<=THISFORM.TEXT2.VALUE ORDER BY C19.F02 NOWAIT
     IF _TALLY >0
        REPORT FORM ALLTRIM(INT_116)+'C03A' TO PRINT PROMPT PREVIEW
        FLG='1'
     ENDIF
  ELSE
     LK=B01.F01   
     SELECT C19.F01,;
            C19.F02,;
            C19.F03,;          
            C19.F05,;
            C19.F06,;       
            C19.F08,;
            C19.F09,;
            C19.F10,;                       
            C19.F13,;
            (C19.F08*IIF(SEEK(C19.F06,'D00'),D00.F02,1)-B01.F38)/B01.F38*100,;
            B01.F02,;
            C01.F04;
     FROM C19,B01,C01;
     WHERE C19.F03=LK AND B01.F01=C19.F03  AND C01.F01=C19.F01 .AND. C19.F02>=THISFORM.TEXT1.VALUE .AND. C19.F02<=THISFORM.TEXT2.VALUE ORDER BY C01.F01 NOWAIT
     IF _TALLY >0
        REPORT FORM ALLTRIM(INT_116)+'C03B' TO PRINT PROMPT PREVIEW
        FLG='1'   
     ENDIF  
  ENDIF         
       THISFORM.RELEASE                     
  ENDPROC
  PROCEDURE CMND2.CLICK
      FLG='1'   
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE    
************************************************特殊輸入欄位的設定----料號
DEFINE CLASS TXTF03 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=43
  FONTSIZE=INT_015*9
  PROCEDURE INTERACTIVECHANGE
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F02 FROM B01 INTO CURSOR MTR ORDER BY F01 WHERE LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1)    
       ELSE
          SELECT F01,F02 FROM B01 INTO CURSOR MTR ORDER BY F01 
       ENDIF
       IF _TALLY>0      
          MAN_SEEK=CREATEOBJECT("MTR_SEEK")  
          MAN_SEEK.SHOW    
          THIS.VALUE=FLG
          THIS.REFRESH
          FLG='0' 
        ENDIF       
    ENDIF  
       THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=IIF(SEEK(THIS.VALUE,'B01'),B01.F02,'')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=IIF(SEEK(THIS.VALUE,'B01'),B01.F04,'')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.REFRESH       
  ENDPROC
ENDDEFINE
***************************************************特殊輸入欄位設定-----------客戶
DEFINE CLASS TXTF01 AS TEXTBOX
  READONLY=.T.
  MAXLENGTH=5
  FONTSIZE=INT_015*9  
  PROCEDURE INTERACTIVECHANGE
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F02,F01,F04 FROM C01 INTO CURSOR VDR ORDER BY F02 WHERE LEFT(F02,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1)
       ELSE
          SELECT F02,F01,F04 FROM C01 INTO CURSOR VDR ORDER BY F02    
       ENDIF   
       IF _TALLY>0
          VDR_SEEK=CREATEOBJECT("VDR_SEEK")  
          VDR_SEEK.SHOW    
          THIS.VALUE=FLG
          THIS.REFRESH
          FLG='0'        
       ENDIF   
    ENDIF  
       THISFORM.PAGEFRAME1.PAGE2.LBLF011.CAPTION=IIF(SEEK(THIS.VALUE,'C01'),C01.F04,'')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=IIF(SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'B01'),B01.F04,'')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF05.REFRESH       
  ENDPROC
ENDDEFINE
***************************************************幣別設定
DEFINE CLASS CRCY AS COMBOBOX
  HEIGHT=INT_015*25
  FONTSIZE=INT_015*9
  AUTOSIZE=.T.
  LEFT=INT_015*379
  BOUNDCOLUMN=1
  COLUMNCOUNT=1
  TOP=INT_015*54
  WIDTH=INT_015*84
  ROWSOURCETYPE=1
  STYLE=2
  NAME='CRCY'
  PROCEDURE INIT
    SELECT D00
    GO TOP 
    DO WHILE .NOT. EOF()
       L=4-LEN(ALLTRIM(F01))
       THIS.ADDITEM(F01)
       SKIP
    ENDDO
  ENDPROC
  PROCEDURE INTERACTIVECHANGE
    THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=THIS.DISPLAYVALUE
  ENDPROC     
ENDDEFINE      
***************************************************