**程式名稱:D11.進貨月報表
SET EXCL OFF
CLOSE ALL
CLEAR 
AREA1='D11'
EXBO='' 
FLG='0'
FCH=''
CHK=''
IF !USED('A01')
   SELE 0
   USE A01
ELSE 
  SELE A01
ENDIF
SET ORDER TO 1
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'D11'      
IF !USED('A23')
    SELE 0
    USE A23
ELSE 
   SELE A23
ENDIF
SET ORDER TO 1 
IF !USED ('B01')
   SELE 0
   USE B01 
ELSE 
   SELE B01
ENDIF
SET ORDER TO B011     
IF !USED('C01')
   SELE 0
   USE C01 
ELSE
   SELE C01
ENDIF
SET ORDER TO C011
IF !USED('D01')
   SELE 0
   USE D01
ELSE 
   SELE D01
ENDIF
SET ORDER TO D011                  
D11='D11'+LEFT(DTOS(DATE()),6)   &&出貨日報表檔
D111='D111'+LEFT(DTOS(DATE()),6)
D112='D112'+LEFT(DTOS(DATE()),6)
D113='D113'+LEFT(DTOS(DATE()),6)
D114='D114'+LEFT(DTOS(DATE()),6)
D115='D115'+LEFT(DTOS(DATE()),6)
D116='D116'+LEFT(DTOS(DATE()),6)
D117='D117'+LEFT(DTOS(DATE()),6)
IF !USED('&D11')
   SELE 0
   USE (D11) ALIA D11 INDE (D11)
ELSE
   SELE D11
ENDIF
SET ORDER TO 1                
GO TOP
SET RELA TO F02 INTO D01 
D11FORM=CREATEOBJECT("TKD11")
D11FORM.SHOW  
DEFINE CLASS TKD11 AS FORM
  CAPTION='D11.進貨日報表'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  ADD OBJECT REC_COUNT AS REC_COUNT  WITH;
      LEFT=INT_015*628,;
      TOP=INT_015*7,;
      BACKCOLOR=RGB(255,255,0)
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*130
  ADD OBJECT MTH_LIST AS MTH_LIST WITH;
      AUTOCENTER=.T.      
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=15,;            
      RECORDSOURCE='D11',; 
      HEIGHT=INT_015*500,;     
      WIDTH=INT_015*780,;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',; 
      COLUMN4.NAME='COLUMN4',; 
      COLUMN5.NAME='COLUMN5',;             
      COLUMN6.NAME='COLUMN6',;       
      COLUMN7.NAME='COLUMN7',;       
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10',;
      COLUMN11.NAME='COLUMN11',;
      COLUMN12.NAME='COLUMN12',;
      COLUMN13.NAME='COLUMN13',;
      COLUMN14.NAME='COLUMN14',;
      COLUMN15.NAME='COLUMN15'
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;      
      TOP=INT_015*0,;
      LEFT=INT_015*403              
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=INT_015*0,;
      LEFT=INT_015*228,;
      ENABLED=.T.,;
      VISIBLE=.T.              
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*5,;
      LEFT=INT_015*443,;      
      FONTSIZE=INT_015*9,;
      CAPTION='\<A.列印進貨分析',;
      HEIGHT=INT_015*25,;     
      WIDTH=INT_015*88                
  PROCEDURE INIT
       SELE D11
        CALCULATE  SUM(F07*F08)  TO TQTY  
       GO TOP
       CHK_STR=IIF(SEEK(DTOS(CTOD((THISFORM.MTH_LIST.DISPLAYVALUE+'/01'))),'A23','A231'),LEFT(DTOC(A23.F01),5),'')
       THISFORM.REC_COUNT.CAPTION='目前金額：'+ALLTRIM(TRANSFORM(ROUND(TQTY,2),'@R 999,999,999,999.99'))
       THISFORM.ORPGROUP.NEW_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.DEL_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限       
       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.)   &&判斷有無列印進貨分析的權限
       THISFORM.GRID1.READONLY=.T.
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')       
       THISFORM.GRID1.LOCKCOLUMNS=2
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*30
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*149
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*70
       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='日期'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料        號'	          
       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單據編號'	   	     	   	   
       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='廠商編號'	   	   
       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='廠商簡稱'
       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='採購單號'  	   
       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
       THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='單        價'   
       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='進貨金額'   	
       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='運貨方式'         
       THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='採購對象'  
       THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='對象簡稱' 
       THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='負責業務'     
       THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務姓名'  
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D11.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D11.F03'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D11.F04'
       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D11.F02'
       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D01.F04'
       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='D11.F05'
       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='D11.F08'
       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='D11.F06'
       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='D11.F07'	   
       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(D11.F07*D11.F08,0)"
       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='D11.F13'	
       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='D11.F09'	
       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='D11.F10'	
       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='D11.F12'	
       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='D11.F11'	
       THISFORM.GRID1.COLUMN8.VISIBLE=!EMPTY(A02.F08)
       THISFORM.GRID1.COLUMN9.VISIBLE=!EMPTY(A02.F08)      
       THISFORM.GRID1.COLUMN10.VISIBLE=!EMPTY(A02.F08)  
       THISFORM.GRID1.SETFOCUS     
       JK='日期'
  ENDPROC      
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依  日期   排列')
           .ADDITEM('依廠商編號+日期排列')
           .ADDITEM('依料號+日期排列')           
           .ADDITEM('依採購單號+日期排列')       
           .ADDITEM('依採購對象排列')       
           .ADDITEM('依負責業務排列')  
       ENDWITH      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE D11
       THISFORM.GRID1.COLUMN9.VISIBLE = .T.
       THISFORM.GRID1.COLUMN11.VISIBLE = .T.
       DO CASE
          CASE THIS.DISPLAYVALUE='依  日期   排列'
		        SET ORDER TO D111
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*149
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='日期'
		       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料        號'	          
		       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單據編號'	   	     	   	   
		       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='廠商編號'	   	   
		       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='廠商簡稱'
		       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='採購單號'  	   
		       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
		       THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
		       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='單        價'   	
		       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='進貨金額'  
		       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='運貨方式'         
		       THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='採購對象'  
		       THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='對象簡稱' 
		       THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='負責業務'     
		       THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務姓名'  
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D11.F01'
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D11.F03'
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D11.F04'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D11.F02'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D01.F04'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='D11.F05'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='D11.F08'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='D11.F06'
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='D11.F07'	   
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(D11.F07*D11.F08,0)"
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='D11.F13'	
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='D11.F09'	
		       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='D11.F10'	
		       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='D11.F12'	
		       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='D11.F11'	    
		       THISFORM.GRID1.COLUMN8.VISIBLE=!EMPTY(A02.F08)
		       THISFORM.GRID1.COLUMN9.VISIBLE=!EMPTY(A02.F08)	
		       THISFORM.GRID1.COLUMN10.VISIBLE=!EMPTY(A02.F08)	           
          CASE THIS.DISPLAYVALUE='依廠商編號+日期排列'
		       SET ORDER TO D112
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*70		       
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*149
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='廠商編號'	   	   
		       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='廠商簡稱'		       
		       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='日期'
		       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	          
		       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單據編號'	   	     	   	   
		       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='採購單號'  	   
		       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
		       THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
		       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='單        價'   	
		       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='進貨金額'  
		       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='運貨方式'         
		       THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='採購對象'  
		       THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='對象簡稱' 
		       THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='負責業務'     
		       THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務姓名'  
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D11.F02'
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D01.F04'		       
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D11.F01'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D11.F03'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D11.F04'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='D11.F05'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='D11.F08'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='D11.F06'
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='D11.F07'	   
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(D11.F07*D11.F08,0)"
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='D11.F13'	
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='D11.F09'	
		       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='D11.F10'	
		       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='D11.F12'	
		       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='D11.F11'	    
		       THISFORM.GRID1.COLUMN8.VISIBLE=!EMPTY(A02.F08)
		       THISFORM.GRID1.COLUMN9.VISIBLE=!EMPTY(A02.F08)	
		       THISFORM.GRID1.COLUMN10.VISIBLE=!EMPTY(A02.F08)			                  
          CASE THIS.DISPLAYVALUE='依料號+日期排列'                
               		SET ORDER TO D113      
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*149                                  
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料        號'			       
		       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='日期'
		       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='單據編號'	   	     	   	   
		       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='廠商編號'	   	   
		       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='廠商簡稱'
		       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='採購單號'  	   
		       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
		       THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
		       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='單        價'   	
		       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='進貨金額'  
		       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='運貨方式'         
		       THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='採購對象'  
		       THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='對象簡稱' 
		       THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='負責業務'     
		       THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務姓名'  
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D11.F03'
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D11.F01'
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D11.F04'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D11.F02'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D01.F04'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='D11.F05'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='D11.F08'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='D11.F06'
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='D11.F07'	   
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(D11.F07*D11.F08,0)"
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='D11.F13'	
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='D11.F09'	
		       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='D11.F10'	
		       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='D11.F12'	
		       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='D11.F11'	    
		       THISFORM.GRID1.COLUMN8.VISIBLE=!EMPTY(A02.F08)
		       THISFORM.GRID1.COLUMN9.VISIBLE=!EMPTY(A02.F08)	
		       THISFORM.GRID1.COLUMN10.VISIBLE=!EMPTY(A02.F08)		                        	                             
          CASE THIS.DISPLAYVALUE='依採購單號+日期排列'                  
               		SET ORDER TO D114 
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*149
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='採購單號'  
		       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='日期'
		       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='料        號'	          
		       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='單據編號'	   	     	   	   
		       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='廠商編號'	   	   
		       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='廠商簡稱'
		       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='數        量'
		       THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='幣別' 
		       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='單        價'   	
		       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='進貨金額'  
		       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='運貨方式'         
		       THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='採購對象'  
		       THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='對象簡稱' 
		       THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='負責業務'     
		       THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務姓名'  
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D11.F05'
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D11.F01'
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D11.F03'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D11.F04'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D11.F02'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='D01.F04'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='D11.F08'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='D11.F06'
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='D11.F07'	   
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(D11.F07*D11.F08,0)"
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='D11.F13'	
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='D11.F09'	
		       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='D11.F10'	
		       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='D11.F12'	
		       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='D11.F11'	    
		       THISFORM.GRID1.COLUMN8.VISIBLE=!EMPTY(A02.F08)
		       THISFORM.GRID1.COLUMN9.VISIBLE=!EMPTY(A02.F08)	
		       THISFORM.GRID1.COLUMN10.VISIBLE=!EMPTY(A02.F08)			             		       
          CASE THIS.DISPLAYVALUE='依採購對象排列'
             		SET ORDER TO D116    
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60             		
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*149
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='採購對象'  
		       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='對象簡稱' 		       
		       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='日期'
		       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	          
		       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單據編號'	   	     	   	   
		       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='廠商編號'	   	   
		       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='廠商簡稱'
		       THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='採購單號'  	   
		       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='數        量'
		       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='幣別' 
		       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='單        價'   	
		       THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='進貨金額' 
		       THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='運貨方式'         
		       THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='負責業務'     
		       THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='業務姓名'  
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D11.F09'	
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D11.F10'			       
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D11.F01'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D11.F03'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D11.F04'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='D11.F02'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='D01.F04'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='D11.F05'
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='D11.F08'
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE='D11.F06'
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='D11.F07'	   
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE="ROUND(D11.F07*D11.F08,0)"
		       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='D11.F13'	
		       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='D11.F12'	
		       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='D11.F11'	       
		       THISFORM.GRID1.COLUMN10.VISIBLE=!EMPTY(A02.F08)
		       THISFORM.GRID1.COLUMN11.VISIBLE=!EMPTY(A02.F08)	
		       THISFORM.GRID1.COLUMN12.VISIBLE=!EMPTY(A02.F08)		       
          CASE THIS.DISPLAYVALUE='依負責業務排列'
		        SET ORDER TO D117
		       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
		       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*60		        
		       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*149
		       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN8.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN9.WIDTH=INT_015*80
		       THISFORM.GRID1.COLUMN10.WIDTH=INT_015*30
		       THISFORM.GRID1.COLUMN11.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN12.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN13.WIDTH=INT_015*70
		       THISFORM.GRID1.COLUMN14.WIDTH=INT_015*50
		       THISFORM.GRID1.COLUMN15.WIDTH=INT_015*60
		       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='負責業務'     
		       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='業務姓名'  		       
		       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='日期'
		       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='料        號'	          
		       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='單據編號'	   	     	   	   
		       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='廠商編號'	   	   
		       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='廠商簡稱'
		       THISFORM.GRID1.COLUMN8.HEADER1.CAPTION='採購單號'  	   
		       THISFORM.GRID1.COLUMN9.HEADER1.CAPTION='數        量'
		       THISFORM.GRID1.COLUMN10.HEADER1.CAPTION='幣別' 
		       THISFORM.GRID1.COLUMN11.HEADER1.CAPTION='單        價'   	
		       THISFORM.GRID1.COLUMN12.HEADER1.CAPTION='進貨金額' 
		       THISFORM.GRID1.COLUMN13.HEADER1.CAPTION='運貨方式'         
		       THISFORM.GRID1.COLUMN14.HEADER1.CAPTION='採購對象'  
		       THISFORM.GRID1.COLUMN15.HEADER1.CAPTION='對象簡稱' 
		       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D11.F12'	
		       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D11.F11'	  
		       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D11.F01'
		       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D11.F03'
		       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D11.F04'
		       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='D11.F02'
		       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='D01.F04'
		       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='D11.F05'
		       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='D11.F08'
		       THISFORM.GRID1.COLUMN10.CONTROLSOURCE='D11.F06'
		       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='D11.F07'	   
		       THISFORM.GRID1.COLUMN12.CONTROLSOURCE="ROUND(D11.F07*D11.F08,0)"
		       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='D11.F13'	
		       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='D11.F09'	
		       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='D11.F10'	       
		       THISFORM.GRID1.COLUMN10.VISIBLE=!EMPTY(A02.F08)
		       THISFORM.GRID1.COLUMN11.VISIBLE=!EMPTY(A02.F08)	
		       THISFORM.GRID1.COLUMN12.VISIBLE=!EMPTY(A02.F08)		        		                    
       ENDCASE 
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC              
  PROC MTH_LIST.INTERACTIVECHANGE
       CHK_STR=IIF(SEEK(DTOS(CTOD((THIS.DISPLAYVALUE+'/01'))),'A23','A231'),LEFT(DTOC(A23.F01),5),'')
       THISFORM.GRID1.RECORDSOURCE=''
       SELE D11
       USE
       D11='D11'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       D111='D111'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       D112='D112'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       D113='D113'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       D114='D114'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       D115='D115'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       D116='D116'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       D117='D117'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       IF !USED('&D11')
          SELE 0
          USE (D11) ALIA D11
       ELSE
          SELE D11
       ENDIF
       SET ORDER TO 1        
       SET RELA TO F02 INTO D01
       CALCULATE  SUM(F07*F08) TO TQTY
       GO TOP
       THISFORM.REC_COUNT.CAPTION='目前金額：'+ALLTRIM(TRANSFORM(ROUND(TQTY,2),'@R 999,999,999,999.99'))
       THISFORM.GRID1.RECORDSOURCE='D11'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='D11.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='D11.F03'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='D11.F04'
       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='D11.F02'
       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='D01.F04'
       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='D11.F05'
       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='D11.F08'
       THISFORM.GRID1.COLUMN8.CONTROLSOURCE='D11.F06'
       THISFORM.GRID1.COLUMN9.CONTROLSOURCE='D11.F07'	   
       THISFORM.GRID1.COLUMN10.CONTROLSOURCE="ROUND(D11.F07*D11.F08,0)"
       THISFORM.GRID1.COLUMN11.CONTROLSOURCE='D11.F13'	
       THISFORM.GRID1.COLUMN12.CONTROLSOURCE='D11.F09'	
       THISFORM.GRID1.COLUMN13.CONTROLSOURCE='D11.F10'	
       THISFORM.GRID1.COLUMN14.CONTROLSOURCE='D11.F12'	
       THISFORM.GRID1.COLUMN15.CONTROLSOURCE='D11.F11'	
       THISFORM.GRID1.COLUMN8.VISIBLE=!EMPTY(A02.F08)
       THISFORM.GRID1.COLUMN9.VISIBLE=!EMPTY(A02.F08)
       THISFORM.GRID1.COLUMN10.VISIBLE=!EMPTY(A02.F08)
       THISFORM.KEY_LIST.INTERACTIVECHANGE
	   THISFORM.GRID1.SETFOCUS        
	   THISFORM.REFRESH
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.ENABLED=.F.
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
          THISFORM.ANS_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.ENABLED=.T.      
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限
          THISFORM.ANS_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.)   &&判斷有無列印進貨分析的權限  
       ENDIF          
  ENDPROC      
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.REFRESH
  ENDPROC       
*************       
  PROC ANS_BOTT.CLICK                               &&列印進貨分析
  	SELECT  D11
   	ANS_CHK=CREATEOBJECT("ANS_CHK")  
   	ANS_CHK.SHOW
   	THISFORM.GRID1.SETFOCUS 
  ENDPROC   
  ENDDEFINE       
********************************************************
DEFINE CLASS ANS_CHK AS FORM
  AUTOCENTER=.T.
  CAPTION='請選擇列印內容'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*140
  WIDTH=INT_015*250
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.  
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_CHK'
ADD OBJECT DATA_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*17,;
      TOP=INT_015*30,;
      AUTOSIZE=.T.,;
      FONTSIZE=INT_015*12,;
      BUTTONCOUNT=4,;
      OPTION1.CAPTION='廠商別進貨分析',;
      OPTION1.TOP=INT_015*0,;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='產品別進貨分析',;
      OPTION2.TOP=INT_015*20,;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.AUTOSIZE=.T.,;      
      OPTION3.CAPTION='採購對象別進貨分析',;
      OPTION3.TOP=INT_015*40,;
      OPTION3.FONTSIZE=INT_015*9,;
      OPTION3.AUTOSIZE=.T.,;
      OPTION4.CAPTION='負責業務別進貨分析',;
      OPTION4.TOP=INT_015*60,;
      OPTION4.FONTSIZE=INT_015*9,;
      OPTION4.AUTOSIZE=.T.,;
      NAME='DATA_OPTION'   
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*20,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<P.列   印',;
      VISIBLE=.F.,;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*60,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<E.轉EXCEL',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;
      TOP=INT_015*100,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<C.取   消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'     
  *****    
 PROCEDURE CMND1.CLICK   
      DO CASE
  	     CASE THISFORM.DATA_OPTION.VALUE=1 
  	       		 SELECT D11.F02 廠商編號,IIF(SEEK(D11.F02,'D01'),D01.F04,'') 廠商名稱,ROUND(SUM(D11.F07*D11.F08),0) 進貨總金額 FROM D11  WHERE LEFT(F04,4)="BA"  OR LEFT(F04,4)="PB" GROUP BY F02 ORDER BY F02 NOWAIT
  	       		  IF _TALLY>0
  	       		      IF !EMPTY(EXBO)
  	       		          FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'廠商別進貨分析'+'(D11)'
		                  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		                  IF !EMPTY(GCDELIMFILE) 
		                       ON ERROR DO FILE_IMPACT
		                       COPY TO (GCDELIMFILE) TYPE XL5     
		                       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		                  ENDIF     
		              ENDIF 		              
  	       		  ELSE
  	       		      =MESSAGEBOX('查無無資料',0+16,'提示訊息視窗')
  	       		  ENDIF
  	     CASE THISFORM.DATA_OPTION.VALUE=2  
  	                 SELECT D11.F03 料號,IIF(SEEK(D11.F03,'B01'),B01.F02,'') 品名規格,ROUND(SUM(D11.F07*D11.F08),0) 進貨總金額 FROM D11 WHERE LEFT(F04,4)="BA"  OR LEFT(F04,4)="PB" GROUP BY F03 ORDER BY F03 NOWAIT
  	       		  IF _TALLY>0
  	       		      IF !EMPTY(EXBO)
  	       		          FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'產品別進貨分析'+'(D11)'
		                  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		                  IF !EMPTY(GCDELIMFILE) 
		                       ON ERROR DO FILE_IMPACT
		                       COPY TO (GCDELIMFILE) TYPE XL5     
		                       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		                  ENDIF     
		              ENDIF 		              
  	       		  ELSE
  	       		      =MESSAGEBOX('查無無資料',0+16,'提示訊息視窗')
  	       		  ENDIF  	                 
  	     CASE THISFORM.DATA_OPTION.VALUE=3
  	                 SELECT D11.F09 採購對象,D11.F10 對象名稱,ROUND(SUM(D11.F07*D11.F08),0) 進貨總金額 FROM D11 WHERE LEFT(F04,4)="BA"  OR LEFT(F04,4)="PB" GROUP BY F09 ORDER BY F09 NOWAIT
  	       		  IF _TALLY>0
  	       		      IF !EMPTY(EXBO)
  	       		          FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'採購對象別進貨分析'+'(D11)'
		                  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		                  IF !EMPTY(GCDELIMFILE) 
		                       ON ERROR DO FILE_IMPACT
		                       COPY TO (GCDELIMFILE) TYPE XL5     
		                       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		                  ENDIF     
		              ENDIF  		              
  	       		  ELSE
  	       		      =MESSAGEBOX('查無無資料',0+16,'提示訊息視窗')
  	       		  ENDIF  	                 
  	     CASE THISFORM.DATA_OPTION.VALUE=4  
  	                 SELECT D11.F12 負責業務,D11.F11 業務姓名,ROUND(SUM(D11.F07*D11.F08),0) 進貨總金額 FROM D11 WHERE LEFT(F04,4)="BA"  OR LEFT(F04,4)="PB" GROUP BY F12 ORDER BY F12 NOWAIT
  	       		  IF _TALLY>0
  	       		      IF !EMPTY(EXBO)
  	       		          FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'負責業務別進貨分析'+'(D11)'
		                  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		                  IF !EMPTY(GCDELIMFILE) 
		                       ON ERROR DO FILE_IMPACT
		                       COPY TO (GCDELIMFILE) TYPE XL5     
		                       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		                  ENDIF     
		              ENDIF   
  	       		  ELSE
  	       		      =MESSAGEBOX('查無無資料',0+16,'提示訊息視窗')
  	       		  ENDIF  	                 
      ENDCASE 	 
      SELECT D11
      THISFORM.RELEASE                         
  ENDPROC
  ****
  PROCEDURE CMND2.CLICK
     EXBO='1'
     THISFORM.CMND1.CLICK
     EXBO='' 
     THISFORM.RELEASE
  ENDPROC       
 ***** 
  PROCEDURE CMND3.CLICK
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE       	 
***********************************************列印程序
PROCEDURE PNT_PRC   
  FLG='0'
   SELE D11
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW    
   IF FLG<>'1'
       =MESSAGEBOX('無此範圍資料',0+48,'警示')
   ENDIF   
   FLG='0'       
ENDPROC
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*150
  WIDTH=INT_015*400
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*25,;
      TOP=INT_015*40,;
      NAME='LABEL1'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      TOP=INT_015*34,;
      LEFT=INT_015*78,;
      HEIGHT=INT_015*25,; 
      NAME='TEXT1'
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*25,;
      TOP=INT_015*90,;
      NAME='LABEL2'      
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      TOP=INT_015*84,;
      LEFT=INT_015*78,;
      HEIGHT=INT_015*25,;         
      NAME='TEXT2'    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*300,;     
      TOP=INT_015*20,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<P.列   印',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*300,;     
      TOP=INT_015*60,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<E.轉EXCEL',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*300,;
      TOP=INT_015*100,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*70,;
      FONTSIZE=INT_015*10,;
      CAPTION='\<C.取   消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'    
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')            
      DO CASE
         CASE KEY()='F01'    
              THISFORM.LABEL1.CAPTION='起始日期'
              THISFORM.LABEL2.CAPTION='截止日期'
              THISFORM.TEXT1.WIDTH=INT_015*25
              THISFORM.TEXT2.WIDTH=INT_015*25   
              THISFORM.TEXT1.MAXLENGTH=2           
              THISFORM.TEXT2.MAXLENGTH=2                                       
              THISFORM.TEXT1.VALUE=D11.F01
              THISFORM.TEXT2.VALUE=D11.F01              
         CASE KEY()='F02+F01'
              THISFORM.LABEL1.CAPTION='起始廠商'
              THISFORM.LABEL2.CAPTION='截止廠商'
              THISFORM.TEXT1.WIDTH=INT_015*60
              THISFORM.TEXT2.WIDTH=INT_015*60 
              THISFORM.TEXT1.MAXLENGTH=5
              THISFORM.TEXT2.MAXLENGTH=5
              THISFORM.TEXT1.VALUE=D11.F02
              THISFORM.TEXT2.VALUE=D11.F02               
         CASE KEY()='F03+F01'       
              THISFORM.LABEL1.CAPTION='起始料號'
              THISFORM.LABEL2.CAPTION='截止料號'
              THISFORM.TEXT1.WIDTH=INT_015*170
              THISFORM.TEXT2.WIDTH=INT_015*170   
              THISFORM.TEXT1.MAXLENGTH=43              
              THISFORM.TEXT2.MAXLENGTH=43                                       
              THISFORM.TEXT1.VALUE=D11.F03
              THISFORM.TEXT2.VALUE=D11.F03               
         CASE KEY()='F05+F01'   
              THISFORM.LABEL1.CAPTION='起始單號'
              THISFORM.LABEL2.CAPTION='截止單號'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=10              
              THISFORM.TEXT2.MAXLENGTH=10                            
              THISFORM.TEXT1.VALUE=D11.F05
              THISFORM.TEXT2.VALUE=D11.F05           
         CASE KEY()='F09'   
              THISFORM.LABEL1.CAPTION='起始對象'
              THISFORM.LABEL2.CAPTION='截止對象'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=5          
              THISFORM.TEXT2.MAXLENGTH=5                          
              THISFORM.TEXT1.VALUE=D11.F09
              THISFORM.TEXT2.VALUE=D11.F09            
         CASE KEY()='F12'   
              THISFORM.LABEL1.CAPTION='起始對象'
              THISFORM.LABEL2.CAPTION='截止對象'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=5         
              THISFORM.TEXT2.MAXLENGTH=5                           
              THISFORM.TEXT1.VALUE=D11.F12
              THISFORM.TEXT2.VALUE=D11.F12                                                                              
      ENDCASE   
  ENDPROC    
  PROCEDURE CMND1.CLICK      
   SELE D11
   DO CASE 
      CASE KEY()='F01'   
           SELECT D11.F01,;           
                  D11.F02,;
                  D11.F03,;
                  D11.F04,;
                  D11.F05,;                  
                  D11.F06,;
                  D11.F07,;                    
                  D11.F08,;
                  D11.F09,;
                  D11.F10,;
                  D11.F11,;
                  D11.F12,;
                  D11.F13,;
                  B01.F02,;
                  D01.F04;
           FROM D11,B01,D01 WHERE D01.F01=D11.F02 AND B01.F01=D11.F03;
           AND D11.F01>=THISFORM.TEXT1.VALUE AND D11.F01<=THISFORM.TEXT2.VALUE;
           ORDER BY D11.F01 INTO CURSOR D11_TEMP 
           SELECT D11_TEMP 
           GO TOP
           IF _TALLY >0
               IF EMPTY(EXBO)
                   REPORT FORM ALLTRIM(INT_116)+'D11A' TO PRINT PROMPT PREVIEW 
              ELSE
                  IF A02.F08='*'
                       SELECT F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,;
                                      F05 採購單號,F08 進貨數量,F06 幣別,F07 單價,ROUND(F07*F08,0) 進貨金額,F13 運貨方式,;
                                      F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名 FROM D11_TEMP NOWAIT
                  ELSE
                       SELECT F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,;
                                     F05 採購單號,F08 進貨數量,F13 運貨方式,F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名 FROM D11_TEMP NOWAIT              
                  ENDIF    
                  FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'進貨日報表'+'(D11)'
		  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		  IF !EMPTY(GCDELIMFILE) 
		       ON ERROR DO FILE_IMPACT
		       COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF 
              ENDIF 
               FLG='1'        
           ENDIF  
      CASE KEY()='F02+F01' 
           SELECT D11.F01,;           
                  D11.F02,;
                  D11.F03,;
                  D11.F04,;
                  D11.F05,;                  
                  D11.F06,;
                  D11.F07,;                    
                  D11.F08,;
                  D11.F09,;
                  D11.F10,;
                  D11.F11,;
                  D11.F12,;
                  D11.F13,;                  
                  B01.F02,;
                  D01.F04;
           FROM D11,B01,D01 WHERE D01.F01=D11.F02 AND B01.F01=D11.F03;
           AND  D11.F02>=THISFORM.TEXT1.VALUE AND D11.F02<=THISFORM.TEXT2.VALUE;
           ORDER BY D11.F02,D11.F01  INTO CURSOR D11_TEMP
           SELECT D11_TEMP
           GO TOP
           IF _TALLY >0
               IF EMPTY(EXBO)
                   REPORT FORM ALLTRIM(INT_116)+'D11B' TO PRINT PROMPT PREVIEW 
              ELSE
                  IF A02.F08='*'
                       SELECT F02_A 廠商編號,F04_B 廠商簡稱,F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F05 採購單號,F08 進貨數量,F06 幣別,F07 單價,ROUND(F07*F08,0) 進貨金額,F13 運貨方式,F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名;
                       FROM D11_TEMP NOWAIT
                  ELSE
                       SELECT F02_A 廠商編號,F04_B 廠商簡稱,F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F05 採購單號,F08 進貨數量,F13 運貨方式,F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名;
                       FROM D11_TEMP NOWAIT              
                  ENDIF    
                  FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'進貨日報表'+'(D11)'
		  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		  IF !EMPTY(GCDELIMFILE) 
		       ON ERROR DO FILE_IMPACT
		       COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF 
              ENDIF 
               FLG='1'                
           ENDIF                        
      CASE KEY()='F03+F01'   
           SELECT D11.F01,;           
                  D11.F02,;
                  D11.F03,;
                  D11.F04,;
                  D11.F05,;                  
                  D11.F06,;
                  D11.F07,;                    
                  D11.F08,;
                  D11.F09,;
                  D11.F10,;
                  D11.F11,;
                  D11.F12,;
                  D11.F13,;                  
                  B01.F02,;
                  D01.F04;
           FROM D11,B01,D01 WHERE D01.F01=D11.F02 AND B01.F01=D11.F03;
           AND D11.F03>=THISFORM.TEXT1.VALUE AND D11.F03<=THISFORM.TEXT2.VALUE;
           ORDER BY D11.F03,D11.F01 INTO CURSOR D11_TEMP
           SELECT D11_TEMP
           GO TOP
           IF _TALLY >0
               IF EMPTY(EXBO)
                   REPORT FORM ALLTRIM(INT_116)+'D11C' TO PRINT PROMPT PREVIEW 
              ELSE
                  IF A02.F08='*'
                       SELECT F03 料號,F02_B 品名規格,F01 日期,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,F05 採購單號,F08 進貨數量,F06 幣別,F07 單價,ROUND(F07*F08,0) 進貨金額,F13 運貨方式,F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名;
                       FROM D11_TEMP NOWAIT
                  ELSE
                       SELECT F03 料號,F02_B 品名規格,F01 日期,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,F05 採購單號,F08 進貨數量,F13 運貨方式,F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名;
                       FROM D11_TEMP NOWAIT              
                  ENDIF    
                  FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'進貨日報表'+'(D11)'
		  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		  IF !EMPTY(GCDELIMFILE) 
		       ON ERROR DO FILE_IMPACT
		       COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF 
              ENDIF 
               FLG='1'                
           ENDIF                               
      CASE KEY()='F05+F01'   
           SELECT D11.F01,;           
                  D11.F02,;
                  D11.F03,;
                  D11.F04,;
                  D11.F05,;                  
                  D11.F06,;
                  D11.F07,;                    
                  D11.F08,;
                  D11.F09,;
                  D11.F10,;
                  D11.F11,;
                  D11.F12,;
                  D11.F13,;                  
                  B01.F02,;
                  D01.F04;
           FROM D11,B01,D01 WHERE D01.F01=D11.F02 AND B01.F01=D11.F03;
           AND D11.F05>=THISFORM.TEXT1.VALUE AND D11.F05<=THISFORM.TEXT2.VALUE;
           ORDER BY D11.F05,D11.F01 INTO CURSOR D11_TEMP
           SELECT D11_TEMP
           GO TOP
           IF _TALLY >0
               IF EMPTY(EXBO)
                   REPORT FORM ALLTRIM(INT_116)+'D11D' TO PRINT PROMPT PREVIEW 
              ELSE
                  IF A02.F08='*'
                       SELECT F05 採購單號,F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,F08 進貨數量,F06 幣別,F07 單價,ROUND(F07*F08,0) 進貨金額,F13 運貨方式,F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名;
                       FROM D11_TEMP NOWAIT
                  ELSE
                       SELECT F05 採購單號,F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,F08 進貨數量,F13 運貨方式,F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名;
                       FROM D11_TEMP NOWAIT              
                  ENDIF    
                  FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'進貨日報表'+'(D11)'
		  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		  IF !EMPTY(GCDELIMFILE) 
		       ON ERROR DO FILE_IMPACT
		       COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF 
              ENDIF 
               FLG='1'                
           ENDIF                    
      CASE KEY()='F09'   
           SELECT D11.F01,;           
                  D11.F02,;
                  D11.F03,;
                  D11.F04,;
                  D11.F05,;                  
                  D11.F06,;
                  D11.F07,;                    
                  D11.F08,;
                  D11.F09,;
                  D11.F10,;
                  D11.F11,;
                  D11.F12,;
                  D11.F13,;                  
                  B01.F02,;
                  D01.F04;
           FROM D11,B01,D01 WHERE D01.F01=D11.F02 AND B01.F01=D11.F03;
           AND D11.F09>=THISFORM.TEXT1.VALUE AND D11.F09<=THISFORM.TEXT2.VALUE;
           ORDER BY D11.F09,D11.F01 INTO CURSOR D11_TEMP
           SELECT D11_TEMP
           GO TOP
           IF _TALLY >0
               IF EMPTY(EXBO)
                   REPORT FORM ALLTRIM(INT_116)+'D11D' TO PRINT PROMPT PREVIEW 
              ELSE
                  IF A02.F08='*'
                       SELECT F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名,F13 運貨方式,F05 採購單號,F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,F08 進貨數量,F06 幣別,F07 單價,ROUND(F07*F08,0) 進貨金額;
                       FROM D11_TEMP NOWAIT
                  ELSE
                       SELECT F09 採購對象,F10 對象簡稱,F12 負責業務,F11 業務姓名,F13 運貨方式,F05 採購單號,F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,F08 進貨數量 FROM D11_TEMP NOWAIT              
                  ENDIF    
                  FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'進貨日報表'+'(D11)'
		  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		  IF !EMPTY(GCDELIMFILE) 
		       ON ERROR DO FILE_IMPACT
		       COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF 
              ENDIF 
               FLG='1'                
           ENDIF                                         
      CASE KEY()='F12'   
           SELECT D11.F01,;           
                  D11.F02,;
                  D11.F03,;
                  D11.F04,;
                  D11.F05,;                  
                  D11.F06,;
                  D11.F07,;                    
                  D11.F08,;
                  D11.F09,;
                  D11.F10,;
                  D11.F11,;
                  D11.F12,;
                  D11.F13,;                  
                  B01.F02,;
                  D01.F04;
           FROM D11,B01,D01 WHERE D01.F01=D11.F02 AND B01.F01=D11.F03;
           AND D11.F12>=THISFORM.TEXT1.VALUE AND D11.F12<=THISFORM.TEXT2.VALUE;
           ORDER BY D11.F12,D11.F01 INTO CURSOR D11_TEMP
           SELECT D11_TEMP
           GO TOP
           IF _TALLY >0
               IF EMPTY(EXBO)
                   REPORT FORM ALLTRIM(INT_116)+'D11D' TO PRINT PROMPT PREVIEW 
              ELSE
                  IF A02.F08='*'
                       SELECT F12 負責業務,F11 業務姓名,F09 採購對象,F10 對象簡稱,F13 運貨方式,F05 採購單號,F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,F08 進貨數量,F06 幣別,F07 單價,ROUND(F07*F08,0) 進貨金額;
                       FROM D11_TEMP NOWAIT
                  ELSE
                       SELECT F12 負責業務,F11 業務姓名,F09 採購對象,F10 對象簡稱,F13 運貨方式,F05 採購單號,F01 日期,F03 料號,F02_B 品名規格,F04_A 單據編號,F02_A 廠商編號,F04_B 廠商簡稱,F08 進貨數量 FROM D11_TEMP NOWAIT              
                  ENDIF    
                  FILENAME=LEFT(CHK_STR,2)+'年'+RIGHT(CHK_STR,2)+'月份'+'進貨日報表'+'(D11)'
		  GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		  IF !EMPTY(GCDELIMFILE) 
		       ON ERROR DO FILE_IMPACT
		       COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF 
              ENDIF 
               FLG='1'                
           ENDIF                                                                            
       ENDCASE 
*       CLEAR 
    THISFORM.RELEASE  
  ENDPROC
  ****
  PROCEDURE CMND2.CLICK
     EXBO='1'
     THISFORM.CMND1.CLICK
     EXBO='' 
     THISFORM.RELEASE
  ENDPROC       
  PROCEDURE CMND3.CLICK
      FLG='1'   
      THISFORM.RELEASE
  ENDPROC        
ENDDEFINE  

