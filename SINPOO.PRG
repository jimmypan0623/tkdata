****程式名稱 新普科技標籤輸入介面
CLEAR ALL
SET TALK OFF
SET EXCL OFF
SET DELE ON
SET CENT OFF
SET SAFE OFF
SET DECIMALS TO 6
SET REPROCESS TO 1
_SCREEN.CAPTION=''
_SCREEN.CONTROLBOX=.F.
ZOOM WIND SCREEN MIN
CLEAR ALL
CLOS DATA ALL
CLOS TABL ALL
SET TALK OFF
SET EXCL OFF
SET DELE ON
SET CENT OFF
SET SAFE OFF
SET DECIMALS TO 6
SET ENGINEBEHAVIOR 70 
SET REPORTBEHAVIOR 80
SET REPROCESS TO 1
_SCREEN.CAPTION=''
_SCREEN.CONTROLBOX=.F.
ZOOM WINDOW  SCREEN MAX
HIDE WINDOW SCREEN
DEACTIVATE WIND SCREEN
SET SYSMENU OFF
SET STATUS BAR OFF
SET MULTILOCKS ON
FILE_NAME=''
DECLARE _FPRESET IN msvcrt20.dll 
CAPSLOCK(.T.)
CREATE CURSOR TD4 (F01 C(25))
INDEX ON F01 TAG TD4
SET ORDER TO 1
IF !USED('A26')
   SELECT 0
   USE A26
ELSE 
   SELECT A26
ENDIF
SET ORDER TO 1      
SEEK 'INT_012'
IF FOUND()
   INT_012=VAL(F06)
ELSE
  INT_012=2   
ENDIF
IF INT_012=1
   SET DATE TO TAIWAN
ELSE
   SET DATE TO YMD
ENDIF   
v_scrx=SYSMETRIC(1)
v_scry=SYSMETRIC(2)
IF v_scrx= 800 AND v_scry=600
   INT_015=1
ELSE
   INT_015=1.28   
endif
SELECT 0
IF !USED('SINPOO1')
   SELECT 0
   USE SINPOO1 EXCLUSIVE
ELSE
   SELECT SINPOO1
ENDIF      
SET ORDER TO 1



IF !USED('C20')
   SELECT 0
   USE C20
ELSE
   SELECT C20
ENDIF
SET ORDER TO 1      
IF !USED('C03')
   SELECT 0
   USE C03
ELSE 
   SELECT C03
ENDIF
SET ORDER TO 1 
IF !USED('C04')
   SELECT 0
   USE C04
ELSE 
   SELECT C04
ENDIF
SET ORDER TO 1      
IF !USED('A23')
   SELECT 0
   USE A23
ELSE 
   SELECT A23
ENDIF
SET ORDER TO 1    
IF !USED('C22')
   SELE 0
   USE C22
ELSE
   SELE C22
ENDIF
SET ORDER TO C223
IF !USED('C23')
   SELE 0
   USE C23
ELSE
   SELE C23
ENDIF
SET ORDER TO 1
SELECT INV_NO FROM SINPOO1 GROUP BY INV_NO ORDER BY INV_NO INTO CURSOR TD3 NOWAIT
SELECT TD3
GO TOP
DO WHILE !EOF()
   SELECT TD4
   APPEND BLANK 
   REPLACE F01 WITH TD3.INV_NO
   SELECT TD3
   SKIP
ENDDO
SELECT TD3 
USE

DO FORM SINPOO1


***************************************輸入DATE CODE
DEFINE CLASS SINPOO2_SEEK AS FORM
*!*	  AUTOCENTER=.T.
  CAPTION='        輸入DATE CODD'
  TOP=INT_015*40
  LEFT=INT_015*325    
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*325
  WIDTH=INT_015*280
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  CLOSABLE=.F.
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='SINPOO2_SEEK'
  ADD OBJECT GRID3 AS GRID3 WITH;          
      TOP=0,;
      HIGHLIGHTROWLINEWIDTH=4,;
      WIDTH=INT_015*280,;      
      HEIGHT=INT_015*283,;      
      ROWHEIGHT=INT_015*18,;
      HEADERHEIGHT=INT_015*19,;
      DELETEMARK=.F.,;
      READONLY=.T.,;
      RECORDSOURCETYPE=1,;
      COLUMNCOUNT=3,;       
      RECORDSOURCE='SINPOO2',;     
      NAME='GRID3',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3'
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*20,;    
      HEIGHT=INT_015*25,;   
      TOP=INT_015*297,;        
      WIDTH=INT_015*80,;    
      FONTSIZE=INT_015*9,;
      CAPTION='\<S.確定',;
      TOOLTIPTEXT='選擇游標所指的紀錄!快速鍵->ALT+S'
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*100,;
      TOP=INT_015*297,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*80,;    
      FONTSIZE=INT_015*9,;      
      CAPTION='\<X.取消',;
      TOOLTIPTEXT='取消此搜尋畫面!快速鍵->ALT+X'
      NAME='CMND2'

   PROCEDURE INIT 
      
         SELE SINPOO2
         
         GO TOP
         THISFORM.GRID3.SETALL('FONTSIZE',INT_015*9,'COLUMN')
         THISFORM.GRID3.SETALL('FONTSIZE',INT_015*9,'HEADER')   
         THISFORM.SETALL('MOVABLE',.F.,'COLUMN') 
         THISFORM.SETALL('MOUSEPOINTER',99,'COMMANDBUTTON')
         THISFORM.SETALL('MOUSEICON','BMPS\harrow.cur','COMMANDBUTTON')                           
         THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
         THISFORM.GRID3.COLUMN1.HEADER1.CAPTION='BOX NO'
         THISFORM.GRID3.COLUMN1.WIDTH=INT_015*60
         THISFORM.GRID3.COLUMN1.CONTROLSOURCE='SINPOO2.BOX_NO'                
         THISFORM.GRID3.COLUMN2.HEADER1.CAPTION='DATE CODE'
         THISFORM.GRID3.COLUMN2.WIDTH=INT_015*70
         THISFORM.GRID3.COLUMN2.CONTROLSOURCE='SINPOO2.DATE_CODE'               
         THISFORM.GRID3.COLUMN3.HEADER1.CAPTION='LOT NO'
         THISFORM.GRID3.COLUMN3.WIDTH=INT_015*70
         THISFORM.GRID3.COLUMN3.CONTROLSOURCE='SINPOO2.LOT_NO'                         
         THISFORM.GRID3.SETFOCUS
      ENDPROC
      ***
     PROC GRID3.INIT      
	      THISFORM.GRID3.COLUMN1.READONLY=.T.
	      THISFORM.GRID3.COLUMN2.READONLY=.F.
	      THISFORM.GRID3.COLUMN3.READONLY=.F.
	
      ENDPROC
      ***
      PROC GRID3.AFTERROWCOLCHANGE
           LPARAMETERS XCOLINDEX
*!*	           FCH='GRID3'
      ENDPROC 
 PROCEDURE CMND1.CLICK
      SELECT SINPOO2
      GO TOP 
      DO WHILE !EOF()
         SELECT SINPOO1
         IF !EMPTY(ALLTRIM(SINPOO2.DATE_CODE))
             REPLACE DATE_CODE WITH SINPOO2.DATE_CODE FOR BOX_NO=SINPOO2.BOX_NO AND INV_NO=SINPOO2.INV_NO
             REPLACE LOT_NO WITH SINPOO2.LOT_NO FOR BOX_NO=SINPOO2.BOX_NO AND INV_NO=SINPOO2.INV_NO
         ENDIF    
         SELECT SINPOO2
         SKIP
      ENDDO
      SELECT SINPOO2
      USE
      THISFORM.RELEASE     
 ENDPROC
 PROCEDURE CMND2.CLICK
      SELECT SINPOO2
      USE
      THISFORM.RELEASE
 ENDPROC  
 **
 
ENDDEFINE  
************************
DEFINE CLASS GRID3 AS GRID 
      TOP=INT_015*30
      LEFT=10
      HEIGHT=INT_015*385
      WIDTH=INT_015*214
      HEADERHEIGHT=INT_015*19
      ROWHEIGHT=INT_015*18   
      DELETEMARK=.F.
      READONLY=.T.
      FONTBOLD=.T.  
*!*	      SPLITBAR=.F.
      ALLOWCELLSELECTION=.T.
      HIGHLIGHTROWLINEWIDTH=4
      ALLOWROWSIZING=.F.
      RECORDSOURCETYPE=1      
      NAME='GRID3'
      PROCEDURE INIT 
           ON KEY LABEL RIGHTMOUSE  DO remouse 
           THISFORM.SETALL('MOVABLE',.F.,'COLUMN')
*!*	            THISFORM.GRID1.BACKCOLOR=RGB(58,186,152)
      ENDPROC             
ENDDEFINE  
***************
