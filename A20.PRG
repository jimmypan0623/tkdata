***************資料維護設定檔****************
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
R=0
AREA1='A20'
AREA2='A22'
FLEN=0
***************開起相關基本檔***************
IF !USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
*!*	SEEK SYS_OPER+'A20'
*!*	GK=F03
IF !USED('A03')
   SELE 0
   USE A03
ELSE 
   SELE A03
ENDIF
SET ORDER TO A03
IF !USED('A20')
   SELE 0
   USE A20 INDE A20
ELSE 
   SELE A20
ENDIF
SET ORDER TO A20
IF !USED('A22')
   SELE 0
   USE A22 INDE A22
ELSE 
   SELE A22
ENDIF
SET ORDER TO A22
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE 
   SELE A02
ENDIF
SET ORDER TO A021
SEEK SYS_OPER+'A20'
GL=F04 &&新增欄位之權限
GM=F05 &&修改欄位之權限
GN=F06 &&刪除欄位之權限
GP=F07 &&列印欄位之權限
SET RELA TO F03 INTO A03
*************************建立表單A20FORM*************************         
A20FORM=CREATEOBJECT("TKA20")
A20FORM.SHOW  
DEFINE CLASS TKA20 AS FORM
  CAPTION='A20.資料維護設定檔'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKA20'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH; &&編輯區
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH; &&瀏覽區
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH; &&操作按鈕
      AUTOCENTER=.T.
*****************************設定PAGEFRAME**********************
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*200,;&&&
      FONTSIZE=INT_015*9,;      
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='依程式編號搜尋紀錄',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='詳細資料內容'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH; &&目前資料排序
      AUTOCENTER=.T.
******************************設定GRID1************************ 
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='A20',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'
******************************設定GRID2************************       
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=15,;            
      RECORDSOURCE='A22',;
      LINKMASTER='A20',;
      RELATIONALEXPR='F01',;
      CHILDORDER='A22',; 
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10',;
      COLUMN11.NAME='COLUMN11',;
      COLUMN12.NAME='COLUMN12',;
      COLUMN13.NAME='COLUMN13',; 
      COLUMN14.NAME='COLUMN14',;
      COLUMN15.NAME='COLUMN15'  
  ADD OBJECT CMDGROUP AS CMDGROUP WITH; &&搜尋或指向資料之按鈕
      AUTOSIZE=.T.
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;  &&操作鍵   
      AUTOSIZE=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH; &&確認鍵
      TOP=INT_015*165,;
      LEFT=INT_015*640 
*************************設定PAGE1***************************                
  PROCEDURE PAGEFRAME1.PAGE1.INIT   
  THIS.ADDOBJECT('LBLF01','LABEL') &&秀出資料檔名
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*27
          .WIDTH=INT_015*50
          .CAPTION='資料檔名'          
     ENDWITH
  THIS.ADDOBJECT('TXTF01','TEXTBOX')      
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*23
          .WIDTH=INT_015*35
          .HEIGHT=INT_015*20
          .MAXLENGTH=3          
     ENDWITH  
  THIS.ADDOBJECT('LBLF07','LABEL')  &&秀出用途描述 
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*65
          .WIDTH=INT_015*50
          .CAPTION='用途描述'    
     ENDWITH     
  THIS.ADDOBJECT('TXTF07','TEXTBOX')     
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*61
          .WIDTH=INT_015*200
          .HEIGHT=INT_015*20
          .MAXLENGTH=40       
     ENDWITH  
  THIS.ADDOBJECT('LBLF02','LABEL')  &&秀出檔案類別
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*103
          .WIDTH=INT_015*50
          .CAPTION='檔案類別'    
     ENDWITH
 THIS.ADDOBJECT('TXTF02','TEXTBOX')      
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*99
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*20
   ENDWITH
 THIS.ADDOBJECT('FILE_TYPE','FILE_TYPE')
 THIS.ADDOBJECT('LBLF03','LABEL')  &&秀出備註說明
     WITH THIS.LBLF03
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*141
          .WIDTH=INT_015*50
          .CAPTION='備註說明'    
     ENDWITH
 THIS.ADDOBJECT('TXTF03','TEXTBOX')      
     WITH THIS.TXTF03
          .VISIBLE=.T.
          .LEFT=INT_015*66
          .TOP=INT_015*137
          .WIDTH=INT_015*200
          .HEIGHT=INT_015*20
          .MAXLENGTH=30
   ENDWITH   
 THIS.ADDOBJECT('LBLF11','LABEL')  &&秀出欄位數目
     WITH THIS.LBLF11
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*27
          .WIDTH=INT_015*75
          .CAPTION='欄  位  數  目'   
     ENDWITH
   THIS.ADDOBJECT('TXTF11','TEXTBOX')     
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .LEFT=INT_015*376
          .TOP=INT_015*23
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*20
          .MAXLENGTH=2       
     ENDWITH  
  THIS.ADDOBJECT('LBLF12','LABEL')  &&秀出RECORD長度
     WITH THIS.LBLF12
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*65
          .WIDTH=INT_015*75
          .CAPTION='RECORD長度'    
     ENDWITH
   THIS.ADDOBJECT('TXTF12','TEXTBOX')      
     WITH THIS.TXTF12
          .VISIBLE=.T.
          .LEFT=INT_015*376
          .TOP=INT_015*61
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*20
          .MAXLENGTH=3         
     ENDWITH  
  THIS.ADDOBJECT('LBLF13','LABEL')  &&秀出最後修改日期
     WITH THIS.LBLF13
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*103
          .WIDTH=INT_015*55
          .CAPTION='安全資料'    
     ENDWITH     
  THIS.ADDOBJECT('LBLF131','LABEL')    
     WITH THIS.LBLF131
          .VISIBLE=.T.
          .LEFT=INT_015*360
          .TOP=INT_015*103
          .AUTOSIZE=.T.
          .CAPTION=''
     ENDWITH             
  ENDPROC
********************************設定PAGE2***************************    
  PROCEDURE PAGEFRAME1.PAGE2.INIT
 THIS.ADDOBJECT('LBLF01','LABEL') &&秀出欄位名稱
    WITH THIS.LBLF01
         .LEFT=INT_015*15
         .TOP=INT_015*22
         .CAPTION='欄位名稱'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
    ENDWITH
  THIS.ADDOBJECT('TXTF01','TEXTBOX') 
    WITH THIS.TXTF01
         .LEFT=INT_015*66
         .TOP=INT_015*16
         .WIDTH=INT_015*30      
         .HEIGHT=INT_015*20
         .MAXLENGTH=3
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('LBLF02','LABEL') &&秀出欄位型態
    WITH THIS.LBLF02
         .LEFT=INT_015*15
         .TOP=INT_015*55
         .CAPTION='欄位型態'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
     ENDWITH
  THIS.ADDOBJECT('TXTF02','TEXTBOX') 
    WITH THIS.TXTF02
         .LEFT=INT_015*66
         .TOP=INT_015*47
         .WIDTH=INT_015*80    
         .HEIGHT=INT_015*20
         .VISIBLE=.T.
     ENDWITH
THIS.ADDOBJECT('FIELD_TYPE','FIELD_TYPE')
THIS.ADDOBJECT('LBLF03','LABEL') &&秀出欄位長度
    WITH THIS.LBLF03
         .LEFT=INT_015*15
         .TOP=INT_015*88
         .CAPTION='欄位長度'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
    ENDWITH
THIS.ADDOBJECT('TXTF03','TEXTBOX') 
    WITH THIS.TXTF03
         .LEFT=INT_015*66
         .TOP=INT_015*80
         .WIDTH=INT_015*50     
         .HEIGHT=INT_015*20
         .MAXLENGTH=3
         .VISIBLE=.T.
    ENDWITH
THIS.ADDOBJECT('LBLF04','LABEL') &&秀出小數長度
    WITH THIS.LBLF04
         .LEFT=INT_015*15
         .TOP=INT_015*120
         .CAPTION='小數長度'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
    ENDWITH
 THIS.ADDOBJECT('TXTF04','TEXTBOX') 
    WITH THIS.TXTF04
         .LEFT=INT_015*66
         .TOP=INT_015*112
         .WIDTH=INT_015*50    
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
 THIS.ADDOBJECT('LBLF06','LABEL') &&秀出用途說明
    WITH THIS.LBLF06
         .LEFT=INT_015*15
         .TOP=INT_015*154
         .CAPTION='用途說明'
         .WIDTH=INT_015*50
         .VISIBLE=.T.
    ENDWITH
 THIS.ADDOBJECT('TXTF06','TEXTBOX') 
    WITH THIS.TXTF06
         .LEFT=INT_015*66
         .TOP=INT_015*146
         .WIDTH=INT_015*316      
         .HEIGHT=INT_015*20
         .MAXLENGTH=80
         .VISIBLE=.T.
    ENDWITH
********************************************************    
 THIS.ADDOBJECT('LBLF10','LABEL')&&秀出第1索引鍵值順序
    WITH THIS.LBLF10
         .LEFT=INT_015*260
         .TOP=INT_015*22
         .CAPTION='第1索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
 THIS.ADDOBJECT('TXTF10','TEXTBOX') 
    WITH THIS.TXTF10
         .LEFT=INT_015*351
         .TOP=INT_015*16
         .WIDTH=INT_015*30     
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
THIS.ADDOBJECT('LBLF11','LABEL')&&秀出第2索引鍵值順序
    WITH THIS.LBLF11
         .LEFT=INT_015*395
         .TOP=INT_015*22
         .CAPTION='第2索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
THIS.ADDOBJECT('TXTF11','TEXTBOX') 
    WITH THIS.TXTF11
         .LEFT=INT_015*486
         .TOP=INT_015*16
         .WIDTH=INT_015*30   
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('LBLF12','LABEL')&&秀出第3索引鍵值順序
    WITH THIS.LBLF12
         .LEFT=INT_015*260
         .TOP=INT_015*50
         .CAPTION='第3索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF12','TEXTBOX') 
    WITH THIS.TXTF12
         .LEFT=INT_015*351
         .TOP=INT_015*42
         .WIDTH=INT_015*30      
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('LBLF13','LABEL')&&秀出第4索引鍵值順序
    WITH THIS.LBLF13
         .LEFT=INT_015*395
         .TOP=INT_015*50
         .CAPTION='第4索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF13','TEXTBOX') 
    WITH THIS.TXTF13
         .LEFT=INT_015*486
         .TOP=INT_015*42
         .WIDTH=INT_015*30    
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('LBLF14','LABEL')&&秀出第5索引鍵值順序
    WITH THIS.LBLF14
         .LEFT=INT_015*260
         .TOP=INT_015*76
         .CAPTION='第5索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF14','TEXTBOX') 
    WITH THIS.TXTF14
         .LEFT=INT_015*351
         .TOP=INT_015*68
         .WIDTH=INT_015*30      
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('LBLF15','LABEL')&&秀出第6索引鍵值順序
    WITH THIS.LBLF15
         .LEFT=INT_015*395
         .TOP=INT_015*76
         .CAPTION='第6索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF15','TEXTBOX') 
    WITH THIS.TXTF15
         .LEFT=INT_015*486
         .TOP=INT_015*68
         .WIDTH=INT_015*30     
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('LBLF16','LABEL')&&秀出第7索引鍵值順序
    WITH THIS.LBLF16
         .LEFT=INT_015*260
         .TOP=INT_015*102
         .CAPTION='第7索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF16','TEXTBOX') 
    WITH THIS.TXTF16
         .LEFT=INT_015*351
         .TOP=INT_015*94
         .WIDTH=INT_015*30     
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
THIS.ADDOBJECT('LBLF17','LABEL')&&秀出第8索引鍵值順序
    WITH THIS.LBLF17
         .LEFT=INT_015*395
         .TOP=INT_015*102
         .CAPTION='第8索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF17','TEXTBOX') 
    WITH THIS.TXTF17
         .LEFT=INT_015*486
         .TOP=INT_015*94
         .WIDTH=INT_015*30     
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH
     THIS.ADDOBJECT('LBLF18','LABEL')&&秀出第9索引鍵值順序
    WITH THIS.LBLF18
         .LEFT=INT_015*260
         .TOP=INT_015*128
         .CAPTION='第9索引鍵值順序'
         .WIDTH=INT_015*90
         .VISIBLE=.T.
    ENDWITH
    THIS.ADDOBJECT('TXTF18','TEXTBOX') 
    WITH THIS.TXTF18
         .LEFT=INT_015*351
         .TOP=INT_015*120
         .WIDTH=INT_015*30     
         .HEIGHT=INT_015*20
         .MAXLENGTH=1
         .VISIBLE=.T.
    ENDWITH          
*!*	     THIS.ADDOBJECT('LBLF19','LABEL')&&秀出第10索引鍵值順序
*!*	    WITH THIS.LBLF19
*!*	         .LEFT=INT_015*390
*!*	         .TOP=INT_015*128
*!*	         .CAPTION='第10索引鍵值順序'
*!*	         .WIDTH=INT_015*95
*!*	         .VISIBLE=.T.
*!*	    ENDWITH
*!*	    THIS.ADDOBJECT('TXTF19','TEXTBOX') 
*!*	    WITH THIS.TXTF19
*!*	         .LEFT=INT_015*486
*!*	         .TOP=INT_015*120
*!*	         .WIDTH=INT_015*30     
*!*	         .HEIGHT=INT_015*20
*!*	         .MAXLENGTH=1
*!*	         .VISIBLE=.T.
*!*	    ENDWITH       
  THIS.ADDOBJECT('LBLF20','LABEL') &&秀出建立日期
    WITH THIS.LBLF20
         .VISIBLE=.T.           
         .LEFT=INT_015*390
         .TOP=INT_015*154
         .WIDTH=INT_015*55
         .CAPTION='安全資料'          
         .VISIBLE=.T.
    ENDWITH     
   THIS.ADDOBJECT('LBLF201','LABEL') 
    WITH THIS.LBLF201
         .LEFT=INT_015*440
         .TOP=INT_015*154
         .AUTOSIZE=.T.    
         .VISIBLE=.T.
         .CAPTION=''   
    ENDWITH  
  ENDPROC
******************設定物件屬性****************
PROC INIT
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限       
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')        
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*150
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='資料檔名'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='用途描述'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A20.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='A20.F07'
           THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
           THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')
           THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='欄位名稱'                                         
           THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='欄位型態'
           THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='欄位長度'   
           THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='小數長度' 
           THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='用途說明' 
	   THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='第1索引鍵'        	   
	   THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='第2索引鍵'
	   THISFORM.GRID2.COLUMN8.HEADER1.CAPTION='第3索引鍵'
	   THISFORM.GRID2.COLUMN9.HEADER1.CAPTION='第4索引鍵'
	   THISFORM.GRID2.COLUMN10.HEADER1.CAPTION='第5索引鍵'
	   THISFORM.GRID2.COLUMN11.HEADER1.CAPTION='第6索引鍵'
	   THISFORM.GRID2.COLUMN12.HEADER1.CAPTION='第7索引鍵'
	   THISFORM.GRID2.COLUMN13.HEADER1.CAPTION='第8索引鍵'
	   THISFORM.GRID2.COLUMN14.HEADER1.CAPTION='第9索引鍵'
	   THISFORM.GRID2.COLUMN15.HEADER1.CAPTION='安全資料' 
	   THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A22.F01'
	   THISFORM.GRID2.COLUMN2.CONTROLSOURCE='BILL(A22.F02)'
	   THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A22.F03'
	   THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A22.F04'
	   THISFORM.GRID2.COLUMN5.CONTROLSOURCE='A22.F06'	  
	   THISFORM.GRID2.COLUMN6.CONTROLSOURCE='A22.F10'
	   THISFORM.GRID2.COLUMN7.CONTROLSOURCE='A22.F11'
	   THISFORM.GRID2.COLUMN8.CONTROLSOURCE='A22.F12'
	   THISFORM.GRID2.COLUMN9.CONTROLSOURCE='A22.F13'
	   THISFORM.GRID2.COLUMN10.CONTROLSOURCE='A22.F14'
	   THISFORM.GRID2.COLUMN11.CONTROLSOURCE='A22.F15'
	   THISFORM.GRID2.COLUMN12.CONTROLSOURCE='A22.F16'
	   THISFORM.GRID2.COLUMN13.CONTROLSOURCE='A22.F17'
	   THISFORM.GRID2.COLUMN14.CONTROLSOURCE='A22.F18'
	   THISFORM.GRID2.COLUMN15.CONTROLSOURCE='A22.F20'  
	   THISFORM.GRID2.COLUMN1.WIDTH=INT_015*50
	   THISFORM.GRID2.COLUMN2.WIDTH=INT_015*50
	   THISFORM.GRID2.COLUMN3.WIDTH=INT_015*50
	   THISFORM.GRID2.COLUMN4.WIDTH=INT_015*50
	   THISFORM.GRID2.COLUMN5.WIDTH=INT_015*200
	   THISFORM.GRID2.COLUMN6.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN7.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN8.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN9.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN10.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN11.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN12.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN13.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN14.WIDTH=INT_015*55
	   THISFORM.GRID2.COLUMN15.WIDTH=INT_015*75
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID2.READONLY=.T.          
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
       	  THISFORM.CMDGROUP.ENABLED=.F.
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
       ELSE  
           THISFORM.CMDGROUP.ENABLED=.T.      
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
           THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限  
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限 
       ENDIF          
       THISFORM.KEY_LIST.DISPLAYVALUE='依資料檔名排列'       
       JK='資料檔名'       
       SELE A20
        GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A20.F01
*!*	       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=A20.F07
  ENDPROC     
******************設定PAGE1之動態動作******************        
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
       SELE A20
     IF THISFORM.SHRGROUP.VISIBLE=.F.
	 THISFORM.GRID1.ENABLED=.T.       
        THISFORM.GRID1.SETFOCUS 
	     THISFORM.KEY_LIST.ENABLED=.T. 
     ELSE
     	     THISFORM.KEY_LIST.ENABLED=.F.   
     ENDIF
     R=0
    IF THISFORM.GRID1.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.LBLF131.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F. 
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限
        THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
     ENDIF
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)   &&判斷有無新增的權限
   ENDPROC
*****************設定PAGE2之動態動作***********
PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
     SELE A22
     IF THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.GRID2.READONLY=.T.   
	THISFORM.GRID2.SETFOCUS         
     ENDIF 
    IF THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE=''
*!*	        THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE=''
        THISFORM.PAGEFRAME1.PAGE2.LBLF201.CAPTION=''
    ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限        
    ENDIF 
	R=RECNO('&AREA1')  
	THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
        THISFORM.GRID1.ENABLED=.F.     
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)   &&判斷有無新增的權限
        THISFORM.KEY_LIST.ENABLED=.F.     
ENDPROC 
***************GRID1動態改變*********        
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
          SELECT A20
          THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A20.F01
          THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=A20.F07
          THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=BILL(A20.F02)
          THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE=A20.F03
          THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=A20.F11
          THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=A20.F12
          THISFORM.PAGEFRAME1.PAGE1.LBLF131.CAPTION=A20.F13
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限         
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION  
       IF THIS.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
       ENDIF   
       CHK=''     
*!*	      THISFORM.REFRESH
  ENDPROC  
***************GRID2動態改變***************       
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX        
       SELECT A22            
       THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE=A22.F01
       THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=BILL(A22.F02)
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A22.F03
       THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A22.F04
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=A22.F06
       THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=A22.F10
       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=A22.F11
       THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=A22.F12
       THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=A22.F13
       THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=A22.F14
       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=A22.F15
       THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE=A22.F16
       THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE=A22.F17
       THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE=A22.F18
*!*	       THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE=A22.F19
       THISFORM.PAGEFRAME1.PAGE2.LBLF201.CAPTION=A22.F20
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ENDIF  
*!*	       THISFORM.REFRESH
  ENDPROC
  ********************************************      
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依資料檔名排列')
       ENDWITH      
  ENDPROC
**************新增鍵******************  
PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
     THISFORM.KEY_LIST.ENABLED=.F.
     THISFORM.GRID1.ENABLED=.F.   
     THISFORM.GRID2.ENABLED=.F.  
    IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1 &&處理表頭新增
       THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
       THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX') 
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS       
       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VISIBLE=.F.
       THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.VISIBLE=.T.
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=''
       THISFORM.PAGEFRAME1.PAGE1.TXTF11.READONLY=.T.
       THISFORM.PAGEFRAME1.PAGE1.TXTF12.READONLY=.T.
       THISFORM.PAGEFRAME1.PAGE1.LBLF131.CAPTION=DTOC(DATE())
     ELSE
       THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.	&&處理表身新增
       THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'TEXTBOX')  
       THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
       THISFORM.PAGEFRAME1.PAGE2.TXTF02.VISIBLE=.F.
       THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VISIBLE=.T.
       THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=1
       THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
       THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE='' 
       THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0
       THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='' 
       THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE='' 
       THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE=''
*!*	       THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE=''
       THISFORM.PAGEFRAME1.PAGE2.LBLF201.CAPTION=DTOC(DATE())
      ENDIF
   ENDPROC
***********************新增之確認******************** 
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
  IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1  &&表頭確認
      SELE A20
     COD=SYS(21)
     DO CASE	 
    	    CASE EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)     
                       =MESSAGEBOX('資料檔名不得空白!',0+64,'提示視窗')
      		      THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
      		      SET ORDER TO &COD
                      RETURN
    	    CASE SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'A20')=.T.     
                       =MESSAGEBOX('此資料檔名已登錄,請重新輸入新的資料檔名!',0+64,'提示視窗')
      		       THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
      		       SET ORDER TO &COD
                       RETURN
            CASE   LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE))<3
            		=MESSAGEBOX('資料檔名長度不能小於3碼!',0+64,'提示視窗')
            		THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
            		SET ORDER TO &COD
                    	RETURN
            CASE  ASC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)<65  .OR.  ASC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)>90
            		 =MESSAGEBOX('資料檔名第1碼須為大寫英文字母A~Z!',0+64,'提示視窗')
            		THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
            		SET ORDER TO &COD
                    	RETURN      	
      ENDCASE
      SELE A20
      APPEND BLANK
       LOCK()
        IF RLOCK()
   	    REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
   	    REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE
            REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
            REPLACE F13 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
           DO CASE  
                   CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="基本檔"
              	              REPLACE F02 WITH   '0'
              	   CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="月份檔"
              	              REPLACE F02 WITH   '1'
              	   CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="奇月檔"
              	              REPLACE F02 WITH   '3'           
              	   CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="暫存檔"
              	              REPLACE F02 WITH   '9'
              	   CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="系統檔"
              	              REPLACE F02 WITH   'z'
             ENDCASE
             SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
       	     SET ORDER TO &COD
            THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
      	    THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.  
            THISFORM.PAGEFRAME1.ACTIVEPAGE=2
            THISFORM.ORPGROUP.NEW_BOTT.CLICK
            THISFORM.REFRESH
         ENDIF 
      * UNLOCK
  ELSE 		&&表身確認
     SELE A22
     COD=SYS(21)
      DO CASE                
             CASE EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE)     
                       =MESSAGEBOX('欄位名稱不得空白!',0+64,'提示視窗')
      		       THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
      		       SET ORDER TO &COD
                       RETURN
            CASE LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE))<3
            		=MESSAGEBOX('欄位名稱長度不能小於3碼!',0+64,'提示視窗')
            		THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
            		SET ORDER TO &COD
                    	RETURN
             CASE  ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE)!=70  
            		 =MESSAGEBOX('欄位名稱第1碼須為大寫英文字母F!',0+64,'提示視窗')
            		 THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
            		 SET ORDER TO &COD
                    	 RETURN                  	          	 
	     CASE   IIF(SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE,'A22'),.T.,.F.)
     			  =MESSAGEBOX('此欄位名稱已有資料,請重新輸入新的欄位名稱!',0+64,'提示視窗')
            		 THISFORM.PAGEFRAME1.PAGE2.TXTF01.SETFOCUS
                    	 RETURN    
                    	 SET ORDER TO &COD   
          ENDCASE
**************判別索引值1********************
   IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE)
   	  SELECT F10 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F10) INTO CURSOR A22A
	  INDEX ON F10 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE),97,122)=.T.
              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
              THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
               RETURN 
               SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F10),65,90)=.T.  &&判斷資料是否為英文索引
              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE),65,90)=.T.&&判斷輸入是否為英文
                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE,'A22A'),.T.,.F.)=.T.
    	                 =MESSAGEBOX('此索引順序已在第1索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
    	                 RETURN
    	                 SET ORDER TO &COD 
    	           ENDIF    
             ELSE
	            =MESSAGEBOX('第1索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	            THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
	            RETURN
	           SET ORDER TO &COD 
              ENDIF
         ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE,'A22A'),.T.,.F.)=.T.
    	               =MESSAGEBOX('此索引順序已在第1索引鍵值中使用請重新指定',0+64,'提示視窗')
    	               THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
    	                RETURN
    	                SET ORDER TO &COD 
    	          ENDIF    
             ELSE
	     	   =MESSAGEBOX('第1索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		   THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
	     	    RETURN
	     	    SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
**************判別索引值2********************
  IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
   	  SELECT F11 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F11) INTO CURSOR A22A
	  INDEX ON F11 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE),97,122)=.T.
        	   =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
        	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
        	   RETURN 
        	   SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F11),65,90)=.T.  &&判斷資料是否為英文索引
         	IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE),65,90)=.T.&&判斷輸入是否為英文
                     IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,'A22A'),.T.,.F.)=.T.
    	                  =MESSAGEBOX('此索引順序已在第2索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                  THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
    	                  RETURN
    	                  SET ORDER TO &COD 
    	              ENDIF    
          	ELSE
	   	        =MESSAGEBOX('第2索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
		        THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
	   	        RETURN
	   	        SET ORDER TO &COD 
        	ENDIF
        ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,'A22A'),.T.,.F.)=.T.
    	              =MESSAGEBOX('此索引順序已在第2索引鍵值中使用請重新指定',0+64,'提示視窗')
    	              THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
    	              RETURN
    	              SET ORDER TO &COD 
    	         ENDIF    
       	    ELSE
	     	  =MESSAGEBOX('第2索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		  THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
	     	  RETURN
	     	  SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
*!*	**************判別索引值3********************
 IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE)
   	  SELECT F12 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F12) INTO CURSOR A22A
	  INDEX ON F12 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE),97,122)=.T.
              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
              THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
               RETURN 
               SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F12),65,90)=.T.  &&判斷資料是否為英文索引
              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE),65,90)=.T.&&判斷輸入是否為英文
                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE,'A22A'),.T.,.F.)=.T.
    	                 =MESSAGEBOX('此索引順序已在第3索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
    	                 RETURN
    	                 SET ORDER TO &COD 
    	           ENDIF    
             ELSE
	            =MESSAGEBOX('第3索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	            THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
	            RETURN
	           SET ORDER TO &COD 
              ENDIF
         ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE,'A22A'),.T.,.F.)=.T.
    	               =MESSAGEBOX('此索引順序已在第3索引鍵值中使用請重新指定',0+64,'提示視窗')
    	               THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
    	                RETURN
    	                SET ORDER TO &COD 
    	          ENDIF    
             ELSE
	     	   =MESSAGEBOX('第3索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		   THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
	     	    RETURN
	     	    SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
*!*	**************判別索引值4********************
 IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE)
   	  SELECT F13 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F13) INTO CURSOR A22A
	  INDEX ON F13 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE),97,122)=.T.
              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
              THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
               RETURN 
               SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F13),65,90)=.T.  &&判斷資料是否為英文索引
              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE),65,90)=.T.&&判斷輸入是否為英文
                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE,'A22A'),.T.,.F.)=.T.
    	                 =MESSAGEBOX('此索引順序已在第4索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
    	                 RETURN
    	                 SET ORDER TO &COD 
    	           ENDIF    
             ELSE
	            =MESSAGEBOX('第4索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	            THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
	            RETURN
	           SET ORDER TO &COD 
              ENDIF
         ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE,'A22A'),.T.,.F.)=.T.
    	               =MESSAGEBOX('此索引順序已在第4索引鍵值中使用請重新指定',0+64,'提示視窗')
    	               THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
    	                RETURN
    	                SET ORDER TO &COD 
    	          ENDIF    
             ELSE
	     	   =MESSAGEBOX('第4索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		   THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
	     	    RETURN
	     	    SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
*!*	**************判別索引值5********************
IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE)
   	 SELECT F14 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F14) INTO CURSOR A22A
	 INDEX ON F14 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE),97,122)=.T.
              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
              THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
               RETURN 
               SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F14),65,90)=.T.  &&判斷資料是否為英文索引
              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE),65,90)=.T.&&判斷輸入是否為英文
                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE,'A22A'),.T.,.F.)=.T.
    	                 =MESSAGEBOX('此索引順序已在第5索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
    	                 RETURN
    	                 SET ORDER TO &COD 
    	           ENDIF    
             ELSE
	            =MESSAGEBOX('第5索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	            THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
	            RETURN
	           SET ORDER TO &COD 
              ENDIF
         ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE,'A22A'),.T.,.F.)=.T.
    	               =MESSAGEBOX('此索引順序已在第5索引鍵值中使用請重新指定',0+64,'提示視窗')
    	               THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
    	                RETURN
    	                SET ORDER TO &COD 
    	          ENDIF    
             ELSE
	     	   =MESSAGEBOX('第5索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		   THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
	     	    RETURN
	     	    SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
*!*	**************判別索引值6********************
IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE)
   	  SELECT F15 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F15) INTO CURSOR A22A
	  INDEX ON F15 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),97,122)=.T.
              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
              THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
               RETURN 
               SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F15),65,90)=.T.  &&判斷資料是否為英文索引
              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),65,90)=.T.&&判斷輸入是否為英文
                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE,'A22A'),.T.,.F.)=.T.
    	                 =MESSAGEBOX('此索引順序已在第6索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
    	                 RETURN
    	                 SET ORDER TO &COD 
    	           ENDIF    
             ELSE
	            =MESSAGEBOX('第6索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	            THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
	            RETURN
	           SET ORDER TO &COD 
              ENDIF
         ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE,'A22A'),.T.,.F.)=.T.
    	               =MESSAGEBOX('此索引順序已在第6索引鍵值中使用請重新指定',0+64,'提示視窗')
    	               THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
    	                RETURN
    	                SET ORDER TO &COD 
    	          ENDIF    
             ELSE
	     	   =MESSAGEBOX('第6索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		   THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
	     	    RETURN
	     	    SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
*!*	**************判別索引值7********************
IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE)
   	  SELECT F16 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F16) INTO CURSOR A22A
	  INDEX ON F16 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE),97,122)=.T.
              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
              THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
               RETURN 
               SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F16),65,90)=.T.  &&判斷資料是否為英文索引
              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE),65,90)=.T.&&判斷輸入是否為英文
                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE,'A22A'),.T.,.F.)=.T.
    	                 =MESSAGEBOX('此索引順序已在第7索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
    	                 RETURN
    	                 SET ORDER TO &COD 
    	           ENDIF    
             ELSE
	            =MESSAGEBOX('第7索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	            THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
	            RETURN
	           SET ORDER TO &COD 
              ENDIF
         ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE,'A22A'),.T.,.F.)=.T.
    	               =MESSAGEBOX('此索引順序已在第7索引鍵值中使用請重新指定',0+64,'提示視窗')
    	               THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
    	                RETURN
    	                SET ORDER TO &COD 
    	          ENDIF    
             ELSE
	     	   =MESSAGEBOX('第7索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		   THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
	     	    RETURN
	     	    SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
*!*	**************判別索引值8********************
IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE)
   	  SELECT F17 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F17) INTO CURSOR A22A
	  INDEX ON F17 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE),97,122)=.T.
              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
              THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
               RETURN 
               SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F17),65,90)=.T.  &&判斷資料是否為英文索引
              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE),65,90)=.T.&&判斷輸入是否為英文
                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE,'A22A'),.T.,.F.)=.T.
    	                 =MESSAGEBOX('此索引順序已在第8索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
    	                 RETURN
    	                 SET ORDER TO &COD 
    	           ENDIF    
             ELSE
	            =MESSAGEBOX('第8索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	            THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
	            RETURN
	           SET ORDER TO &COD 
              ENDIF
         ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE,'A22A'),.T.,.F.)=.T.
    	               =MESSAGEBOX('此索引順序已在第8索引鍵值中使用請重新指定',0+64,'提示視窗')
    	               THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
    	                RETURN
    	                SET ORDER TO &COD 
    	          ENDIF    
             ELSE
	     	   =MESSAGEBOX('第8索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		   THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
	     	    RETURN
	     	    SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
*!*	 **************判別索引值9********************
IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE)
   	  SELECT F18 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F18) INTO CURSOR A22A
	  INDEX ON F18 TAG A22A1
         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE),97,122)=.T.
              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
              THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
               RETURN 
               SET ORDER TO &COD 
         ENDIF	   
         IF  BETWEEN(ASC(A22A.F18),65,90)=.T.  &&判斷資料是否為英文索引
              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE),65,90)=.T.&&判斷輸入是否為英文
                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE,'A22A'),.T.,.F.)=.T.
    	                 =MESSAGEBOX('此索引順序已在第9索引鍵值中使用請重新指定',0+64,'提示視窗')
    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
    	                 RETURN
    	                 SET ORDER TO &COD 
    	           ENDIF    
             ELSE
	            =MESSAGEBOX('第9索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	            THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
	            RETURN
	           SET ORDER TO &COD 
              ENDIF
         ELSE	   &&否則資料則是數字索引
             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE,'A22A'),.T.,.F.)=.T.
    	               =MESSAGEBOX('此索引順序已在第9索引鍵值中使用請重新指定',0+64,'提示視窗')
    	               THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
    	                RETURN
    	                SET ORDER TO &COD 
    	          ENDIF    
             ELSE
	     	   =MESSAGEBOX('第9索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
		   THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
	     	    RETURN
	     	    SET ORDER TO &COD
            ENDIF 
  	ENDIF
  ENDIF  
*!*	*!*	 **************判別索引值10********************
*!*	IF  !EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE)
*!*	   	  SELECT F19 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F19) INTO CURSOR A22A
*!*		  INDEX ON F19 TAG A22A1
*!*	         IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE),97,122)=.T.
*!*	              =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
*!*	              THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*	               RETURN 
*!*	               SET ORDER TO &COD 
*!*	         ENDIF	   
*!*	         IF  BETWEEN(ASC(A22A.F19),65,90)=.T.  &&判斷資料是否為英文索引
*!*	              IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE),65,90)=.T.&&判斷輸入是否為英文
*!*	                    IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE,'A22A'),.T.,.F.)=.T.
*!*	    	                 =MESSAGEBOX('此索引順序已在第10索引鍵值中使用請重新指定',0+64,'提示視窗')
*!*	    	                 THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*	    	                 RETURN
*!*	    	                 SET ORDER TO &COD 
*!*	    	           ENDIF    
*!*	             ELSE
*!*		            =MESSAGEBOX('第10索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
*!*		            THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*		            RETURN
*!*		           SET ORDER TO &COD 
*!*	              ENDIF
*!*	         ELSE	   &&否則資料則是數字索引
*!*	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE),1,9)=.T.&&判斷輸入是否為數字
*!*	        	  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE,'A22A'),.T.,.F.)=.T.
*!*	    	               =MESSAGEBOX('此索引順序已在第10索引鍵值中使用請重新指定',0+64,'提示視窗')
*!*	    	               THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*	    	                RETURN
*!*	    	                SET ORDER TO &COD 
*!*	    	          ENDIF    
*!*	             ELSE
*!*		     	   =MESSAGEBOX('第10索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
*!*			   THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*		     	    RETURN
*!*		     	    SET ORDER TO &COD
*!*	            ENDIF 
*!*	  	ENDIF
*!*	  ENDIF    
***************************************
 	SELE A22
       APPEND BLANK
       LOCK()
       IF RLOCK()
          REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE
          REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
          REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
          REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
          REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
          REPLACE F10 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE)
          REPLACE F11 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
          REPLACE F12 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE)
          REPLACE F13 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE)
          REPLACE F14 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE)
          REPLACE F15 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE)
          REPLACE F16 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE)
          REPLACE F17 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE)
          REPLACE F18 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE)
*!*	          REPLACE F19 WITH UPPER(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE)
          REPLACE F20 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
          DO  CASE  
                      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=1
              	                 REPLACE F02 WITH   'C'
              	      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=2
              	                 REPLACE F02 WITH   'D'
              	      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=3
              	                 REPLACE F02 WITH   'T'
              	      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=4
              	                 REPLACE F02 WITH   'N'
              	      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=5
              	                 REPLACE F02 WITH   'F' 
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=6
  	                         REPLACE F02 WITH   'I'    
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=7
  	                         REPLACE F02 WITH   'B'    
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=8
  	                         REPLACE F02 WITH   'Y'    
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=9
  	                         REPLACE F02 WITH   'L'    
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=10
  	                         REPLACE F02 WITH   'M'
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=11
              	                 REPLACE F02 WITH   'G'         
          ENDCASE
          THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
      	  THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.  
          THISFORM.PAGEFRAME1.ACTIVEPAGE=2
          THISFORM.ORPGROUP.NEW_BOTT.CLICK
          THISFORM.REFRESH
          UNLOCK
        ENDIF 
        ***欄位數
	SELECT A22.F01,A22.F05 FROM A22 WHERE A22.F05=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)  INTO CURSOR A22_2
		SELECT A20
		SEEK A22_2.F05
		IF FOUND()
		    REPLACE F11 WITH RECCOUNT('A22_2')
		ENDIF
	 **RECORD數
        SELECT  A22.F05,SUM(A22.F03) FROM A22 ORDER BY A22.F05 GROUP BY A22.F05 WHERE A22.F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  INTO CURSOR A22_1 
		 SELECT A20
		 SEEK A22_1.F05
		IF FOUND()
		    REPLACE F12 WITH A22_1.SUM_F03
		ENDIF	
      UNLOCK 
 ENDIF
ENDPROC
*****************修改***********
PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
   THISFORM.KEY_LIST.ENABLED=.F. 
   THISFORM.GRID1.ENABLED=.F. 
   THISFORM.GRID2.ENABLED=.F. 
   IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1 
   	THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F. 
        THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX')  &&表頭修改
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTF07.SETFOCUS
        THISFORM.PAGEFRAME1.PAGE1.TXTF02.VISIBLE=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTF11.READONLY=.T.
        THISFORM.PAGEFRAME1.PAGE1.TXTF12.READONLY=.T.
        THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.VISIBLE=.T.
        THISFORM.PAGEFRAME1.PAGE1.LBLF131.CAPTION=DTOC(DATE())
        DO CASE  
                   CASE THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE='基本檔'
              	              THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.VALUE=1
              	   CASE THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE='月份檔'
              	              THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.VALUE=2
              	    CASE THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE='奇月檔'
              	              THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.VALUE=3         
              	   CASE THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE='暫存檔'
              	              THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.VALUE=4
              	   CASE THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE='系統檔'
              	              THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.VALUE=5
             ENDCASE                      
         LOCK()
         IF !RLOCK()
              DO FILE_IMPACT
              RETURN
         ENDIF   
   ELSE  &&表身修改
         FLEN=THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE &&為更改前的欄位長度
        THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF01.ENABLED=.F. 
        THISFORM.PAGEFRAME1.PAGE2.TXTF02.VISIBLE=.F.
        THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VISIBLE=.T.
        THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.SETFOCUS
        THISFORM.PAGEFRAME1.PAGE2.LBLF201.CAPTION=DTOC(DATE())
         DO CASE  
                   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='字元'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=1
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='日期'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=2
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='時間日期'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=3
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='數值'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=4
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.F.
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='浮點數'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=5
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.F.
           	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='整數'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=6 
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.          
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='倍精準數'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=7
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.F.
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='貨幣'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=8
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.             
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='邏輯'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=9
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='備註'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=10
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T. 
              	   CASE ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE)='通用'
              	              THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=11
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
              	              THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.                                                
             ENDCASE 
         LOCK() 
         IF !RLOCK()
              DO FILE_IMPACT
              RETURN
         ENDIF          
   ENDIF
 ENDPROC
*****************修改之確認***********
 PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
    IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
          SELE A20  &&表頭修改確認
 	  IF RLOCK()
 	  	 REPL F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF03.VALUE
                 REPL F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
                 REPL F13 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
                 DO CASE  
                        CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="基本檔"
              	                   REPLACE F02 WITH   '0'
              	        CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="月份檔"
              	                   REPLACE F02 WITH   '1'
              	        CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="奇月檔"
              	                   REPLACE F02 WITH   '3'           
              	        CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="暫存檔"
              	                   REPLACE F02 WITH   '9'
              	        CASE THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.DISPLAYVALUE="系統檔"
              	                   REPLACE F02 WITH   'z'
                  ENDCASE  
           ELSE 
                 DO   FILE_IMPACT
                 RETURN    
           ENDIF
    ELSE        &&表身修改確認 
          SELE A22
          IF  RLOCK()
               REPL F01 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE
               REPL F03 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE
               REPL F04 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE
*!*	               REPL F05 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
               REPL F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
               REPL F20 WITH DTOC(DATE())
               DO  CASE  
                      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=1
              	                 REPLACE F02 WITH   'C'
              	      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=2
              	                 REPLACE F02 WITH   'D'
              	      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=3
              	                 REPLACE F02 WITH   'T'
              	      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=4
              	                 REPLACE F02 WITH   'N'
              	      CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=5
              	                 REPLACE F02 WITH   'F' 
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=6
  	                         REPLACE F02 WITH   'I'    
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=7
  	                         REPLACE F02 WITH   'B'    
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=8
  	                         REPLACE F02 WITH   'Y'    
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=9
  	                         REPLACE F02 WITH   'L'    
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=10
  	                         REPLACE F02 WITH   'M'
  	              CASE THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VALUE=11
              	                 REPLACE F02 WITH   'G'         
            ENDCASE  
            **************判別索引值1********************
            IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F10=THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE)
            	  SELECT A22
                  REPLACE A22.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
           ELSE
                  SELECT F10 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F10) INTO CURSOR A22A
 		  INDEX ON F10 TAG A22A1
 		  IF RECCOUNT('A22A')=0 
                       SELE A22     
   	               REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F10),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第1索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第1索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第1索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第1索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF          
**************判別索引值2********************
           IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F11=THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
            	  SELECT A22
                  REPLACE A22.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
           ELSE
                  SELECT F11 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F11) INTO CURSOR A22A
 		  INDEX ON F11 TAG A22A1
 		  IF RECCOUNT('A22A')=0
                       SELE A22     
   	               REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F11),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第2索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第2索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第2索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第2索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF                   
*!*	**************判別索引值3********************
            IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F12=THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE)
            	  SELECT A22
                  REPLACE A22.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE
           ELSE
                  SELECT F12 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F12) INTO CURSOR A22A
 		  INDEX ON F12 TAG A22A1
 		  IF RECCOUNT('A22A')=0 
                       SELE A22     
   	               REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F12),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第3索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第3索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第3索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第3索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF                               
*!*	**************判別索引值4********************
           IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F13=THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE)
            	  SELECT A22
                  REPLACE A22.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
           ELSE
                  SELECT F13 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F13) INTO CURSOR A22A
 		  INDEX ON F13 TAG A22A1
 		  IF RECCOUNT('A22A')=0 
                       SELE A22     
   	               REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F13),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第4索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第4索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第4索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第4索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF                   
*!*	**************判別索引值5********************
           IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F14=THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE)
                  SELECT A22
                  REPLACE A22.F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
           ELSE
                  SELECT F14 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F14) INTO CURSOR A22A
 		  INDEX ON F14 TAG A22A1
 		  IF RECCOUNT('A22A')=0 
                       SELE A22     
   	               REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F14),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第5索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第5索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第5索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第5索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF14.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF                
*!*	**************判別索引值6********************
           IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F15=THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE)
                 SELECT A22
                 REPLACE A22.F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE
           ELSE
                  SELECT F15 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F15) INTO CURSOR A22A
 		  INDEX ON F15 TAG A22A1
 		  IF RECCOUNT('A22A')=0 
                       SELE A22     
   	               REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F15),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第6索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第6索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第6索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第6索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF                           
*!*	**************判別索引值7********************
          IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F16=THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE)
                  SELECT A22
                  REPLACE A22.F16 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE
           ELSE
                  SELECT F16 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F16) INTO CURSOR A22A
 		  INDEX ON F16 TAG A22A1
 		  IF RECCOUNT('A22A')=0
                       SELE A22     
   	               REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F16),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第7索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第7索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第7索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第7索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF16.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF   
*!*	**************判別索引值8********************
          IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F17=THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE)
                  SELECT A22
                  REPLACE A22.F17 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE
           ELSE
                  SELECT F17 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F17) INTO CURSOR A22A
 		  INDEX ON F17 TAG A22A1
 		  IF RECCOUNT('A22A')=0
                       SELE A22     
   	               REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F17),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第8索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第8索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第8索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第8索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF17.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF    
*!*	**************判別索引值9********************
          IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE),97,122)=.T.
                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
                 THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
                 RETURN
            ENDIF	   
            IF  (A22.F18=THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE)
                  SELECT A22
                  REPLACE A22.F18 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE
           ELSE
                  SELECT F18 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F18) INTO CURSOR A22A
 		  INDEX ON F18 TAG A22A1
 		  IF RECCOUNT('A22A')=0
                       SELE A22     
   	               REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE
		  ELSE
            	       IF  BETWEEN(ASC(A22A.F18),65,90)=.T.	&&判斷資料是否為英文索引
            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE),65,90)=.T.&&判斷輸入是否為英文
            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE,'A22A'),.T.,.F.)=.T.
		    	                =MESSAGEBOX('此索引順序已在第9索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	                THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
		    	                 RETURN
		    	                *SET ORDER TO &COD 
				   ENDIF
		    	     ELSE   
		    	           =MESSAGEBOX('第9索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
	           		   THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
	          		   RETURN
	           		  *SET ORDER TO &COD  
            	             ENDIF
            	       ELSE  &&否則資料則是數字索引
            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE),1,9)=.T.&&判斷輸入是否為數字
        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE,'A22A'),.T.,.F.)=.T.
		    	               =MESSAGEBOX('此索引順序已在第9索引鍵值中使用請重新指定',0+64,'提示視窗')
		    	              THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
		    	               RETURN
		    	                   *SET ORDER TO &COD 
		    	          ENDIF    
		            ELSE
			          =MESSAGEBOX('第9索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
				  THISFORM.PAGEFRAME1.PAGE2.TXTF18.SETFOCUS
			     	  RETURN
			     	  *SET ORDER TO &COD
		            ENDIF 
		      ENDIF
		      SELECT A22A
		      USE
            	 ENDIF 
              ENDIF 
*!*	*!*	**************判別索引值10********************
*!*	          IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE),97,122)=.T.
*!*	                 =MESSAGEBOX('索引鍵值須為大寫英文字母請重新輸入',0+64,'提示視窗')
*!*	                 THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*	                 RETURN
*!*	            ENDIF	   
*!*	            IF  (A22.F19=THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE) .OR. EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE)
*!*	                  SELECT A22
*!*	                  REPLACE A22.F19 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE
*!*	           ELSE
*!*	                  SELECT F19 FROM A22 WHERE F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  .AND. !EMPTY(F19) INTO CURSOR A22A
*!*	 		  INDEX ON F19 TAG A22A1
*!*	 		  IF RECCOUNT('A22A')=0
*!*	                       SELE A22     
*!*	   	               REPLACE F19 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE
*!*			  ELSE
*!*	            	       IF  BETWEEN(ASC(A22A.F19),65,90)=.T.	&&判斷資料是否為英文索引
*!*	            	             IF  BETWEEN(ASC(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE),65,90)=.T.&&判斷輸入是否為英文
*!*	            			   IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE,'A22A'),.T.,.F.)=.T.
*!*			    	                =MESSAGEBOX('此索引順序已在第10索引鍵值中使用請重新指定',0+64,'提示視窗')
*!*			    	                THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*			    	                 RETURN
*!*			    	                *SET ORDER TO &COD 
*!*					   ENDIF
*!*			    	     ELSE   
*!*			    	           =MESSAGEBOX('第10索引鍵值已設為英文鍵值不可用數字當索引鍵值請重新輸入',0+64,'提示視窗')
*!*		           		   THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*		          		   RETURN
*!*		           		  *SET ORDER TO &COD  
*!*	            	             ENDIF
*!*	            	       ELSE  &&否則資料則是數字索引
*!*	            	             IF  BETWEEN(VAL(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE),1,9)=.T.&&判斷輸入是否為數字
*!*	        	 		  IF  IIF(SEEK(THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE,'A22A'),.T.,.F.)=.T.
*!*			    	               =MESSAGEBOX('此索引順序已在第10索引鍵值中使用請重新指定',0+64,'提示視窗')
*!*			    	              THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*			    	               RETURN
*!*			    	                   *SET ORDER TO &COD 
*!*			    	          ENDIF    
*!*			            ELSE
*!*				          =MESSAGEBOX('第10索引鍵值已設為數字鍵值不可用英文當索引鍵值請重新輸入',0+64,'提示視窗')
*!*					  THISFORM.PAGEFRAME1.PAGE2.TXTF19.SETFOCUS
*!*				     	  RETURN
*!*				     	  *SET ORDER TO &COD
*!*			            ENDIF 
*!*			      ENDIF
*!*			      SELECT A22A
*!*			      USE
*!*	            	 ENDIF 
*!*	              ENDIF               
         ************      
          SELECT A20 
          SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
          IF FOUND()
               REPLACE F12 WITH A20.F12-FLEN+THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE &&修改總欄位長度
                
	  ENDIF                       
  	   SELECT  A22    
  	   SEEK  THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF01.VALUE 
  	   IF FOUND()   
           	REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE  
           	REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE 
           	REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE 
           	REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE 
           	REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE 
           	REPLACE F15 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE
           	REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF16.VALUE 
           	REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF17.VALUE 
           	REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE          
*!*	           	REPLACE F19 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF19.VALUE     
           	REPLACE F20 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
          ENDIF 	
***********************************************
     ELSE
      	   DO FILE_IMPACT
           RETURN   
     ENDIF 
 ENDIF
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
ENDPROC    
 *****************刪除***********
PROCEDURE ORPGROUP.DEL_BOTT.CLICK     
   IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
      IF MESSAGEBOX('是否確定要刪除此筆程式編號之所有資料',4+32+256,'請確認')=6
         SELE A20
         LOCK()
         IF  RLOCK()
               DELE
               UNLOCK
               SKIP -1
               SELE A22
               DELE FOR  A22.F05=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
                  IF BOF()
                       GO TOP
                  ENDIF   
              THISFORM.GRID1.SETFOCUS
               IF  THISFORM.GRID1.ACTIVEROW=0
                    THISFORM.PAGEFRAME1.PAGE1.SETALL('VALUE','','TEXTBOX')
                    THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
                    THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
                    THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
                    THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
                    THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
                    THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
                    THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
               ELSE
                    THISFORM.CMDGROUP.ENABLED=.T. 
                    THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
                    THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
                    THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限
               ENDIF
         ELSE
            DO FILE_IMPACT
         ENDIF
       ENDIF  
   ELSE
     IF  MESSAGEBOX('是否確定要刪除此筆欄位編號之所有資料',4+32+256,'請確認')=6  
        SELE A22  
        LOCK()
        IF  RLOCK()
             DELE
             UNLOCK
             SKIP -1
             IF   BOF()
                   GO TOP
             ENDIF   
             THISFORM.GRID2.SETFOCUS
               IF THISFORM.GRID2.ACTIVEROW=0
                   THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
                   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
                   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
                   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
                   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
                   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
                   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
                   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
                ELSE
                    THISFORM.CMDGROUP.ENABLED=.T. 
                    THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
                    THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
                    THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限
                ENDIF
        ELSE
           DO FILE_IMPACT    
        ENDIF 
     ENDIF           
  ENDIF  
  ENDPROC  
**************************放棄***************
PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(GL='*',.T.,.F.)   &&判斷有無新增的權限      
      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(GM='*',.T.,.F.)  &&判斷有無修改的權限
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(GN='*',.T.,.F.)   &&判斷有無刪除的權限
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(GP='*',.T.,.F.)   &&判斷有無列印的權限      
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE1.FILE_TYPE.VISIBLE=.F.
      THISFORM.PAGEFRAME1.PAGE2.FIELD_TYPE.VISIBLE=.F.
      THISFORM.PAGEFRAME1.PAGE1.TXTF01.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF01.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE1.TXTF02.VISIBLE=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF02.VISIBLE=.T.
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
            THISFORM.GRID1.ENABLED=.T.
           THISFORM.GRID2.ENABLED=.T.
           THISFORM.GRID1.SETFOCUS   
           THISFORM.KEY_LIST.ENABLED=.T.
      ELSE
            THISFORM.GRID1.ENABLED=.F.
           THISFORM.GRID2.ENABLED=.T.
           THISFORM.GRID2.SETFOCUS      
            IF THISFORM.GRID2.ACTIVEROW=0
                 SELE A20              
                 DELE
                 SKIP -1
                 IF BOF()
                     GO TOP
                 ENDIF               
	         THISFORM.PAGEFRAME1.ACTIVEPAGE=1
	         THISFORM.REFRESH
          ENDIF  
       ENDIF    
    UNLOCK ALL
  ENDPROC
  ***************************完成***********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
      SELE A22
        THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC
ENDDEFINE 
 ***********************************************列印程序
 PROCEDURE PNT_PRC  
	  PO_NO=A20.F01
	  SELECT A20.F03,A20.F07,A22.F01,BILL(A22.F02),A22.F03,A22.F04,A22.F05,A22.F06,A22.F10,A22.F11,A22.F12,A22.F13,A22.F14,A22.F15,A22.F16,A22.F17,A22.F18  ORDER BY A22.F01 FROM A20,A22 WHERE A22.F05=PO_NO AND A20.F01=PO_NO NOWAIT
	  REPORT FORM ALLTRIM(INT_116)+'A20' TO PRINT PROMPT PREVIEW
	  CLEAR
 ENDPROC
********************檔案類別
DEFINE CLASS FILE_TYPE AS COMBOBOX  
      VISIBLE=.F.
      HEIGHT=INT_015*25
      WIDTH=INT_015*70
      TOP=INT_015*99
      LEFT=INT_015*66
      FONTSIZE=INT_015*9
      ROWSOURCETYPE=1
      STYLE=2
      VALUE=1
      NAME='FILE_TYPE'   
  PROCEDURE INIT
   THIS.ADDITEM('基本檔')&&0
   THIS.ADDITEM('月份檔')&&1
   THIS.ADDITEM('奇月檔')&&3
   THIS.ADDITEM('暫存檔')&&9
   THIS.ADDITEM('系統檔')&&z
  ENDPROC    
  PROCEDURE INTERACTIVECHANGE 

  ENDPROC
 ENDDEFINE  
  ************************  欄位型態
  DEFINE CLASS FIELD_TYPE AS COMBOBOX
      VISIBLE=.F.
      VALUE=1
      HEIGHT=INT_015*25
      WIDTH=INT_015*80
      TOP=INT_015*46
      LEFT=INT_015*66
      FONTSIZE=INT_015*9
      ROWSOURCETYPE=1
      STYLE=2
      NAME='FIELD_TYPE'  
  PROCEDURE INIT 
          THIS.ADDITEM('字元')
          THIS.ADDITEM('日期')
          THIS.ADDITEM('時間日期')
          THIS.ADDITEM('數值')
          THIS.ADDITEM('浮點數')
          THIS.ADDITEM('整數')
          THIS.ADDITEM('倍精準數')
          THIS.ADDITEM('貨幣')
          THIS.ADDITEM('邏輯')
          THIS.ADDITEM('備註')
          THIS.ADDITEM('通用')
  ENDPROC
 ******************   
  PROCEDURE INTERACTIVECHANGE
    DO CASE
    	   CASE THIS.DISPLAYVALUE='字元'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=0
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0
     	   CASE THIS.DISPLAYVALUE='日期'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=8
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0
     	  CASE THIS.DISPLAYVALUE='時間日期'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=8
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0
     	  CASE THIS.DISPLAYVALUE='數值'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=0
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.F.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0
     	  CASE THIS.DISPLAYVALUE='浮點數'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.F.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=0
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.F.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0	 
     	  CASE THIS.DISPLAYVALUE='整數'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=4
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
		      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0	
	  CASE THIS.DISPLAYVALUE='倍精準數'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=8
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.F.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0	
     	  CASE THIS.DISPLAYVALUE='貨幣'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=8
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0
     	 CASE THIS.DISPLAYVALUE='邏輯'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=1
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0	
     	CASE THIS.DISPLAYVALUE='備註'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=4
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0	
        CASE THIS.DISPLAYVALUE='通用'
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=4
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.READONLY=.T.
     	  	      THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=0	      	  	         	        	      	       	  	       	         	      	      	            
    ENDCASE
    THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=THIS.DISPLAYVALUE	      	  
  ENDPROC 
ENDDEFINE 
********************
FUNC BILL
     PARA JUK
     JO=''
     DO CASE
        CASE JUK='0'
             JO='基本檔'
        CASE JUK='1'
             JO='月份檔'
        CASE JUK='3'
             JO='奇月檔'     
        CASE JUK='z'
             JO='系統檔'
        CASE JUK='9'
             JO='暫存檔'
        CASE JUK='C'
             JO='字元'
        CASE JUK='D'  
             JO='日期' 
        CASE JUK='T'  
             JO='時間日期'         
        CASE JUK='N'  
             JO='數值'
        CASE JUK='F'  
             JO='浮點數' 
        CASE JUK='I'  
             JO='整數'  
        CASE JUK='B'  
             JO='倍精準數'  
       CASE JUK='Y'  
             JO='貨幣'                                    
        CASE JUK='L'  
             JO='邏輯' 
        CASE JUK='M'  
             JO='備註'       
        CASE JUK='G'  
             JO='通用'      
     ENDCASE
     RETURN JO          