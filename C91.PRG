*********C91.業務部營運目標考核表
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
AREA1='C91_1'
CHK=''
TOL=0
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE 
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK sys_oper+'C91'   
IF !USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01
IF !USED('A14')
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141  
IF !USED('A23')
    SELE 0
    USE A23
ELSE 
   SELE A23
ENDIF
SET ORDER TO 1  
IF !USED('B01')
   SELE 0
   USE B01 INDE B01
ELSE
   SELE B01
ENDIF
SET ORDER TO 1
IF !USED('C01')
    SELE 0
    USE C01
ELSE 
   SELE C01
ENDIF
SET ORDER TO 1               
IF !USED('C91')
   SELECT  0
   USE C91  INDE C91
ELSE 
   SELECT  C91
ENDIF
SET ORDER TO C911  
IF !USED('K5F')
   SELE 0
   USE K5F 
ELSE 
   SELE K5F 
ENDIF
SET ORDER TO K5F1
IF !USED('K51')
   SELE 0
   USE K51 
ELSE 
   SELE K51 
ENDIF
SET ORDER TO K511
WAIT WINDOW "資料匯入中,請稍後!" AT 0,150 NOWAIT NOCLEAR
******比重設定
CREATE CURSOR C91_2;
(F08A N(3),F08B N(3),F08C N(3),F08D N(3),F08E N(3),F08F N(3),F08G N(3),F08H N(3),F08I N(3),F08J N(3),F08K N(3),F08L N(3),F98 N(3),F99 C(17))
SELECT F07,F08,F99 FROM C91 WHERE  C91.F02='Z'  ORDER BY C91.F07 INTO CURSOR C91B
SELECT C91_2
APPEND BLANK 
REPLACE C91_2.F99 WITH C91B.F99
GO TOP
SELECT C91B
GO TOP
DO WHILE !EOF()
       SELECT C91_2
       DO CASE
              CASE C91B.F07='A'
                          REPLACE C91_2.F08A WITH C91B.F08
              CASE C91B.F07='B'
                          REPLACE C91_2.F08B WITH C91B.F08
              CASE C91B.F07='C'
                          REPLACE C91_2.F08C WITH C91B.F08 
              CASE C91B.F07='D'
                          REPLACE C91_2.F08D WITH C91B.F08  
              CASE C91B.F07='E'
                          REPLACE C91_2.F08E WITH C91B.F08  
              CASE C91B.F07='F'
                          REPLACE C91_2.F08F WITH C91B.F08 
              CASE C91B.F07='G'
                          REPLACE C91_2.F08G WITH C91B.F08
              CASE C91B.F07='H'
                          REPLACE C91_2.F08H WITH C91B.F08  
              CASE C91B.F07='I'
                          REPLACE C91_2.F08I WITH C91B.F08
              CASE C91B.F07='J'
                          REPLACE C91_2.F08J WITH C91B.F08
              CASE C91B.F07='K'
                          REPLACE C91_2.F08K WITH C91B.F08
              CASE C91B.F07='L'
                          REPLACE C91_2.F08L WITH C91B.F08                                                                              
         ENDCASE   
         REPLACE C91_2.F98 WITH C91_2.F98+C91B.F08
         SELECT C91B
         SKIP
ENDDO
SELECT C91B
USE
************等級設定
CREATE CURSOR C91_3;
(F10A N(3),F11A N(3),F10B N(3),F11B N(3),F10C N(3),F11C N(3),F10D N(3),F11D N(3),F10E N(3),F11E N(3),F99 C(17))
SELECT F09,F10,F11,F99 FROM C91 WHERE  C91.F02='Y'  ORDER BY C91.F09 INTO CURSOR C91C
SELECT C91_3
APPEND BLANK 
REPLACE C91_3.F99 WITH C91C.F99    
GO TOP
SELECT C91C
GO TOP
DO WHILE !EOF()
       SELECT C91_3
       DO CASE 
              CASE C91C.F09='A'
                         REPLACE C91_3.F10A WITH C91C.F10
			 REPLACE C91_3.F11A WITH C91C.F11
              CASE C91C.F09='B'
                         REPLACE C91_3.F10B WITH C91C.F10
			 REPLACE C91_3.F11B WITH C91C.F11			 
              CASE C91C.F09='C'
                         REPLACE C91_3.F10C WITH C91C.F10
			 REPLACE C91_3.F11C WITH C91C.F11
              CASE C91C.F09='D'
                         REPLACE C91_3.F10D WITH C91C.F10
			 REPLACE C91_3.F11D WITH C91C.F11
              CASE C91C.F09='E'
                         REPLACE C91_3.F10E WITH C91C.F10
			 REPLACE C91_3.F11E WITH C91C.F11			 			 			 
       ENDCASE
       SELECT C91C
       SKIP
ENDDO
SELECT C91C
USE
****等級比對表
SELECT F09,F10,F11 FROM C91 WHERE F02='Y'  ORDER BY F09 INTO CURSOR C91_TEMPY
*************考核內容
CREATE CURSOR C91_1;
(F01 D(8),F03A N(8),F04A N(8),F05A N(3),F06A N(3),F03B N(8),F04B N(8),F05B N(3),F06B N(3),F03C N(8),F04C N(8),F05C N(3),F06C N(3),;
	             F03D N(8),F04D N(8),F05D N(3),F06D N(3),F03E N(8),F04E N(8),F05E N(3),F06E N(3),F03F N(8),F04F N(8),F05F N(3),F06F N(3),;
	             F03G N(8),F04G N(8),F05G N(3),F06G N(3),F03H N(8),F04H N(8),F05H N(3),F06H N(3),F03I N(8),F04I N(8),F05I N(3),F06I N(3),;
	             F03J N(8),F04J N(8),F05J N(3),F06J N(3),F03K N(8),F04K N(8),F05K N(3),F06K N(3),F03L N(8),F04L N(8),F05L N(3),F06L N(3),F10 N(3),F11 C(1),F99 C(17)) 
INDE ON DTOS(F01) TAG C91_11
SET ORDER TO C91_11
SELECT F01,F99 FROM C91 WHERE  C91.F02<>'Z' .AND. C91.F02<>'Y' ORDER BY C91.F01 GROUP BY C91.F01 INTO CURSOR C91A
SELECT C91A
GO TOP
DO WHILE !EOF()
       SELECT C91_1
       APPEND BLANK 
       REPLACE C91_1.F01 WITH C91A.F01
       REPLACE C91_1.F99 WITH C91A.F99
       SELECT C91A
       SKIP
ENDDO
SELECT C91A
USE
SELECT F01,F02,F03,F04,F05,F06 FROM C91 WHERE  C91.F02<>'Z' .AND. C91.F02<>'Y' ORDER BY C91.F01 INTO CURSOR C91_TEMP
SELECT C91_TEMP
GO TOP
DO WHILE !EOF()
       SELECT C91_1
       SEEK DTOS(C91_TEMP.F01)
       IF FOUND()
           DO CASE 
                  CASE C91_TEMP.F02='A'
                             REPLACE C91_1.F03A WITH C91_TEMP.F03
                             REPLACE C91_1.F04A WITH C91_TEMP.F04
                             REPLACE C91_1.F05A WITH C91_TEMP.F05
                             REPLACE C91_1.F06A WITH C91_TEMP.F06
                  CASE C91_TEMP.F02='B'
                             REPLACE C91_1.F03B WITH C91_TEMP.F03
                             REPLACE C91_1.F04B WITH C91_TEMP.F04
                             REPLACE C91_1.F05B WITH C91_TEMP.F05
                             REPLACE C91_1.F06B WITH C91_TEMP.F06
                  CASE C91_TEMP.F02='C'
                             REPLACE C91_1.F03C WITH C91_TEMP.F03
                             REPLACE C91_1.F04C WITH C91_TEMP.F04
                             REPLACE C91_1.F05C WITH C91_TEMP.F05
                             REPLACE C91_1.F06C WITH C91_TEMP.F06
                  CASE C91_TEMP.F02='D'
                             REPLACE C91_1.F03D WITH C91_TEMP.F03
                             REPLACE C91_1.F04D WITH C91_TEMP.F04
                             REPLACE C91_1.F05D WITH C91_TEMP.F05
                             REPLACE C91_1.F06D WITH C91_TEMP.F06
                  CASE C91_TEMP.F02='E'
                             REPLACE C91_1.F03E WITH C91_TEMP.F03
                             REPLACE C91_1.F04E WITH C91_TEMP.F04
                             REPLACE C91_1.F05E WITH C91_TEMP.F05
                             REPLACE C91_1.F06E WITH C91_TEMP.F06
                  CASE C91_TEMP.F02='F'
                             REPLACE C91_1.F03F WITH C91_TEMP.F03
                             REPLACE C91_1.F04F WITH C91_TEMP.F04
                             REPLACE C91_1.F05F WITH C91_TEMP.F05
                             REPLACE C91_1.F06F WITH C91_TEMP.F06
                  CASE C91_TEMP.F02='G'
                             REPLACE C91_1.F03G WITH C91_TEMP.F03
                             REPLACE C91_1.F04G WITH C91_TEMP.F04
                             REPLACE C91_1.F05G WITH C91_TEMP.F05
                             REPLACE C91_1.F06G WITH C91_TEMP.F06
                  CASE C91_TEMP.F02='H'
                             REPLACE C91_1.F03H WITH C91_TEMP.F03
                             REPLACE C91_1.F04H WITH C91_TEMP.F04
                             REPLACE C91_1.F05H WITH C91_TEMP.F05
                             REPLACE C91_1.F06H WITH C91_TEMP.F06
                  CASE C91_TEMP.F02='I'
                             REPLACE C91_1.F03I WITH C91_TEMP.F03
                             REPLACE C91_1.F04I WITH C91_TEMP.F04
                             REPLACE C91_1.F05I WITH C91_TEMP.F05
                             REPLACE C91_1.F06I WITH C91_TEMP.F06       
                  CASE C91_TEMP.F02='J'
                             REPLACE C91_1.F03J WITH C91_TEMP.F03
                             REPLACE C91_1.F04J WITH C91_TEMP.F04
                             REPLACE C91_1.F05J WITH C91_TEMP.F05
                             REPLACE C91_1.F06J WITH C91_TEMP.F06     
                  CASE C91_TEMP.F02='K'
                             REPLACE C91_1.F03K WITH C91_TEMP.F03
                             REPLACE C91_1.F04K WITH C91_TEMP.F04
                             REPLACE C91_1.F05K WITH C91_TEMP.F05
                             REPLACE C91_1.F06K WITH C91_TEMP.F06     
                  CASE C91_TEMP.F02='L'
                             REPLACE C91_1.F03L WITH C91_TEMP.F03
                             REPLACE C91_1.F04L WITH C91_TEMP.F04
                             REPLACE C91_1.F05L WITH C91_TEMP.F05
                             REPLACE C91_1.F06L WITH C91_TEMP.F06                                                                                                                                                                                                                                                                                                                             
	   ENDCASE
	   REPLACE C91_1.F10   WITH  C91_1.F10+C91_TEMP.F06
       ENDIF   
       SELECT C91_TEMP
       SKIP
ENDDO
SELECT C91_TEMP
USE
SELECT C91_1
GO TOP
DO WHILE !EOF()
       SELECT C91_TEMPY
       GO TOP      
       DO WHILE !EOF()
               IF C91_1.F10<=C91_TEMPY.F10 .AND. C91_1.F10>=C91_TEMPY.F11
                    SELECT C91_1
                    REPLACE C91_1.F11 WITH C91_TEMPY.F09
               ENDIF
               SELECT C91_TEMPY
               SKIP
       ENDDO
       SELECT C91_1
       SKIP
ENDDO
SELECT C91_1
SET ORDER TO C91_11
GO TOP
WAIT CLEAR
**********
C91FORM=CREATEOBJECT("TKC91")
C91FORM.SHOW  
DEFINE CLASS TKC91 AS FORM
  CAPTION='C91.業務部營運目標考核表'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKC91'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.  
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*67,;      
      FONTSIZE=INT_015*9,;
      CAPTION='\<A.參數設定',;
      NAME='ANS_BOTT'                      
  ADD OBJECT LBLF01 AS LABEL WITH;
      LEFT=INT_015*260,;
      TOP=INT_015*35,;
      WIDTH=INT_015*50,;
      CAPTION='考核年月'
  ADD OBJECT TXTF01 AS TEXTBOX WITH;
      LEFT=INT_015*311,;
      TOP=INT_015*29,;
      WIDTH=INT_015*65,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=8,;
      NAME='TXTF01'           
 ADD OBJECT COMBOBOX01 AS COMBOBOX01 WITH;      
      VISIBLE=.F.,;
       LEFT=INT_015*311,;
       TOP=INT_015*29                  
  ADD OBJECT LINEL AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*87,;
      HEIGHT=INT_015*333,;
      WIDTH=INT_015*0             
  ADD OBJECT LINER AS LINE WITH;      
      LEFT=INT_015*750,;
      TOP=INT_015*87,;
      HEIGHT=INT_015*333,;
      WIDTH=INT_015*0        
  ADD OBJECT LBLF03 AS LABEL WITH;      
      LEFT=INT_015*485,;
      TOP=INT_015*70,;
      AUTOSIZE=.T.,;
      CAPTION='目標值           達成值            達成率           得    分'        
  ADD OBJECT LINE02 AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*87,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490      
 **************     
  ADD OBJECT LBLF02A AS LABEL WITH;      
      LEFT=INT_015*270,;
      TOP=INT_015*96,;
      AUTOSIZE=.T.,;
      CAPTION='1、當月銷售收入                                                                                                      ％' 
  ADD OBJECT TXTF03A AS TEXTBOX WITH;
      LEFT=INT_015*460,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF03A'            
  ADD OBJECT TXTF04A AS TEXTBOX WITH;
      LEFT=INT_015*530,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF04A'        
  ADD OBJECT TXTF05A AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05A'            
  ADD OBJECT TXTF06A AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06A'      
  ADD OBJECT LINE02A AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*115,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490         
  ***********    
  ADD OBJECT LBLF02B AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*124,;
      AUTOSIZE=.T.,;
      CAPTION='2、銷售收入毛利率                                                   ％                    ％                   ％'          
  ADD OBJECT TXTF03B AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*118,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF03B'           
  ADD OBJECT TXTF04B AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*118,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF04B'        
  ADD OBJECT TXTF05B AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*118,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05B'            
  ADD OBJECT TXTF06B AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*118,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06B'     
  ADD OBJECT LINE02B AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*143,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
  *********            
  ADD OBJECT LBLF02C AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*152,;
      AUTOSIZE=.T.,;
      CAPTION='3、應收帳款回收率                                                   ％                    ％                   ％'  
  ADD OBJECT TXTF03C AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*146,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF03C'           
  ADD OBJECT TXTF04C AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*146,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF04C'        
  ADD OBJECT TXTF05C AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*146,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05C'            
  ADD OBJECT TXTF06C AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*146,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06C'    
  ADD OBJECT LINE02C AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*171,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490            
   *************         
  ADD OBJECT LBLF02D AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*180,;
      AUTOSIZE=.T.,;
      CAPTION='4、在庫非呆料庫存週轉率                                       ％                    ％                   ％'  
  ADD OBJECT TXTF03D AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*174,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF03D'           
  ADD OBJECT TXTF04D AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*174,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF04D'        
  ADD OBJECT TXTF05D AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*174,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05D'            
  ADD OBJECT TXTF06D AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*174,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06D'    
  ADD OBJECT LINE02D AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*198,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
****************      
  ADD OBJECT LBLF02E AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*206,;
      AUTOSIZE=.T.,;
      CAPTION='5、在庫呆料變動率                                                   ％                    ％                   ％'  
  ADD OBJECT TXTF03E AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*201,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF03E'           
  ADD OBJECT TXTF04E AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*201,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF04E'        
  ADD OBJECT TXTF05E AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*201,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05E'            
  ADD OBJECT TXTF06E AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*201,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06E'    
  ADD OBJECT LINE02E AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*226,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
****************          
  ADD OBJECT LBLF02F AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*235,;
      AUTOSIZE=.T.,;
      CAPTION='6、上海廠間接接單金額                                                                                          ％'  
  ADD OBJECT TXTF03F AS TEXTBOX WITH;
      LEFT=INT_015*460,;
      TOP=INT_015*229,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF03F'           
  ADD OBJECT TXTF04F AS TEXTBOX WITH;
      LEFT=INT_015*530,;
      TOP=INT_015*229,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF04F'        
  ADD OBJECT TXTF05F AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*229,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05F'            
  ADD OBJECT TXTF06F AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*229,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06F'    
  ADD OBJECT LINE02F AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*253,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
****************         
  ADD OBJECT LBLF02G AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*262,;
      AUTOSIZE=.T.,;
      CAPTION='7、緊急採購、緊急異動及訂購異動率                   ％                    ％                   ％'  
  ADD OBJECT TXTF03G AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*256,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF03G'           
  ADD OBJECT TXTF04G AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*256,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF04G'        
  ADD OBJECT TXTF05G AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*256,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05G'            
  ADD OBJECT TXTF06G AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*256,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06G'    
  ADD OBJECT LINE02G AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*280,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490        
************      
  ADD OBJECT LBLF02H AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*289,;
      AUTOSIZE=.T.,;
      CAPTION='8、維持交易客戶數量                                                                                              ％'  
  ADD OBJECT TXTF03H AS TEXTBOX WITH;
      LEFT=INT_015*460,;
      TOP=INT_015*283,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF03H'           
  ADD OBJECT TXTF04H AS TEXTBOX WITH;
      LEFT=INT_015*530,;
      TOP=INT_015*283,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF04H'        
  ADD OBJECT TXTF05H AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*283,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05H'            
  ADD OBJECT TXTF06H AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*283,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06H'    
  ADD OBJECT LINE02H AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*308,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490        
************            
  ADD OBJECT LBLF02I AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*316,;
      AUTOSIZE=.T.,;
      CAPTION='9、新客戶增長率                                                       ％                    ％                   ％'                                            
  ADD OBJECT TXTF03I AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*311,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF03I'           
  ADD OBJECT TXTF04I AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*311,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF04I'        
  ADD OBJECT TXTF05I AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*311,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05I'            
  ADD OBJECT TXTF06I AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*311,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06I'      
  ADD OBJECT LINE02I AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*336,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490             
  ****************     
  ADD OBJECT LBLF02J AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*346,;
      AUTOSIZE=.T.,;
      CAPTION='10、各類新產品開發率                                             ％                    ％                   ％'                                            
  ADD OBJECT TXTF03J AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*339,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF03J'           
  ADD OBJECT TXTF04J AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*339,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF04J'        
  ADD OBJECT TXTF05J AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*339,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05J'            
  ADD OBJECT TXTF06J AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*339,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06J'    
  ADD OBJECT LINE02J AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*364,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490         
 ****************         
  ADD OBJECT LBLF02K AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*373,;
      AUTOSIZE=.T.,;
      CAPTION='11、部品特殊運輸費用                                                                                            ％'                                            
  ADD OBJECT TXTF03K AS TEXTBOX WITH;
      LEFT=INT_015*460,;
      TOP=INT_015*367,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF03K'           
  ADD OBJECT TXTF04K AS TEXTBOX WITH;
      LEFT=INT_015*530,;
      TOP=INT_015*367,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF04K'        
  ADD OBJECT TXTF05K AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*367,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05K'            
  ADD OBJECT TXTF06K AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*367,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06K'    
  ADD OBJECT LINE02K AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*392,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
 ****************         
  ADD OBJECT LBLF02L AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*402,;
      AUTOSIZE=.T.,;
      CAPTION='12、加工類特殊採購及製造費                                                                                ％'                                            
  ADD OBJECT TXTF03L AS TEXTBOX WITH;
      LEFT=INT_015*460,;
      TOP=INT_015*395,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF03L'           
  ADD OBJECT TXTF04L AS TEXTBOX WITH;
      LEFT=INT_015*530,;
      TOP=INT_015*395,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF04L'        
  ADD OBJECT TXTF05L AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*395,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05L'            
  ADD OBJECT TXTF06L AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*395,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06L'    
  ADD OBJECT LINE02L AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*420,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
 *************     
  ADD OBJECT LBLF_TOL AS LABEL WITH;
      LEFT=INT_015*290,;
      TOP=INT_015*435,;
      AUTOSIZE=.T. ,;
      BACKCOLOR=RGB(255,255,0),;
      CAPTION='總  得  分：'            
  ADD OBJECT LBLF_LEV AS LABEL WITH;
      LEFT=INT_015*400,;
      TOP=INT_015*435,;
      AUTOSIZE=.T. ,;
      BACKCOLOR=RGB(255,255,0),;
      CAPTION='等        級：'                        
  ADD OBJECT LBLF99 AS LABEL WITH;
      LEFT=INT_015*560,;
      TOP=INT_015*435,;
      WIDTH=INT_015*50,;
      CAPTION='安全資料'
  ADD OBJECT LBLF991 AS LABEL WITH;
      LEFT=INT_015*610,;
      TOP=INT_015*435,;
      CAPTION='',;
      AUTOSIZE=.T.                   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
*!*	  ADD OBJECT MTH_LIST AS MTH_LIST WITH;
*!*	      AUTOCENTER=.T.      
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=1,;            
      RECORDSOURCE='C91_1',;      
      COLUMN1.NAME='COLUMN1'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.              
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOSIZE=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*460,;
      LEFT=INT_015*620          
  PROC INIT  
       SELECT C91_1
       GO TOP
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.SETALL('HEIGHT',INT_015*22,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')       
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'HEADER')       
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='考核年月'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE="LEFT(ALLTRIM(DTOC(C91_1.F01)),5)"
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       
          THISFORM.CMDGROUP.ENABLED=.F.
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
          THISFORM.SETALL('VALUE','','TEXTBOX')
          THISFORM.LBLF991.CAPTION=''
          THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
          THISFORM.LBLF_LEV.CAPTION='等        級：'             
       ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.            
          THISFORM.CMDGROUP.ENABLED=.T.      
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  &&判斷有無刪除的權限
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限     
       ENDIF     
       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無確認的權限 
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)  &&判斷有無新增的權限 
       JK='考核日期'
  ENDPROC
  ***********     
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依考核日期排列')
       ENDWITH      
  ENDPROC 
  **********
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       THISFORM.TXTF01.VALUE=LEFT(ALLTRIM(DTOC(C91_1.F01)),5)
       THISFORM.TXTF03A.VALUE=C91_1.F03A
       THISFORM.TXTF04A.VALUE=C91_1.F04A
       THISFORM.TXTF05A.VALUE=C91_1.F05A
       THISFORM.TXTF06A.VALUE=C91_1.F06A
       THISFORM.TXTF03B.VALUE=C91_1.F03B
       THISFORM.TXTF04B.VALUE=C91_1.F04B
       THISFORM.TXTF05B.VALUE=C91_1.F05B
       THISFORM.TXTF06B.VALUE=C91_1.F06B
       THISFORM.TXTF03C.VALUE=C91_1.F03C
       THISFORM.TXTF04C.VALUE=C91_1.F04C
       THISFORM.TXTF05C.VALUE=C91_1.F05C
       THISFORM.TXTF06C.VALUE=C91_1.F06C
       THISFORM.TXTF03D.VALUE=C91_1.F03D
       THISFORM.TXTF04D.VALUE=C91_1.F04D
       THISFORM.TXTF05D.VALUE=C91_1.F05D
       THISFORM.TXTF06D.VALUE=C91_1.F06D
       THISFORM.TXTF03E.VALUE=C91_1.F03E
       THISFORM.TXTF04E.VALUE=C91_1.F04E
       THISFORM.TXTF05E.VALUE=C91_1.F05E
       THISFORM.TXTF06E.VALUE=C91_1.F06E
       THISFORM.TXTF03F.VALUE=C91_1.F03F
       THISFORM.TXTF04F.VALUE=C91_1.F04F
       THISFORM.TXTF05F.VALUE=C91_1.F05F
       THISFORM.TXTF06F.VALUE=C91_1.F06F
       THISFORM.TXTF03G.VALUE=C91_1.F03G
       THISFORM.TXTF04G.VALUE=C91_1.F04G
       THISFORM.TXTF05G.VALUE=C91_1.F05G
       THISFORM.TXTF06G.VALUE=C91_1.F06G
       THISFORM.TXTF03H.VALUE=C91_1.F03H
       THISFORM.TXTF04H.VALUE=C91_1.F04H
       THISFORM.TXTF05H.VALUE=C91_1.F05H
       THISFORM.TXTF06H.VALUE=C91_1.F06H
       THISFORM.TXTF03I.VALUE=C91_1.F03I
       THISFORM.TXTF04I.VALUE=C91_1.F04I
       THISFORM.TXTF05I.VALUE=C91_1.F05I
       THISFORM.TXTF06I.VALUE=C91_1.F06I
       THISFORM.TXTF03J.VALUE=C91_1.F03J
       THISFORM.TXTF04J.VALUE=C91_1.F04J
       THISFORM.TXTF05J.VALUE=C91_1.F05J
       THISFORM.TXTF06J.VALUE=C91_1.F06J
       THISFORM.TXTF03K.VALUE=C91_1.F03K
       THISFORM.TXTF04K.VALUE=C91_1.F04K
       THISFORM.TXTF05K.VALUE=C91_1.F05K
       THISFORM.TXTF06K.VALUE=C91_1.F06K
       THISFORM.TXTF03L.VALUE=C91_1.F03L
       THISFORM.TXTF04L.VALUE=C91_1.F04L
       THISFORM.TXTF05L.VALUE=C91_1.F05L
       THISFORM.TXTF06L.VALUE=C91_1.F06L                     
       THISFORM.LBLF991.CAPTION=C91_1.F99    
       THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(C91_1.F10))+' 分'
       THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_1.F11
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.REFRESH
  ENDPROC      
  ********** 
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
       THISFORM.GRID1.ENABLED=.F.
       THISFORM.KEY_LIST.ENABLED=.F. 
       THISFORM.ANS_BOTT.ENABLED=.F.   &&判斷有無確認的權限
       THISFORM.SETALL('READONLY',.F.,'TEXTBOX')  
       THISFORM.COMBOBOX01.VISIBLE=.T.
       THISFORM.COMBOBOX01.VALUE=1
       THISFORM.TXTF01.VISIBLE=.F.         
       THISFORM.TXTF05A.READONLY=.T.  
       THISFORM.TXTF06A.READONLY=.T. 
       THISFORM.TXTF05B.READONLY=.T.  
       THISFORM.TXTF06B.READONLY=.T. 
       THISFORM.TXTF05C.READONLY=.T.  
       THISFORM.TXTF06C.READONLY=.T. 
       THISFORM.TXTF05D.READONLY=.T.  
       THISFORM.TXTF06D.READONLY=.T. 
       THISFORM.TXTF05E.READONLY=.T.  
       THISFORM.TXTF06E.READONLY=.T. 
       THISFORM.TXTF05F.READONLY=.T.  
       THISFORM.TXTF06F.READONLY=.T. 
       THISFORM.TXTF05G.READONLY=.T.  
       THISFORM.TXTF06G.READONLY=.T. 
       THISFORM.TXTF05H.READONLY=.T.  
       THISFORM.TXTF06H.READONLY=.T. 
       THISFORM.TXTF05I.READONLY=.T.  
       THISFORM.TXTF06I.READONLY=.T.    
       THISFORM.TXTF05J.READONLY=.T.    
       THISFORM.TXTF06J.READONLY=.T.   
       THISFORM.TXTF05K.READONLY=.T.  
       THISFORM.TXTF06K.READONLY=.T.   
       THISFORM.TXTF05L.READONLY=.T.  
       THISFORM.TXTF06L.READONLY=.T.                                                      
       THISFORM.TXTF01.VALUE=''
       THISFORM.TXTF03A.VALUE=0
       THISFORM.TXTF04A.VALUE=0
       THISFORM.TXTF05A.VALUE=0
       THISFORM.TXTF06A.VALUE=0
       THISFORM.TXTF03B.VALUE=0
       THISFORM.TXTF04B.VALUE=0
       THISFORM.TXTF05B.VALUE=0
       THISFORM.TXTF06B.VALUE=0
       THISFORM.TXTF03C.VALUE=0
       THISFORM.TXTF04C.VALUE=0
       THISFORM.TXTF05C.VALUE=0
       THISFORM.TXTF06C.VALUE=0
       THISFORM.TXTF03D.VALUE=0
       THISFORM.TXTF04D.VALUE=0
       THISFORM.TXTF05D.VALUE=0
       THISFORM.TXTF06D.VALUE=0
       THISFORM.TXTF03E.VALUE=0
       THISFORM.TXTF04E.VALUE=0
       THISFORM.TXTF05E.VALUE=0
       THISFORM.TXTF06E.VALUE=0
       THISFORM.TXTF03F.VALUE=0
       THISFORM.TXTF04F.VALUE=0
       THISFORM.TXTF05F.VALUE=0
       THISFORM.TXTF06F.VALUE=0
       THISFORM.TXTF03G.VALUE=0
       THISFORM.TXTF04G.VALUE=0
       THISFORM.TXTF05G.VALUE=0
       THISFORM.TXTF06G.VALUE=0
       THISFORM.TXTF03H.VALUE=0
       THISFORM.TXTF04H.VALUE=0
       THISFORM.TXTF05H.VALUE=0
       THISFORM.TXTF06H.VALUE=0
       THISFORM.TXTF03I.VALUE=0
       THISFORM.TXTF04I.VALUE=0
       THISFORM.TXTF05I.VALUE=0
       THISFORM.TXTF06I.VALUE=0
       THISFORM.TXTF03J.VALUE=0
       THISFORM.TXTF04J.VALUE=0
       THISFORM.TXTF05J.VALUE=0
       THISFORM.TXTF06J.VALUE=0      
       THISFORM.TXTF03K.VALUE=0
       THISFORM.TXTF04K.VALUE=0
       THISFORM.TXTF05K.VALUE=0
       THISFORM.TXTF06K.VALUE=0
       THISFORM.TXTF03L.VALUE=0
       THISFORM.TXTF04L.VALUE=0
       THISFORM.TXTF05L.VALUE=0
       THISFORM.TXTF06L.VALUE=0              
       THISFORM.LBLF991.CAPTION=''          
       THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
       THISFORM.LBLF_LEV.CAPTION='等        級：'          
      THISFORM.COMBOBOX01.SETFOCUS()
      FLG='1'
  ENDPROC  
************
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
    IF EMPTY(THISFORM.COMBOBOX01.DISPLAYVALUE)
       =MESSAGEBOX('考核年月不得空白!',0+64,'提示視窗')
       THISFORM.COMBOBOX01.SETFOCUS
       RETURN
    ENDIF  
    IF INDEXSEEK(DTOS(CTOD(ALLTRIM(THISFORM.COMBOBOX01.DISPLAYVALUE)+'/01')),.F.,'C91','C911')
       =MESSAGEBOX('此考核年月已存在,請重新輸入!',0+64,'提示視窗')
       THISFORM.COMBOBOX01.SETFOCUS
       RETURN
    ENDIF                   
    SELECT  C91_1
    APPEND BLANK
    LOCK()
    IF RLOCK()
       REPLACE C91_1.F01 WITH CTOD(THISFORM.TXTF01.VALUE+'/01')
       REPLACE C91_1.F03A WITH THISFORM.TXTF03A.VALUE
       REPLACE C91_1.F04A WITH THISFORM.TXTF04A.VALUE
       REPLACE C91_1.F05A WITH THISFORM.TXTF05A.VALUE
       REPLACE C91_1.F06A WITH THISFORM.TXTF06A.VALUE
       REPLACE C91_1.F03B WITH THISFORM.TXTF03B.VALUE
       REPLACE C91_1.F04B WITH THISFORM.TXTF04B.VALUE
       REPLACE C91_1.F05B WITH THISFORM.TXTF05B.VALUE
       REPLACE C91_1.F06B WITH THISFORM.TXTF06B.VALUE
       REPLACE C91_1.F03C WITH THISFORM.TXTF03C.VALUE
       REPLACE C91_1.F04C WITH THISFORM.TXTF04C.VALUE
       REPLACE C91_1.F05C WITH THISFORM.TXTF05C.VALUE
       REPLACE C91_1.F06C WITH THISFORM.TXTF06C.VALUE
       REPLACE C91_1.F03D WITH THISFORM.TXTF03D.VALUE
       REPLACE C91_1.F04D WITH THISFORM.TXTF04D.VALUE
       REPLACE C91_1.F05D WITH THISFORM.TXTF05D.VALUE
       REPLACE C91_1.F06D WITH THISFORM.TXTF06D.VALUE
       REPLACE C91_1.F03E WITH THISFORM.TXTF03E.VALUE
       REPLACE C91_1.F04E WITH THISFORM.TXTF04E.VALUE
       REPLACE C91_1.F05E WITH THISFORM.TXTF05E.VALUE
       REPLACE C91_1.F06E WITH THISFORM.TXTF06E.VALUE
       REPLACE C91_1.F03F WITH THISFORM.TXTF03F.VALUE
       REPLACE C91_1.F04F WITH THISFORM.TXTF04F.VALUE
       REPLACE C91_1.F05F WITH THISFORM.TXTF05F.VALUE
       REPLACE C91_1.F06F WITH THISFORM.TXTF06F.VALUE
       REPLACE C91_1.F03G WITH THISFORM.TXTF03G.VALUE
       REPLACE C91_1.F04G WITH THISFORM.TXTF04G.VALUE
       REPLACE C91_1.F05G WITH THISFORM.TXTF05G.VALUE
       REPLACE C91_1.F06G WITH THISFORM.TXTF06G.VALUE
       REPLACE C91_1.F03H WITH THISFORM.TXTF03H.VALUE
       REPLACE C91_1.F04H WITH THISFORM.TXTF04H.VALUE
       REPLACE C91_1.F05H WITH THISFORM.TXTF05H.VALUE
       REPLACE C91_1.F06H WITH THISFORM.TXTF06H.VALUE
       REPLACE C91_1.F03I WITH THISFORM.TXTF03I.VALUE
       REPLACE C91_1.F04I WITH THISFORM.TXTF04I.VALUE
       REPLACE C91_1.F05I WITH THISFORM.TXTF05I.VALUE
       REPLACE C91_1.F06I WITH THISFORM.TXTF06I.VALUE       
       REPLACE C91_1.F03J WITH THISFORM.TXTF03J.VALUE
       REPLACE C91_1.F04J WITH THISFORM.TXTF04J.VALUE
       REPLACE C91_1.F05J WITH THISFORM.TXTF05J.VALUE
       REPLACE C91_1.F06K WITH THISFORM.TXTF06J.VALUE        
       REPLACE C91_1.F03K WITH THISFORM.TXTF03K.VALUE
       REPLACE C91_1.F04K WITH THISFORM.TXTF04K.VALUE
       REPLACE C91_1.F05K WITH THISFORM.TXTF05K.VALUE
       REPLACE C91_1.F06K WITH THISFORM.TXTF06K.VALUE        
       REPLACE C91_1.F03L WITH THISFORM.TXTF03L.VALUE
       REPLACE C91_1.F04L WITH THISFORM.TXTF04L.VALUE
       REPLACE C91_1.F05L WITH THISFORM.TXTF05L.VALUE
       REPLACE C91_1.F06L WITH THISFORM.TXTF06L.VALUE        
       REPLACE C91_1.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       REPLACE C91_1.F10 WITH THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
       						       THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
       						       THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
       REPLACE C91_1.F11 WITH  RIGHT(ALLTRIM(THISFORM.LBLF_LEV.CAPTION),1)           	  				               	  				       
       FOR I=1 TO 12
               C91_1F03='C91_1.F03'+CHR(64+I)
               C91_1F04='C91_1.F04'+CHR(64+I)
               C91_1F05='C91_1.F05'+CHR(64+I)
               C91_1F06='C91_1.F06'+CHR(64+I)
               NO=ALLTRIM(CHR(64+I))
               SELECT C91
	       APPEND BLANK 
	       REPLACE C91.F01 WITH C91_1.F01
	       REPLACE C91.F02 WITH NO
	       REPLACE C91.F03 WITH &C91_1F03
	       REPLACE C91.F04 WITH &C91_1F04
	       REPLACE C91.F05 WITH &C91_1F05
	       REPLACE C91.F06 WITH &C91_1F06
	       REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
	ENDFOR       
    ENDIF
    UNLOCK
    THISFORM.GRID1.ENABLED=.T.
    THISFORM.REFRESH
    THISFORM.GRID1.SETFOCUS    
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK             
  ENDPROC
************  
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
     SELECT C91_1
     THISFORM.GRID1.ENABLED=.F.
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.ANS_BOTT.ENABLED=.F.   &&判斷有無確認的權限
     THISFORM.SETALL('READONLY',.F.,'TEXTBOX')   
     THISFORM.TXTF01.READONLY=.T.
     THISFORM.TXTF05A.READONLY=.T.  
     THISFORM.TXTF06A.READONLY=.T. 
     THISFORM.TXTF05B.READONLY=.T.  
     THISFORM.TXTF06B.READONLY=.T. 
     THISFORM.TXTF05C.READONLY=.T.  
     THISFORM.TXTF06C.READONLY=.T. 
     THISFORM.TXTF05D.READONLY=.T.  
     THISFORM.TXTF06D.READONLY=.T. 
     THISFORM.TXTF05E.READONLY=.T.  
     THISFORM.TXTF06E.READONLY=.T. 
     THISFORM.TXTF05F.READONLY=.T.  
     THISFORM.TXTF06F.READONLY=.T. 
     THISFORM.TXTF05G.READONLY=.T.  
     THISFORM.TXTF06G.READONLY=.T. 
     THISFORM.TXTF05H.READONLY=.T.  
     THISFORM.TXTF06H.READONLY=.T. 
     THISFORM.TXTF05I.READONLY=.T.  
     THISFORM.TXTF06I.READONLY=.T.         
     THISFORM.TXTF05J.READONLY=.T.  
     THISFORM.TXTF06J.READONLY=.T.         
     THISFORM.TXTF05K.READONLY=.T.  
     THISFORM.TXTF06K.READONLY=.T.     
     THISFORM.TXTF05L.READONLY=.T.  
     THISFORM.TXTF06L.READONLY=.T.     
     THISFORM.LBLF991.CAPTION=''     
     THISFORM.TXTF03A.SETFOCUS
     LOCK()
     IF !RLOCK()
        DO FILE_IMPACT
        RETURN
     ENDIF
  ENDPROC 
************  
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK    
    SELECT  C91_1  
    IF  RLOCK()
	 REPLACE C91_1.F03A WITH THISFORM.TXTF03A.VALUE
	 REPLACE C91_1.F04A WITH THISFORM.TXTF04A.VALUE
	 REPLACE C91_1.F05A WITH THISFORM.TXTF05A.VALUE
	 REPLACE C91_1.F06A WITH THISFORM.TXTF06A.VALUE
	 REPLACE C91_1.F03B WITH THISFORM.TXTF03B.VALUE
	 REPLACE C91_1.F04B WITH THISFORM.TXTF04B.VALUE
	 REPLACE C91_1.F05B WITH THISFORM.TXTF05B.VALUE
	 REPLACE C91_1.F06B WITH THISFORM.TXTF06B.VALUE
	 REPLACE C91_1.F03C WITH THISFORM.TXTF03C.VALUE
	 REPLACE C91_1.F04C WITH THISFORM.TXTF04C.VALUE
	 REPLACE C91_1.F05C WITH THISFORM.TXTF05C.VALUE
	 REPLACE C91_1.F06C WITH THISFORM.TXTF06C.VALUE
	 REPLACE C91_1.F03D WITH THISFORM.TXTF03D.VALUE
	 REPLACE C91_1.F04D WITH THISFORM.TXTF04D.VALUE
	 REPLACE C91_1.F05D WITH THISFORM.TXTF05D.VALUE
	 REPLACE C91_1.F06D WITH THISFORM.TXTF06D.VALUE
	 REPLACE C91_1.F03E WITH THISFORM.TXTF03E.VALUE
	 REPLACE C91_1.F04E WITH THISFORM.TXTF04E.VALUE
	 REPLACE C91_1.F05E WITH THISFORM.TXTF05E.VALUE
	 REPLACE C91_1.F06E WITH THISFORM.TXTF06E.VALUE
	 REPLACE C91_1.F03F WITH THISFORM.TXTF03F.VALUE
	 REPLACE C91_1.F04F WITH THISFORM.TXTF04F.VALUE
	 REPLACE C91_1.F05F WITH THISFORM.TXTF05F.VALUE
	 REPLACE C91_1.F06F WITH THISFORM.TXTF06F.VALUE
	 REPLACE C91_1.F03G WITH THISFORM.TXTF03G.VALUE
	 REPLACE C91_1.F04G WITH THISFORM.TXTF04G.VALUE
	 REPLACE C91_1.F05G WITH THISFORM.TXTF05G.VALUE
	 REPLACE C91_1.F06G WITH THISFORM.TXTF06G.VALUE
	 REPLACE C91_1.F03H WITH THISFORM.TXTF03H.VALUE
	 REPLACE C91_1.F04H WITH THISFORM.TXTF04H.VALUE
	 REPLACE C91_1.F05H WITH THISFORM.TXTF05H.VALUE
	 REPLACE C91_1.F06H WITH THISFORM.TXTF06H.VALUE
	 REPLACE C91_1.F03I WITH THISFORM.TXTF03I.VALUE
	 REPLACE C91_1.F04I WITH THISFORM.TXTF04I.VALUE
	 REPLACE C91_1.F05I WITH THISFORM.TXTF05I.VALUE
	 REPLACE C91_1.F06I WITH THISFORM.TXTF06I.VALUE       
	 REPLACE C91_1.F03J WITH THISFORM.TXTF03J.VALUE
	 REPLACE C91_1.F04J WITH THISFORM.TXTF04J.VALUE
	 REPLACE C91_1.F05J WITH THISFORM.TXTF05J.VALUE
	 REPLACE C91_1.F06K WITH THISFORM.TXTF06J.VALUE        
	 REPLACE C91_1.F03K WITH THISFORM.TXTF03K.VALUE
	 REPLACE C91_1.F04K WITH THISFORM.TXTF04K.VALUE
	 REPLACE C91_1.F05K WITH THISFORM.TXTF05K.VALUE
	 REPLACE C91_1.F06K WITH THISFORM.TXTF06K.VALUE        
	 REPLACE C91_1.F03L WITH THISFORM.TXTF03L.VALUE
	 REPLACE C91_1.F04L WITH THISFORM.TXTF04L.VALUE
	 REPLACE C91_1.F05L WITH THISFORM.TXTF05L.VALUE
	 REPLACE C91_1.F06L WITH THISFORM.TXTF06L.VALUE       
         REPLACE C91_1.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
         REPLACE C91_1.F10 WITH THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
       						         THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
       						         THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
         REPLACE C91_1.F11 WITH  RIGHT(ALLTRIM(THISFORM.LBLF_LEV.CAPTION),1)          
         FOR I=1 TO 12
               C91_1F03='C91_1.F03'+CHR(64+I)
               C91_1F04='C91_1.F04'+CHR(64+I)
               C91_1F05='C91_1.F05'+CHR(64+I)
               C91_1F06='C91_1.F06'+CHR(64+I)
               NO=ALLTRIM(CHR(64+I))
               SELECT C91
	       SET ORDER TO C911
	       SEEK DTOS(C91_1.F01)+NO
	       IF  FOUND()
	            REPLACE C91.F03 WITH &C91_1F03
	            REPLACE C91.F04 WITH &C91_1F04
	            REPLACE C91.F05 WITH &C91_1F05
	            REPLACE C91.F06 WITH &C91_1F06
	            REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
	       ENDIF     
	ENDFOR       
    ELSE
        DO file_impact
        RETURN   
    ENDIF   
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC
*******************
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK
     SELECT C91_1
     LOCK()
     IF MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	
          SELECT  RECNO() FROM C91 WHERE C91.F01=C91_1.F01 .AND. C91.F02<>'Z'  .AND. C91.F02<>'Y'  INTO ARRAY BK1                                
          JJ1=''                
          IF _TALLY>0   
             FOR I= 1 TO ALEN(BK1)
                 JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
             ENDFOR    
             KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
             RLOCK(KK1,'C91')
             LL1=RLOCK(KK1,'C91')
          ELSE
             LL1=.T.   
          ENDIF   
           IF LL1=.T. .AND. LEN(ALLTRIM(JJ1))>0      
                SELECT C91
                FOR I= 1 TO ALEN(BK1)                      
                        GO BK1(I)  
			DELETE  
                ENDFOR        
           ENDIF   
           RELEASE ALL LIKE BK*
           SELECT C91_1
           IF RLOCK()
                DELETE 
		SKIP -1
                IF BOF()
                    GO TOP
                ENDIF                
           ENDIF
           UNLOCK
      ENDIF              
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC
*************   
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      SELECT C91_1
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.    
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')   
      THISFORM.KEY_LIST.ENABLED=.T.     
      THISFORM.COMBOBOX01.VISIBLE=.F.
      THISFORM.TXTF01.VISIBLE=.T.           
      THISFORM.GRID1.ENABLED=.T. 
      THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       
          THISFORM.CMDGROUP.ENABLED=.F.
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
          THISFORM.TXTF01.VALUE=''
	  THISFORM.TXTF03A.VALUE=0
	  THISFORM.TXTF04A.VALUE=0
	  THISFORM.TXTF05A.VALUE=0
	  THISFORM.TXTF06A.VALUE=0
	  THISFORM.TXTF03B.VALUE=0
	  THISFORM.TXTF04B.VALUE=0
	  THISFORM.TXTF05B.VALUE=0
	  THISFORM.TXTF06B.VALUE=0
	  THISFORM.TXTF03C.VALUE=0
	  THISFORM.TXTF04C.VALUE=0
	  THISFORM.TXTF05C.VALUE=0
	  THISFORM.TXTF06C.VALUE=0
	  THISFORM.TXTF03D.VALUE=0
	  THISFORM.TXTF04D.VALUE=0
	  THISFORM.TXTF05D.VALUE=0
	  THISFORM.TXTF06D.VALUE=0
	  THISFORM.TXTF03E.VALUE=0
	  THISFORM.TXTF04E.VALUE=0
	  THISFORM.TXTF05E.VALUE=0
	  THISFORM.TXTF06E.VALUE=0
	  THISFORM.TXTF03F.VALUE=0
	  THISFORM.TXTF04F.VALUE=0
	  THISFORM.TXTF05F.VALUE=0
	  THISFORM.TXTF06F.VALUE=0
	  THISFORM.TXTF03G.VALUE=0
	  THISFORM.TXTF04G.VALUE=0
	  THISFORM.TXTF05G.VALUE=0
	  THISFORM.TXTF06G.VALUE=0
	  THISFORM.TXTF03H.VALUE=0
	  THISFORM.TXTF04H.VALUE=0
	  THISFORM.TXTF05H.VALUE=0
	  THISFORM.TXTF06H.VALUE=0
	  THISFORM.TXTF03I.VALUE=0
	  THISFORM.TXTF04I.VALUE=0
	  THISFORM.TXTF05I.VALUE=0
	  THISFORM.TXTF06I.VALUE=0
	  THISFORM.TXTF03J.VALUE=0
	  THISFORM.TXTF04J.VALUE=0
	  THISFORM.TXTF05J.VALUE=0
	  THISFORM.TXTF06J.VALUE=0	  
	  THISFORM.TXTF03K.VALUE=0
	  THISFORM.TXTF04K.VALUE=0
	  THISFORM.TXTF05K.VALUE=0
	  THISFORM.TXTF06K.VALUE=0	  
	  THISFORM.TXTF03L.VALUE=0
	  THISFORM.TXTF04L.VALUE=0
	  THISFORM.TXTF05L.VALUE=0
	  THISFORM.TXTF06L.VALUE=0	  
	  THISFORM.LBLF991.CAPTION='' 
          THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
          THISFORM.LBLF_LEV.CAPTION='等        級：'   	  
       ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.            
          THISFORM.CMDGROUP.ENABLED=.T. 
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)   &&判斷有無修改的權限
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限
	  THISFORM.TXTF01.VALUE=LEFT(DTOC(C91_1.F01),5)
	  THISFORM.TXTF03A.VALUE=C91_1.F03A
	  THISFORM.TXTF04A.VALUE=C91_1.F04A
	  THISFORM.TXTF05A.VALUE=C91_1.F05A
	  THISFORM.TXTF06A.VALUE=C91_1.F06A
	  THISFORM.TXTF03B.VALUE=C91_1.F03B
	  THISFORM.TXTF04B.VALUE=C91_1.F04B
	  THISFORM.TXTF05B.VALUE=C91_1.F05B
	  THISFORM.TXTF06B.VALUE=C91_1.F06B
	  THISFORM.TXTF03C.VALUE=C91_1.F03C
	  THISFORM.TXTF04C.VALUE=C91_1.F04C
	  THISFORM.TXTF05C.VALUE=C91_1.F05C
	  THISFORM.TXTF06C.VALUE=C91_1.F06C
	  THISFORM.TXTF03D.VALUE=C91_1.F03D
	  THISFORM.TXTF04D.VALUE=C91_1.F04D
	  THISFORM.TXTF05D.VALUE=C91_1.F05D
	  THISFORM.TXTF06D.VALUE=C91_1.F06D
	  THISFORM.TXTF03E.VALUE=C91_1.F03E
	  THISFORM.TXTF04E.VALUE=C91_1.F04E
	  THISFORM.TXTF05E.VALUE=C91_1.F05E
	  THISFORM.TXTF06E.VALUE=C91_1.F06E
	  THISFORM.TXTF03F.VALUE=C91_1.F03F
	  THISFORM.TXTF04F.VALUE=C91_1.F04F
	  THISFORM.TXTF05F.VALUE=C91_1.F05F
	  THISFORM.TXTF06F.VALUE=C91_1.F06F
	  THISFORM.TXTF03G.VALUE=C91_1.F03G
	  THISFORM.TXTF04G.VALUE=C91_1.F04G
	  THISFORM.TXTF05G.VALUE=C91_1.F05G
	  THISFORM.TXTF06G.VALUE=C91_1.F06G
	  THISFORM.TXTF03H.VALUE=C91_1.F03H
	  THISFORM.TXTF04H.VALUE=C91_1.F04H
	  THISFORM.TXTF05H.VALUE=C91_1.F05H
	  THISFORM.TXTF06H.VALUE=C91_1.F06H
	  THISFORM.TXTF03I.VALUE=C91_1.F03I
	  THISFORM.TXTF04I.VALUE=C91_1.F04I
	  THISFORM.TXTF05I.VALUE=C91_1.F05I
	  THISFORM.TXTF06I.VALUE=C91_1.F06I
	  THISFORM.TXTF03J.VALUE=C91_1.F03J
	  THISFORM.TXTF04J.VALUE=C91_1.F04J
	  THISFORM.TXTF05J.VALUE=C91_1.F05J
	  THISFORM.TXTF06J.VALUE=C91_1.F06J
	  THISFORM.TXTF03K.VALUE=C91_1.F03K
	  THISFORM.TXTF04K.VALUE=C91_1.F04K
	  THISFORM.TXTF05K.VALUE=C91_1.F05K
	  THISFORM.TXTF06K.VALUE=C91_1.F06K
	  THISFORM.TXTF03L.VALUE=C91_1.F03L
	  THISFORM.TXTF04L.VALUE=C91_1.F04L
	  THISFORM.TXTF05L.VALUE=C91_1.F05L
	  THISFORM.TXTF06L.VALUE=C91_1.F06L      
	  THISFORM.LBLF991.CAPTION=C91_1.F99          
          THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(C91_1.F10))+' 分'
          THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_1.F11	   
       ENDIF   
       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無確認的權限 
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)  &&判斷有無新增的權限   
       UNLOCK ALL
  ENDPROC
  ********
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK 
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC       
*************1.當月銷售收入
   PROCEDURE TXTF03A.INTERACTIVECHANGE
           THISFORM.TXTF05A.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04A.VALUE,100,ROUND((THISFORM.TXTF04A.VALUE/THISFORM.TXTF03A.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
           THISFORM.TXTF06A.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04A.VALUE,C91_2.F08A,ROUND((C91_2.F08A/THISFORM.TXTF03A.VALUE)*THISFORM.TXTF04A.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1
  ENDPROC          
  PROCEDURE TXTF04A.INTERACTIVECHANGE 
           THISFORM.TXTF05A.VALUE=IIF(THISFORM.TXTF03A.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03A.VALUE)*100,0)) 
           THISFORM.TXTF06A.VALUE=IIF(THISFORM.TXTF03A.VALUE<=THIS.VALUE,C91_2.F08A,ROUND((C91_2.F08A/THISFORM.TXTF03A.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1       
  ENDPROC
  PROCEDURE TXTF06A.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
ENDPROC 
*************2.銷售收入毛利比
   PROCEDURE TXTF03B.INTERACTIVECHANGE
           THISFORM.TXTF05B.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04B.VALUE,100,ROUND((THISFORM.TXTF04B.VALUE/THISFORM.TXTF03B.VALUE)*100,0)) 
           THISFORM.TXTF06B.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04B.VALUE,C91_2.F08B,ROUND((C91_2.F08B/THISFORM.TXTF03B.VALUE)*THISFORM.TXTF04B.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04B.INTERACTIVECHANGE 
           THISFORM.TXTF05B.VALUE=IIF(THISFORM.TXTF03B.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03B.VALUE)*100,0)) 
           THISFORM.TXTF06B.VALUE=IIF(THISFORM.TXTF03B.VALUE<=THIS.VALUE,C91_2.F08B,ROUND((C91_2.F08B/THISFORM.TXTF03B.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC 
  PROCEDURE TXTF06B.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************3.應收帳款回收率
   PROCEDURE TXTF03C.INTERACTIVECHANGE
           THISFORM.TXTF05C.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04C.VALUE,100,ROUND((THISFORM.TXTF04C.VALUE/THISFORM.TXTF03C.VALUE)*100,0)) 
           THISFORM.TXTF06C.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04C.VALUE,C91_2.F08C,ROUND((C91_2.F08C/THISFORM.TXTF03C.VALUE)*THISFORM.TXTF04C.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04C.INTERACTIVECHANGE 
           THISFORM.TXTF05C.VALUE=IIF(THISFORM.TXTF03C.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03C.VALUE)*100,0)) 
           THISFORM.TXTF06C.VALUE=IIF(THISFORM.TXTF03C.VALUE<=THIS.VALUE,C91_2.F08C,ROUND((C91_2.F08C/THISFORM.TXTF03C.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC     
  PROCEDURE TXTF06C.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************4.在庫非呆料
   PROCEDURE TXTF03D.INTERACTIVECHANGE
           THISFORM.TXTF05D.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04D.VALUE,100,ROUND((THISFORM.TXTF04D.VALUE/THISFORM.TXTF03D.VALUE)*100,0)) 
           THISFORM.TXTF06D.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04D.VALUE,C91_2.F08D,ROUND((C91_2.F08D/THISFORM.TXTF03D.VALUE)*THISFORM.TXTF04D.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04D.INTERACTIVECHANGE 
           THISFORM.TXTF05D.VALUE=IIF(THISFORM.TXTF03D.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03D.VALUE)*100,0)) 
           THISFORM.TXTF06D.VALUE=IIF(THISFORM.TXTF03D.VALUE<=THIS.VALUE,C91_2.F08D,ROUND((C91_2.F08D/THISFORM.TXTF03D.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC  
  PROCEDURE TXTF06D.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************5.在庫呆料變動率
   PROCEDURE TXTF03E.INTERACTIVECHANGE
           THISFORM.TXTF05E.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04E.VALUE,100,ROUND((THISFORM.TXTF04E.VALUE/THISFORM.TXTF03E.VALUE)*100,0)) 
           THISFORM.TXTF06E.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04E.VALUE,C91_2.F08E,ROUND((C91_2.F08E/THISFORM.TXTF03E.VALUE)*THISFORM.TXTF04E.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04E.INTERACTIVECHANGE 
           THISFORM.TXTF05E.VALUE=IIF(THISFORM.TXTF03E.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03E.VALUE)*100,0)) 
           THISFORM.TXTF06E.VALUE=IIF(THISFORM.TXTF03E.VALUE<=THIS.VALUE,C91_2.F08E,ROUND((C91_2.F08E/THISFORM.TXTF03E.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC     
  PROCEDURE TXTF06E.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************6.上海廠.....
   PROCEDURE TXTF03F.INTERACTIVECHANGE
           THISFORM.TXTF05F.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04F.VALUE,100,ROUND((THISFORM.TXTF04F.VALUE/THISFORM.TXTF03F.VALUE)*100,0)) 
           THISFORM.TXTF06F.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04F.VALUE,C91_2.F08F,ROUND((C91_2.F08F/THISFORM.TXTF03F.VALUE)*THISFORM.TXTF04F.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04F.INTERACTIVECHANGE 
           THISFORM.TXTF05F.VALUE=IIF(THISFORM.TXTF03F.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03F.VALUE)*100,0)) 
           THISFORM.TXTF06F.VALUE=IIF(THISFORM.TXTF03F.VALUE<=THIS.VALUE,C91_2.F08F,ROUND((C91_2.F08F/THISFORM.TXTF03F.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC     
  PROCEDURE TXTF06F.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************7.緊急採購.....
   PROCEDURE TXTF03G.INTERACTIVECHANGE
           THISFORM.TXTF05G.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04G.VALUE,100,ROUND((THISFORM.TXTF04G.VALUE/THISFORM.TXTF03G.VALUE)*100,0)) 
           THISFORM.TXTF06G.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04G.VALUE,C91_2.F08G,ROUND((C91_2.F08G/THISFORM.TXTF03G.VALUE)*THISFORM.TXTF04G.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04G.INTERACTIVECHANGE 
           THISFORM.TXTF05G.VALUE=IIF(THISFORM.TXTF03G.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03G.VALUE)*100,0)) 
           THISFORM.TXTF06G.VALUE=IIF(THISFORM.TXTF03G.VALUE<=THIS.VALUE,C91_2.F08G,ROUND((C91_2.F08G/THISFORM.TXTF03G.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC    
  PROCEDURE TXTF06G.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************8.維持交易客戶.....
   PROCEDURE TXTF03H.INTERACTIVECHANGE
           THISFORM.TXTF05H.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04H.VALUE,100,ROUND((THISFORM.TXTF04H.VALUE/THISFORM.TXTF03H.VALUE)*100,0)) 
           THISFORM.TXTF06H.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04H.VALUE,C91_2.F08H,ROUND((C91_2.F08H/THISFORM.TXTF03H.VALUE)*THISFORM.TXTF04H.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04H.INTERACTIVECHANGE 
           THISFORM.TXTF05H.VALUE=IIF(THISFORM.TXTF03H.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03H.VALUE)*100,0)) 
           THISFORM.TXTF06H.VALUE=IIF(THISFORM.TXTF03H.VALUE<=THIS.VALUE,C91_2.F08H,ROUND((C91_2.F08H/THISFORM.TXTF03H.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC   
  PROCEDURE TXTF06H.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************9.新客戶成長.....
   PROCEDURE TXTF03I.INTERACTIVECHANGE
           THISFORM.TXTF05I.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04I.VALUE,100,ROUND((THISFORM.TXTF04I.VALUE/THISFORM.TXTF03I.VALUE)*100,0)) 
           THISFORM.TXTF06I.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04I.VALUE,C91_2.F08I,ROUND((C91_2.F08I/THISFORM.TXTF03I.VALUE)*THISFORM.TXTF04I.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04I.INTERACTIVECHANGE 
           THISFORM.TXTF05I.VALUE=IIF(THISFORM.TXTF03I.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03I.VALUE)*100,0)) 
           THISFORM.TXTF06I.VALUE=IIF(THISFORM.TXTF03I.VALUE<=THIS.VALUE,C91_2.F08I,ROUND((C91_2.F08I/THISFORM.TXTF03I.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC     
  PROCEDURE TXTF06I.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            	
*************10.各類產品開發率.....
   PROCEDURE TXTF03J.INTERACTIVECHANGE
           THISFORM.TXTF05J.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04J.VALUE,100,ROUND((THISFORM.TXTF04J.VALUE/THISFORM.TXTF03J.VALUE)*100,0)) 
           THISFORM.TXTF06J.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04J.VALUE,C91_2.F08J,ROUND((C91_2.F08J/THISFORM.TXTF03J.VALUE)*THISFORM.TXTF04J.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04J.INTERACTIVECHANGE 
           THISFORM.TXTF05J.VALUE=IIF(THISFORM.TXTF03J.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03J.VALUE)*100,0)) 
           THISFORM.TXTF06J.VALUE=IIF(THISFORM.TXTF03J.VALUE<=THIS.VALUE,C91_2.F08J,ROUND((C91_2.F08J/THISFORM.TXTF03J.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC     
  PROCEDURE TXTF06J.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************11.部品特殊運輸費用.....
   PROCEDURE TXTF03K.INTERACTIVECHANGE
           THISFORM.TXTF05K.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04K.VALUE,100,ROUND((THISFORM.TXTF04K.VALUE/THISFORM.TXTF03K.VALUE)*100,0)) 
           THISFORM.TXTF06K.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04K.VALUE,C91_2.F08K,ROUND((C91_2.F08K/THISFORM.TXTF03K.VALUE)*THISFORM.TXTF04K.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04K.INTERACTIVECHANGE 
           THISFORM.TXTF05K.VALUE=IIF(THISFORM.TXTF03K.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03K.VALUE)*100,0)) 
           THISFORM.TXTF06K.VALUE=IIF(THISFORM.TXTF03K.VALUE<=THIS.VALUE,C91_2.F08K,ROUND((C91_2.F08K/THISFORM.TXTF03K.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC     
  PROCEDURE TXTF06K.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												               
*************12.加工類.....
   PROCEDURE TXTF03L.INTERACTIVECHANGE
           THISFORM.TXTF05L.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04L.VALUE,100,ROUND((THISFORM.TXTF04L.VALUE/THISFORM.TXTF03L.VALUE)*100,0)) 
           THISFORM.TXTF06L.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF04L.VALUE,C91_2.F08L,ROUND((C91_2.F08L/THISFORM.TXTF03L.VALUE)*THISFORM.TXTF04L.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC          
  PROCEDURE TXTF04L.INTERACTIVECHANGE 
           THISFORM.TXTF05L.VALUE=IIF(THISFORM.TXTF03L.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF03L.VALUE)*100,0)) 
           THISFORM.TXTF06L.VALUE=IIF(THISFORM.TXTF03L.VALUE<=THIS.VALUE,C91_2.F08L,ROUND((C91_2.F08L/THISFORM.TXTF03L.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
                    THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
                    THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C91_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C91_TEMPY.F10 .AND. TOL>=C91_TEMPY.F11
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
                  ENDIF
                  SELECT C91_TEMPY
                  SKIP
           ENDDO
	   SELECT C91_1               
  ENDPROC     
  PROCEDURE TXTF06L.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
           												               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
           												               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE))+' 分'
  ENDPROC            												                 											               
**********  
  PROC ANS_BOTT.CLICK     &&參數設定
       SELECT  C91_1
       NO=C91_1.F01
       ANS_SEEK=CREATEOBJECT("ANS_SEEK")  
       ANS_SEEK.SHOW                
       FLG='0'           
       SELECT  C91_1  
       SEEK DTOS(NO)
       THISFORM.GRID1.SETFOCUS
  ENDPROC
ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
       LK=C91_1.F01
        SELECT * FROM C91_1 WHERE  LEFT(DTOS(C91_1.F01),6)=LEFT(DTOS(LK),6)  NOWAIT
        IF _TALLY >0
            REPORT FORM ALLTRIM(INT_116)+'C91' TO PRINT PROMPT PREVIEW
            CLEAR
        ELSE
            =MESSAGEBOX('資料不完全無法列印',0+48,'警示')
        ENDIF   
ENDPROC
*************************************************員工編號
DEFINE CLASS COMBOBOX01 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*65
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX01'
 PROCEDURE INIT    
       SELECT LEFT(DTOC(F01),5) FROM A23   ORDER BY F01 DESC  INTO CURSOR A23_TEMP
       SELECT A23_TEMP
       GO TOP  
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(A23_TEMP.EXP_1))
      	      SELECT  A23_TEMP
      	      SKIP
       ENDDO
       SELECT A23_TEMP
       USE    
  ENDPROC  
  PROCEDURE INTERACTIVECHANGE
       IF THIS.VALUE=1
	   THISFORM.TXTF01.VALUE=''
	   THISFORM.TXTF03A.VALUE=0
	   THISFORM.TXTF04A.VALUE=0
	   THISFORM.TXTF05A.VALUE=0
	   THISFORM.TXTF06A.VALUE=0
	   THISFORM.TXTF03B.VALUE=0
	   THISFORM.TXTF04B.VALUE=0
	   THISFORM.TXTF05B.VALUE=0
	   THISFORM.TXTF06B.VALUE=0
	   THISFORM.TXTF03C.VALUE=0
	   THISFORM.TXTF04C.VALUE=0
	   THISFORM.TXTF05C.VALUE=0
	   THISFORM.TXTF06C.VALUE=0
	   THISFORM.TXTF03D.VALUE=0
	   THISFORM.TXTF04D.VALUE=0
	   THISFORM.TXTF05D.VALUE=0
	   THISFORM.TXTF06D.VALUE=0
	   THISFORM.TXTF03E.VALUE=0
	   THISFORM.TXTF04E.VALUE=0
	   THISFORM.TXTF05E.VALUE=0
	   THISFORM.TXTF06E.VALUE=0
	   THISFORM.TXTF03F.VALUE=0
	   THISFORM.TXTF04F.VALUE=0
	   THISFORM.TXTF05F.VALUE=0
	   THISFORM.TXTF06F.VALUE=0
	   THISFORM.TXTF03G.VALUE=0
	   THISFORM.TXTF04G.VALUE=0
	   THISFORM.TXTF05G.VALUE=0
	   THISFORM.TXTF06G.VALUE=0
	   THISFORM.TXTF03H.VALUE=0
	   THISFORM.TXTF04H.VALUE=0
	   THISFORM.TXTF05H.VALUE=0
	   THISFORM.TXTF06H.VALUE=0
	   THISFORM.TXTF03I.VALUE=0
	   THISFORM.TXTF04I.VALUE=0
	   THISFORM.TXTF05I.VALUE=0
	   THISFORM.TXTF06I.VALUE=0
	   THISFORM.TXTF03J.VALUE=0
	   THISFORM.TXTF04J.VALUE=0
	   THISFORM.TXTF05J.VALUE=0
	   THISFORM.TXTF06J.VALUE=0      
	   THISFORM.TXTF03K.VALUE=0
	   THISFORM.TXTF04K.VALUE=0
	   THISFORM.TXTF05K.VALUE=0
	   THISFORM.TXTF06K.VALUE=0
	   THISFORM.TXTF03L.VALUE=0
	   THISFORM.TXTF04L.VALUE=0
	   THISFORM.TXTF05L.VALUE=0
	   THISFORM.TXTF06L.VALUE=0              
	   THISFORM.LBLF991.CAPTION=''          
	   THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
	   THISFORM.LBLF_LEV.CAPTION='等        級：'         
       ELSE     
            THISFORM.TXTF01.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
            HK=ALLTRIM(THISFORM.TXTF01.VALUE)
            HK1=''
            DO CASE &&抓取前次目標值
                  CASE  (VAL(RIGHT(HK,2))-1)=0
                              HK1=ALLTRIM(STR(VAL(LEFT(HK,2))-1))+'/12/01'
                  CASE  (VAL(RIGHT(HK,2))-1)<10    .AND.  (VAL(RIGHT(HK,2))-1)<>0
                              HK1=LEFT(HK,3)+'0'+ALLTRIM(STR(VAL(RIGHT(HK,2))-1))+'/01'
                  OTHERWISE 
                              HK1=LEFT(HK,3)+ALLTRIM(STR(VAL(RIGHT(HK,2))-1))+'/01'           
             ENDCASE   
             C10='C10'+LEFT(ALLTRIM(DTOS(CTOD(HK+'/01'))),6)   &&出貨日報表檔
             F=ALLTRIM(C10)+'.DBF'
             IF FILE('&F')=.F.
		  =MESSAGEBOX('此考核年月 '+LEFT(DTOC(THIS.VALUE),5)+' 尚無資料,請重新輸入!',0+64,'提示視窗')
	          THISFORM.COMBOBOX01.SETFOCUS
	          THISFORM.COMBOBOX01.VALUE=1
	          RETURN
	     ENDIF
	     IF !USED('&C10')
	          SELE 0
	          USE (C10) ALIA C10 INDE (C10)
	     ELSE
                  SELE C10
             ENDIF
	     SET ORDER TO 1  
	     CALCULATE  SUM(F07*F08) TO TQTY   &&總銷售金額
	     SELECT C01.F02,SUM(C10.F07*C10.F08),SUM(B01.F37*C10.F08) FROM C10,C01,B01  WHERE  C01.F01=C10.F02  .AND. B01.F01=C10.F03  .AND. C10.F08>0  INTO CURSOR C10_1       
	*!*	      CALCULATE SUM(SUM_EXP_2) TO TOY
	     ****1.當月銷售收入
	     THISFORM.TXTF03A.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'A',.T.,'C91','C911'),C91.F03,0)
             THISFORM.TXTF04A.VALUE=TQTY     
	     THISFORM.TXTF05A.VALUE=IIF(THISFORM.TXTF03A.VALUE<=THISFORM.TXTF04A.VALUE,100,ROUND((THISFORM.TXTF04A.VALUE/THISFORM.TXTF03A.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
	     THISFORM.TXTF06A.VALUE=IIF(THISFORM.TXTF03A.VALUE<=THISFORM.TXTF04A.VALUE,C91_2.F08A,ROUND((C91_2.F08A/THISFORM.TXTF03A.VALUE)*THISFORM.TXTF04A.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值
	      ****2.銷售收入毛利
	     THISFORM.TXTF03B.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'B',.T.,'C91','C911'),C91.F03,0)
	     THISFORM.TXTF04B.VALUE=IIF(C10_1.SUM_EXP_2=0,0,ROUND((C10_1.SUM_EXP_2-C10_1.SUM_EXP_3)/C10_1.SUM_EXP_2*100,0))
	*!*	      THISFORM.TXTF04B.VALUE=TOY&&ROUND((TOY/RECCOUNT('C10_1'))*100,0)
	     THISFORM.TXTF05B.VALUE=IIF(THISFORM.TXTF03B.VALUE<=THISFORM.TXTF04B.VALUE,100,ROUND((THISFORM.TXTF04B.VALUE/THISFORM.TXTF03B.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
	     THISFORM.TXTF06B.VALUE=IIF(THISFORM.TXTF03B.VALUE<=THISFORM.TXTF04B.VALUE,C91_2.F08B,ROUND((C91_2.F08B/THISFORM.TXTF03B.VALUE)*THISFORM.TXTF04B.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值
	     SELECT C10_1
	     USE
	     SELECT C10
	     USE
	     ****3.應收帳款
	     REC_F05=0  &&已收帳款金額
	     REC_F06=0  &&應收帳款金額
	     SELECT K5F.F13,SUM(K5F.F04) FROM K5F WHERE  K5F.F14='1'  .AND.  LEFT(DTOS(K5F.F10),6)=LEFT(DTOS(CTOD(HK+'/01')),6)  INTO CURSOR K5FA
	     REC_F05=K5FA.SUM_F04   
	     REC_F06=K5FA.SUM_F04  
	     SELECT K5FA
	     USE
	     SELECT K51.F17,SUM(K51.F10) FROM K51 WHERE K51.F19='1'  .AND.  LEFT(DTOS(K51.F15),6)=LEFT(DTOS(CTOD(HK+'/01')),6)  INTO CURSOR K51A
	     REC_F06=REC_F06+K51A.SUM_F10  
	     SELECT K51A
	     USE	         	         
	     THISFORM.TXTF03C.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'C',.T.,'C91','C911'),C91.F03,0)
	     THISFORM.TXTF04C.VALUE=IIF(REC_F06<>0 .AND. REC_F05<>0,ROUND((REC_F05/REC_F06)*100,0),0)
	     THISFORM.TXTF05C.VALUE=IIF(THISFORM.TXTF03C.VALUE<=THISFORM.TXTF04C.VALUE,100,ROUND((THISFORM.TXTF04C.VALUE/THISFORM.TXTF03C.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
	     THISFORM.TXTF06C.VALUE=IIF(THISFORM.TXTF03C.VALUE<=THISFORM.TXTF04C.VALUE,C91_2.F08C,ROUND((C91_2.F08C/THISFORM.TXTF03C.VALUE)*THISFORM.TXTF04C.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值      
	     ****4.
	     THISFORM.TXTF03D.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'D',.T.,'C91','C911'),C91.F03,0)
	     ****5.
	     THISFORM.TXTF03E.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'E',.T.,'C91','C911'),C91.F03,0)
	     ****6.
	     THISFORM.TXTF03F.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'F',.T.,'C91','C911'),C91.F03,0)
	     ****7.
	     THISFORM.TXTF03G.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'G',.T.,'C91','C911'),C91.F03,0)
	     ****8.維持交易客戶數量
	      C13_NUM1=0
	      C13_NUM2=0
	      YEA=ALLTRIM(STR(VAL(LEFT(HK,2))+1911))
	      MON=RIGHT(ALLTRIM(HK),2)
	      C13=ALLTRIM('C13'+YEA+MON)
              IF !USED('&C13')
		    SELECT  0
		    USE (C13) ALIA C13
	      ELSE
		    SELECT  C13
	      ENDIF    
	      SELECT C13.F03 FROM C13,C01 WHERE C13.F03=C01.F01  GROUP BY C13.F03 INTO CURSOR C13_TEMP
	      C13_NUM1=RECCOUNT('C13_TEMP')  &&本月份客戶數
	      SELECT C13_TEMP
	      USE
	      SELECT C13
	      USE	    
	      FOR I=1 TO 3  STEP 1  &&前3各月平均客戶數
	              DO CASE 
	                     CASE VAL(MON)-I=0
	                                YEA=ALLTRIM(STR(VAL(LEFT(HK,2))+1910))
	                                 MON1='12'
	                     CASE VAL(MON)-I=-1
	                                YEA=ALLTRIM(STR(VAL(LEFT(HK,2))+1910))
	                                MON1='11'        
	                     CASE VAL(MON)-I=-2
	                                YEA=ALLTRIM(STR(VAL(LEFT(HK,2))+1910))
	                                MON1='10'	  
	                     OTHERWISE          
	                                MON1=IIF((VAL(MON)-I)<10,'0'+ALLTRIM(STR(VAL(MON)-I)),ALLTRIM(STR(VAL(MON)-I)))
	              ENDCASE                                          
	              C13=ALLTRIM('C13'+YEA+MON1)
		      IF !USED('&C13')
		           SELECT  0 
	 	           USE (C13) ALIA C13
		      ELSE
		            SELECT  C13
		      ENDIF    
		      SELECT C13.F03 FROM C13,C01 WHERE C13.F03=C01.F01  GROUP BY C13.F03 INTO CURSOR C13_TEMP
		      C13_NUM2=C13_NUM2+RECCOUNT('C13_TEMP')
		      SELECT C13_TEMP
		      USE
		      SELECT C13
		      USE		           
	      ENDFOR         
	      THISFORM.TXTF03H.VALUE=ROUND(C13_NUM2/3,0)
	      THISFORM.TXTF04H.VALUE=C13_NUM1
	      THISFORM.TXTF05H.VALUE=IIF(THISFORM.TXTF03H.VALUE<=THISFORM.TXTF04H.VALUE,100,ROUND((THISFORM.TXTF04H.VALUE/THISFORM.TXTF03H.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
	      THISFORM.TXTF06H.VALUE=IIF(THISFORM.TXTF03H.VALUE<=THISFORM.TXTF04H.VALUE,C91_2.F08H,ROUND((C91_2.F08H/THISFORM.TXTF03H.VALUE)*THISFORM.TXTF04H.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值
	      ****9.
	      THISFORM.TXTF03I.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'I',.T.,'C91','C911'),C91.F03,0)
	      ****10.
	      THISFORM.TXTF03J.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'J',.T.,'C91','C911'),C91.F03,0)
	      ****11.
	      THISFORM.TXTF03K.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'K',.T.,'C91','C911'),C91.F03,0)
	      ****12.
	      THISFORM.TXTF03L.VALUE=IIF(INDEXSEEK(DTOS(CTOD(HK1))+'L',.T.,'C91','C911'),C91.F03,0)
	      ****
	      TOL=THISFORM.TXTF06A.VALUE+THISFORM.TXTF06B.VALUE+THISFORM.TXTF06C.VALUE+THISFORM.TXTF06D.VALUE+;
	               THISFORM.TXTF06E.VALUE+THISFORM.TXTF06F.VALUE+THISFORM.TXTF06G.VALUE+THISFORM.TXTF06H.VALUE+;
	               THISFORM.TXTF06I.VALUE+THISFORM.TXTF06J.VALUE+THISFORM.TXTF06K.VALUE+THISFORM.TXTF06L.VALUE
	      THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
	      SELECT C91_TEMPY
	      GO TOP
	      DO WHILE !EOF()
	             IF TOL<=C91_TEMPY.F10 .AND. TOL>C91_TEMPY.F11
	                 THISFORM.LBLF_LEV.CAPTION='等        級：' +C91_TEMPY.F09
	             ENDIF
	             SELECT C91_TEMPY
	             SKIP
	      ENDDO
	      SELECT C91_1   
	ENDIF            
  ENDPROC 
ENDDEFINE      
************************************************參數設定
DEFINE CLASS ANS_SEEK AS FORM
  AUTOCENTER=.T.
  CAPTION='參數設定'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*500
  WIDTH=INT_015*363
  FONTSIZE=INT_015*9
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_SEEK'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      LEFT=INT_015*3,;
      WIDTH=INT_015*354,;
      HEIGHT=INT_015*496
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      TOP=INT_015*6,;
      LEFT=INT_015*9,;
      WIDTH=INT_015*343,;
      HEIGHT=INT_015*485,;
      FONTSIZE=INT_015*9,;
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='考核內容比重設定',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='考核等級範圍設定'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      VISIBLE=.F.    
PROCEDURE PAGEFRAME1.PAGE1.INIT           
     THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*18
          .AUTOSIZE=.T.
          .CAPTION='比    重'       
     ENDWITH   
     THIS.ADDOBJECT('LINE08','LINE')
     WITH THIS.LINE08 
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*35
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312       
     ENDWITH      
     THIS.ADDOBJECT('LINEL','LINE')
     WITH THIS.LINEL 
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*35
          .HEIGHT=INT_015*338
          .WIDTH=INT_015*0     
     ENDWITH 
     THIS.ADDOBJECT('LINER','LINE')
     WITH THIS.LINER 
          .VISIBLE=.T.
          .LEFT=INT_015*325
          .TOP=INT_015*35
          .HEIGHT=INT_015*338
          .WIDTH=INT_015*0       
     ENDWITH            
 **************     
     THIS.ADDOBJECT('LBLF02A','LABEL')
     WITH THIS.LBLF02A
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*44
          .AUTOSIZE=.T.
          .CAPTION='1、當月銷售收入                                                                分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08A','TXTF08A')
     WITH THIS.TXTF08A
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*39
     ENDWITH      
     THIS.ADDOBJECT('LINE02A','LINE')
     WITH THIS.LINE02A
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*64
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH              
  ***********
     THIS.ADDOBJECT('LBLF02B','LABEL')
     WITH THIS.LBLF02B
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*72
          .AUTOSIZE=.T.
          .CAPTION='2、銷售收入毛利率                                                            分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08B','TXTF08B')
     WITH THIS.TXTF08B
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*67
     ENDWITH      
     THIS.ADDOBJECT('LINE02B','LINE')
     WITH THIS.LINE02B
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*92
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH   
  ***********
     THIS.ADDOBJECT('LBLF02C','LABEL')
     WITH THIS.LBLF02C
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*100
          .AUTOSIZE=.T.
          .CAPTION='3、應收帳款回收率                                                            分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08C','TXTF08C')
     WITH THIS.TXTF08C
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*95  
     ENDWITH      
     THIS.ADDOBJECT('LINE02C','LINE')
     WITH THIS.LINE02C
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*120
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH              
  *********** 
     THIS.ADDOBJECT('LBLF02D','LABEL')
     WITH THIS.LBLF02D
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*128
          .AUTOSIZE=.T.
          .CAPTION='4、在庫非呆料庫存週轉率                                                分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08D','TXTF08D')
     WITH THIS.TXTF08D
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*123   
     ENDWITH      
     THIS.ADDOBJECT('LINE02D','LINE')
     WITH THIS.LINE02D
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*148
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH              
  ***********      
     THIS.ADDOBJECT('LBLF02E','LABEL')
     WITH THIS.LBLF02E
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*156
          .AUTOSIZE=.T.
          .CAPTION='5、在庫呆料變動率                                                            分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08E','TXTF08E')
     WITH THIS.TXTF08E
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*151
     ENDWITH      
     THIS.ADDOBJECT('LINE02E','LINE')
     WITH THIS.LINE02E
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*176
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH              
  ***********      
     THIS.ADDOBJECT('LBLF02F','LABEL')
     WITH THIS.LBLF02F
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*184
          .AUTOSIZE=.T.
          .CAPTION='6、上海廠間接接單金額                                                    分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08F','TXTF08F')
     WITH THIS.TXTF08F
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*179
     ENDWITH      
     THIS.ADDOBJECT('LINE02F','LINE')
     WITH THIS.LINE02F
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*204
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH 
   **********
     THIS.ADDOBJECT('LBLF02G','LABEL')
     WITH THIS.LBLF02G
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*212
          .AUTOSIZE=.T.
          .CAPTION='7、緊急採購、緊急異動及訂購異動率                            分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08G','TXTF08G')
     WITH THIS.TXTF08G
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*207 
     ENDWITH      
     THIS.ADDOBJECT('LINE02G','LINE')
     WITH THIS.LINE02G
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*232
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH                     
  ***********    
     THIS.ADDOBJECT('LBLF02H','LABEL')
     WITH THIS.LBLF02H
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*240
          .AUTOSIZE=.T.
          .CAPTION='8、維持交易客戶數量                                                        分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08H','TXTF08H')
     WITH THIS.TXTF08H
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*235
     ENDWITH      
     THIS.ADDOBJECT('LINE04H','LINE')
     WITH THIS.LINE04H
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*260
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH                     
  ***********     
     THIS.ADDOBJECT('LBLF02I','LABEL')
     WITH THIS.LBLF02I
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*268
          .AUTOSIZE=.T.
          .CAPTION='9、新客戶增長率                                                                分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08I','TXTF08I')
     WITH THIS.TXTF08I
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*263
     ENDWITH      
     THIS.ADDOBJECT('LINE02I','LINE')
     WITH THIS.LINE02I
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*288
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH               
  ***********     
     THIS.ADDOBJECT('LBLF02J','LABEL')
     WITH THIS.LBLF02J
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*296
          .AUTOSIZE=.T.
          .CAPTION='10、各類新產品開發率                                                      分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08J','TXTF08J')
     WITH THIS.TXTF08J
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*291
     ENDWITH      
     THIS.ADDOBJECT('LINE02J','LINE')
     WITH THIS.LINE02J
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*316
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH     
  ***********     
     THIS.ADDOBJECT('LBLF02K','LABEL')
     WITH THIS.LBLF02K
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*324
          .AUTOSIZE=.T.
          .CAPTION='11、部品特殊運費用                                                          分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08K','TXTF08K')
     WITH THIS.TXTF08K
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*319
     ENDWITH      
     THIS.ADDOBJECT('LINE02K','LINE')
     WITH THIS.LINE02K
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*344
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH                 
  ***********     
     THIS.ADDOBJECT('LBLF02L','LABEL')
     WITH THIS.LBLF02L
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*352
          .AUTOSIZE=.T.
          .CAPTION='12、加工類特殊採購及製造費用                                      分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF08L','TXTF08L')
     WITH THIS.TXTF08L
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*347
     ENDWITH      
     THIS.ADDOBJECT('LINE02L','LINE')
     WITH THIS.LINE02L
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*372
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH                                                
********
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*385
          .WIDTH=INT_015*50
          .CAPTION='安全資料'       
     ENDWITH 
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*75
          .TOP=INT_015*385
          .AUTOSIZE=.T.
          .CAPTION=''       
     ENDWITH   
     THIS.ADDOBJECT('LBLF_TOA','LABEL')
     WITH THIS.LBLF_TOA
          .VISIBLE=.T.
          .LEFT=INT_015*217
          .TOP=INT_015*385
          .WIDTH=INT_015*50
          .CAPTION='總 比 重'       
     ENDWITH 
     THIS.ADDOBJECT('LBLF_TOA1','LABEL')
     WITH THIS.LBLF_TOA1
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*385
          .AUTOSIZE=.T.
          .CAPTION=''       
     ENDWITH        
 ENDPROC    
 *********
PROCEDURE PAGEFRAME1.PAGE2.INIT  
     THIS.ADDOBJECT('LBLF09A','LABEL')
     WITH THIS.LBLF09A
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*44
          .AUTOSIZE=.T.
          .CAPTION='1、等級A    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10A','TEXTBOX')
     WITH THIS.TXTF10A
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*39
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF10A'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF11A','TEXTBOX')
     WITH THIS.TXTF11A
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*39
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF11A'     
     ENDWITH       
    ***
     THIS.ADDOBJECT('LBLF09B','LABEL')
     WITH THIS.LBLF09B
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*72
          .AUTOSIZE=.T.
          .CAPTION='2、等級B    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10B','TEXTBOX')
     WITH THIS.TXTF10B
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*67
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF10B'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF11B','TEXTBOX')
     WITH THIS.TXTF11B
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*67
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF11B'     
     ENDWITH      
   ****
     THIS.ADDOBJECT('LBLF09C','LABEL')
     WITH THIS.LBLF09C
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*100
          .AUTOSIZE=.T.
          .CAPTION='3、等級C    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10C','TEXTBOX')
     WITH THIS.TXTF10C
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*95
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF10C'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF11C','TEXTBOX')
     WITH THIS.TXTF11C
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*95
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF11C'     
     ENDWITH      
   ****
     THIS.ADDOBJECT('LBLF09D','LABEL')
     WITH THIS.LBLF09D
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*128
          .AUTOSIZE=.T.
          .CAPTION='4、等級D    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10D','TEXTBOX')
     WITH THIS.TXTF10D
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*123
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF10D'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF11D','TEXTBOX')
     WITH THIS.TXTF11D
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*123
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF11D'     
     ENDWITH      
   ****
    THIS.ADDOBJECT('LBLF09E','LABEL')
     WITH THIS.LBLF09E
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*156
          .AUTOSIZE=.T.
          .CAPTION='5、等級E    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10E','TEXTBOX')
     WITH THIS.TXTF10E
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*151
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF10E'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF11E','TEXTBOX')
     WITH THIS.TXTF11E
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*151
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF11E'     
     ENDWITH      
   ****   
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*200
          .WIDTH=INT_015*50
          .CAPTION='安全資料'       
     ENDWITH 
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*75
          .TOP=INT_015*200
          .AUTOSIZE=.T.
          .CAPTION=''       
     ENDWITH   
ENDPROC    
****    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*25,;
      TOP=INT_015*455,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<E.修改',;
      TOOLTIPTEXT='修改此作業內容!快速鍵->ALT+E'
      NAME='CMND1'      
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*68,;
      TOP=INT_015*455,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<X.離開',;
      TOOLTIPTEXT='取消此作業畫面!快速鍵->ALT+X'
      NAME='CMND2'
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*252,;
      TOP=INT_015*445,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<Y.確認',;
      TOOLTIPTEXT='確認此作業內容!快速鍵->ALT+E'
      NAME='CMND3'        
  ADD OBJECT CMND4 AS COMMANDBUTTON WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*445,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<C.結束',;
      TOOLTIPTEXT='結束此作業內容!快速鍵->ALT+E'
      NAME='CMND4'            
   ********   
      PROCEDURE INIT 
          SELECT C91_2
          GO TOP
         THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
         THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9
         THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX') 
         THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')    
         THISFORM.SETALL('HEIGHT',INT_015*22,'TEXTBOX')   
         THISFORM.SETALL('READONLY',.T.,'TEXTBOX')     
         THISFORM.CMND1.ENABLED=.T.               
         THISFORM.CMND2.ENABLED=.T.           
         THISFORM.CMND3.VISIBLE=.F.  
         THISFORM.CMND4.VISIBLE=.F.       
         THISFORM.PAGEFRAME1.PAGE1.TXTF08A.SETFOCUS       
         THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE=C91_2.F08A
         THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE=C91_2.F08B
         THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE=C91_2.F08C
         THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE=C91_2.F08D
         THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE=C91_2.F08E
         THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE=C91_2.F08F
         THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE=C91_2.F08G
         THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE=C91_2.F08H
         THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE=C91_2.F08I
         THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE=C91_2.F08J
         THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE=C91_2.F08K
         THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE=C91_2.F08L
         THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=C91_2.F99   
         THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(C91_2.F98))+'    分'              
      ENDPROC
   *******   
    PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
         SELECT C91_2
         THISFORM.PAGEFRAME1.PAGE1.TXTF08A.SETFOCUS 
         THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE=C91_2.F08A
         THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE=C91_2.F08B
         THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE=C91_2.F08C
         THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE=C91_2.F08D
         THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE=C91_2.F08E
         THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE=C91_2.F08F
         THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE=C91_2.F08G
         THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE=C91_2.F08H
         THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE=C91_2.F08I
         THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE=C91_2.F08J
         THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE=C91_2.F08K
         THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE=C91_2.F08L         
         THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=C91_2.F99   
         THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(C91_2.F98))+'    分'                       
      ENDPROC      
   *******   
      PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
         SELECT C91_3 
         THISFORM.PAGEFRAME1.PAGE2.TXTF10A.SETFOCUS              
         THISFORM.PAGEFRAME1.PAGE2.TXTF10A.VALUE=C91_3.F10A 
         THISFORM.PAGEFRAME1.PAGE2.TXTF11A.VALUE=C91_3.F11A 
         THISFORM.PAGEFRAME1.PAGE2.TXTF10B.VALUE=C91_3.F10B 
         THISFORM.PAGEFRAME1.PAGE2.TXTF11B.VALUE=C91_3.F11B 
         THISFORM.PAGEFRAME1.PAGE2.TXTF10C.VALUE=C91_3.F10C 
         THISFORM.PAGEFRAME1.PAGE2.TXTF11C.VALUE=C91_3.F11C 
         THISFORM.PAGEFRAME1.PAGE2.TXTF10D.VALUE=C91_3.F10D 
         THISFORM.PAGEFRAME1.PAGE2.TXTF11D.VALUE=C91_3.F11D 
         THISFORM.PAGEFRAME1.PAGE2.TXTF10E.VALUE=C91_3.F10E 
         THISFORM.PAGEFRAME1.PAGE2.TXTF11E.VALUE=C91_3.F11E    
         THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=C91_3.F99
      ENDPROC   
  *******       
      PROC CMND1.CLICK
           THISFORM.CMND1.VISIBLE=.F. 
           THISFORM.CMND2.VISIBLE=.F.  
	   THISFORM.CMND3.VISIBLE=.T.     
	   THISFORM.CMND4.VISIBLE=.T.          
           THISFORM.SETALL('READONLY',.F.,'TEXTBOX')  
            IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
                THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08A.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08B.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08C.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08D.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08E.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08F.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08G.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08H.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08I.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08J.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08K.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08L.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08A.SETFOCUS 
                THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''  
            ELSE
                THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
                THISFORM.PAGEFRAME1.PAGE2.TXTF10A.SETFOCUS 
                THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''  
            ENDIF    
      ENDPROC
********** 
      PROCEDURE CMND2.CLICK  
          SELECT C91_TEMPY
          USE
          SELECT F09,F10,F11 FROM C91 WHERE F02='Y'  ORDER BY F09 INTO CURSOR C91_TEMPY
          SELECT C91_1 
         THISFORM.RELEASE         
      ENDPROC       
  ********    
    PROC CMND3.CLICK
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
            IF  (THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+;
                  THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+;
                  THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+;
                  THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE)<100
                   =MESSAGEBOX('總比重分數不得小於100分',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE1.TXTF08A.SETFOCUS
                  RETURN              
            ENDIF       
            IF  (THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+;
                  THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+;
                  THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+;
                  THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE)>100
                  =MESSAGEBOX('總比重分數不得大於100分',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE1.TXTF08A.SETFOCUS
                  RETURN              
           ENDIF               
           SELECT  C91_2
           GO TOP
           LOCK()
           IF RLOCK()
               REPLACE  C91_2.F08A WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE
               REPLACE  C91_2.F08B WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE
               REPLACE  C91_2.F08C WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE
               REPLACE  C91_2.F08D WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE
               REPLACE  C91_2.F08E WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE
               REPLACE  C91_2.F08F WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE
               REPLACE  C91_2.F08G WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE
               REPLACE  C91_2.F08H WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE
               REPLACE  C91_2.F08I WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE
               REPLACE  C91_2.F08J WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE
               REPLACE  C91_2.F08K WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE
               REPLACE  C91_2.F08L WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE
               REPLACE  C91_2.F98 WITH   THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+;
						                  THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+;
						                  THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+;
						                  THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE
               REPLACE  C91_2.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
               SELECT C91
               SET ORDER TO C912
               SEEK 'Z'+'A'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'A'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF   
               SEEK 'Z'+'B'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'B'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	
               SEEK 'Z'+'C'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'C'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	   
               SEEK 'Z'+'D'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'D'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  
               SEEK 'Z'+'E'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'E'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	       	                            
               SEEK 'Z'+'F'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'F'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	  
               SEEK 'Z'+'G'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'G'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	              
               SEEK 'Z'+'H'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'H'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	        
               SEEK 'Z'+'I'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'I'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  
               SEEK 'Z'+'J'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'J'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	     
               SEEK 'Z'+'K'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'K'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	         	
               SEEK 'Z'+'L'
               IF FOUND()
	           REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE
	           REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C91
	          APPEND BLANK 
	          REPLACE  C91.F02 WITH 'Z'
	          REPLACE  C91.F07 WITH 'L'
	          REPLACE  C91.F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE
	          REPLACE  C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	              
           ENDIF   
        ELSE  &&
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF10A.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF11A.VALUE
                  =MESSAGEBOX('等級A之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF10A.SETFOCUS
                  RETURN              
           ENDIF           
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF10B.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF11B.VALUE
                  =MESSAGEBOX('等級B之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF10B.SETFOCUS
                  RETURN              
           ENDIF   
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF10C.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF11C.VALUE
                  =MESSAGEBOX('等級C之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF10C.SETFOCUS
                  RETURN              
           ENDIF   
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF10D.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF11D.VALUE
                  =MESSAGEBOX('等級D之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF10D.SETFOCUS
                  RETURN              
           ENDIF   
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF10E.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF11E.VALUE
                  =MESSAGEBOX('等級E之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF10E.SETFOCUS
                  RETURN              
           ENDIF                       
           IF (THISFORM.PAGEFRAME1.PAGE2.TXTF10A.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF11A.VALUE)+;
               (THISFORM.PAGEFRAME1.PAGE2.TXTF10B.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF11B.VALUE)+;
               (THISFORM.PAGEFRAME1.PAGE2.TXTF10C.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF11C.VALUE)+;
               (THISFORM.PAGEFRAME1.PAGE2.TXTF10D.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF11D.VALUE)+;
               (THISFORM.PAGEFRAME1.PAGE2.TXTF10E.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF11E.VALUE)+4<>100
               =MESSAGEBOX('分數範圍之總合不等於100,請重新輸入!',0+64,'提示訊息視窗')
               THISFORM.PAGEFRAME1.PAGE2.TXTF10A.SETFOCUS
               RETURN   
           ENDIF
           SELECT  C91_3
           GO TOP
           LOCK()
           IF RLOCK()
               REPLACE  C91_3.F10A WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10A.VALUE
               REPLACE  C91_3.F11A WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11A.VALUE
               REPLACE  C91_3.F10B WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10B.VALUE
               REPLACE  C91_3.F11B WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11B.VALUE
               REPLACE  C91_3.F10C WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10C.VALUE
               REPLACE  C91_3.F11C WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11C.VALUE
               REPLACE  C91_3.F10D WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10D.VALUE
               REPLACE  C91_3.F11D WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11D.VALUE
               REPLACE  C91_3.F10E WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10E.VALUE
               REPLACE  C91_3.F11E WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11E.VALUE
               REPLACE  C91_3.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
               SELECT C91
               SET ORDER TO C912
               SEEK 'Y'+'A'
               IF FOUND()
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10A.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11A.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C91
                   APPEND BLANK
                   REPLACE C91.F02 WITH 'Y'
                   REPLACE C91.F09 WITH 'A'
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10A.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11A.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF
               SEEK 'Y'+'B'
               IF FOUND()
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10B.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11B.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C91
                   APPEND BLANK
                   REPLACE C91.F02 WITH 'Y'
                   REPLACE C91.F09 WITH 'B'
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10B.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11B.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF
               SEEK 'Y'+'C'
               IF FOUND()
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10C.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11C.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C91
                   APPEND BLANK
                   REPLACE C91.F02 WITH 'Y'
                   REPLACE C91.F09 WITH 'C'
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10C.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11C.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF
               SEEK 'Y'+'D'
               IF FOUND()
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10D.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11D.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C91
                   APPEND BLANK
                   REPLACE C91.F02 WITH 'Y'
                   REPLACE C91.F09 WITH 'D'
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10D.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11D.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF
               SEEK 'Y'+'E'
               IF FOUND()
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10E.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11E.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C91
                   APPEND BLANK
                   REPLACE C91.F02 WITH 'Y'
                   REPLACE C91.F09 WITH 'E'
                   REPLACE C91.F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10E.VALUE
                   REPLACE C91.F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11E.VALUE
                   REPLACE C91.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF   
            ENDIF                                                     
        ENDIF   
           UNLOCK
           THISFORM.CMND4.CLICK    
      ENDPROC             
********
    PROC CMND4.CLICK
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
           THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
           THISFORM.CMND1.VISIBLE=.T. 
           THISFORM.CMND2.VISIBLE=.T.  
	   THISFORM.CMND3.VISIBLE=.F.     
	   THISFORM.CMND4.VISIBLE=.F.          
           THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
           IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
                SELECT C91_2
                THISFORM.PAGEFRAME1.PAGE1.TXTF08A.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08B.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08C.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08D.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08E.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08F.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08G.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08H.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF08I.READONLY=.T.    
                THISFORM.PAGEFRAME1.PAGE1.TXTF08J.READONLY=.T.  
                THISFORM.PAGEFRAME1.PAGE1.TXTF08K.READONLY=.T.  
                THISFORM.PAGEFRAME1.PAGE1.TXTF08L.READONLY=.T.              
                THISFORM.PAGEFRAME1.PAGE1.TXTF08A.SETFOCUS     
	        THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE=C91_2.F08A
                THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE=C91_2.F08B
                THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE=C91_2.F08C
                THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE=C91_2.F08D
                THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE=C91_2.F08E
                THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE=C91_2.F08F
                THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE=C91_2.F08G
                THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE=C91_2.F08H
                THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE=C91_2.F08I
                THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE=C91_2.F08J
                THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE=C91_2.F08K
                THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE=C91_2.F08L
                THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=C91_2.F99   
                THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(C91_2.F98))+'    分'                               
	   ELSE  
	         SELECT C91_3 
	         THISFORM.PAGEFRAME1.PAGE2.TXTF10A.SETFOCUS           
                 THISFORM.PAGEFRAME1.PAGE2.TXTF10A.VALUE=C91_3.F10A 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF11A.VALUE=C91_3.F11A 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF10B.VALUE=C91_3.F10B 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF11B.VALUE=C91_3.F11B 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF10C.VALUE=C91_3.F10C 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF11C.VALUE=C91_3.F11C 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF10D.VALUE=C91_3.F10D 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF11D.VALUE=C91_3.F11D 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF10E.VALUE=C91_3.F10E 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF11E.VALUE=C91_3.F11E    
                 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=C91_3.F99        
	   ENDIF 
           UNLOCK ALL      
      ENDPROC     
ENDDEFINE    
*************************************************比重1
DEFINE CLASS TXTF08A AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08A'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF
  ENDPROC       
ENDDEFINE    
*************************************************比重2
DEFINE CLASS TXTF08B AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08B'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重3
DEFINE CLASS TXTF08C AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08C'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重4
DEFINE CLASS TXTF08D AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08D'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重5
DEFINE CLASS TXTF08E AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08E'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重6
DEFINE CLASS TXTF08F AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08F'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重7
DEFINE CLASS TXTF08G AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08G'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重8
DEFINE CLASS TXTF08H AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08H'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重9
DEFINE CLASS TXTF08I AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08I'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重10
DEFINE CLASS TXTF08J AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08J'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE  
*************************************************比重11
DEFINE CLASS TXTF08K AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08K'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08L.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE  
*************************************************比重12
DEFINE CLASS TXTF08L AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF08L'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08E.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08F.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08G.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08H.VALUE+;
                               THISFORM.PAGEFRAME1.PAGE1.TXTF08I.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08J.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08K.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF08A.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE  