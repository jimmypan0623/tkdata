*****C30.客戶品號對照表
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
R=0
AREA1='C01'
AREA2='A34'
IF ! USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF      
SET ORDER TO A01
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE 
   SELE A02
ENDIF
SET ORDER TO A021
SEEK SYS_OPER+'C30'  
IF !USED('B01')
   SELE 0
   USE B01
ELSE 
   SELE B01
ENDIF
SET ORDER TO 1 
IF !USED('C01')
   SELE 0
   USE C01
ELSE 
   SELE C01
ENDIF
SET ORDER TO 1 
IF !USED('A34')
   SELE 0
   USE A34 INDE A34
ELSE 
   SELE A34
ENDIF
SET ORDER TO A341
SET RELA TO F02 INTO B01 
SELECT DISTINCT F03 FROM A34 WHERE F03!=' ' INTO CURSOR A34_1
INDEX ON F03 TAG A34_11
*************      
C30FORM=CREATEOBJECT("TKC30")
C30FORM.SHOW  
DEFINE CLASS TKC30 AS FORM
  CAPTION='C30.客戶品號對照表'
  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=3  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKC30'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*200,;
      FONTSIZE=INT_015*9,;      
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='依客戶編號搜尋紀錄',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='詳細資料內容' 
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='C01',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'      
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=4,;            
      RECORDSOURCE='A34',;
      LINKMASTER='C01',;
      RELATIONALEXPR='F01',;
      CHILDORDER='A341',; 
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOSIZE=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*173,;
      LEFT=INT_015*558 
****************************               
  PROCEDURE PAGEFRAME1.PAGE1.INIT     
     THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*27
          .WIDTH=INT_015*50
          .CAPTION='客戶編號'          
     ENDWITH
     THIS.ADDOBJECT('LBLF011','LABEL')     
     WITH THIS.LBLF011
          .VISIBLE=.T.
          .LEFT=INT_015*116
          .TOP=INT_015*27
          .AUTOSIZE=.T.  
     ENDWITH            
     THIS.ADDOBJECT('TXTF01','TEXTBOX')     
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*22
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25       
     ENDWITH 
      THIS.ADDOBJECT('TXTF011','TEXTBOX')     
     WITH THIS.TXTF011
          .VISIBLE=.F.
          .LEFT=INT_015*65
          .TOP=INT_015*22
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25       
     ENDWITH   
  ENDPROC 
 ****************
 PROCEDURE PAGEFRAME1.PAGE2.INIT    
   THIS.ADDOBJECT('LBLF02','LABEL')
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*27
          .WIDTH=INT_015*50
          .CAPTION='料品編號'          
     ENDWITH  
     THIS.ADDOBJECT('LBLF021','LABEL')     
     WITH THIS.LBLF021
          .VISIBLE=.T.
          .LEFT=INT_015*333
          .TOP=INT_015*27
          .CAPTION=''    
          .AUTOSIZE=.T.  
     ENDWITH            
     THIS.ADDOBJECT('TXTF02','TEXTBOX')     
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*22
          .WIDTH=INT_015*261
          .HEIGHT=INT_015*25       
     ENDWITH
   THIS.ADDOBJECT('LBLF03','LABEL')
     WITH THIS.LBLF03
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*53
          .WIDTH=INT_015*50
          .CAPTION='客戶品號'          
     ENDWITH
   THIS.ADDOBJECT('LBLF031','LABEL')     
     WITH THIS.LBLF031
          .VISIBLE=.T.
          .LEFT=INT_015*220
          .TOP=INT_015*53
          .CAPTION='' 
          .AUTOSIZE=.T.  
     ENDWITH        
     THIS.ADDOBJECT('TXTF03','TEXTBOX')     
     WITH THIS.TXTF03
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*48
          .WIDTH=INT_015*260
          .HEIGHT=INT_015*25       
     ENDWITH
     THIS.ADDOBJECT('LBLF04','LABEL')
     WITH THIS.LBLF04
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*79
          .WIDTH=INT_015*50
          .CAPTION='備        註'          
     ENDWITH
     THIS.ADDOBJECT('TXTF04','TEXTBOX')     
     WITH THIS.TXTF04
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*74
          .WIDTH=INT_015*200
          .HEIGHT=INT_015*25       
     ENDWITH                     
 ENDPROC
**********************    
PROC INIT
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9  
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限   
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限              
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限      
       THISFORM.PAGEFRAME1.FONTSIZE=INT_015*9  
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('READONLY',.T.,'CHECKBOX')
       THISFORM.SETALL('AUTOSIZE',.T.,'CHECKBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'CHECKBOX')       
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')       
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶簡稱'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F05'
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')       
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='料號'
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='客戶品號'
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='備註'
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION=''
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A34.F02'
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A34.F03'
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A34.F04'
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE=''
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*150
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*250
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*150
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*50
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID2.READONLY=.T.           
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.      
       ENDIF          
       THISFORM.KEY_LIST.DISPLAYVALUE='依客戶編號排列'       
       JK='客戶編號'
       SELE C01
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C01.F01
       THISFORM.PAGEFRAME1.PAGE1.TXTF011.VALUE=C01.F01
       THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=C01.F05
  ENDPROC     
************************ 
 PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
     R=0 
     IF THISFORM.KEY_LIST.DISPLAYVALUE='依客戶編號排列' .OR. THISFORM.KEY_LIST.DISPLAYVALUE='依客戶簡稱排列'
        SELECT C01
     ELSE
        IF THISFORM.KEY_LIST.DISPLAYVALUE='依料品編號排列'
             SELECT  B01
        ELSE
             SELECT A34_1
        ENDIF     
     ENDIF      
     SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE          
     THISFORM.GRID1.ENABLED=.T.          
     THISFORM.GRID1.SETFOCUS    
      IF THISFORM.GRID1.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''
        THISFORM.PAGEFRAME1.PAGE1.TXTF011.VALUE=''
     ELSE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
     ENDIF   
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
     THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
     THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
     THISFORM.KEY_LIST.ENABLED=.T.
  ENDPROC
**************  
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
     SELE A34
     IF THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.GRID2.SETFOCUS 
        THISFORM.GRID2.READONLY=.T.
     ENDIF   
    IF THISFORM.GRID2.ACTIVEROW=0 .AND. THISFORM.SHRGROUP.ENABLED=.F.
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
        THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
        THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=''
     ELSE
     THISFORM.GRID2.AFTERROWCOLCHANGE
        THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
        THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
        THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
        THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限        
     ENDIF   
     R=RECNO('&AREA1')
     THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
     THISFORM.GRID1.ENABLED=.F.     
     THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
     THISFORM.KEY_LIST.ENABLED=.F.     
  ENDPROC   
**************     
  PROC KEY_LIST.INIT 
       WITH THIS
       	   .ADDITEM('依客戶編號排列') 
           .ADDITEM('依客戶簡稱排列')
           .ADDITEM('依料品編號排列')
           .ADDITEM('依客戶品號排列')
       ENDWITH      
  ENDPROC
 ******************
PROC KEY_LIST.INTERACTIVECHANGE                 
  SELECT B01
  SET RELATION OFF INTO A34
  SELECT C01
  SET RELATION OFF INTO A34
  SELECT A34_1
  SET RELATION OFF INTO A34
  SELECT A34
  SET RELATION OFF INTO C01
  SET RELATION OFF INTO B01
  SET RELATION OFF INTO A34_1
  THISFORM.GRID1.RECORDSOURCE=''
  THISFORM.GRID1.CHILDORDER=''
  THISFORM.GRID2.LINKMASTER=''
  THISFORM.GRID2.RELATIONALEXPR=''
  THISFORM.GRID2.CHILDORDER=''
       DO CASE
       	     CASE THIS.DISPLAYVALUE='依客戶編號排列'
       	     		CH=1
       	     	        SELECT C01
       	     	        SET ORDER TO C011
       	     	        SELECT B01
       	     	        SET ORDER TO B011
			AREA1='C01'
       	     		SELECT A34
		        SET ORDER TO A341
		        SET RELATION TO F02 INTO B01
		        THISFORM.GRID1.RECORDSOURCE='C01'
		        THISFORM.GRID2.LINKMASTER='C01'
               		THISFORM.GRID2.RELATIONALEXPR='F01'
               		THISFORM.GRID2.CHILDORDER='A341'
       	     		THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照客戶編號搜尋紀錄'
       	     		THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='客戶編號'
       	     		THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=C01.F05
       	     		THISFORM.PAGEFRAME1.PAGE1.LBLF011.LEFT=INT_015*116
       	     		THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C01.F01
       	     		THISFORM.PAGEFRAME1.PAGE1.TXTF011.VALUE=C01.F01
       	     		THISFORM.PAGEFRAME1.PAGE1.TXTF01.WIDTH=INT_015*50
       			THISFORM.PAGEFRAME1.PAGE2.LBLF02.CAPTION='料品編號'
       			THISFORM.PAGEFRAME1.PAGE2.TXTF02.WIDTH=INT_015*261
       			THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=A34.F02
       			THISFORM.PAGEFRAME1.PAGE2.LBLF021.LEFT=INT_015*337
			THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=B01.F02
		        THISFORM.PAGEFRAME1.PAGE2.LBLF03.CAPTION='客戶品名'      
		        THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A34.F03
		        THISFORM.PAGEFRAME1.PAGE2.TXTF03.WIDTH=INT_015*150
		        THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
		        THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A34.F04
       	     	        THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶編號'
			THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶簡稱'
			THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F01'
			THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F05'
			THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
	       		THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55 
	       		THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='料號'
		        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='客戶品號'
		        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='備註'
		        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION=''
		        THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A34.F02'
		        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A34.F03'
		        THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A34.F04'
		        THISFORM.GRID2.COLUMN4.CONTROLSOURCE=''
		        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*150
		        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*250
		        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*150
		        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*50
	      CASE THIS.DISPLAYVALUE='依客戶簡稱排列'
	      		 CH=1
	      		 SELECT C01
	      		 SET ORDER TO C013
	      		 SELECT B01
       	     	         SET ORDER TO B011
			 AREA1='C01'
       	     		 SELECT A34
		         SET ORDER TO A341
		         SET RELATION TO F02 INTO B01
		         THISFORM.GRID1.RECORDSOURCE='C01'
		         THISFORM.GRID2.LINKMASTER='C01'
               		 THISFORM.GRID2.RELATIONALEXPR='F01'
               		 THISFORM.GRID2.CHILDORDER='A341'
	      		 THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照客戶簡稱搜尋紀錄'
	      		 THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='客戶簡稱'
       	     		 THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C01.F05
       	     		 THISFORM.PAGEFRAME1.PAGE1.TXTF011.VALUE=C01.F01
       	     		 THISFORM.PAGEFRAME1.PAGE1.TXTF01.WIDTH=INT_015*60
       			 THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=C01.F01
       			 THISFORM.PAGEFRAME1.PAGE1.LBLF011.LEFT=INT_015*126
       			 THISFORM.PAGEFRAME1.PAGE2.LBLF02.CAPTION='料品編號'
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF02.WIDTH=INT_015*261
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=A34.F02
       			 THISFORM.PAGEFRAME1.PAGE2.LBLF021.LEFT=INT_015*337
		         THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=B01.F02
		         THISFORM.PAGEFRAME1.PAGE2.LBLF03.CAPTION='客戶品名'      
		         THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A34.F03
		         THISFORM.PAGEFRAME1.PAGE2.TXTF03.WIDTH=INT_015*150
		         THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
		         THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A34.F04
		         THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶簡稱'
			 THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='客戶編號'
			 THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C01.F05'
			 THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C01.F01'
			 THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
	       		 THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
	       		 THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='料號'
		         THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='客戶品號'
		         THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='備註'
		         THISFORM.GRID2.COLUMN4.HEADER1.CAPTION=''
		         THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A34.F02'
		         THISFORM.GRID2.COLUMN2.CONTROLSOURCE='A34.F03'
		         THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A34.F04'
		         THISFORM.GRID2.COLUMN4.CONTROLSOURCE=''
		         THISFORM.GRID2.COLUMN1.WIDTH=INT_015*150
		         THISFORM.GRID2.COLUMN2.WIDTH=INT_015*250
		         THISFORM.GRID2.COLUMN3.WIDTH=INT_015*150
		         THISFORM.GRID2.COLUMN4.WIDTH=INT_015*50
	       CASE THIS.DISPLAYVALUE='依料品編號排列'
	       		  CH=2	
	       		  SELECT C01
	       		  SET ORDER TO C011
			  SELECT B01
			  SET ORDER TO B011	 
			  AREA1='B01'
			  SELECT A34
			  SET ORDER TO A342
			  THISFORM.GRID1.RECORDSOURCE='B01'
			  THISFORM.GRID2.LINKMASTER='B01'
               		  THISFORM.GRID2.RELATIONALEXPR='F01'
               		  THISFORM.GRID2.CHILDORDER='A342'
			  THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照料品編號搜尋紀錄' 
			  THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='料品編號'
			  THISFORM.PAGEFRAME1.PAGE1.TXTF01.WIDTH=INT_015*261
       	     		  THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=B01.F01
       	     		  THISFORM.PAGEFRAME1.PAGE1.LBLF011.LEFT=INT_015*337
       			  THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=B01.F02
       			  THISFORM.PAGEFRAME1.PAGE2.LBLF02.CAPTION='客戶編號'
       			  THISFORM.PAGEFRAME1.PAGE2.TXTF02.WIDTH=INT_015*50
       			  THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=A34.F01
       			  THISFORM.PAGEFRAME1.PAGE2.LBLF021.LEFT=INT_015*120
		          THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=C01.F05
		          THISFORM.PAGEFRAME1.PAGE2.LBLF03.CAPTION='客戶品名'
		          THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A34.F03
		          THISFORM.PAGEFRAME1.PAGE2.TXTF03.WIDTH=INT_015*150
		          THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
		          THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A34.F04
	       		  THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料品編號'
			  THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='品名規格'
			  THISFORM.GRID1.COLUMN1.CONTROLSOURCE='B01.F01'
			  THISFORM.GRID1.COLUMN2.CONTROLSOURCE='B01.F02'
			  THISFORM.GRID1.COLUMN1.WIDTH=INT_015*120
	       		  THISFORM.GRID1.COLUMN2.WIDTH=INT_015*120
	       		  THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='客戶編號'
	       		  THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='客戶簡稱'
		          THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='客戶品名'
		          THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='備註'
		          THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A34.F01'
			  THISFORM.GRID2.COLUMN2.CONTROLSOURCE="IIF(SEEK(A34.F01,'C01'),C01.F05,'')"
		          THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A34.F03'
		          THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A34.F04'
		          THISFORM.GRID2.COLUMN1.WIDTH=INT_015*50
		          THISFORM.GRID2.COLUMN2.WIDTH=INT_015*54
		          THISFORM.GRID2.COLUMN3.WIDTH=INT_015*250
		          THISFORM.GRID2.COLUMN4.WIDTH=INT_015*150
	 CASE THIS.DISPLAYVALUE='依客戶品號排列'
	       		  CH=2	
	       		  SELECT C01
	       		  SET ORDER TO C011
	       		  SELECT B01
       	     	          SET ORDER TO B011
			  SELECT A34_1
       	     	          SET ORDER TO A34_11
			  AREA1='A34_1'
			  SELECT A34 
			  SET ORDER TO A343
			  SET RELATION TO F02 INTO B01 
			  THISFORM.GRID1.RECORDSOURCE='A34_1'
			  THISFORM.GRID2.LINKMASTER='A34_1'
               		  THISFORM.GRID2.RELATIONALEXPR='F03'
               		  THISFORM.GRID2.CHILDORDER='A343'
			  THISFORM.PAGEFRAME1.PAGE1.CAPTION='依照客戶品號搜尋紀錄' 
			  THISFORM.PAGEFRAME1.PAGE1.LBLF01.CAPTION='客戶品號'
       			  THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''
       			  THISFORM.PAGEFRAME1.PAGE1.LBLF011.LEFT=INT_015*216
			  THISFORM.PAGEFRAME1.PAGE1.TXTF01.WIDTH=INT_015*260
       	     		  THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A34_1.F03
       			  THISFORM.PAGEFRAME1.PAGE2.LBLF02.CAPTION='客戶編號'
       			  THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=C01.F05
       			  THISFORM.PAGEFRAME1.PAGE2.LBLF021.LEFT=INT_015*120
       			  THISFORM.PAGEFRAME1.PAGE2.TXTF02.WIDTH=INT_015*50
       			  THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=A34.F01
		          THISFORM.PAGEFRAME1.PAGE2.LBLF03.CAPTION='料品編號'
		          THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A34.F02
		          THISFORM.PAGEFRAME1.PAGE2.TXTF03.WIDTH=INT_015*261
		          THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=B01.F02
		          THISFORM.PAGEFRAME1.PAGE2.LBLF031.LEFT=INT_015*337
		          THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A34.F04
	       		  THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='客戶品號'
			  THISFORM.GRID1.COLUMN2.HEADER1.CAPTION=''
			  THISFORM.GRID1.COLUMN1.CONTROLSOURCE='A34_1.F03'
			  THISFORM.GRID1.COLUMN2.CONTROLSOURCE=''
			  THISFORM.GRID1.COLUMN1.WIDTH=INT_015*150
	       		  THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
	       		  THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='客戶編號'
	       		  THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='客戶簡稱'
		          THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='料品編號'
		          THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='備註'
		          THISFORM.GRID2.COLUMN1.CONTROLSOURCE='A34.F01'
		          THISFORM.GRID2.COLUMN2.CONTROLSOURCE="IIF(SEEK(A34.F01,'C01'),C01.F05,'')"
		          THISFORM.GRID2.COLUMN3.CONTROLSOURCE='A34.F02'
		          THISFORM.GRID2.COLUMN4.CONTROLSOURCE='A34.F04'
		          THISFORM.GRID2.COLUMN1.WIDTH=INT_015*50
		          THISFORM.GRID2.COLUMN2.WIDTH=INT_015*55
		          THISFORM.GRID2.COLUMN3.WIDTH=INT_015*150
		          THISFORM.GRID2.COLUMN4.WIDTH=INT_015*150
	ENDCASE
       	THISFORM.GRID1.SETFOCUS     
 ENDPROC   
*******************
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       DO CASE
             CASE THISFORM.KEY_LIST.DISPLAYVALUE='依客戶編號排列'  
       	                THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C01.F01
       	                THISFORM.PAGEFRAME1.PAGE1.TXTF011.VALUE=C01.F01
                        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=C01.F05
                        FCH=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
             CASE THISFORM.KEY_LIST.DISPLAYVALUE='依客戶簡稱排列' 
             	        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=C01.F05
           	        THISFORM.PAGEFRAME1.PAGE1.TXTF011.VALUE=C01.F01
           	        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=C01.F01
           	        FCH=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
       	     CASE THISFORM.KEY_LIST.DISPLAYVALUE='依料品編號排列' 
	       	        THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=B01.F01
	                THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=B01.F02
	                FCH=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
	     CASE	THISFORM.KEY_LIST.DISPLAYVALUE='依客戶品號排列'  	    
	                THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=A34_1.F03
	                THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''
	                FCH=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
       ENDCASE   
       JK=THIS.COLUMN1.HEADER1.CAPTION  
       IF THIS.ACTIVEROW=0
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ELSE
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
       ENDIF   
       CHK=''     
       THISFORM.REFRESH
  ENDPROC
******************       
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
          DO CASE 
                CASE  AREA1='C01'		
	                    THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=A34.F02
			    THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=B01.F02
			    THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
			    THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A34.F03
			    THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A34.F04
           	 CASE  AREA1='B01' 
	                     THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=A34.F01     
		             THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=C01.F05
		             THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=''
		             THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A34.F03
	                     THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A34.F04
		CASE   AREA1='A34_1'
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF02.VALUE=A34.F01
		             THISFORM.PAGEFRAME1.PAGE2.LBLF021.CAPTION=C01.F05
		             THISFORM.PAGEFRAME1.PAGE2.LBLF031.CAPTION=B01.F02
		             THISFORM.PAGEFRAME1.PAGE2.TXTF03.VALUE=A34.F02
	                     THISFORM.PAGEFRAME1.PAGE2.TXTF04.VALUE=A34.F04
           ENDCASE   
           DO CASE
                   CASE THISFORM.KEY_LIST.DISPLAYVALUE='依客戶編號排列'  
       	   		      CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
		   CASE THISFORM.KEY_LIST.DISPLAYVALUE='依客戶簡稱排列' 
           	 	      CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF011.VALUE
           	   CASE THISFORM.KEY_LIST.DISPLAYVALUE='依料品編號排列' 
           	      	      CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
	           CASE THISFORM.KEY_LIST.DISPLAYVALUE='依客戶品號排列'  	
           	              CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE 
           ENDCASE         	 	 	    
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
       THISFORM.GRID2.ALLOWCELLSELECTION=.F.
          THISFORM. CMDGROUP.SEEK_BOTT.ENABLED=.F.
       ENDIF   
  ENDPROC 
ENDDEFINE
***********************************************列印程序
PROCEDURE PNT_PRC  
ENDPROC


