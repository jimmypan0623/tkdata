***程式名稱:S09A.員工其他所得發放作業
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
CHK_NULL=''		&&判定GRID1資料是否為空
R=0
AREA1='S05'
AREA2='S09'
IF !USED('A01')	&&操作人員資料設定
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')	&&權限設定檔
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'S05'  
IF FOUND()  AND A02.F09='*'   &&判斷是否有權限可處理所有員工
    ALL_CHK=.T.
ELSE
    ALL_CHK=.F.
ENDIF
SELECT A02
SEEK SYS_OPER+'S09'             
IF !USED('S00')	&&薪資參數設定
   SELE 0
   USE S00 
ELSE
   SELE S00
ENDIF
SET ORDER TO S001
IF !USED('S01')	&&S01 薪資資料設定
   SELE 0
   USE S01 
ELSE
   SELE S01
ENDIF
SET ORDER TO S011
IF !USED('S05')	&&人事薪資基本資料
   SELE 0
   USE S05 
ELSE
   SELE S05
ENDIF
IF  ALL_CHK=.F. 
      SET FILTER TO F27=.T.
ENDIF
SET ORDER TO S051
IF !USED('S06')	&&薪資項目及扣款項目
   SELE 0
   USE S06 
ELSE
   SELE S06
ENDIF
SET ORDER TO S061
IF !USED('S09')	&&S09 其他所得發放作業
   SELE 0
   USE S09
ELSE
   SELE S09
ENDIF
SET FILTER TO F16='1' OR F16='3'
SET ORDER TO S091
GO TOP
********
S09AFORM=CREATEOBJECT("TKS09A")
S09AFORM.SHOW  
DEFINE CLASS TKS09A AS FORM
  CAPTION='S09A.員工其他所得發放作業'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKS09A'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.  
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*515,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='發放對象',;      
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='發放內容'        
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*215
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=3,;            
      RECORDSOURCE='S05',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3'
  ADD OBJECT GRID2 AS GRID2 WITH;
      TOP=INT_015*230,;
      HEIGHT=INT_015*290,;
      COLUMNCOUNT=11,;            
      RECORDSOURCE='S09',; 
      LINKMASTER='S05',;
      RELATIONALEXPR='F01',;
      CHILDORDER='S091',;   
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;      
      COLUMN8.NAME='COLUMN8',;
      COLUMN9.NAME='COLUMN9',;
      COLUMN10.NAME='COLUMN10',;
      COLUMN11.NAME='COLUMN11'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
	AUTOSIZE=.T. 
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
	AUTOSIZE=.T.             
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*172,;
      LEFT=INT_015*640          
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*45,;      
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<A.確認',;
      TOOLTIPTEXT='確認目前所指紀錄內容!快速鍵->ALT+A',;
      NAME='ANS_BOTT'      
  ADD OBJECT  INVERSE_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*62,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*50,;      
      FONTSIZE=INT_015*9,;
      CAPTION='\<I.反確認',;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      NAME='INVERSE_BOTT'           
  ADD OBJECT LIST_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*114,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*87,;      
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<L.列印簽收明細',;
      TOOLTIPTEXT='列印單獨發放簽收明細!快速鍵->ALT+L',;
      NAME='LIST_BOTT'      
**************            
PROCEDURE PAGEFRAME1.PAGE1.INIT  
  THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION='員工編號'
     ENDWITH   
  THIS.ADDOBJECT('LBLF011','LABEL')
     WITH THIS.LBLF011
         .VISIBLE=.T.
         .LEFT=INT_015*120
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION=''
     ENDWITH        
 THIS.ADDOBJECT('TXTF01','TEXTBOX')          
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*14
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
      ENDWITH  
 THIS.ADDOBJECT('LBLF02','LABEL')
     WITH THIS.LBLF02
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION='部門編號'
     ENDWITH 
 THIS.ADDOBJECT('LBLF021','LABEL')
     WITH THIS.LBLF021
         .VISIBLE=.T.
         .LEFT=INT_015*120
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION=''
     ENDWITH          
 THIS.ADDOBJECT('TXTF02','TEXTBOX')          
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*39
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
      ENDWITH                 
 THIS.ADDOBJECT('LBLF28','LABEL')
     WITH THIS.LBLF28
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*70
         .WIDTH=INT_015*50
         .CAPTION='任職狀況'
     ENDWITH     
 THIS.ADDOBJECT('TXTF28','TEXTBOX')          
     WITH THIS.TXTF28
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*64
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25 
      ENDWITH         
 THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*95
         .WIDTH=INT_015*50
         .CAPTION='發薪種類'
     ENDWITH         
 THIS.ADDOBJECT('TXTF15','TEXTBOX')     
     WITH THIS.TXTF15
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*89
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
      ENDWITH          
 THIS.ADDOBJECT('TXTF151','TEXTBOX')     
     WITH THIS.TXTF151
          .VISIBLE=.F.
          .LEFT=INT_015*65
          .TOP=INT_015*89
          .WIDTH=INT_015*20
          .HEIGHT=INT_015*25
          .MAXLENGTH=1
      ENDWITH        
 THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*120
         .WIDTH=INT_015*50
         .CAPTION='異動日期'
     ENDWITH     
 THIS.ADDOBJECT('TXTF10','TEXTBOX')          
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*114
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
      ENDWITH                       
 ENDPROC
**************************************      
PROCEDURE PAGEFRAME1.PAGE2.INIT 
  THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION='發放日期'
     ENDWITH        
 THIS.ADDOBJECT('TXTF05','TEXTBOX')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*14
          .HEIGHT=INT_015*25
          .WIDTH=INT_015*70
      ENDWITH  
  THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION='發放項目'
     ENDWITH              
 THIS.ADDOBJECT('TXTF06','TEXTBOX')          
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*39
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
      ENDWITH        
 THIS.ADDOBJECT('COMBOBOX06','COMBOBOX06')          
     WITH THIS.COMBOBOX06
          .LEFT=INT_015*65
          .TOP=INT_015*39
      ENDWITH         
  THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*72
         .WIDTH=INT_015*50
         .CAPTION='發放方式'
     ENDWITH            
 THIS.ADDOBJECT('OPTIONGROUP07','OPTIONGROUP07')
    WITH THIS.OPTIONGROUP07
   	   .TOP=INT_015*64
   	   .LEFT=INT_015*65    
     ENDWITH      
 THIS.ADDOBJECT('SPINNER081','SPINNER')      
    WITH THIS.SPINNER081
          .VISIBLE=.T.
	  .TOP=INT_015*66
	  .LEFT=INT_015*332
          .HEIGHT=INT_015*25     
	  .WIDTH=INT_015*47  
	  .KEYBOARDLOWVALUE=0
	  .KEYBOARDHIGHVALUE=999
	  .SPINNERLOWVALUE=0
	  .SPINNERHIGHVALUE=999
	  .INPUTMASK='999'     
     ENDWITH   
  THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
         .VISIBLE=.T.
         .LEFT=INT_015*383
         .TOP=INT_015*72
         . AUTOSIZE=.T.
         .CAPTION='年               月'
     ENDWITH          
 THIS.ADDOBJECT('SPINNER082','SPINNER')      
    WITH THIS.SPINNER082
          .VISIBLE=.T.
	  .TOP=INT_015*66
	  .LEFT=INT_015*397
          .HEIGHT=INT_015*25     
	  .WIDTH=INT_015*40  
	  .KEYBOARDLOWVALUE=0
	  .KEYBOARDHIGHVALUE=12
	  .SPINNERLOWVALUE=0
	  .SPINNERHIGHVALUE=12
	  .INPUTMASK='99'     
     ENDWITH                    
  THIS.ADDOBJECT('LBLF09','LABEL')
     WITH THIS.LBLF09
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*102
         .WIDTH=INT_015*50
         .CAPTION='金額比例'
     ENDWITH        
 THIS.ADDOBJECT('OPTIONGROUP09','OPTIONGROUP09')
     WITH THIS.OPTIONGROUP09
   	   .TOP=INT_015*93
   	   .LEFT=INT_015*65    
     ENDWITH         
  THIS.ADDOBJECT('TXTF09','TEXTBOX')      
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .LEFT=INT_015*135
          .TOP=INT_015*95
          .WIDTH=INT_015*55
          .HEIGHT=INT_015*25
          .MAXLENGTH=4            
     ENDWITH     
  THIS.ADDOBJECT('TXTF091','TEXTBOX')   &&發放底數   
     WITH THIS.TXTF091
          .VISIBLE=.F.
          .LEFT=INT_015*135
          .TOP=INT_015*95
          .WIDTH=INT_015*55
          .HEIGHT=INT_015*25
          .MAXLENGTH=1            
     ENDWITH           
THIS.ADDOBJECT('COMBOBOX09','COMBOBOX09')
    WITH THIS.COMBOBOX09
	   .TOP=INT_015*95
	   .LEFT=INT_015*135
   ENDWITH         
  THIS.ADDOBJECT('LBLF10','LABEL') 
     WITH THIS.LBLF10
          .VISIBLE=.T.
          .LEFT=INT_015*196
          .TOP=INT_015*102
          .AUTOSIZE=.T.
          .CAPTION='發放比例                    ％'          
     ENDWITH   
  THIS.ADDOBJECT('TXTF10','TXTF10')      
     WITH THIS.TXTF10
          .ALIGNMENT=1
          .LEFT=INT_015*248
          .TOP=INT_015*95   
     ENDWITH    
  THIS.ADDOBJECT('TXTF11','TXTF11')      
     WITH THIS.TXTF11
          .ALIGNMENT=1
          .LEFT=INT_015*400
          .TOP=INT_015*95  
     ENDWITH                     
   THIS.ADDOBJECT('LBLF12','LABEL')
     WITH THIS.LBLF12
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*131
          .WIDTH=INT_015*50
          .CAPTION='是否扣稅'          
     ENDWITH     
 THIS.ADDOBJECT('OPTIONGROUP12','OPTIONGROUP12')
     WITH THIS.OPTIONGROUP12
   	   .TOP=INT_015*122
   	   .LEFT=INT_015*65    
     ENDWITH                    
  THIS.ADDOBJECT('TXTF12','TXTF12')          
     WITH THIS.TXTF12
          .ALIGNMENT=1
          .LEFT=INT_015*248
          .TOP=INT_015*124      
     ENDWITH         
   THIS.ADDOBJECT('LBLF121','LABEL')
     WITH THIS.LBLF121
          .VISIBLE=.T.
          .LEFT=INT_015*303
          .TOP=INT_015*131
          .WIDTH=INT_015*20
          .CAPTION='％'          
     ENDWITH                 
  THIS.ADDOBJECT('LBLF13','LABEL')
     WITH THIS.LBLF13
         .VISIBLE=.T.
         .LEFT=INT_015*346
         .TOP=INT_015*130
         .WIDTH=INT_015*50
         .CAPTION='稅前小計'
     ENDWITH           
  THIS.ADDOBJECT('LBLF131','LABEL')
     WITH THIS.LBLF131
         .VISIBLE=.T.
         .LEFT=INT_015*397
         .TOP=INT_015*130
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH        
  THIS.ADDOBJECT('LBLF171','LABEL') &&稅後小計
     WITH THIS.LBLF171
         .VISIBLE=.F.
         .LEFT=INT_015*397
         .TOP=INT_015*130
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH        
  THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*157
         .WIDTH=INT_015*50
         .CAPTION='備註說明'
     ENDWITH        
 THIS.ADDOBJECT('TXTF14','TEXTBOX')          
     WITH THIS.TXTF14
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*151
          .WIDTH=INT_015*300
          .HEIGHT=INT_015*25
          .MAXLENGTH=40
      ENDWITH     
  THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*185
         .WIDTH=INT_015*50
         .CAPTION='狀        態'
     ENDWITH  
  THIS.ADDOBJECT('LBLF151','LABEL')
     WITH THIS.LBLF151
         .VISIBLE=.T.
         .LEFT=INT_015*65
         .TOP=INT_015*185
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH           
  THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*355
         .TOP=INT_015*185
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH  
  THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*406
         .TOP=INT_015*185
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH                                                                
ENDPROC                               
********  
  PROC INIT       
       THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
       THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)    
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*10
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*10  
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')     
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')    
       THISFORM.SETALL('FONTSIZE',INT_015*9,'SPINNER')             
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('READONLY',.T.,'SPINNER')       
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='任職狀況'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F02'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE="BILL_MODE(S05.F28)"
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55          
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*55
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(INDEXSEEK(S05.F01+'N',.F.,'S09','S093'),RGB(255,0,0),IIF(S05.F28='9',RGB(0,255,255),''))","COLUMN")    	     &&若為有尚未確認之內容則呈現紅色否則為外包人員則秀出天空藍顏色             
       THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF(S09.F15<>'Y',RGB(255,0,0),IIF(S09.F16='3',RGB(0,255,255),''))","COLUMN") 
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')     
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='發放日期'    
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='發放項目'       
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='發放方式'
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='發放底數'
       THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='發放比例(％)'
       THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='發放金額'
       THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='稅 率 (％)'
       THISFORM.GRID2.COLUMN8.HEADER1.CAPTION='扣  稅  額' 
       THISFORM.GRID2.COLUMN9.HEADER1.CAPTION='稅前小計'   
       THISFORM.GRID2.COLUMN10.HEADER1.CAPTION='稅後小計'     
       THISFORM.GRID2.COLUMN11.HEADER1.CAPTION='安全資料'
       THISFORM.GRID2.LINKMASTER='S05'
       THISFORM.GRID2.RELATIONALEXPR='F01'
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='S09.F05'
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE='S09.F06'
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE="IIF(S09.F07<>'1','合併薪資發放','單獨發放')"
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE="IIF(EMPTY(S09.F09),'',IIF(S09.F09='H','時薪',IIF(S09.F09='D','日薪','底薪')))"
       THISFORM.GRID2.COLUMN5.CONTROLSOURCE="IIF(EMPTY(S09.F10),'',S09.F10)"
       THISFORM.GRID2.COLUMN6.CONTROLSOURCE="IIF(EMPTY(S09.F11),'',S09.F11)"
       THISFORM.GRID2.COLUMN7.CONTROLSOURCE="IIF(EMPTY(S09.F12),'',S09.F12)"
       THISFORM.GRID2.COLUMN8.CONTROLSOURCE="IIF(EMPTY(S09.F12),'',S09.F13-S09.F17)"
       THISFORM.GRID2.COLUMN9.CONTROLSOURCE='S09.F13'
       THISFORM.GRID2.COLUMN10.CONTROLSOURCE="IIF(S09.F12<>0,S09.F17,'')"
       THISFORM.GRID2.COLUMN11.CONTROLSOURCE='S09.F99' 
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*65
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*120
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*80
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*50
       THISFORM.GRID2.COLUMN5.WIDTH=INT_015*70
       THISFORM.GRID2.COLUMN6.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN7.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN8.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN9.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN10.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN11.WIDTH=INT_015*100
       THISFORM.GRID1.READONLY=.T.      
       THISFORM.GRID2.READONLY=.T.            
       THISFORM.GRID1.SETFOCUS
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.       
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
       THISFORM.ANS_BOTT.ENABLED=.F.     
       THISFORM.INVERSE_BOTT.ENABLED=.F.   
       IF THISFORM.GRID1.ACTIVEROW=0
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.       
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	        
	   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F. 
           THISFORM.LIST_BOTT.ENABLED=.F.
           CHK_NULL='Y' 
       ELSE
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.       
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	     
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限       
           THISFORM.LIST_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.)     		   &&判斷有無列印簽收明細的權限 
           CHK_NULL='N' 
       ENDIF          
       JK='員工編號'
       SELE S05
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05.F01
  ENDPROC     
  ***********
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
        R=0
        SELECT S05
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO S051
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO S052
         ENDCASE       
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)                    
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.      	
       	THISFORM.ANS_BOTT.ENABLED=.F.     
       	THISFORM.INVERSE_BOTT.ENABLED=.F.    
       	THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE=S05.F15  &&發薪種類
         IF THISFORM.SHRGROUP.VISIBLE=.F.
              THISFORM.GRID1.ENABLED=.T. 
              THISFORM.GRID1.SETFOCUS 
              THISFORM.KEY_LIST.ENABLED=.T.
         ELSE
              THISFORM.KEY_LIST.ENABLED=.F. 	      	
         ENDIF                		                 
*!*	        THISFORM.REFRESH    
  ENDPROC     
**********             
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
	SELECT S09 	 
        IF THISFORM.SHRGROUP.ENABLED=.F.
             THISFORM.GRID2.READONLY=.T.     
             THISFORM.GRID2.SETFOCUS   
        ENDIF	
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,255)               
	IF THISFORM.GRID2.ACTIVEROW=0 AND THISFORM.SHRGROUP.ENABLED=.F.	
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	         
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.LIST_BOTT.ENABLED=.F.
	      THISFORM.ANS_BOTT.ENABLED=.F.
	      THISFORM.INVERSE_BOTT.ENABLED=.F.	      
	       IF CHK_NULL='Y' AND THISFORM.SHRGROUP.ENABLED=.F.
	           THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
	       ELSE
                   THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.) AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)&&判斷有無新增的權限  	
               ENDIF	
	      THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')   
	      THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''      
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''  
      	      THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE=0
      	      THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE=0      	      
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE='' 
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE='' 
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=''   	      
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE='' 
      	      THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''      	      
	      THISFORM.PAGEFRAME1.PAGE2.LBLF151.CAPTION=''   	 
	      THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=''      
	      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''       	      
	ELSE
	      THISFORM.PAGEFRAME1.PAGE2.LBLF13.CAPTION=ALLTRIM(IIF(S09.F12<>0,'稅後小計','稅前小計'))
	      THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(IIF(S09.F12<>0,S09.F17,S09.F13)))
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.	
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.			   
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.		   
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.) AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.) &&判斷有無新增的權限 
     	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S09.F15<>'Y'    &&判斷有無修改的權限
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S09.F15<>'Y'     &&判斷有無刪除的權限	   
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 		      
	      THISFORM.LIST_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.)     		   &&判斷有無列印簽收明細的權限 
	      THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND S09.F15<>'Y'   AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	      THISFORM.INVERSE_BOTT.ENABLED=IIF(A02.F11='*',.T.,.F.) AND S09.F15='Y'   AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	      THISFORM.GRID2.AFTERROWCOLCHANGE 	      
	ENDIF          
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
       THISFORM.KEY_LIST.ENABLED=.F.  	                 
*!*	        THISFORM.REFRESH    
  ENDPROC   
**********    
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依員工編號排列')
           .ADDITEM('依員工姓名排列')
           .VALUE=1
       ENDWITH             
  ENDPROC
********* 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE S05 
       DO CASE
          CASE THIS.DISPLAYVALUE='依員工編號排列'
               SET ORDER TO S051 
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F01'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F02'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55 
          CASE THIS.DISPLAYVALUE='依員工姓名排列'
               SET ORDER TO S052
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F02'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F01'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50                                                                
       ENDCASE 
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
***********  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
         SELECT S05
        THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(INDEXSEEK(S05.F01+'N',.F.,'S09','S093'),RGB(255,0,0),IIF(S05.F28='9',RGB(0,255,255),''))","COLUMN")    	     &&若為有尚未確認之內容則呈現紅色否則為外包人員則秀出天空藍顏色      
        THISFORM.GRID1.TOOLTIPTEXT=IIF(INDEXSEEK(S05.F01+'N',.F.,'S09','S093'),'尚有資料未確認',IIF(S05.F28='9','此為外包人員',''))        
        THISFORM.PAGEFRAME1.PAGE1.LBLF10.VISIBLE=IIF(EMPTY(S05.F10),.F.,.T.)
        THISFORM.PAGEFRAME1.PAGE1.TXTF10.VISIBLE=IIF(EMPTY(S05.F10),.F.,.T.)          
       	THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05.F01
       	THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=S05.F05 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=IIF(EMPTY(S05.F10),'',S05.F10)
       	THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=BILL_MODE(S05.F28)
       	THISFORM.PAGEFRAME1.PAGE1.TXTF15.VALUE=IIF(S05.F15='M','月薪',IIF(S05.F15='D','日薪','時薪'))
       	THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE=S05.F15  
        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=S05.F02   
        THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION=S05.F06     
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.     	
       	THISFORM.ANS_BOTT.ENABLED=.F.
       	THISFORM.INVERSE_BOTT.ENABLED=.F. 
       	IF THISFORM.GRID1.ACTIVEROW=0 
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.	  
	       THISFORM.LIST_BOTT.ENABLED=.F.     
	       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''  	
	       THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.TXTF15.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''   
	       THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION=''             
 	 ELSE
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 	
	       THISFORM.LIST_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.)     		   &&判斷有無列印簽收明細的權限 
         ENDIF	      
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION  
         IF THIS.ACTIVEROW=0
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
         ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
         ENDIF   
         CHK=''     
*!*	       THISFORM.REFRESH
  ENDPROC     
**********  
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
         THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF(S09.F15<>'Y',RGB(255,0,0),IIF(S09.F16='3',RGB(0,255,255),''))","COLUMN")
         THISFORM.GRID2.TOOLTIPTEXT=IIF(S09.F15<>'Y','尚未確認',IIF(S09.F16='3','已確認,此筆資料為S09B.部門其他所得發放作業中新增','已確認'))                         
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=S09.F05
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=S09.F06  
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=IIF(EMPTY(S09.F09),'',IIF(S09.F09='H','時薪',IIF(S09.F09='D','日薪','底薪')))
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE=S09.F09	 
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=IIF(!EMPTY(S09.F10),S09.F10,'')
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=IIF(!EMPTY(S09.F11),S09.F11,'')   
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=IIF(EMPTY(S09.F12),'',S09.F12)   	 
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=S09.F14       	 	 
   	 THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=VAL(S09.F07)
         THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=IIF(EMPTY(S09.F09),2,1)    
         THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=IIF(EMPTY(S09.F12),1,2)           	 
   	 THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE=IIF(EMPTY(S09.F08),0,VAL(LEFT(DTOS(S09.F08),4))-1911)
   	 THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE=IIF(EMPTY(S09.F08),0,VAL(SUBSTR(DTOS(S09.F08),5,2)))
	 THISFORM.PAGEFRAME1.PAGE2.LBLF131.VISIBLE=IIF(S09.F12<>0,.F.,.T.)
	 THISFORM.PAGEFRAME1.PAGE2.LBLF171.VISIBLE=IIF(S09.F12<>0,.T.,.F.)	   	 
	 THISFORM.PAGEFRAME1.PAGE2.LBLF13.CAPTION=ALLTRIM(IIF(S09.F12<>0,'稅後小計','稅前小計'))
	 THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(IIF(S09.F12<>0,S09.F17,S09.F13)))       	 
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF151.CAPTION=IIF(EMPTY(S09.F15),'',IIF(S09.F15<>'Y','尚未確認',IIF(S09.F15='Y' AND S09.F16='3','已確認,此筆資料為S09B.部門其他所得發放作業中新增','已確認')))  	  
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF151.BACKCOLOR=IIF(S09.F15<>'Y',RGB(255,0,0),RGB(58,186,152))
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(S09.F17))   
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S09.F99
         IF THISFORM.PAGEFRAME1.ACTIVEPAGE<>2
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.      	 
	     THISFORM.ANS_BOTT.ENABLED=.F.  	 
	     THISFORM.INVERSE_BOTT.ENABLED=.F.  
	 ELSE    
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S09.F15<>'Y'    &&判斷有無修改的權限
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S09.F15<>'Y'   &&判斷有無刪除的權限	               	 
	     THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND S09.F15<>'Y'  AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)         
	     THISFORM.INVERSE_BOTT.ENABLED=IIF(A02.F11='*',.T.,.F.) AND S09.F15='Y'  AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	 ENDIF			    			 
         FCH=THISFORM.ACTIVECONTROL.NAME 
         JK=THIS.COLUMN1.HEADER1.CAPTION
         CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  
*       THISFORM.REFRESH
  ENDPROC 
***********
PROCEDURE ORPGROUP.NEW_BOTT.CLICK   
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.F.  
     THISFORM.GRID2.ENABLED=.F.  
     THISFORM.ANS_BOTT.ENABLED=.F.    
     THISFORM.INVERSE_BOTT.ENABLED=.F.           
     THISFORM.SETALL('READONLY',.F.,'TEXTBOX')   
     THISFORM.SETALL('READONLY',.F.,'SPINNER') 
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.               
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.READONLY=.T.      
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=.T.    
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.F.
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.READONLY=.T.          
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VISIBLE=.F.     	      
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VISIBLE=.T. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE=1 
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.T.       
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=2
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.ENABLED=.T.       
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=2 
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.ENABLED=.T. 
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=1	      
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VISIBLE=.F.      
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=DATE()
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''     
     THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE=VAL(LEFT(DTOS(DATE()),4))-1911
     THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE=VAL(SUBSTR(DTOS(DATE()),5,2))            
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=''           
     THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE='' 
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=0
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=''     
     THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=''      
     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''           
     THISFORM.PAGEFRAME1.PAGE2.LBLF151.CAPTION=''  
     THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=''   
     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''     
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS     
  ENDPROC
*************  
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK               &&新增確認
    SELE S09
    SET ORDER TO S091  && F01+DTOS(F05)+F06+F16
    COD=SYS(21)
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
         =MESSAGEBOX('發放日期不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN        	  
    ENDIF
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)
         =MESSAGEBOX('發放項目不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.SETFOCUS
  	  SET ORDER TO &COD
  	  RETURN        	  
    ENDIF
    IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE;
         +DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE);
         +THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,.F.,'S09','S091')=.T.
         =MESSAGEBOX('此發放日期與發放項目已存在,請重新輸入!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN     
    ENDIF
    IF  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=2 
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE)
               =MESSAGEBOX('合併薪資發放之合併日期年度不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.SPINNER081.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF          
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE)
               =MESSAGEBOX('合併薪資發放之合併日期月份不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.SPINNER082.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF         	    	  
    ENDIF    
    IF  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=1 
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)
               =MESSAGEBOX('金額比例之發放底數不得為空白!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF09.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF     
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE)
               =MESSAGEBOX('金額比例之發放比例不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF    
    ELSE	 	      
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
               =MESSAGEBOX('金額比例之發放金額不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF      	    	  
    ENDIF   
    IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=2
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE)
               =MESSAGEBOX('扣稅額比例不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF    
    ENDIF      
    SELECT S09
   APPEND BLANK
    LOCK()
    IF RLOCK()
    	REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    	REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION)
    	REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
    	REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION)    	
    	REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
    	REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
    	REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE))
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=2
    	     REPLACE F08 WITH CTOD(ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE))+'/'+ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE))+'/01')
    	ENDIF     
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=1
    	    REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE
    	    REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
    	ELSE    
    	    REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
    	ENDIF    	
    	REPLACE F12 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=2,THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE,0)
    	REPLACE F13 WITH VAL(THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION)
    	REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
    	REPLACE F15 WITH  'N'    	
    	REPLACE F16 WITH  '1'  
    	REPLACE F17 WITH VAL(THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION)
    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ENDIF
    UNLOCK ALL
    SELECT S09
    SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    THISFORM.ORPGROUP.NEW_BOTT.CLICK   
    THISFORM.REFRESH
  ENDPROC  
***********    
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK 
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.F.   
     THISFORM.GRID2.ENABLED=.F.                
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.          
     THISFORM.SETALL('READONLY',.F.,'TEXTBOX')  
     THISFORM.PAGEFRAME1.PAGE2.SPINNER081.READONLY=IIF(S09.F07<>'1',.F.,.T.)
     THISFORM.PAGEFRAME1.PAGE2.SPINNER082.READONLY=IIF(S09.F07<>'1',.F.,.T.)   
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.READONLY=IIF(EMPTY(S09.F09),.T.,.F.)           
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=IIF(EMPTY(S09.F10),.T.,.F.)
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=IIF(EMPTY(S09.F11),.T.,.F.)   
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.READONLY=IIF(EMPTY(S09.F12),.T.,.F.)                
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.T.     
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.ENABLED=.T.  
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.ENABLED=.T.      
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VISIBLE=.F.     
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VISIBLE=IIF(EMPTY(S09.F09),.T.,.F.) 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VISIBLE=IIF(EMPTY(S09.F09),.F.,.T.)     
     THISFORM.PAGEFRAME1.PAGE2.TXTF091.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VISIBLE=.T.        
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.DISPLAYVALUE=S09.F06   
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=VAL(S09.F07)
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=IIF(EMPTY(S09.F09),2,1)     
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=IIF(EMPTY(S09.F09),1,IIF(S09.F09='H',2,IIF(S09.F09='D',3,4)))
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=IIF(EMPTY(S09.F12),1,2)       		      	    
     THISFORM.PAGEFRAME1.PAGE2.LBLF151.CAPTION=''
     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''     
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS 
     LOCK()
     IF !RLOCK()
          DO FILE_IMPACT
          RETURN
     ENDIF   
 ENDPROC    
**************
PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK   &&修改確認                 
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
         =MESSAGEBOX('發放日期不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	  RETURN        	  
    ENDIF
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)
         =MESSAGEBOX('發放項目不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.SETFOCUS
  	  RETURN        	  
    ENDIF
    IF S09.F05<>THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE  OR ALLTRIM(S09.F06)<>ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)
         IF INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE;
             +DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE);
             +THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,.F.,'S09','S091')=.T.
             =MESSAGEBOX('此發放日期與發放項目已存在,請重新輸入!',0+64,'提示訊息視窗')
  	     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.SETFOCUS
  	     RETURN   
  	 ENDIF     
    ENDIF     
    IF  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=2 
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE)
               =MESSAGEBOX('合併薪資發放之合併日期年度不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.SPINNER081.SETFOCUS
  	       RETURN 
  	 ENDIF          
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE)
               =MESSAGEBOX('合併薪資發放之合併日期月份不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.SPINNER082.SETFOCUS
  	       RETURN 
  	 ENDIF         	    	  
    ENDIF       
    IF  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=1 
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE)
               =MESSAGEBOX('金額比例之發放底數不得為空白!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF09.SETFOCUS
  	       RETURN 
  	 ENDIF     
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE)
               =MESSAGEBOX('金額比例之發放比例不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF10.SETFOCUS
  	       RETURN 
  	 ENDIF    
    ELSE	 	      
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
               =MESSAGEBOX('金額比例之發放金額不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
  	       RETURN 
  	 ENDIF      	    	  
    ENDIF   
    IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=2
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE)
               =MESSAGEBOX('扣稅額比例不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
  	       RETURN 
  	 ENDIF    
    ENDIF       
    SELE S09          
    IF RLOCK()
    	REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
    	REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
    	REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE))
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE=1
    	     REPLACE F08 WITH CTOD('')
    	ELSE
    	     REPLACE F08 WITH CTOD(ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE))+'/'+ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE))+'/01')    	     
    	ENDIF      
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=1
    	     REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE
    	     REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
    	     REPLACE F11 WITH 0
    	ELSE    
    	    REPLACE F09 WITH  ''
    	    REPLACE F10 WITH  0 
    	    REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
    	ENDIF    	
    	REPLACE F12 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=2,THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE,0)
    	REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
    	**
        DO CASE
              CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='M'   &&發薪種類(M:月薪 D:日薪 T:時薪)
                        MONTH_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A',.T.,'S06','S061'),S06.F08,0)  &&底薪
	                DAY_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F02,0)<>0,MONTH_MONEY/S00.F02,0)       			    &&日薪
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	    &&時薪
	      CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='D'     
	     		MONTH_MONEY=0
	                DAY_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'B',.T.,'S06','S061'),S06.F08,0)     
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	   
	      CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='T'      
	     		MONTH_MONEY=0
	                DAY_MONEY=0
	                TIME_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C',.T.,'S06','S061'),S06.F08,0)
        ENDCASE    	
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=1  	&&依比例發放
            DO CASE
                  CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=2  &&時薪
                              MONEY_NOW=ROUND(TIME_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                              REPLACE F13 WITH MONEY_NOW															  		               &&稅前
      	                      REPLACE F17 WITH MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)       &&稅後                 
                  CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=3  &&日薪
                              MONEY_NOW=ROUND(DAY_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                              REPLACE F13 WITH MONEY_NOW
      	                      REPLACE F17 WITH MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)
                 CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=4  &&底薪
                  	    MONEY_NOW=ROUND(MONTH_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                  	    REPLACE F13 WITH MONEY_NOW
      			    REPLACE F17 WITH MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)
             ENDCASE
         ELSE     		&&依金額發放
             REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
             REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE-ROUND(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)
        ENDIF     	
    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ELSE
          DO FILE_IMPACT
          RETURN   
    ENDIF  
    THISFORM.GRID2.SETFOCUS		      		          	    	              
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
ENDPROC   
*************
PROC ORPGROUP.DEL_BOTT.CLICK                    &&刪除資料程序
 IF  MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認')=6 
       SELECT S09
       LOCK()
       IF RLOCK()
 	    IF S09.F15='Y'
 	       	 =MESSAGEBOX('此資料已確認,無法刪除!',0+64,'提示訊息視窗')
 	    ELSE
     	       DELETE 
     	       UNLOCK
     	       SKIP -1
     	       IF BOF()
     	           GO TOP
     	       ENDIF  
 	    ENDIF
       ELSE
           DO FILE_IMPACT
       ENDIF
       THISFORM.GRID2.SETFOCUS 	
       THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	      
  ENDIF
*!*	  THISFORM.REFRESH	       
ENDPROC  
****************
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.SETALL('VISIBLE',.T.,'TEXTBOX')
      THISFORM.SETALL('READONLY',.T.,'SPINNER')        
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.      
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.           
      THISFORM.PAGEFRAME1.PAGE1.TXTF151.VISIBLE=.F.          
      THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF12.READONLY=.T.         
      THISFORM.PAGEFRAME1.PAGE2.TXTF091.VISIBLE=.F.          	      
      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VISIBLE=.F.   
      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VISIBLE=.F.        
      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.ENABLED=.F.  
      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.ENABLED=.F. 
      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.ENABLED=.F.      
      THISFORM.PAGEFRAME1.PAGE2.LBLF131.VISIBLE=IIF(S09.F12<>0,.F.,.T.)
      THISFORM.PAGEFRAME1.PAGE2.LBLF171.VISIBLE=IIF(S09.F12<>0,.T.,.F.)
      THISFORM.GRID2.ENABLED=.T.        
      THISFORM.GRID2.SETFOCUS   
      THISFORM.PAGEFRAME1.PAGE2.ACTIVATE       
*!*	      THISFORM.REFRESH   
      UNLOCK ALL          
  ENDPROC
**********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
  SELECT S05
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO S051
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO S052
         ENDCASE   
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
***************
 PROC ANS_BOTT.CLICK     &&確認作業     
     IF  MESSAGEBOX('您是否確認此筆資料!',4+32+256,'請確認')=6
           IF  S09.F15='Y'   &&判斷是否已確認
                =MESSAGEBOX('此筆資料已確認過,請查明後再作確認!',0+64,'提示訊息視窗')
                THISFORM.GRID2.SETFOCUS
           ELSE           
                IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE<>1  &&判斷是否為合併薪資發放  1.單獨 2.合併
                     S1=LEFT(DTOS(S09.F08),6)
          	     FILE_S10='S10'+ALLTRIM(S1)
		     FIND_S10=ALLTRIM(FILE_S10)+'.DBF'
		     S102='S102'+LEFT(DTOS(S09.F08),6)	&& F01+F97+F18+F19+DTOS(F22)
		     IF  FILE('&FIND_S10')=.T.   
		          IF  !USED('&FIND_S10')
		                SELE 0
			        USE &FIND_S10  
		          ELSE
			        SELE &FILE_S10
		          ENDIF  
		          SELECT &FILE_S10
	       	          SET ORDER TO S102  
	       	          SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A'
	      	          IF  FOUND()  					&&判斷是否已有此人員之薪資計算資料
		                IF  &FILE_S10..F98<>'Y' 		&&判斷薪資計算作業是否已確認
		          	      SELECT &FILE_S10
		           	      SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C'+'I'+THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE+DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
		          	      IF  !FOUND() 				&&若尚未確認則判斷改發放項目+日期 是否存在,不存在則新增該發放項目(I:其他所得發放)
		                            SELECT &FILE_S10
			                    APPEND BLANK			                    
			                    REPLACE &FILE_S10..F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
			                    REPLACE &FILE_S10..F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION)
			                    REPLACE &FILE_S10..F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
			                    REPLACE &FILE_S10..F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION)               		               
			                    REPLACE &FILE_S10..F18 WITH 'I'
			                    REPLACE &FILE_S10..F19 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
			                    REPLACE &FILE_S10..F20 WITH S09.F13
			                    REPLACE &FILE_S10..F21 WITH 0
			                    REPLACE &FILE_S10..F22 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
				            REPLACE &FILE_S10..F23 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=2,THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE,0)
				            REPLACE &FILE_S10..F98 WITH 'N'
			                    REPLACE &FILE_S10..F97 WITH 'C'
			              	    REPLACE &FILE_S10..F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			              	    IF  S09.F12<>0	&&零表示不扣稅,若要扣稅則需把扣稅之金額寫入到扣款項目中且扣款類別為N:其他所得發放扣稅額
			                         SELECT &FILE_S10
				                 APPEND BLANK
				                 REPLACE &FILE_S10..F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
				                 REPLACE &FILE_S10..F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION)
				                 REPLACE &FILE_S10..F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
				                 REPLACE &FILE_S10..F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION)
				                 REPLACE &FILE_S10..F24 WITH 'N'
				                 REPLACE &FILE_S10..F25 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)+'扣稅額'
				                 REPLACE &FILE_S10..F26 WITH S09.F13-VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION))  &&稅後小計-稅前小計
				                 REPLACE &FILE_S10..F97 WITH 'D'
				                 REPLACE &FILE_S10..F98 WITH 'N'
				              	 REPLACE &FILE_S10..F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			              	    ENDIF
		                       ELSE
			                    =MESSAGEBOX('此發放作業已存在薪資計算作業中,請查明後再確認!',0+64,'提示訊息視窗')
		  	 	            SELECT &FILE_S10
			  	            USE
			  	            SELECT S09
			  	            THISFORM.GRID2.SETFOCUS
			  	            RETURN  
			                ENDIF
	             	          ELSE
	         	                =MESSAGEBOX('此人員之'+ALLTRIM(LEFT(DTOC(S09.F08),5))+'薪資計算作業已確認,故此發放作業無法與薪資合併發放!',0+64,'提示訊息視窗')
	  	 	   	        SELECT &FILE_S10
	  	 	   	        USE
		  	 	        SELECT S09
		  	 	        THISFORM.GRID2.SETFOCUS
		  	  	        RETURN  
	  	     	          ENDIF    	  
                            ENDIF  
               	            SELECT &FILE_S10
	  	            USE
                        ENDIF 
                  ENDIF   
                  SELECT S09
                  LOCK()
                  IF  RLOCK()
     	               REPLACE S09.F15 WITH 'Y'  	      
    		       REPLACE S09.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')   
    		       =MESSAGEBOX('此發放作業確認成功!',0+64,'提示訊息視窗') 
    		       THISFORM.GRID2.SETFOCUS
 	          ENDIF          
            ENDIF 
       ENDIF    
       UNLOCK   ALL 	
       THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	   
   ENDPROC
***************
 PROC INVERSE_BOTT.CLICK     &&反確認作業   
     IF  MESSAGEBOX('您是否要反確認此筆資料!',4+32+256,'請確認')=6
           IF  S09.F15<>'Y'   &&判斷是否已確認
                =MESSAGEBOX('此筆資料尚未確認過,請查明後再作反確認!',0+64,'提示訊息視窗')
                THISFORM.GRID2.SETFOCUS         
           ELSE       
                IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP07.VALUE<>1  &&判斷是否為合併薪資發放  1.單獨 2.合併
                     S1=LEFT(DTOS(S09.F08),6)
          	     FILE_S10='S10'+ALLTRIM(S1)
		     FIND_S10=ALLTRIM(FILE_S10)+'.DBF'
		     S102='S102'+LEFT(DTOS(S09.F08),6)	&& F01+F97+F18+F19+DTOS(F22)
		     S103='S103'+LEFT(DTOS(S09.F08),6)	&& F01+F97+F24+F25
		     IF  FILE('&FIND_S10')=.T.   
		          IF  !USED('&FIND_S10')
		                SELE 0
			        USE &FIND_S10 
		          ELSE
			        SELE &FILE_S10
		          ENDIF  
		          SELECT &FILE_S10
	       	          SET ORDER TO S103  
	       	          SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A'
	      	          IF  FOUND()  					&&判斷是否已有此人員之薪資計算資料
		                IF  &FILE_S10..F98<>'Y' 		&&判斷此人員之薪資計算作業是否已確認
		          	      SELECT &FILE_S10
		           	      SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'D'+'N'+ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)+'扣稅額'
		          	      IF  FOUND() 				&&刪除扣款項目中的其他所得發放之扣稅額
		                            SELECT &FILE_S10
					    DELETE 
		                      ENDIF		                	
		          	      SELECT &FILE_S10
		          	      SET ORDER TO S102
		           	      SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C'+'I'+THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE+DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
		          	      IF  FOUND() 				&&刪除扣款項目中的薪資所得中之其他所得發放
		                            SELECT &FILE_S10
					    DELETE 
		                      ENDIF
	             	         ELSE
	         	                =MESSAGEBOX('此人員之'+ALLTRIM(LEFT(DTOC(S09.F08),5))+'薪資計算作業已確認,故此發放作業無法進行反確認!',0+64,'提示訊息視窗')
	  	 	   	        SELECT &FILE_S10
	  	 	   	        USE
		  	 	        SELECT S09
		  	 	        THISFORM.GRID2.SETFOCUS
		  	  	        RETURN  
	  	     	         ENDIF    	  
                           ENDIF  
               	           SELECT &FILE_S10
	  	           USE
                       ENDIF 
                  ENDIF   
                  SELECT S09
                  LOCK()
                  IF  RLOCK()
     	               REPLACE S09.F15 WITH 'N'  	      
    		       REPLACE S09.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')   
    		       =MESSAGEBOX('此發放作業反確認成功!',0+64,'提示訊息視窗') 
    		       THISFORM.GRID2.SETFOCUS
 	          ENDIF          
            ENDIF 
       ENDIF     
        UNLOCK   ALL 	
       THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	   
ENDPROC    
***************
 PROC LIST_BOTT.CLICK     &&列印簽收明細
    SELECT  S05
    LIST_RANGE=CREATEOBJECT("LIST_RANGE")  
    LIST_RANGE.SHOW        
 ENDPROC       
ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
   SELECT  S09
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW       
ENDPROC 
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
*!*	  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  TOP=INT_015*200
  LEFT=INT_015*200    
  HEIGHT=INT_015*140
  WIDTH=INT_015*380
  FONTSIZE=INT_015*9
  MOVABLE=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL_NOTE AS LABEL WITH;
      AUTOSIZE=.T.,; 
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*14,;
      CAPTION='發放方式設定',;
      NAME='LABEL_NOTE'    
  ADD OBJECT OPTIONGROUP_NOTE AS OPTIONGROUP_NOTE WITH;      
      VISIBLE=.T.,;
      TOP=INT_015*8,;
      LEFT=INT_015*110,;  
      ENABLED=.T.               
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*45,;
      CAPTION='起始員工編號',;
      NAME='LABEL1'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      TOP=INT_015*39,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*60,; 
      MAXLENGTH=4,;
      NAME='TEXT1'      
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*76,;
      CAPTION='截止員工編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      TOP=INT_015*70,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,;   
      WIDTH=INT_015*60,;     
      MAXLENGTH=4,;   
      NAME='TEXT2'    
  ADD OBJECT LABEL3 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*190,;
      TOP=INT_015*45,;
      CAPTION='發放日期',;
      NAME='LABEL3'
  ADD OBJECT TEXT3 AS TEXTBOX WITH;
      TOP=INT_015*39,;
      LEFT=INT_015*245,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*100,; 
      NAME='TEXT3'          
  ADD OBJECT LABEL4 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*190,;
      TOP=INT_015*76,;
      CAPTION='發放項目',;
      NAME='LABEL4'
ADD OBJECT COMBOBOX04 AS COMBOBOX04 WITH; 
     VISIBLE=.T.,;          
      LEFT=INT_015*245,;     
      TOP=INT_015*70      
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*30,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*75,;    
      TOP=INT_015*105,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<V.預覽列印',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*155,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*85,;    
      TOP=INT_015*105,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<L.列印薪資單',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*290,;
      TOP=INT_015*105,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*55,; 
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*10,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*10,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*10,'COMMANDBUTTON')   
      THISFORM.TEXT1.VALUE=S05.F01
      THISFORM.TEXT2.VALUE=S05.F01   
      THISFORM.TEXT3.VALUE=DATE()    
  ENDPROC    
 ********預覽列印 
  PROCEDURE CMND1.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
       IF THISFORM.OPTIONGROUP_NOTE.VALUE<>4 AND EMPTY(THISFORM.TEXT3.VALUE)
           =MESSAGEBOX('發放日期不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT3.SETFOCUS
  	   RETURN       
       ENDIF        
       IF THISFORM.OPTIONGROUP_NOTE.VALUE<>4 AND EMPTY(THISFORM.COMBOBOX04.DISPLAYVALUE)
           =MESSAGEBOX('發放項目不得為空白!',0+64,'提示訊息視窗')
           THISFORM.COMBOBOX04.SETFOCUS
  	   RETURN       
       ENDIF     
      DO CASE
            CASE  THISFORM.OPTIONGROUP_NOTE.VALUE=4 
	   		SELECT  * FROM S09 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE;
	                    		 AND F16<>'2'  AND F15='Y' ORDER BY F01,F05 NOWAIT
      	    CASE  THISFORM.OPTIONGROUP_NOTE.VALUE=3
	   		SELECT  * FROM S09 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE;
	                      		AND F05=THISFORM.TEXT3.VALUE AND ALLTRIM(F06)=ALLTRIM(THISFORM.COMBOBOX04.DISPLAYVALUE);
	                      		AND F16<>'2'  AND F15='Y' ORDER BY F01,F05 NOWAIT         	    
      	    OTHERWISE
	   		SELECT  * FROM S09 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE;
	                      		AND F05=THISFORM.TEXT3.VALUE AND ALLTRIM(F06)=ALLTRIM(THISFORM.COMBOBOX04.DISPLAYVALUE);
	                      		AND F07=ALLTRIM(STR(THISFORM.OPTIONGROUP_NOTE.VALUE));
	                      		AND F16<>'2'  AND F15='Y' ORDER BY F01,F05 NOWAIT               
      ENDCASE	                      
      IF  _TALLY >0
           REPORT FORM ALLTRIM(INT_116)+'S09A_1' TO PRINT PROMPT   PREVIEW
      ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.RELEASE
  ENDPROC           
***************列印薪資單
  PROCEDURE CMND2.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
       IF THISFORM.OPTIONGROUP_NOTE.VALUE<>4 AND EMPTY(THISFORM.TEXT3.VALUE)
           =MESSAGEBOX('發放日期不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT3.SETFOCUS
  	   RETURN       
       ENDIF        
       IF THISFORM.OPTIONGROUP_NOTE.VALUE<>4 AND EMPTY(THISFORM.COMBOBOX04.DISPLAYVALUE)
           =MESSAGEBOX('發放項目不得為空白!',0+64,'提示訊息視窗')
           THISFORM.COMBOBOX04.SETFOCUS
  	   RETURN       
       ENDIF               
      DO CASE
            CASE  THISFORM.OPTIONGROUP_NOTE.VALUE=4 
	   		SELECT  * FROM S09 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE;
	                    		 AND F16<>'2'  AND F15='Y' ORDER BY F01,F05  INTO CURSOR S09A
      	    CASE  THISFORM.OPTIONGROUP_NOTE.VALUE=3
	   		SELECT  * FROM S09 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE;
	                      		AND F05=THISFORM.TEXT3.VALUE AND ALLTRIM(F06)=ALLTRIM(THISFORM.COMBOBOX04.DISPLAYVALUE);
	                      		AND F16<>'2'  AND F15='Y' ORDER BY F01,F05 INTO CURSOR S09A      	    
      	    OTHERWISE               	                                
	   		SELECT  * FROM S09 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE;
	                      		AND F05=THISFORM.TEXT3.VALUE AND ALLTRIM(F06)=ALLTRIM(THISFORM.COMBOBOX04.DISPLAYVALUE);
	                      		AND F07=ALLTRIM(STR(THISFORM.OPTIONGROUP_NOTE.VALUE));
	                      		AND F16<>'2'  AND F15='Y' ORDER BY F01,F05 INTO CURSOR S09A
     ENDCASE	    
     IF  _TALLY >0    
         CREATE CURSOR S09_TEMP;
      	                (F01 C(5),F02 C(8),F03 C(5),F04 C(8),F05 D(8),F06 C(30),F12 N(4,1),F13 N(7),F14 C(40),F17 N(7),SUM_F13 N(7),SUM_F17 N(7))      
         CREATE CURSOR S09_1;
      	                (F01 C(5),F02 C(8),F03 C(5),F04 C(8),F05 D(8),F06 C(30),F12 N(4,1),F13 N(7),F14 C(40),F17 N(7))                     		
         SELECT S09A
         GO TOP
         S09A_RC=S09A.F01
         DO WHILE !EOF()
                IF  S09A_RC=S09A.F01
                        SELECT S09_1
                        APPEND BLANK 
                        REPLACE F01 WITH S09A.F01
                        REPLACE F02 WITH S09A.F02
                        REPLACE F03 WITH S09A.F03
                        REPLACE F04 WITH S09A.F04
                        REPLACE F05 WITH S09A.F05
	                REPLACE F06 WITH S09A.F06
	                REPLACE F12 WITH S09A.F12
	                REPLACE F13 WITH S09A.F13
	                REPLACE F14 WITH S09A.F14
	                REPLACE F17 WITH S09A.F17
	                S09A_RC=S09A.F01
	                SELECT S09A
	                SKIP	                            
                ELSE 
                        SUM_13=0
                        SUM_17=0
                        SELECT S09_1
                        GO TOP
                        DO WHILE !EOF()
	                       SELECT S09_TEMP
	                       APPEND BLANK 
	                       REPLACE F01 WITH S09_1.F01
		               REPLACE F02 WITH S09_1.F02
	                       REPLACE F03 WITH S09_1.F03
	                       REPLACE F04 WITH S09_1.F04
	                       REPLACE F05 WITH S09_1.F05
	                       REPLACE F06 WITH S09_1.F06
	                       REPLACE F12 WITH S09_1.F12
	                       REPLACE F13 WITH S09_1.F13
	                       REPLACE F14 WITH S09_1.F14
	                       REPLACE F17 WITH S09_1.F17
	                       SUM_13=SUM_13+S09_1.F13
	                       SUM_17=SUM_17+S09_1.F17
	                       SELECT S09_1
	                       SKIP	                            
                        ENDDO
		   *****滿足一頁只印15各項目
			IF MOD(RECCOUNT('S09_1'),15)=0
			     START_NO=RECCOUNT('S09_1')     
			ELSE
			     IF RECCOUNT('S09_1')<=15
			         START_NO=15
			    ELSE
			         START_NO=RECCOUNT('S09_1')+(15-MOD(RECCOUNT('S09_1'),15))
			    ENDIF        
			ENDIF
			FOR I=1 TO START_NO-RECCOUNT('S09_1')
			        SELECT S09_TEMP
			        APPEND BLANK
			ENDFOR    
			SELECT S09_TEMP
			GO BOTTOM
			REPLACE SUM_F13 WITH SUM_13
			REPLACE SUM_F17 WITH SUM_17
			SELECT S09_1
			USE 
  	                CREATE CURSOR S09_1;
  	                               (F01 C(5),F02 C(8),F03 C(5),F04 C(8),F05 D(8),F06 C(20),F12 N(4,1),F13 N(7),F14 C(40),F17 N(7))        
                        SELECT S09_1
                        APPEND BLANK 
                        REPLACE F01 WITH S09A.F01
                        REPLACE F02 WITH S09A.F02
                        REPLACE F03 WITH S09A.F03
                        REPLACE F04 WITH S09A.F04
                        REPLACE F05 WITH S09A.F05
                        REPLACE F06 WITH S09A.F06
                        REPLACE F12 WITH S09A.F12
                        REPLACE F13 WITH S09A.F13
                        REPLACE F14 WITH S09A.F14
                        REPLACE F17 WITH S09A.F17
                        S09A_RC=S09A.F01
                        SELECT S09A
                        SKIP
                ENDIF     	                          
          ENDDO   
	   ***************      
           SUM_13=0
           SUM_17=0
           SELECT S09_1
           GO TOP
           DO WHILE !EOF()
                  SELECT S09_TEMP
                  APPEND BLANK 
                  REPLACE F01 WITH S09_1.F01
                  REPLACE F02 WITH S09_1.F02
                  REPLACE F03 WITH S09_1.F03
                  REPLACE F04 WITH S09_1.F04
                  REPLACE F05 WITH S09_1.F05
                  REPLACE F06 WITH S09_1.F06
                  REPLACE F12 WITH S09_1.F12
                  REPLACE F13 WITH S09_1.F13
                  REPLACE F14 WITH S09_1.F14
                  REPLACE F17 WITH S09_1.F17
                  SUM_13=SUM_13+S09_1.F13
                  SUM_17=SUM_17+S09_1.F17
                  SELECT S09_1
                  SKIP	                            
             ENDDO
	     ****滿足一頁只印15各項目
	     IF MOD(RECCOUNT('S09_1'),15)=0
	          START_NO=RECCOUNT('S09_1')     
	     ELSE
	          IF RECCOUNT('S09_1')<=15
	               START_NO=15
	          ELSE
	               START_NO=RECCOUNT('S09_1')+(15-MOD(RECCOUNT('S09_1'),15))
	          ENDIF        
	     ENDIF
	     FOR I=1 TO START_NO-RECCOUNT('S09_1')
	             SELECT S09_TEMP
	            APPEND BLANK
	     ENDFOR    
	     SELECT S09_1
	     USE 
	     SELECT S09_TEMP
	     GO BOTTOM
	     REPLACE SUM_F13 WITH SUM_13
	     REPLACE SUM_F17 WITH SUM_17
             SELECT S09_TEMP
             GO TOP
*!*	             REPORT FORM ALLTRIM(INT_116)+'S09A' TO PRINT PROMPT   PREVIEW
             REPORT FORM ALLTRIM(INT_116)+'S09A' TO PRINT PROMPT 
             SELECT S09_TEMP
             USE
      ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.RELEASE
  ENDPROC           
***************  
  PROCEDURE CMND3.CLICK
      THISFORM.RELEASE
  ENDPROC      
  PROC CMND1.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND1.TOP=INT_015*106
             THISFORM.CMND1.LEFT=INT_015*31
  ENDPROC     
  PROC CMND1.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND1.TOP=INT_015*105
             THISFORM.CMND1.LEFT=INT_015*30                  
  ENDPROC     
  PROC CMND2.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND2.TOP=INT_015*106
             THISFORM.CMND2.LEFT=INT_015*156
  ENDPROC     
  PROC CMND2.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND2.TOP=INT_015*105
             THISFORM.CMND2.LEFT=INT_015*155                  
  ENDPROC      
  PROC CMND3.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND3.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND3.TOP=INT_015*106
             THISFORM.CMND3.LEFT=INT_015*291
  ENDPROC     
  PROC CMND3.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND3.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND3.TOP=INT_015*105
             THISFORM.CMND3.LEFT=INT_015*290                  
  ENDPROC    
ENDDEFINE       
***********************************************列印簽收明細
DEFINE CLASS LIST_RANGE AS FORM
*!*	  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  TOP=INT_015*200
  LEFT=INT_015*200    
  HEIGHT=INT_015*140
  WIDTH=INT_015*380
  FONTSIZE=INT_015*9
  MOVABLE=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='LIST_RANGE '
  ADD OBJECT LABEL_NOTE AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*35,;
      TOP=INT_015*7,;
      BACKCOLOR=RGB(255,255,0),;
      CAPTION='注意！！此功能只能列印發放方式為"單獨發放"之資料',;
      NAME='LABEL_NOTE'  
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*40,;
      CAPTION='起始員工編號',;
      NAME='LABEL1'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      TOP=INT_015*34,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*60,; 
      MAXLENGTH=4,;
      NAME='TEXT1'      
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*71,;
      CAPTION='截止員工編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      TOP=INT_015*65,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,;   
      WIDTH=INT_015*60,;     
      MAXLENGTH=4,;   
      NAME='TEXT2'    
  ADD OBJECT LABEL3 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*190,;
      TOP=INT_015*40,;
      CAPTION='發放日期',;
      NAME='LABEL3'
  ADD OBJECT TEXT3 AS TEXTBOX WITH;
      TOP=INT_015*34,;
      LEFT=INT_015*245,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*100,; 
      NAME='TEXT3'          
  ADD OBJECT LABEL4 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*190,;
      TOP=INT_015*71,;
      CAPTION='發放項目',;
      NAME='LABEL4'
ADD OBJECT COMBOBOX04 AS COMBOBOX04 WITH; 
     VISIBLE=.T.,;          
      LEFT=INT_015*245,;
      TOP=INT_015*65      
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*110,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*55,;    
      TOP=INT_015*105,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<Y.執行',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*245,;
      TOP=INT_015*105,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*55,; 
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*10,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*10,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*10,'COMMANDBUTTON')   
      THISFORM.TEXT1.VALUE=S05.F01
      THISFORM.TEXT2.VALUE=S05.F01   
      THISFORM.TEXT3.VALUE=DATE()    
  ENDPROC    
  PROCEDURE CMND1.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
      IF  EMPTY(THISFORM.TEXT3.VALUE)
           =MESSAGEBOX('發放日期不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT3.SETFOCUS
  	   RETURN 
      ENDIF     
      IF  EMPTY(THISFORM.COMBOBOX04.DISPLAYVALUE)
           =MESSAGEBOX('發放項目不得為空白!',0+64,'提示訊息視窗')
           THISFORM.COMBOBOX04.SETFOCUS
  	   RETURN 
      ENDIF        
      SELECT  * FROM S09 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE;
                     AND F05=THISFORM.TEXT3.VALUE AND ALLTRIM(F06)=ALLTRIM(THISFORM.COMBOBOX04.DISPLAYVALUE);
                     AND F07='1' AND F16<>'2'  AND F15='Y'  ORDER BY F01,F05 NOWAIT
      IF  _TALLY >0
	   IF  MESSAGEBOX('是否要列印實發金額!',4+32+256,'請確認')=6
                REPORT FORM ALLTRIM(INT_116)+'S09A_2' TO PRINT PROMPT   PREVIEW	   
	   ELSE
	        REPORT FORM ALLTRIM(INT_116)+'S09A_3' TO PRINT PROMPT   PREVIEW  
	   ENDIF      
      ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.RELEASE
  ENDPROC           
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC      
  PROC CMND1.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND1.TOP=INT_015*106
             THISFORM.CMND1.LEFT=INT_015*111
  ENDPROC     
  PROC CMND1.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND1.TOP=INT_015*105
             THISFORM.CMND1.LEFT=INT_015*110                  
  ENDPROC     
  PROC CMND2.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND2.TOP=INT_015*106
             THISFORM.CMND2.LEFT=INT_015*246
  ENDPROC     
  PROC CMND2.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND2.TOP=INT_015*105
             THISFORM.CMND2.LEFT=INT_015*245                  
  ENDPROC   
ENDDEFINE   
********列印選擇使用
DEFINE CLASS OPTIONGROUP_NOTE AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*25
   WIDTH=INT_015*235
   BUTTONCOUNT=4
   VALUE=1
   ENABLED=.T.	   
   NAME='OPTIONGROUP_NOTE'
   OPTION1.CAPTION='單獨'
   OPTION1.FONTSIZE=INT_015*9     
   OPTION1.TOP=INT_015*5
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5 
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='合併'
   OPTION2.FONTSIZE=INT_015*9
   OPTION2.TOP=INT_015*5
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*50
   OPTION2.NAME='OPTION2'	 
   OPTION3.CAPTION='單獨合併'
   OPTION3.FONTSIZE=INT_015*9   
   OPTION3.TOP=INT_015*5
   OPTION3.AUTOSIZE=.T.
   OPTION3.LEFT=INT_015*95
   OPTION3.NAME='OPTION3' 	
   OPTION4.CAPTION='全部列印'
   OPTION4.FONTSIZE=INT_015*9   
   OPTION4.TOP=INT_015*5
   OPTION4.AUTOSIZE=.T.
   OPTION4.LEFT=INT_015*165
   OPTION4.NAME='OPTION4'     
   PROCEDURE INTERACTIVECHANGE
      IF THIS.VALUE=4	
            THISFORM.TEXT3.ENABLED=.F.
            THISFORM.COMBOBOX04.ENABLED=.F.
      ELSE
            THISFORM.TEXT3.ENABLED=.T.
            THISFORM.COMBOBOX04.ENABLED=.T.            
      ENDIF    
  ENDPROC    
ENDDEFINE 
**********************************************發放項目(列印簽收明細用)
DEFINE CLASS COMBOBOX04 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*100
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX04' 
    PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='G'  ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
   ENDPROC         
ENDDEFINE
**********************************************發放項目
DEFINE CLASS COMBOBOX06 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*150
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX06' 
    PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='G'  ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
   ENDPROC         
   PROCEDURE INTERACTIVECHANGE
      IF THIS.VALUE=1
	     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''    
      ELSE   
	     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
     ENDIF	     
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.REFRESH           
  ENDPROC       
ENDDEFINE
****************發放方式
DEFINE CLASS OPTIONGROUP07 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*29
   WIDTH=INT_015*400
   BUTTONCOUNT=2
   VALUE=1
   ENABLED=.F.	   
   NAME='OPTIONGROUP07'
   OPTION1.CAPTION='單獨發放'
   OPTION1.FONTSIZE=INT_015*9  
   OPTION1.TOP=INT_015*7
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='合併薪資發放,合併日期'
   OPTION2.FONTSIZE=INT_015*9 	   
   OPTION2.TOP=INT_015*7
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*125
   OPTION2.NAME='OPTION2'
   PROCEDURE INTERACTIVECHANGE
      IF THIS.VALUE=1
      	   THISFORM.PAGEFRAME1.PAGE2.SPINNER081.READONLY=.T. 
      	   THISFORM.PAGEFRAME1.PAGE2.SPINNER082.READONLY=.T.  
           THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE=0
           THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE=0  	        	   	      
      ELSE     	         	    
      	   THISFORM.PAGEFRAME1.PAGE2.SPINNER081.READONLY=.F. 
      	   THISFORM.PAGEFRAME1.PAGE2.SPINNER082.READONLY=.F.  
           THISFORM.PAGEFRAME1.PAGE2.SPINNER081.VALUE=VAL(LEFT(DTOS(DATE()),4))-1911
           THISFORM.PAGEFRAME1.PAGE2.SPINNER082.VALUE=VAL(SUBSTR(DTOS(DATE()),5,2))         	      
      ENDIF    
  ENDPROC    
ENDDEFINE 
****************金額比例
DEFINE CLASS OPTIONGROUP09 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*29
   WIDTH=INT_015*400
   BUTTONCOUNT=2 
   VALUE=1
   ENABLED=.F.	   
   NAME='OPTIONGROUP09'
   OPTION1.CAPTION='發放底數'
   OPTION1.FONTSIZE=INT_015*9  
   OPTION1.TOP=INT_015*7
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='發放金額'
   OPTION2.FONTSIZE=INT_015*9 	   
   OPTION2.TOP=INT_015*7
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*267
   OPTION2.NAME='OPTION2'
   PROCEDURE INTERACTIVECHANGE
     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''
      IF THIS.VALUE=1
           THISFORM.PAGEFRAME1.PAGE2.TXTF09.VISIBLE=.F. 
           THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VISIBLE=.T. 
           THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=1         
      	   THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=.F. 
      	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.T. 
	   THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=''
	   THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE=''	        	   
	   THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=0
	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=''		      
      ELSE     	         	    
           THISFORM.PAGEFRAME1.PAGE2.TXTF09.VISIBLE=.T. 
           THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VISIBLE=.F.      
      	   THISFORM.PAGEFRAME1.PAGE2.TXTF10.READONLY=.T. 
      	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.F. 
	   THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=''   
	   THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE=''	      	   
	   THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''
	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=0	  
      ENDIF    
  ENDPROC    
ENDDEFINE 
****************發放底數設定
DEFINE CLASS COMBOBOX09 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*55
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX09'
 PROCEDURE INIT    
       THIS.ADDITEM('')
       THIS.ADDITEM('時薪')
       THIS.ADDITEM('日薪')
       THIS.ADDITEM('底薪')       
  ENDPROC         
   PROCEDURE INTERACTIVECHANGE
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='M'   &&發薪種類(M:月薪 D:日薪 T:時薪)
                        MONTH_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A',.T.,'S06','S061'),S06.F08,0)  &&底薪
	                DAY_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F02,0)<>0,MONTH_MONEY/S00.F02,0)       			    &&日薪
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	    &&時薪
	     CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='D'     
	     		MONTH_MONEY=0
	                DAY_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'B',.T.,'S06','S061'),S06.F08,0)     
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	   
	     CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='T'      
	     		MONTH_MONEY=0
	                DAY_MONEY=0
	                TIME_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C',.T.,'S06','S061'),S06.F08,0)
       ENDCASE	               
       IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=1   &&不扣稅
	    DO CASE
	          CASE THIS.VALUE=1
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE=''		&&稅前小計
	             	     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''
	          CASE THIS.VALUE=2      &&時薪 
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE='H' 
      		             THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(TIME_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)))      &&時薪*發放比例	             	     
	          CASE THIS.VALUE=3      &&日薪 
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE='D' 
      		             THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(DAY_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)))        &&日薪*發放比例
	          CASE THIS.VALUE=4 	      &&底薪
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE='B' 	          
	      	             THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(MONTH_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)))   &&底薪*發放比例
	    ENDCASE
	    THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION
	ELSE			&&要扣稅
	    DO CASE
	          CASE THIS.VALUE=1
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE=''
	             	     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''	&&稅前小計
	             	     THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=''	&&稅後小計
	          CASE THIS.VALUE=2       &&時薪 
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE='H' 	          
	                     MONEY_NOW=ROUND(TIME_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
			     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))	
	      	   	     THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))	&&日薪-(日薪*扣稅額)	             	     
	          CASE THIS.VALUE=3       &&日薪 
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE='D' 	          
	                     MONEY_NOW=ROUND(DAY_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
			     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))	
	      	   	     THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))	&&日薪-(日薪*扣稅額)
	          CASE THIS.VALUE=4 	     &&底薪
         	             THISFORM.PAGEFRAME1.PAGE2.TXTF091.VALUE='B' 	          
	                     MONEY_NOW=ROUND(MONTH_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
			     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))	
	      	             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))	&&底薪-(底薪*扣稅額)
	    ENDCASE	
	ENDIF   
	THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=ALLTRIM(THIS.DISPLAYVALUE)          	     
    THISFORM.PAGEFRAME1.PAGE2.TXTF09.REFRESH    
  ENDPROC   
ENDDEFINE     
**********************************************發放比例
DEFINE CLASS TXTF10 AS TEXTBOX
       READONLY=.T.
       VISIBLE=.T.
       WIDTH=INT_015*50
       HEIGHT=INT_015*25
       FONTSIZE=INT_015*9         
       MAXLENGTH=6        
       INPUTMASK='999.99'       
       NAME='TXTF10' 
  PROCEDURE INTERACTIVECHANGE
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='M'   &&發薪種類(M:月薪 D:日薪 T:時薪)
                        MONTH_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A',.T.,'S06','S061'),S06.F08,0)  &&底薪
	                DAY_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F02,0)<>0,MONTH_MONEY/S00.F02,0)       			    &&日薪
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	    &&時薪
	     CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='D'     
	     		MONTH_MONEY=0
	                DAY_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'B',.T.,'S06','S061'),S06.F08,0)     
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	   
	     CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='T'      
	     		MONTH_MONEY=0
	                DAY_MONEY=0
	                TIME_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C',.T.,'S06','S061'),S06.F08,0)
       ENDCASE
       IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=1   &&不扣稅
	    DO CASE
	          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=1
	             	     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION='' 	&&稅前小計
	          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=2       &&時新
	      	   	     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(TIME_MONEY*(THIS.VALUE/100),0)))	&&日薪*發放比例	             	     
	          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=3       &&日薪
	      	   	     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(DAY_MONEY*(THIS.VALUE/100),0)))	&&日薪*發放比例
	          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=4   	 &&底薪
	      	             THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(MONTH_MONEY*(THIS.VALUE/100),0)))	&&底薪*發放比例
	    ENDCASE
	    THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION
	ELSE			&&要扣稅
	    DO CASE
	          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=1
	             	     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''	&&稅前小計
	             	     THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=''	&&稅後小計
	          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=2       
	                     MONEY_NOW=ROUND(TIME_MONEY*(THIS.VALUE/100),0)
			     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
	      	   	     THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))	             	     
	          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=3       
	                     MONEY_NOW=ROUND(DAY_MONEY*(THIS.VALUE/100),0)
			     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
	      	   	     THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))
	          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=4 
	                     MONEY_NOW=ROUND(MONTH_MONEY*(THIS.VALUE/100),0)
                             THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
	      	             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))	      	             
	    ENDCASE	
	ENDIF                        
  ENDPROC
ENDDEFINE
********************************************發放金額
DEFINE CLASS TXTF11 AS TEXTBOX
       READONLY=.T.
       VISIBLE=.T.
       WIDTH=INT_015*50
       HEIGHT=INT_015*25
       FONTSIZE=INT_015*9         
       MAXLENGTH=6       
       INPUTMASK='999999'       
       NAME='TXTF11' 
  PROCEDURE INTERACTIVECHANGE 
      IF  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP12.VALUE=1 &&不扣稅
           THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(THIS.VALUE))
      ELSE
           THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(THIS.VALUE-ROUND(THIS.VALUE*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))
     ENDIF
     THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(THIS.VALUE))
  ENDPROC 
ENDDEFINE   
*************選擇是否扣稅
DEFINE CLASS OPTIONGROUP12 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*29
   WIDTH=INT_015*260
   BUTTONCOUNT=2
   VALUE=1
   ENABLED=.F.   
   NAME='OPTIONGROUP12'
   OPTION1.CAPTION='不扣稅'
   OPTION1.TOP=INT_015*7
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5
   OPTION1.FONTSIZE=INT_015*9    
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='扣 稅率'
   OPTION2.TOP=INT_015*7
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*125
   OPTION2.FONTSIZE=INT_015*9    
   OPTION2.NAME='OPTION2'
   PROCEDURE INTERACTIVECHANGE
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='M'   &&發薪種類(M:月薪 D:日薪 T:時薪)
                        MONTH_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A',.T.,'S06','S061'),S06.F08,0)  &&底薪
	                DAY_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F02,0)<>0,MONTH_MONEY/S00.F02,0)       			    &&日薪
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	    &&時薪
	     CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='D'     
	     		MONTH_MONEY=0
	                DAY_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'B',.T.,'S06','S061'),S06.F08,0)     
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	   
	     CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='T'      
	     		MONTH_MONEY=0
	                DAY_MONEY=0
	                TIME_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C',.T.,'S06','S061'),S06.F08,0)
       ENDCASE
       IF THIS.VALUE=1 &&不扣稅
           THISFORM.PAGEFRAME1.PAGE2.TXTF12.READONLY=.T. 
       	   THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=''	   
	   THISFORM.PAGEFRAME1.PAGE2.LBLF13.CAPTION='未稅小計'    	
	   THISFORM.PAGEFRAME1.PAGE2.LBLF131.VISIBLE=.T.   
	   THISFORM.PAGEFRAME1.PAGE2.LBLF171.VISIBLE=.F.
           IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=1 &&依比例發放
               DO CASE
                     CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=1    
                                THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''      
                     CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=2  &&時薪
      			        THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(TIME_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)))                                
                     CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=3  &&日薪
      			        THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(DAY_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)))
                     CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=4  &&底薪
      			        THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(ROUND(MONTH_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)))
               ENDCASE
           ELSE     				&&依金額發放
               THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE))
           ENDIF  
           THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION
      ELSE  &&扣稅
           THISFORM.PAGEFRAME1.PAGE2.TXTF12.READONLY=.F. 
       	   THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=IIF(INDEXSEEK('J',.T.,'S00','S001'),S00.F59,0) 
       	   THISFORM.PAGEFRAME1.PAGE2.LBLF13.CAPTION='含稅小計'  
	   THISFORM.PAGEFRAME1.PAGE2.LBLF131.VISIBLE=.F.   
	   THISFORM.PAGEFRAME1.PAGE2.LBLF171.VISIBLE=.T.       	    
           IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=1 	&&依比例發放
               DO CASE
                     CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=1    
                                THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''      
                                THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=''
                     CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=2  &&時薪
                                MONEY_NOW=ROUND(TIME_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                                THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
      			        THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))      			                                        
                     CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=3  &&日薪
                                MONEY_NOW=ROUND(DAY_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                                THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
      			        THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))      			        
                     CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=4  &&底薪
                                MONEY_NOW=ROUND(MONTH_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                                THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
      			        THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))
               ENDCASE
           ELSE     		&&依金額發放
	       THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE))
               THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE-ROUND(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE*(THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE/100),0)))
           ENDIF
      ENDIF    
  ENDPROC    
ENDDEFINE       
***********************************************稅額
DEFINE CLASS TXTF12 AS TEXTBOX
       READONLY=.T.
       VISIBLE=.T.
       WIDTH=INT_015*50
       HEIGHT=INT_015*25
       FONTSIZE=INT_015*9         
       MAXLENGTH=4       
       INPUTMASK='99.9'       
       NAME='TXTF12' 
  PROCEDURE INTERACTIVECHANGE 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='M'   &&發薪種類(M:月薪 D:日薪 T:時薪)
                        MONTH_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A',.T.,'S06','S061'),S06.F08,0)  &&底薪
	                DAY_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F02,0)<>0,MONTH_MONEY/S00.F02,0)       			    &&日薪
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	    &&時薪
	     CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='D'     
	     		MONTH_MONEY=0
	                DAY_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'B',.T.,'S06','S061'),S06.F08,0)     
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	   
	     CASE THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE='T'      
	     		MONTH_MONEY=0
	                DAY_MONEY=0
	                TIME_MONEY=IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C',.T.,'S06','S061'),S06.F08,0)
       ENDCASE
       IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP09.VALUE=1  	&&依比例發放
            DO CASE
                  CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=1    
                             MONEY_NOW=0
                             THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=''    
                             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=''   
                  CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=2  &&時薪
                              MONEY_NOW=ROUND(TIME_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                              THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
      	                      THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THIS.VALUE/100),0)))                             
                  CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=3  &&日薪
                              MONEY_NOW=ROUND(DAY_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                              THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
      	                      THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THIS.VALUE/100),0)))
                 CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX09.VALUE=4  &&底薪
                  	    MONEY_NOW=ROUND(MONTH_MONEY*(THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE/100),0)
                  	    THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(MONEY_NOW))
      			    THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(MONEY_NOW-ROUND(MONEY_NOW*(THIS.VALUE/100),0)))
            ENDCASE
        ELSE     		&&依金額發放
            THISFORM.PAGEFRAME1.PAGE2.LBLF131.CAPTION=ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE))
            THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE-ROUND(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE*(THIS.VALUE/100),0)))
       ENDIF               
  ENDPROC
ENDDEFINE  

