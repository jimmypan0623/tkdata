****K01.會計科目
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
AREA1='K03'
IF !USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE
   SELE A01
ENDIF
SET ORDER TO A01
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE 
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'K01'   
IF !USED('K03')
   SELE 0
   USE K03 INDE K03
ELSE 
   SELE K03
ENDIF
SET ORDER TO 1 
*************
K01FORM=CREATEOBJECT("TKK01")
K01FORM.SHOW  
DEFINE CLASS TKK01 AS FORM
  CAPTION='K01.會計科目'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  NAME='TKK01'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT LBL_REC AS LBL_REC WITH;
      AUTOCENTER =.T.
  ADD OBJECT REC_COUNT AS REC_COUNT  WITH;
      CAPTION=STR(RECCOUNT()) 
 *****************          
  ADD OBJECT LBLF01 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*27,;
      WIDTH=INT_015*50,;
      CAPTION='科目編號'
  ADD OBJECT TXTF01 AS TEXTBOX WITH;      
      LEFT=INT_015*295,;
      TOP=INT_015*21,;
      WIDTH=INT_015*55,;
      MAXLENGTH=7,;
      NAME='TXTF01'     
  ADD OBJECT LBLF02 AS LABEL WITH;      
      LEFT=INT_015*244,;
      TOP=INT_015*54,;
      WIDTH=INT_015*50,;
      CAPTION='科目名稱'
 ADD OBJECT TXTF02 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*295,;
      TOP=INT_015*48,;
      WIDTH=INT_015*135,;
      MAXLENGTH=20,;
      NAME='TXTF02'            
  ADD OBJECT LBLF04 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*81,;
      WIDTH=INT_015*50,;
      CAPTION='借方/貸方' 
 ADD OBJECT TXTF04 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*75,;
      WIDTH=INT_015*55,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=4,;
      NAME='TXTF04'       
 ADD OBJECT OPTION04 AS OPTIONGROUP WITH;
      HEIGHT=INT_015*25,;
      TOP=INT_015*75,;
      LEFT=INT_015*295,;
      WIDTH=INT_015*100,;
      FONTSIZE=INT_015*9,;
      BUTTONCOUNT=2,;
      NAME='OPTION04'              
  ADD OBJECT LBLF07 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*108,;
      WIDTH=INT_015*50,;
      CAPTION='是否結轉'
  ADD OBJECT TXTF07 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*102,;
      WIDTH=INT_015*25,;            
      MAXLENGTH=2,;
      NAME='TXTF07'  
  ADD OBJECT OPTION07 AS OPTIONGROUP WITH;
      HEIGHT=INT_015*25,;
      TOP=INT_015*102,;
      LEFT=INT_015*295,;
      WIDTH=INT_015*100,;
      FONTSIZE=INT_015*9,;
      BUTTONCOUNT=2,;
      NAME='OPTION07' 
  ADD OBJECT LBLF08 AS LABEL WITH;
      LEFT=INT_015*550,;
      TOP=INT_015*108,;
      WIDTH=INT_015*85,;
      CAPTION='是否設定明細帳' 
   ADD OBJECT TXTF08 AS TEXTBOX WITH;      
      LEFT=INT_015*635,;
      TOP=INT_015*102,;
      WIDTH=INT_015*25,;
      MAXLENGTH=2,;
      NAME='TXTF08'
  ADD OBJECT OPTION08 AS OPTIONGROUP WITH;
      HEIGHT=INT_015*25,;
      TOP=INT_015*102,;
      LEFT=INT_015*635,;
      WIDTH=INT_015*100,;
      FONTSIZE=INT_015*9,;
      BUTTONCOUNT=2,;
      NAME='OPTION08'     
  ADD OBJECT LBLF10 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*135,;
      WIDTH=INT_015*50,;
      CAPTION='專案編號'
   ADD OBJECT TXTF10 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*128,;
      WIDTH=INT_015*55,;
      MAXLENGTH=6,;
      NAME='TXTF10' 
  ADD OBJECT OPTION10 AS OPTIONGROUP WITH;
      HEIGHT=INT_015*25,;
      TOP=INT_015*128,;
      LEFT=INT_015*295,;
      WIDTH=INT_015*170,;
      FONTSIZE=INT_015*9,;
      BUTTONCOUNT=3,;
      NAME='OPTION10'       
  ADD OBJECT LBLF09 AS LABEL WITH;
      LEFT=INT_015*550,;
      TOP=INT_015*135,;
      WIDTH=INT_015*85,;
      CAPTION='是否傳票中使用'  
   ADD OBJECT TXTF09 AS TEXTBOX WITH;
      LEFT=INT_015*635,;
      TOP=INT_015*128,;
      WIDTH=INT_015*25,;
      MAXLENGTH=2,;
      NAME='TXTF09' 
  ADD OBJECT OPTION09 AS OPTIONGROUP WITH;
      HEIGHT=INT_015*25,;
      TOP=INT_015*128,;
      LEFT=INT_015*635,;
      WIDTH=INT_015*100,;
      FONTSIZE=INT_015*9,;
      BUTTONCOUNT=2,;
      NAME='OPTION09'        
 ADD OBJECT LBLF12 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*162,;
      WIDTH=INT_015*50,;
      CAPTION='部        門'
 ADD OBJECT TXTF12 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*155,;
      WIDTH=INT_015*55,;
      MAXLENGTH=6,;
      NAME='TXTF12'   
ADD OBJECT OPTION12 AS OPTIONGROUP WITH;
      HEIGHT=INT_015*25,;
      TOP=INT_015*155,;
      LEFT=INT_015*295,;
      WIDTH=INT_015*170,;
      FONTSIZE=INT_015*9,;
      BUTTONCOUNT=3,;
      NAME='OPTION12'               
  ADD OBJECT LBLF11 AS LABEL WITH;
      LEFT=INT_015*550,;
      TOP=INT_015*162,;
      WITH=INT_015*85,;
      CAPTION='是否已開始使用'
  ADD OBJECT TXTF11 AS TEXTBOX WITH;
      LEFT=INT_015*635,;
      TOP=INT_015*155,;
      WIDTH=INT_015*25,;
      MAXLENGTH=15,;
      NAME='TXTF11' 
  ADD OBJECT OPTION11 AS OPTIONGROUP WITH;
      HEIGHT=INT_015*25,;
      TOP=INT_015*155,;
      LEFT=INT_015*635,;
      WIDTH=INT_015*100,;
      FONTSIZE=INT_015*9,;
      BUTTONCOUNT=2,;
      NAME='OPTION11'          
  ADD OBJECT LBLF13 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*189,;
      WITH=INT_015*50,;
      CAPTION='對  象  別' 
  ADD OBJECT TXTF13 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*182,;
      WIDTH=INT_015*250,;
      NAME='TXTF13' 
   ADD OBJECT CHKF131 AS CHECKBOX WITH;
      VISIBLE=.F.,;
      CAPTION='客戶',;
      LEFT=INT_015*295,;
      TOP=INT_015*186,;
      WIDTH=INT_015*40,;
      NAME='CHKF131' 
  ADD OBJECT CHKF132 AS CHECKBOX WITH;
      VISIBLE=.F.,;
      CAPTION='員工',;
      LEFT=INT_015*338,;
      TOP=INT_015*186,;
      WIDTH=INT_015*40,;
      NAME='CHKF132' 
   ADD OBJECT CHKF133 AS CHECKBOX WITH;
      VISIBLE=.F.,;
      CAPTION='廠商',;
      LEFT=INT_015*381,;
      TOP=INT_015*186,;
      WIDTH=INT_015*40,;
      NAME='CHKF133' 
  ADD OBJECT CHKF134 AS CHECKBOX WITH;
      VISIBLE=.F.,;
      CAPTION='協力廠',;
      LEFT=INT_015*424,;
      TOP=INT_015*186,;
      WIDTH=INT_015*51,;
      NAME='CHKF134'
  ADD OBJECT CHKF135 AS CHECKBOX WITH;
      VISIBLE=.F.,;
      CAPTION='其他',;
      LEFT=INT_015*478,;
      TOP=INT_015*186,;
      WIDTH=INT_015*40,;
      NAME='CHKF135' 
   ADD OBJECT LBLF131 AS LABEL WITH;
     VISIBLE=.F.,;
      LEFT=INT_015*244,;
      TOP=INT_015*216,;
      WITH=INT_015*90,;
      CAPTION='對象別是否輸入'    
   ADD OBJECT OPTION13 AS OPTIONGROUP WITH;
      HEIGHT=INT_015*25,;
      TOP=INT_015*210,;
      LEFT=INT_015*330,;
      WIDTH=INT_015*160,;
      FONTSIZE=INT_015*9,;
      BUTTONCOUNT=2,;
      NAME='OPTION13' 
  ADD OBJECT LBLF06 AS LABEL WITH;
      LEFT=INT_015*574,;
      TOP=INT_015*220,;
      WITH=INT_015*50,;
      CAPTION='安全資料'   
   ADD OBJECT LBLF061 AS LABEL WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*220,;
      AUTOSIZE=.T.,;
      CAPTION=''                   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='K03',; 
      FONTSIZE=INT_015*9,;           
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOCENTER=.T.        
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOCENTER=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*255,;
      LEFT=INT_015*558 
 ******************              
  PROC INIT
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F. 
       THISFORM.SETALL('HEIGHT',25*INT_015,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',17*INT_015,'LABEL')
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')         
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')   
       THISFORM.SETALL('FONTSIZE',INT_015*9,'CHECKBOX')   
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')  
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*130
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='科目編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='科目名稱'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='K03.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='K03.F02'
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS   
       JK='科目編號'
  ENDPROC   
**********************    
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依科目編號排列')
       ENDWITH      
  ENDPROC
*********************   
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       THISFORM.TXTF01.VALUE=K03.F01
       THISFORM.TXTF02.VALUE=K03.F02
       THISFORM.TXTF04.VALUE=BILL(K03.F04)
       THISFORM.TXTF07.VALUE=BILL(K03.F07)
       THISFORM.TXTF08.VALUE=BILL(K03.F08)
       THISFORM.TXTF09.VALUE=BILL(K03.F09)
       THISFORM.TXTF10.VALUE=BILL(K03.F10)
       THISFORM.TXTF11.VALUE=CTF(K03.F11)
       THISFORM.TXTF12.VALUE=BILL(K03.F12)
       THISFORM.TXTF13.VALUE=STRS(K03.F13)
       THISFORM.LBLF061.CAPTION=K03.F06
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.REFRESH
  ENDPROC
***************************         
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK  
       THISFORM.SETALL('READONLY',.F.,'TEXTBOX') 
       THISFORM.SETALL('VISIBLE',.T.,'OPTIONGROUP') 
       THISFORM.SETALL('VISIBLE',.T.,'CHECKBOX')   
       THISFORM.SETALL('VALUE',1,'OPTIONGROUP')
       THISFORM.SETALL('VALUE',0,'CHECKBOX') 
       THISFORM.TXTF01.VALUE=''
       THISFORM.TXTF02.VALUE=''
       THISFORM.TXTF04.VALUE=''
       THISFORM.TXTF04.VALUE=THISFORM.OPTION04.VALUE
       THISFORM.TXTF07.VALUE=''
       THISFORM.TXTF07.VALUE=THISFORM.OPTION07.VALUE
       THISFORM.TXTF08.VALUE=''
       THISFORM.TXTF08.VALUE=THISFORM.OPTION08.VALUE
       THISFORM.TXTF09.VALUE=''
       THISFORM.TXTF09.VALUE=THISFORM.OPTION09.VALUE
       THISFORM.TXTF10.VALUE=''
       THISFORM.TXTF10.VALUE=THISFORM.OPTION10.VALUE
       THISFORM.TXTF11.VALUE=''
       THISFORM.TXTF11.VALUE=THISFORM.OPTION11.VALUE
       THISFORM.TXTF12.VALUE=''
       THISFORM.TXTF12.VALUE=THISFORM.OPTION12.VALUE
       THISFORM.TXTF13.VISIBLE=.F.
       THISFORM.LBLF131.VISIBLE=.T.
       THISFORM.LBLF061.CAPTION=''
       THISFORM.TXTF01.SETFOCUS()
       THISFORM.GRID1.ENABLED=.F.
       FLG='1'
  ENDPROC 
************************
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
  CHS=''
    IF EMPTY(THISFORM.TXTF01.VALUE)
       =MESSAGEBOX('科目編號不得空白!',0+64,'提示視窗')
       THISFORM.TXTF01.SETFOCUS
       RETURN
    ENDIF   
    IF SEEK(THISFORM.TXTF01.VALUE,'K03')=.T.
        =MESSAGEBOX('此科目編號已建立請重新輸入!',0+64,'提示視窗')
        THISFORM.TXTF01.SETFOCUS
        RETURN
    ENDIF   
   SELECT K03
    APPEND BLANK
    LOCK()
    IF RLOCK()
       REPLACE F01 WITH THISFORM.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.TXTF02.VALUE
       DO CASE 
       	      CASE THISFORM.OPTION04.VALUE=1
      			 REPLACE F04 WITH 'D'
      	      CASE THISFORM.OPTION04.VALUE=2
      			 REPLACE F04 WITH 'C'
       ENDCASE
       DO CASE 
       	      CASE THISFORM.OPTION07.VALUE=1
      			 REPLACE F07 WITH 'Y'
      	      CASE THISFORM.OPTION07.VALUE=2
      			 REPLACE F07 WITH 'N'
       ENDCASE		 	 
       DO CASE 
       	      CASE THISFORM.OPTION08.VALUE=1
      			 REPLACE F08 WITH 'Y'
      	      CASE THISFORM.OPTION08.VALUE=2
      			 REPLACE F08 WITH 'N'
       ENDCASE
        DO CASE 
       	      CASE THISFORM.OPTION09.VALUE=1
      			 REPLACE F09 WITH 'Y'
      	      CASE THISFORM.OPTION09.VALUE=2
      			 REPLACE F09 WITH 'N'
       ENDCASE
       DO CASE 
       	      CASE THISFORM.OPTION10.VALUE=1
      			 REPLACE F10 WITH '1'
      	      CASE THISFORM.OPTION10.VALUE=2
      			 REPLACE F10 WITH '0'
      	      CASE THISFORM.OPTION10.VALUE=3
      			 REPLACE F10 WITH '2'		 
       ENDCASE
       DO CASE 
       	      CASE THISFORM.OPTION11.VALUE=1
      			 REPLACE F11 WITH .T.
      	      CASE THISFORM.OPTION11.VALUE=2
      			 REPLACE F11 WITH .F.
       ENDCASE
       DO CASE 
       	      CASE THISFORM.OPTION12.VALUE=1
      			 REPLACE F12 WITH '1'
      	      CASE THISFORM.OPTION12.VALUE=2
      			 REPLACE F12 WITH '0'
      	      CASE THISFORM.OPTION12.VALUE=3
      			 REPLACE F12 WITH '2'		 
       ENDCASE
       IF THISFORM.CHKF131.VALUE=1
       		CHS=CHS+'C'
       ENDIF
        IF THISFORM.CHKF132.VALUE=1
       		CHS=CHS+'P'
       ENDIF
        IF THISFORM.CHKF133.VALUE=1
       		CHS=CHS+'V'
       ENDIF
        IF THISFORM.CHKF134.VALUE=1
       		CHS=CHS+'W'
       ENDIF
        IF THISFORM.CHKF135.VALUE=1
       		CHS=CHS+'O'
       ENDIF
       IF THISFORM.OPTION13.VALUE=1
       		CHS=CHS+''
       ELSE
       		CHS=CHS+'/'	
       ENDIF
      REPLACE F13 WITH CHS
      REPLACE F06 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ENDIF
    UNLOCK
    THISFORM.REC_COUNT.CAPTION=STR(RECCOUNT())
    THISFORM.GRID1.ENABLED=.T.
    THISFORM.REFRESH
    THISFORM.GRID1.SETFOCUS    
    THISFORM.ORPGROUP.NEW_BOTT.CLICK            
  ENDPROC
****************************** 
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
    THISFORM.SETALL('VISIBLE',.T.,'CHECKBOX')
    THISFORM.SETALL('VISIBLE',.T.,'OPTIONGROUP')    
     THISFORM.TXTF01.READONLY=.T.
     THISFORM.OPTION04.VALUE=IIF(K03.F04='D',1,2)
     THISFORM.OPTION07.VALUE=IIF(K03.F07='Y',1,2)
     THISFORM.OPTION08.VALUE=IIF(K03.F08='Y',1,2)
     THISFORM.OPTION09.VALUE=IIF(K03.F09='Y',1,2)
     THISFORM.OPTION10.VALUE=IIF(K03.F10='1',1,IIF(K03.F10='0',2,3))
     THISFORM.OPTION11.VALUE=IIF(K03.F11=.T.,1,2)
     THISFORM.OPTION12.VALUE=IIF(K03.F10='1',1,IIF(K03.F10='0',2,3))
     THISFORM.TXTF13.VISIBLE=.F.
     FOR I=1 TO LEN(ALLTRIM(K03.F13))
      IF  RIGHT(LEFT(K03.F13,I),1)='C'
     	   THISFORM.CHKF131.VALUE=1
      ENDIF
      IF  RIGHT(LEFT(K03.F13,I),1)='P'
     	   THISFORM.CHKF132.VALUE=1
      ENDIF
      IF  RIGHT(LEFT(K03.F13,I),1)='V'
     	   THISFORM.CHKF133.VALUE=1
      ENDIF
      IF  RIGHT(LEFT(K03.F13,I),1)='W'
     	   THISFORM.CHKF134.VALUE=1
      ENDIF
      IF  RIGHT(LEFT(K03.F13,I),1)='O'
     	   THISFORM.CHKF135.VALUE=1
      ENDIF 
      IF  RIGHT(LEFT(K03.F13,I),1)='/'
     	   THISFORM.OPTION13.VALUE=2
     ELSE
     	   THISFORM.OPTION13.VALUE=1  
      ENDIF	  
   ENDFOR
     THISFORM.LBLF131.VISIBLE=.T.
     THISFORM.LBLF061.CAPTION=''
     THISFORM.GRID1.ENABLED=.F.
     THISFORM.TXTF02.SETFOCUS
     LOCK()
     IF !RLOCK()
        DO FILE_IMPACT
        RETURN
     ENDIF
  ENDPROC 
***************************************
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
  CHS=''
   IF EMPTY(THISFORM.TXTF02.VALUE)
       =MESSAGEBOX('科目名稱不得白!',0+64,'提示視窗')
       THISFORM.TXTF02.SETFOCUS
       RETURN
    ENDIF   
    SELE K03
    IF RLOCK()
       REPLACE F02 WITH THISFORM.TXTF02.VALUE
       DO CASE 
       	      CASE THISFORM.OPTION04.VALUE=1
      			 REPLACE F04 WITH 'D'
      	      CASE THISFORM.OPTION04.VALUE=2
      			 REPLACE F04 WITH 'C'
       ENDCASE
       DO CASE 
       	      CASE THISFORM.OPTION07.VALUE=1
      			 REPLACE F07 WITH 'Y'
      	      CASE THISFORM.OPTION07.VALUE=2
      			 REPLACE F07 WITH 'N'
       ENDCASE		 	 
       DO CASE 
       	      CASE THISFORM.OPTION08.VALUE=1
      			 REPLACE F08 WITH 'Y'
      	      CASE THISFORM.OPTION08.VALUE=2
      			 REPLACE F08 WITH 'N'
       ENDCASE
        DO CASE 
       	      CASE THISFORM.OPTION09.VALUE=1
      			 REPLACE F09 WITH 'Y'
      	      CASE THISFORM.OPTION09.VALUE=2
      			 REPLACE F09 WITH 'N'
       ENDCASE
       DO CASE 
       	      CASE THISFORM.OPTION10.VALUE=1
      			 REPLACE F10 WITH '1'
      	      CASE THISFORM.OPTION10.VALUE=2
      			 REPLACE F10 WITH '0'
      	      CASE THISFORM.OPTION10.VALUE=3
      			 REPLACE F10 WITH '2'		 
       ENDCASE
        DO CASE 
       	      CASE THISFORM.OPTION11.VALUE=1
      			 REPLACE F11 WITH .T.
      	      CASE THISFORM.OPTION11.VALUE=2
      			 REPLACE F11 WITH .F.
       ENDCASE
       DO CASE 
       	      CASE THISFORM.OPTION12.VALUE=1
      			 REPLACE F12 WITH '1'
      	      CASE THISFORM.OPTION12.VALUE=2
      			 REPLACE F12 WITH '0'
      	      CASE THISFORM.OPTION12.VALUE=3
      			 REPLACE F12 WITH '2'		 
       ENDCASE
       IF THISFORM.CHKF131.VALUE=1
       		CHS=CHS+'C'
       ENDIF
        IF THISFORM.CHKF132.VALUE=1
       		CHS=CHS+'P'
       ENDIF
        IF THISFORM.CHKF133.VALUE=1
       		CHS=CHS+'V'
       ENDIF
        IF THISFORM.CHKF134.VALUE=1
       		CHS=CHS+'W'
       ENDIF
        IF THISFORM.CHKF135.VALUE=1
       		CHS=CHS+'O'
       ENDIF
       IF THISFORM.OPTION13.VALUE=1
       		CHS=CHS+''
       ELSE
       		CHS=CHS+'/'	
       ENDIF
      REPLACE F13 WITH CHS
      REPLACE F06 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'') 
    ELSE
      DO FILE_IMPACT
      RETURN   
    ENDIF   
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC  
******************************
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK
     IF MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	        
        SELE K03
        LOCK()
        IF RLOCK()   
           DELE
           UNLOCK
           SKIP -1
           IF BOF()
              GO TOP
           ENDIF   
           THISFORM.GRID1.SETFOCUS
           IF THISFORM.GRID1.ACTIVEROW=0
              THISFORM.SETALL('VALUE','','TEXTBOX')
              THISFORM.CMDGROUP.ENABLED=.F.
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
           ELSE
              THISFORM.CMDGROUP.ENABLED=.T.
              THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限              
           ENDIF
        ELSE
          DO FILE_IMPACT    
        ENDIF     
     ENDIF   
  ENDPROC
********************** 
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限      
      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限      
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.KEY_LIST.ENABLED=.T.   
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.SETALL('VISIBLE',.F.,'OPTIONGROUP') 
      THISFORM.SETALL('VISIBLE',.F.,'CHECKBOX') 
      THISFORM.TXTF13.VISIBLE=.T. 
      THISFORM.LBLF131.VISIBLE=.F.
      UNLOCK ALL
      SELE K03
      THISFORM.GRID1.ENABLED=.T.
      THISFORM.GRID1.SETFOCUS          
  ENDPROC
****************  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK   
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC  
 ***************    
  PROCEDURE OPTION04.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .OPTION1.CAPTION='借方'
	  .OPTION1.LEFT=INT_015*2
	  .OPTION1.TOP=INT_015*1
	  .OPTION1.WIDTH=INT_015*40
	  .OPTION1.HEIGHT=INT_015*25
	  .OPTION2.CAPTION='貸方'
	  .OPTION2.LEFT=INT_015*45
	  .OPTION2.TOP=INT_015*1
	  .OPTION2.WIDTH=INT_015*40
	  .OPTION2.HEIGHT=INT_015*25     
     ENDWITH   
  ENDPROC  
  PROCEDURE OPTION04.INTERACTIVECHANGE
     THISFORM.TXTF04.VALUE=THIS.VALUE
  ENDPROC
   PROCEDURE OPTION07.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .OPTION1.CAPTION='是'
	  .OPTION1.LEFT=INT_015*2
	  .OPTION1.TOP=INT_015*1
	  .OPTION1.WIDTH=INT_015*40
	  .OPTION1.HEIGHT=INT_015*25
	  .OPTION2.CAPTION='否'
	  .OPTION2.LEFT=INT_015*45
	  .OPTION2.TOP=INT_015*1
	  .OPTION2.WIDTH=INT_015*40
	  .OPTION2.HEIGHT=INT_015*25     
     ENDWITH   
  ENDPROC  
  PROCEDURE OPTION07.INTERACTIVECHANGE
     THISFORM.TXTF07.VALUE=THIS.VALUE
  ENDPROC
  PROCEDURE OPTION08.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .OPTION1.CAPTION='是'
	  .OPTION1.LEFT=INT_015*2
	  .OPTION1.TOP=INT_015*1
	  .OPTION1.WIDTH=INT_015*40
	  .OPTION1.HEIGHT=INT_015*25
	  .OPTION2.CAPTION='否'
	  .OPTION2.LEFT=INT_015*45
	  .OPTION2.TOP=INT_015*1
	  .OPTION2.WIDTH=INT_015*40
	  .OPTION2.HEIGHT=INT_015*25     
     ENDWITH   
  ENDPROC  
  PROCEDURE OPTION08.INTERACTIVECHANGE
     THISFORM.TXTF08.VALUE=THIS.VALUE
  ENDPROC
 PROCEDURE OPTION09.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .OPTION1.CAPTION='是'
	  .OPTION1.LEFT=INT_015*2
	  .OPTION1.TOP=INT_015*1
	  .OPTION1.WIDTH=INT_015*40
	  .OPTION1.HEIGHT=INT_015*25
	  .OPTION2.CAPTION='否'
	  .OPTION2.LEFT=INT_015*45
	  .OPTION2.TOP=INT_015*1
	  .OPTION2.WIDTH=INT_015*40
	  .OPTION2.HEIGHT=INT_015*25     
     ENDWITH   
  ENDPROC  
  PROCEDURE OPTION09.INTERACTIVECHANGE
     THISFORM.TXTF09.VALUE=THIS.VALUE
  ENDPROC
 PROCEDURE OPTION10.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .OPTION1.CAPTION='不限'
	  .OPTION1.LEFT=INT_015*2
	  .OPTION1.TOP=INT_015*1
	  .OPTION1.WIDTH=INT_015*40
	  .OPTION1.HEIGHT=INT_015*25
	  .OPTION2.CAPTION='不輸入'
	  .OPTION2.LEFT=INT_015*45
	  .OPTION2.TOP=INT_015*1
	  .OPTION2.WIDTH=INT_015*55
	  .OPTION2.HEIGHT=INT_015*25 
	  .OPTION3.CAPTION='必須輸入'
	  .OPTION3.LEFT=INT_015*100
	  .OPTION3.TOP=INT_015*1
	  .OPTION3.WIDTH=INT_015*65
	  .OPTION3.HEIGHT=INT_015*25     
     ENDWITH   
  ENDPROC  
  PROCEDURE OPTION10.INTERACTIVECHANGE
     THISFORM.TXTF10.VALUE=THIS.VALUE
  ENDPROC  
 PROCEDURE OPTION11.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .OPTION1.CAPTION='是'
	  .OPTION1.LEFT=INT_015*2
	  .OPTION1.TOP=INT_015*1
	  .OPTION1.WIDTH=INT_015*40
	  .OPTION1.HEIGHT=INT_015*25
	  .OPTION2.CAPTION='否'
	  .OPTION2.LEFT=INT_015*45
	  .OPTION2.TOP=INT_015*1
	  .OPTION2.WIDTH=INT_015*40
	  .OPTION2.HEIGHT=INT_015*25     
     ENDWITH   
  ENDPROC  
  PROCEDURE OPTION11.INTERACTIVECHANGE
     THISFORM.TXTF11.VALUE=THIS.VALUE
  ENDPROC  
 PROCEDURE OPTION12.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .OPTION1.CAPTION='不限'
	  .OPTION1.LEFT=INT_015*2
	  .OPTION1.TOP=INT_015*1
	  .OPTION1.WIDTH=INT_015*40
	  .OPTION1.HEIGHT=INT_015*25
	  .OPTION2.CAPTION='不輸入'
	  .OPTION2.LEFT=INT_015*45
	  .OPTION2.TOP=INT_015*1
	  .OPTION2.WIDTH=INT_015*55
	  .OPTION2.HEIGHT=INT_015*25 
	  .OPTION3.CAPTION='必須輸入'
	  .OPTION3.LEFT=INT_015*100
	  .OPTION3.TOP=INT_015*1
	  .OPTION3.WIDTH=INT_015*65
	  .OPTION3.HEIGHT=INT_015*25     
     ENDWITH   
  ENDPROC  
  PROCEDURE OPTION12.INTERACTIVECHANGE
     THISFORM.TXTF12.VALUE=THIS.VALUE
  ENDPROC
  PROCEDURE OPTION13.INIT
     WITH THIS 
          .VISIBLE=.F.
          .VALUE=1
          .OPTION1.CAPTION='無須輸入'
	  .OPTION1.LEFT=INT_015*2
	  .OPTION1.TOP=INT_015*1
	  .OPTION1.WIDTH=INT_015*70
	  .OPTION1.HEIGHT=INT_015*25
	  .OPTION2.CAPTION='必須輸入'
	  .OPTION2.LEFT=INT_015*75
	  .OPTION2.TOP=INT_015*1
	  .OPTION2.WIDTH=INT_015*70
	  .OPTION2.HEIGHT=INT_015*25   
     ENDWITH   
  ENDPROC                  
ENDDEFINE
***************
FUNC BILL
     PARA JUK
     JO=''
     DO CASE
        CASE JUK='Y'
             JO='是'
        CASE JUK='N'
             JO='否'
        CASE JUK='D'
             JO='借方'
        CASE JUK='C'
             JO='貸方'                
        CASE JUK='0'
             JO='不輸入'
        CASE JUK='1'
             JO='不限'
        CASE JUK='2'
             JO='必須輸入' 
     ENDCASE
     RETURN JO         
***********判斷是否已開始使用
FUNC CTF
     PARA TF
     OTF=''
     DO CASE
        CASE TF=.T.
             OTF ='是' 
        CASE TF=.F.
             OTF='否' 
     ENDCASE
     RETURN OTF 
***********判斷對象別
FUNC STRS
     PARA SR
     ST=''
FOR I=1 TO LEN(ALLTRIM(SR))
    DO CASE
    	  CASE  RIGHT(LEFT(SR,I),1)='C'
      		      ST=ST+'客戶,'
      	  CASE  RIGHT(LEFT(SR,I),1)='P'
      	  	      ST=ST+'員工,' 
      	  CASE  RIGHT(LEFT(SR,I),1)='V'
      	  	      ST=ST+'廠商,' 
      	  CASE  RIGHT(LEFT(SR,I),1)='W'
      	  	      ST=ST+'協力廠,' 
      	 CASE  RIGHT(LEFT(SR,I),1)='O'
      	  	      ST=ST+'其他,'  	
      	 CASE  RIGHT(LEFT(SR,I),1)='/'
      	  	      ST=ST+'(必須輸入)'   	            	      
    ENDCASE
ENDFOR   
 RETURN ST         
