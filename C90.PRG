*********C90.業務人員月目標考核表
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
AREA1='C90_1'
CHK=''
HK=''
TOL=0
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE 
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK sys_oper+'C90'   
IF !USED('A01')
   SELE 0
   USE A01 INDE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01
IF !USED('A14')
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141  
IF !USED('A23')
    SELE 0
    USE A23
ELSE 
   SELE A23
ENDIF
SET ORDER TO 1  
IF !USED('B01')
   SELE 0
   USE B01 INDE B01
ELSE
   SELE B01
ENDIF
SET ORDER TO 1
B26='B26'+LEFT(DTOS(DATE()),6)   &&庫存異動記錄檔 
B261='B261'+LEFT(DTOS(DATE()),6)
IF !USED('&B26')
   SELE 0
   USE (B26) ALIA B26 INDE (B26)
ELSE
   SELE B26
ENDIF
SET ORDER TO B261  
IF !USED('C01')
    SELE 0
    USE C01
ELSE 
   SELE C01
ENDIF
SET ORDER TO 1  
C10='C10'+LEFT(DTOS(DATE()),6)   &&出貨日報表檔
IF !USED('&C10')
   SELE 0
   USE (C10) ALIA C10 INDE (C10)
ELSE
   SELE C10
ENDIF
SET ORDER TO 1                 
IF !USED('C90')
   SELECT  0
   USE C90  INDE C90
ELSE 
   SELECT  C90
ENDIF
SET ORDER TO C901  
D11='D11'+LEFT(DTOS(DATE()),6)   &&出貨日報表檔
D111='D111'+LEFT(DTOS(DATE()),6)
IF !USED('&D11')
   SELE 0
   USE (D11) ALIA D11 INDE (D11)
ELSE
   SELE D11
ENDIF
SET ORDER TO D111   
IF !USED('K5F')
   SELE 0
   USE K5F 
ELSE 
   SELE K5F 
ENDIF
SET ORDER TO K5F1
IF !USED('K51')
   SELE 0
   USE K51 
ELSE 
   SELE K51 
ENDIF
SET ORDER TO K511
******比重設定
CREATE CURSOR C90_2;
(F10A N(3),F10B N(3),F10C N(3),F10D N(3),F10E N(3),F10G N(3),F10H N(3),F10I N(3),F98 N(3),F99 C(17))
SELECT F09,F10,F99 FROM C90 WHERE  C90.F04='Z'  ORDER BY C90.F09 INTO CURSOR C90B
SELECT C90_2
APPEND BLANK 
REPLACE C90_2.F99 WITH C90B.F99
GO TOP
SELECT C90B
GO TOP
DO WHILE !EOF()
       SELECT C90_2
       DO CASE
              CASE C90B.F09='A'
                          REPLACE C90_2.F10A WITH C90B.F10
              CASE C90B.F09='B'
                          REPLACE C90_2.F10B WITH C90B.F10
              CASE C90B.F09='C'
                          REPLACE C90_2.F10C WITH C90B.F10 
              CASE C90B.F09='D'
                          REPLACE C90_2.F10D WITH C90B.F10  
              CASE C90B.F09='E'
                          REPLACE C90_2.F10E WITH C90B.F10  
         ENDCASE   
         REPLACE C90_2.F98 WITH C90_2.F98+C90B.F10
         SELECT C90B
         SKIP
ENDDO
SELECT C90B
USE
************等級設定
CREATE CURSOR C90_3;
(F12A N(3),F13A N(3),F12B N(3),F13B N(3),F12C N(3),F13C N(3),F12D N(3),F13D N(3),F12E N(3),F13E N(3),F99 C(17))
SELECT F11,F12,F13,F99 FROM C90 WHERE  C90.F04='Y'  ORDER BY C90.F11 INTO CURSOR C90C
SELECT C90_3
APPEND BLANK 
REPLACE C90_3.F99 WITH C90C.F99    
GO TOP
SELECT C90C
GO TOP
DO WHILE !EOF()
       SELECT C90_3
       DO CASE 
              CASE C90C.F11='A'
                         REPLACE C90_3.F12A WITH C90C.F12
			 REPLACE C90_3.F13A WITH C90C.F13
              CASE C90C.F11='B'
                         REPLACE C90_3.F12B WITH C90C.F12
			 REPLACE C90_3.F13B WITH C90C.F13			 
              CASE C90C.F11='C'
                         REPLACE C90_3.F12C WITH C90C.F12
			 REPLACE C90_3.F13C WITH C90C.F13
              CASE C90C.F11='D'
                         REPLACE C90_3.F12D WITH C90C.F12
			 REPLACE C90_3.F13D WITH C90C.F13
              CASE C90C.F11='E'
                         REPLACE C90_3.F12E WITH C90C.F12
			 REPLACE C90_3.F13E WITH C90C.F13			 			 			 
       ENDCASE
       SELECT C90C
       SKIP
ENDDO
SELECT C90C
USE
****等級比對表
SELECT F11,F12,F13 FROM C90 WHERE F04='Y'  ORDER BY F11 INTO CURSOR C90_TEMPY
*************考核內容
CREATE CURSOR C90_1;
(F01 C(5),F02 C(10),F03 D(8),F05A N(8),F06A N(8),F07A N(3),F08A N(3),F05B N(8),F06B N(8),F07B N(3),F08B N(3),F05C N(8),F06C N(8),F07C N(3),F08C N(3),;
	                                         F05D N(8),F06D N(8),F07D N(3),F08D N(3),F05E N(8),F06E N(8),F07E N(3),F08E N(3),F10 N(3),F11 C(1),F14X C(254),F99 C(17)) 
INDE ON F01 TAG C90_11
INDE ON F02 TAG C90_12
SET ORDER TO C90_11
SELECT F01,F02,F03,F99 FROM C90 WHERE LEFT(DTOS(C90.F03),6)=LEFT(DTOS(DATE()),6) .AND. C90.F04<>'Z' .AND. C90.F04<>'Y' ORDER BY C90.F01 GROUP BY C90.F01 INTO CURSOR C90A
SELECT C90A
GO TOP
DO WHILE !EOF()
       SELECT C90_1
       APPEND BLANK 
       REPLACE C90_1.F01 WITH C90A.F01
       REPLACE C90_1.F02 WITH C90A.F02
       REPLACE C90_1.F03 WITH C90A.F03
       REPLACE C90_1.F99 WITH C90A.F99
       SELECT C90A
       SKIP
ENDDO
SELECT C90A
USE
SELECT F01,F04,F05,F06,F07,F08,F14 FROM C90 WHERE LEFT(DTOS(C90.F03),6)=LEFT(DTOS(DATE()),6) .AND. C90.F04<>'Z' .AND. C90.F04<>'Y' ORDER BY C90.F01 INTO CURSOR C90_TEMP
SELECT C90_TEMP
GO TOP
DO WHILE !EOF()
       SELECT C90_1
       SEEK C90_TEMP.F01
       IF FOUND()
           DO CASE 
                  CASE C90_TEMP.F04='A'
                             REPLACE C90_1.F05A WITH C90_TEMP.F05
                             REPLACE C90_1.F06A WITH C90_TEMP.F06
                             REPLACE C90_1.F07A WITH C90_TEMP.F07
                             REPLACE C90_1.F08A WITH C90_TEMP.F08
                  CASE C90_TEMP.F04='B'
                             REPLACE C90_1.F05B WITH C90_TEMP.F05
                             REPLACE C90_1.F06B WITH C90_TEMP.F06
                             REPLACE C90_1.F07B WITH C90_TEMP.F07
                             REPLACE C90_1.F08B WITH C90_TEMP.F08
                  CASE C90_TEMP.F04='C'
                             REPLACE C90_1.F05C WITH C90_TEMP.F05
                             REPLACE C90_1.F06C WITH C90_TEMP.F06
                             REPLACE C90_1.F07C WITH C90_TEMP.F07
                             REPLACE C90_1.F08C WITH C90_TEMP.F08
                  CASE C90_TEMP.F04='D'
                             REPLACE C90_1.F05D WITH C90_TEMP.F05
                             REPLACE C90_1.F06D WITH C90_TEMP.F06
                             REPLACE C90_1.F07D WITH C90_TEMP.F07
                             REPLACE C90_1.F08D WITH C90_TEMP.F08
                  CASE C90_TEMP.F04='E'
                             REPLACE C90_1.F05E WITH C90_TEMP.F05
                             REPLACE C90_1.F06E WITH C90_TEMP.F06
                             REPLACE C90_1.F07E WITH C90_TEMP.F07
                             REPLACE C90_1.F08E WITH C90_TEMP.F08           
                  CASE C90_TEMP.F04='X'	&&備註說明
                             REPLACE C90_1.F14X WITH C90_TEMP.F14                                                                                                                                                                                                                                                  
	   ENDCASE
	   REPLACE C90_1.F10   WITH  C90_1.F10+C90_TEMP.F08	&&總得分
       ENDIF   
       SELECT C90_TEMP
       SKIP
ENDDO
SELECT C90_TEMP
USE
**判斷得分等級
SELECT C90_1
GO TOP
DO WHILE !EOF()
       SELECT C90_TEMPY
       GO TOP      
       DO WHILE !EOF()
               IF C90_1.F10<=C90_TEMPY.F12 AND C90_1.F10>=C90_TEMPY.F13
                    SELECT C90_1
                    REPLACE C90_1.F11 WITH C90_TEMPY.F11
               ENDIF
               SELECT C90_TEMPY
               SKIP
       ENDDO
       SELECT C90_1
       SKIP
ENDDO
SELECT C90_1
SET ORDER TO C90_11
GO TOP
**********
C90FORM=CREATEOBJECT("TKC90")
C90FORM.SHOW  
DEFINE CLASS TKC90 AS FORM
  CAPTION='C90.業務人員月目標考核表'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKC90'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.  
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*67,;      
      FONTSIZE=INT_015*9,;
      CAPTION='\<A.參數設定',;
      NAME='ANS_BOTT'                      
  ADD OBJECT LBLF01 AS LABEL WITH;
      LEFT=INT_015*260,;
      TOP=INT_015*35,;
      WIDTH=INT_015*50,;
      CAPTION='人員編號'
  ADD OBJECT LBLF011 AS LABEL WITH;
      LEFT=INT_015*386,;
      TOP=INT_015*35,;
      AUTOSIZE=.T.,;
      CAPTION=''         
  ADD OBJECT TXTF01 AS TEXTBOX WITH;
      LEFT=INT_015*311,;
      TOP=INT_015*29,;
      WIDTH=INT_015*65,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=5,;
      NAME='TXTF01'       
 ADD OBJECT COMBOBOX01 AS COMBOBOX01 WITH;      
      VISIBLE=.F.,;
       LEFT=INT_015*311,;
       TOP=INT_015*29                 
  ADD OBJECT LINEL AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*87,;
      HEIGHT=INT_015*254,;
      WIDTH=INT_015*0             
  ADD OBJECT LINER AS LINE WITH;      
      LEFT=INT_015*749,;
      TOP=INT_015*87,;
      HEIGHT=INT_015*254,;
      WIDTH=INT_015*0        
  ADD OBJECT LBLF05 AS LABEL WITH;      
      LEFT=INT_015*485,;
      TOP=INT_015*70,;
      AUTOSIZE=.T.,;
      CAPTION='目標值           達成值            達成率           得    分'        
  ADD OBJECT LINE04 AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*87,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490      
 **************     
  ADD OBJECT LBLF04A AS LABEL WITH;      
      LEFT=INT_015*270,;
      TOP=INT_015*96,;
      AUTOSIZE=.T.,;
      CAPTION='1、當月銷售金額                                                                                                      ％' 
  ADD OBJECT TXTF05A AS TEXTBOX WITH;
      LEFT=INT_015*460,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF05A'            
  ADD OBJECT TXTF06A AS TEXTBOX WITH;
      LEFT=INT_015*530,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF06A'        
  ADD OBJECT TXTF07A AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF07A'            
  ADD OBJECT TXTF08A AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*90,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF08A'      
  ADD OBJECT LINE04A AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*115,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490         
  ***********    
  ADD OBJECT LBLF04B AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*124,;
      AUTOSIZE=.T.,;
      CAPTION='2、應收帳款回收率                                                   ％                    ％                   ％'          
  ADD OBJECT TXTF05B AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*118,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05B'           
  ADD OBJECT TXTF06B AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*118,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06B'        
  ADD OBJECT TXTF07B AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*118,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF07B'            
  ADD OBJECT TXTF08B AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*118,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF08B'          
  ADD OBJECT LINE04B AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*143,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
  *********            
  ADD OBJECT LBLF04C AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*152,;
      AUTOSIZE=.T.,;
      CAPTION='3、當月進貨金額與進貨已出金額比                                                                        ％' 
  ADD OBJECT TXTF05C AS TEXTBOX WITH;
      LEFT=INT_015*460,;
      TOP=INT_015*146,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF05C'           
  ADD OBJECT TXTF06C AS TEXTBOX WITH;
      LEFT=INT_015*530,;
      TOP=INT_015*146,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*60,;
       MAXLENGTH=8,;
       INPUTMASK='99999999',;
      NAME='TXTF06C'        
  ADD OBJECT TXTF07C AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*146,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF07C'            
  ADD OBJECT TXTF08C AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*146,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF08C'    
  ADD OBJECT LINE04C AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*171,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490            
   *************         
  ADD OBJECT LBLF04D AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*180,;
      AUTOSIZE=.T.,;
      CAPTION='4、緊急採購、緊急異動及訂購異動率                     ％                    ％                   ％'  
  ADD OBJECT TXTF05D AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*174,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05D'           
  ADD OBJECT TXTF06D AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*174,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06D'        
  ADD OBJECT TXTF07D AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*174,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF07D'            
  ADD OBJECT TXTF08D AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*174,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF08D'          
  ADD OBJECT LINE04D AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*198,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
****************      
  ADD OBJECT LBLF04E AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*206,;
      AUTOSIZE=.T.,;
      CAPTION='5、主管評分                                                              ％                    ％                   ％'  
  ADD OBJECT TXTF05E AS TEXTBOX WITH;
      LEFT=INT_015*485,;
      TOP=INT_015*201,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF05E'           
  ADD OBJECT TXTF06E AS TEXTBOX WITH;
      LEFT=INT_015*555,;
      TOP=INT_015*201,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF06E'        
  ADD OBJECT TXTF07E AS TEXTBOX WITH;
      LEFT=INT_015*625,;
      TOP=INT_015*201,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF07E'            
  ADD OBJECT TXTF08E AS TEXTBOX WITH;
      LEFT=INT_015*695,;
      TOP=INT_015*201,;
      HEIGHT=INT_015*22,;
      WIDTH=INT_015*35,;
       MAXLENGTH=3,;
       INPUTMASK='999',;
      NAME='TXTF08E'    
  ADD OBJECT LINE04E AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*226,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490           
******
  ADD OBJECT LBLF_NOTE AS LABEL WITH;
      LEFT=INT_015*270,;
      TOP=INT_015*233,;
      AUTOSIZE=.T.,;
      CAPTION='6、備註說明'          
  ADD OBJECT TXTF_NOTE AS EDITBOX WITH;
      LEFT=INT_015*285,;
      TOP=INT_015*250,;
      WIDTH=INT_015*400,;
      HEIGHT=INT_015*80,;
      READONLY=.T.,;
      MAXLENGTH=254,;
      NAME='TXTF_NOTE'               
  ADD OBJECT LINE_NOTE AS LINE WITH;      
      LEFT=INT_015*260,;
      TOP=INT_015*340,;
      HEIGHT=INT_015*0,;
      WIDTH=INT_015*490            
************
  ADD OBJECT LBLF_TOL AS LABEL WITH;
      LEFT=INT_015*290,;
      TOP=INT_015*350,;
      AUTOSIZE=.T. ,;
      BACKCOLOR=RGB(255,255,0),;
      CAPTION='總  得  分：'            
  ADD OBJECT LBLF_LEV AS LABEL WITH;
      LEFT=INT_015*400,;
      TOP=INT_015*350,;
      AUTOSIZE=.T. ,;
      BACKCOLOR=RGB(255,255,0),;
      CAPTION='等        級：'                        
  ADD OBJECT LBLF99 AS LABEL WITH;
      LEFT=INT_015*560,;
      TOP=INT_015*350,;
      WIDTH=INT_015*50,;
      CAPTION='安全資料'
  ADD OBJECT LBLF991 AS LABEL WITH;
      LEFT=INT_015*610,;
      TOP=INT_015*350,;
      CAPTION='',;
      AUTOSIZE=.T.                   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*130
  ADD OBJECT MTH_LIST AS MTH_LIST WITH;
      AUTOCENTER=.T.      
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=2,;            
      RECORDSOURCE='C90_1',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.              
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
      AUTOSIZE=.T.
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*370,;
      LEFT=INT_015*620          
  PROC INIT  
       HK=ALLTRIM(THISFORM.MTH_LIST.DISPLAYVALUE)
       SELECT C90_1
       GO TOP
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.SETALL('HEIGHT',INT_015*22,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')       
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'HEADER')    
       THISFORM.TXTF_NOTE.FONTSIZE=INT_015*9
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)  
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='人員編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='人員姓名'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='C90_1.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='C90_1.F02'
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       
          THISFORM.CMDGROUP.ENABLED=.F.
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
          THISFORM.SETALL('VALUE','','TEXTBOX')
          THISFORM.TXTF_NOTE.VALUE=''
          THISFORM.LBLF011.CAPTION=''
          THISFORM.LBLF991.CAPTION=''
          THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
          THISFORM.LBLF_LEV.CAPTION='等        級：'             
       ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.            
          THISFORM.CMDGROUP.ENABLED=.T.      
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  &&判斷有無刪除的權限
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限     
       ENDIF     
       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無確認的權限 
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)  &&判斷有無新增的權限 
       JK='人員編號'
  ENDPROC
  ***********     
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依人員編號排列')
       ENDWITH      
  ENDPROC 
  *********
  PROC MTH_LIST.INIT        
       WITH THIS
            SELE A23
            GO TOP
            K=0
            S=0
            DO WHILE !EOF()                
               K=K+1
               .ADDITEM(LEFT(DTOC(A23.F01),5))
               IF LEFT(DTOC(DATE()),5)=LEFT(DTOC(A23.F01),5)
                  S=K
               ENDIF       
               SKIP
            ENDDO   
            .VALUE=S
       ENDWITH   
  ENDPROC  
  ******
 PROC MTH_LIST.INTERACTIVECHANGE
       HK=ALLTRIM(THISFORM.MTH_LIST.DISPLAYVALUE)
       THISFORM.GRID1.RECORDSOURCE=''
       SELECT B26
       USE
       B26='B26'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)    &&庫存異動記錄檔 
       B261='B261'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6) 
       IF !USED('&B26')
	   SELE 0
	   USE (B26) ALIA B26 INDE (B26)
       ELSE
	   SELE B26
       ENDIF
       SET ORDER TO B261         
       SELECT C10
       USE
       C10='C10'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)   &&出貨日報表檔
       C101='C101'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6) 
       IF !USED('&C10')
	   SELE 0
	   USE (C10) ALIA C10 INDE (C10)
       ELSE
	   SELE C10
       ENDIF
       SET ORDER TO C101      
       SELECT D11
       USE 
       D11='D11'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)   &&出貨日報表檔
       D111='D111'+LEFT(DTOS(CTOD(THIS.DISPLAYVALUE+'/01')),6)
       IF !USED('&D11')
           SELECT  0
           USE (D11) ALIA D11 INDE (D11)
       ELSE
           SELE D11
       ENDIF
       SET ORDER TO D111                
       SELECT C90_1
       USE 
	*************考核內容
	CREATE CURSOR C90_1;
       (F01 C(5),F02 C(10),F03 D(8),F05A N(8),F06A N(8),F07A N(3),F08A N(3),F05B N(8),F06B N(8),F07B N(3),F08B N(3),F05C N(8),F06C N(8),F07C N(3),F08C N(3),;
	                                                F05D N(8),F06D N(8),F07D N(3),F08D N(3),F05E N(8),F06E N(8),F07E N(3),F08E N(3),F10 N(3),F11 C(1),F14X C(254),F99 C(17)) 		                                         
	INDE ON F01 TAG C90_11
	INDE ON F02 TAG C90_12
	SET ORDER TO C90_11
	SELECT F01,F02,F03,F99 FROM C90 WHERE LEFT(DTOS(C90.F03),6)=LEFT(DTOS(CTOD(ALLTRIM(THISFORM.MTH_LIST.DISPLAYVALUE)+'/01')),6);
	             .AND. C90.F04<>'Z' .AND. C90.F04<>'Y' ORDER BY C90.F01 GROUP BY C90.F01 INTO CURSOR C90A
	SELECT C90A
	GO TOP
	DO WHILE !EOF()
	       SELECT C90_1
	       APPEND BLANK 
	       REPLACE C90_1.F01 WITH C90A.F01
	       REPLACE C90_1.F02 WITH C90A.F02
	       REPLACE C90_1.F03 WITH C90A.F03
	       REPLACE C90_1.F99 WITH C90A.F99
	       SELECT C90A
	       SKIP
	ENDDO
	SELECT C90A
	USE
	SELECT F01,F04,F05,F06,F07,F08,F14 FROM C90 WHERE LEFT(DTOS(C90.F03),6)=LEFT(DTOS(CTOD(ALLTRIM(THISFORM.MTH_LIST.DISPLAYVALUE)+'/01')),6);
	             .AND. C90.F04<>'Z' .AND. C90.F04<>'Y' ORDER BY C90.F01 INTO CURSOR C90_TEMP
	SELECT C90_TEMP
	GO TOP
	DO WHILE !EOF()
	       SELECT C90_1
	       SEEK C90_TEMP.F01
	       IF FOUND()
	           DO CASE 
	                  CASE C90_TEMP.F04='A'
	                             REPLACE C90_1.F05A WITH C90_TEMP.F05
	                             REPLACE C90_1.F06A WITH C90_TEMP.F06
	                             REPLACE C90_1.F07A WITH C90_TEMP.F07
	                             REPLACE C90_1.F08A WITH C90_TEMP.F08
	                  CASE C90_TEMP.F04='B'
	                             REPLACE C90_1.F05B WITH C90_TEMP.F05
	                             REPLACE C90_1.F06B WITH C90_TEMP.F06
	                             REPLACE C90_1.F07B WITH C90_TEMP.F07
	                             REPLACE C90_1.F08B WITH C90_TEMP.F08
	                  CASE C90_TEMP.F04='C'
	                             REPLACE C90_1.F05C WITH C90_TEMP.F05
	                             REPLACE C90_1.F06C WITH C90_TEMP.F06
	                             REPLACE C90_1.F07C WITH C90_TEMP.F07
	                             REPLACE C90_1.F08C WITH C90_TEMP.F08
	                  CASE C90_TEMP.F04='D'
	                             REPLACE C90_1.F05D WITH C90_TEMP.F05
	                             REPLACE C90_1.F06D WITH C90_TEMP.F06
	                             REPLACE C90_1.F07D WITH C90_TEMP.F07
	                             REPLACE C90_1.F08D WITH C90_TEMP.F08
	                  CASE C90_TEMP.F04='E'
	                             REPLACE C90_1.F05E WITH C90_TEMP.F05
	                             REPLACE C90_1.F06E WITH C90_TEMP.F06
	                             REPLACE C90_1.F07E WITH C90_TEMP.F07
	                             REPLACE C90_1.F08E WITH C90_TEMP.F08
	                  CASE C90_TEMP.F04='X'	&&備註說明
	                             REPLACE C90_1.F14X WITH C90_TEMP.F14
		   ENDCASE
		   REPLACE C90_1.F10   WITH  C90_1.F10+C90_TEMP.F08
	       ENDIF   
	       SELECT C90_TEMP
	       SKIP
	ENDDO
	SELECT C90_TEMP
	USE
	SELECT C90_1
	GO TOP
	DO WHILE !EOF()
	       SELECT C90_TEMPY
	       GO TOP      
	       DO WHILE !EOF()
	               IF C90_1.F10<=C90_TEMPY.F12 .AND. C90_1.F10>=C90_TEMPY.F13
	                    SELECT C90_1
	                    REPLACE C90_1.F11 WITH C90_TEMPY.F11
	               ENDIF
	               SELECT C90_TEMPY
	               SKIP
	       ENDDO
	       SELECT C90_1
	       SKIP
	ENDDO
	SELECT C90_1
	SET ORDER TO C90_11
	GO TOP    
       THISFORM.GRID1.RECORDSOURCE='C90_1'
       THISFORM.KEY_LIST.INTERACTIVECHANGE
       THISFORM.REFRESH
       THISFORM.GRID1.SETFOCUS        
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       
          THISFORM.CMDGROUP.ENABLED=.F.
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
          THISFORM.SETALL('VALUE','','TEXTBOX')
          THISFORM.TXTF_NOTE.VALUE=''
          THISFORM.LBLF011.CAPTION=''
          THISFORM.LBLF991.CAPTION=''
          THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
          THISFORM.LBLF_LEV.CAPTION='等        級：'             
       ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.            
          THISFORM.CMDGROUP.ENABLED=.T.      
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  &&判斷有無刪除的權限
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限
       ENDIF                   
       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無確認的權限 
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)  &&判斷有無新增的權限   
ENDPROC        
  **********
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       THISFORM.TXTF01.VALUE=C90_1.F01
       THISFORM.TXTF05A.VALUE=C90_1.F05A
       THISFORM.TXTF06A.VALUE=C90_1.F06A
       THISFORM.TXTF07A.VALUE=C90_1.F07A
       THISFORM.TXTF08A.VALUE=C90_1.F08A
       THISFORM.TXTF05B.VALUE=C90_1.F05B
       THISFORM.TXTF06B.VALUE=C90_1.F06B
       THISFORM.TXTF07B.VALUE=C90_1.F07B
       THISFORM.TXTF08B.VALUE=C90_1.F08B
       THISFORM.TXTF05C.VALUE=C90_1.F05C
       THISFORM.TXTF06C.VALUE=C90_1.F06C
       THISFORM.TXTF07C.VALUE=C90_1.F07C
       THISFORM.TXTF08C.VALUE=C90_1.F08C
       THISFORM.TXTF05D.VALUE=C90_1.F05D
       THISFORM.TXTF06D.VALUE=C90_1.F06D
       THISFORM.TXTF07D.VALUE=C90_1.F07D
       THISFORM.TXTF08D.VALUE=C90_1.F08D
       THISFORM.TXTF05E.VALUE=C90_1.F05E
       THISFORM.TXTF06E.VALUE=C90_1.F06E
       THISFORM.TXTF07E.VALUE=C90_1.F07E
       THISFORM.TXTF08E.VALUE=C90_1.F08E
       THISFORM.TXTF_NOTE.VALUE=C90_1.F14X
       THISFORM.LBLF011.CAPTION=C90_1.F02
       THISFORM.LBLF991.CAPTION=C90_1.F99    
       THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(C90_1.F10))+' 分'
       THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_1.F11
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.REFRESH
  ENDPROC      
  ********** 
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
       THISFORM.GRID1.ENABLED=.F.
       THISFORM.MTH_LIST.ENABLED=.F. 
       THISFORM.KEY_LIST.ENABLED=.F. 
       THISFORM.ANS_BOTT.ENABLED=.F.   &&判斷有無確認的權限
       THISFORM.SETALL('READONLY',.F.,'TEXTBOX')
       THISFORM.COMBOBOX01.VISIBLE=.T.
       THISFORM.COMBOBOX01.VALUE=1
       THISFORM.COMBOBOX01.CLICK 
       THISFORM.TXTF01.VISIBLE=.F.      
       THISFORM.TXTF07A.READONLY=.T.  
       THISFORM.TXTF08A.READONLY=.T. 
       THISFORM.TXTF07B.READONLY=.T.  
       THISFORM.TXTF08B.READONLY=.T. 
       THISFORM.TXTF07C.READONLY=.T.  
       THISFORM.TXTF08C.READONLY=.T. 
       THISFORM.TXTF07D.READONLY=.T.  
       THISFORM.TXTF08D.READONLY=.T. 
       THISFORM.TXTF07E.READONLY=.T.  
       THISFORM.TXTF08E.READONLY=.T. 
       THISFORM.TXTF_NOTE.READONLY=.F.                                                
       THISFORM.TXTF01.VALUE=''
       THISFORM.TXTF05A.VALUE=0
       THISFORM.TXTF06A.VALUE=0
       THISFORM.TXTF07A.VALUE=0
       THISFORM.TXTF08A.VALUE=0
       THISFORM.TXTF05B.VALUE=0
       THISFORM.TXTF06B.VALUE=0
       THISFORM.TXTF07B.VALUE=0
       THISFORM.TXTF08B.VALUE=0
       THISFORM.TXTF05C.VALUE=0
       THISFORM.TXTF06C.VALUE=0
       THISFORM.TXTF07C.VALUE=0
       THISFORM.TXTF08C.VALUE=0
       THISFORM.TXTF05D.VALUE=0
       THISFORM.TXTF06D.VALUE=0
       THISFORM.TXTF07D.VALUE=0
       THISFORM.TXTF08D.VALUE=0
       THISFORM.TXTF05E.VALUE=0
       THISFORM.TXTF06E.VALUE=0
       THISFORM.TXTF07E.VALUE=0
       THISFORM.TXTF08E.VALUE=0
       THISFORM.TXTF_NOTE.VALUE=''
       THISFORM.LBLF011.CAPTION=''
       THISFORM.LBLF991.CAPTION=''          
       THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
       THISFORM.LBLF_LEV.CAPTION='等        級：'        
       THISFORM.COMBOBOX01.SETFOCUS()
       FLG='1'
  ENDPROC  
************
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
    IF EMPTY(THISFORM.TXTF01.VALUE)
       =MESSAGEBOX('人員編號不得空白!',0+64,'提示視窗')
       THISFORM.COMBOBOX01.SETFOCUS
       RETURN
    ENDIF  
    IF INDEXSEEK(THISFORM.TXTF01.VALUE+'A'+DTOS(CTOD(ALLTRIM(HK+'/01'))),.F.,'C90','C903')
       =MESSAGEBOX('此人員編號之考核表已存在,請重新輸入!',0+64,'提示視窗')
       THISFORM.COMBOBOX01.SETFOCUS
       RETURN
    ENDIF                   
    SELECT  C90_1
    APPEND BLANK
    LOCK()
    IF RLOCK()
       REPLACE C90_1.F01 WITH THISFORM.TXTF01.VALUE
       REPLACE C90_1.F02 WITH ALLTRIM(THISFORM.LBLF011.CAPTION)
       REPLACE C90_1.F05A WITH THISFORM.TXTF05A.VALUE
       REPLACE C90_1.F06A WITH THISFORM.TXTF06A.VALUE
       REPLACE C90_1.F07A WITH THISFORM.TXTF07A.VALUE
       REPLACE C90_1.F08A WITH THISFORM.TXTF08A.VALUE
       REPLACE C90_1.F05B WITH THISFORM.TXTF05B.VALUE
       REPLACE C90_1.F06B WITH THISFORM.TXTF06B.VALUE
       REPLACE C90_1.F07B WITH THISFORM.TXTF07B.VALUE
       REPLACE C90_1.F08B WITH THISFORM.TXTF08B.VALUE
       REPLACE C90_1.F05C WITH THISFORM.TXTF05C.VALUE
       REPLACE C90_1.F06C WITH THISFORM.TXTF06C.VALUE
       REPLACE C90_1.F07C WITH THISFORM.TXTF07C.VALUE
       REPLACE C90_1.F08C WITH THISFORM.TXTF08C.VALUE
       REPLACE C90_1.F05D WITH THISFORM.TXTF05D.VALUE
       REPLACE C90_1.F06D WITH THISFORM.TXTF06D.VALUE
       REPLACE C90_1.F07D WITH THISFORM.TXTF07D.VALUE
       REPLACE C90_1.F08D WITH THISFORM.TXTF08D.VALUE
       REPLACE C90_1.F05E WITH THISFORM.TXTF05E.VALUE
       REPLACE C90_1.F06E WITH THISFORM.TXTF06E.VALUE
       REPLACE C90_1.F07E WITH THISFORM.TXTF07E.VALUE
       REPLACE C90_1.F08E WITH THISFORM.TXTF08E.VALUE
       REPLACE C90_1.F14X WITH ALLTRIM(THISFORM.TXTF_NOTE.VALUE)
       REPLACE C90_1.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       REPLACE C90_1.F10 WITH THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
       REPLACE C90_1.F11 WITH  RIGHT(ALLTRIM(THISFORM.LBLF_LEV.CAPTION),1)           	  				       
*!*	       SELECT C90_TEMPY
*!*	       GO TOP
*!*	       DO WHILE !EOF()
*!*	       	      IF C90_1.F10<=C90_TEMPY.F12 .AND. C90_1.F10>=C90_TEMPY.F13
*!*		           SELECT C90_1
*!*		           REPLACE C90_1.F11 WITH C90_TEMPY.F11
*!*		      ENDIF
*!*		      SELECT C90_TEMPY
*!*		      SKIP
*!*	       ENDDO           	  				       
       FOR I=1 TO 5
               C90_1F05='C90_1.F05'+CHR(64+I)
               C90_1F06='C90_1.F06'+CHR(64+I)
               C90_1F07='C90_1.F07'+CHR(64+I)
               C90_1F08='C90_1.F08'+CHR(64+I)
               NO=ALLTRIM(CHR(64+I))
               SELECT C90
	       APPEND BLANK 
	       REPLACE C90.F01 WITH C90_1.F01
	       REPLACE C90.F02 WITH C90_1.F02    
	       REPLACE C90.F03 WITH CTOD(ALLTRIM(THISFORM.MTH_LIST.DISPLAYVALUE)+'/01')
	       REPLACE C90.F04 WITH NO
	       REPLACE C90.F05 WITH &C90_1F05
	       REPLACE C90.F06 WITH &C90_1F06
	       REPLACE C90.F07 WITH &C90_1F07
	       REPLACE C90.F08 WITH &C90_1F08
	       REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
	ENDFOR  
	SELECT C90
	APPEND BLANK 
	REPLACE C90.F01 WITH C90_1.F01
	REPLACE C90.F02 WITH C90_1.F02    
	REPLACE C90.F03 WITH CTOD(ALLTRIM(THISFORM.MTH_LIST.DISPLAYVALUE)+'/01')
	REPLACE C90.F04 WITH 'X'
	REPLACE C90.F14 WITH ALLTRIM(THISFORM.TXTF_NOTE.VALUE)
	REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')	     
    ENDIF
    UNLOCK
    THISFORM.GRID1.ENABLED=.T.
    THISFORM.REFRESH
    THISFORM.GRID1.SETFOCUS    
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK      
  ENDPROC
************  
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
     SELECT C90_1
     THISFORM.GRID1.ENABLED=.F.
     THISFORM.MTH_LIST.ENABLED=.F. 
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.ANS_BOTT.ENABLED=.F.   &&判斷有無確認的權限
     THISFORM.SETALL('READONLY',.F.,'TEXTBOX')   
     THISFORM.TXTF01.READONLY=.T.
     THISFORM.TXTF07A.READONLY=.T.  
     THISFORM.TXTF08A.READONLY=.T. 
     THISFORM.TXTF07B.READONLY=.T.  
     THISFORM.TXTF08B.READONLY=.T. 
     THISFORM.TXTF07C.READONLY=.T.  
     THISFORM.TXTF08C.READONLY=.T. 
     THISFORM.TXTF07D.READONLY=.T.  
     THISFORM.TXTF08D.READONLY=.T. 
     THISFORM.TXTF07E.READONLY=.T.  
     THISFORM.TXTF08E.READONLY=.T.      
     THISFORM.TXTF_NOTE.READONLY=.F.     
     THISFORM.LBLF991.CAPTION=''     
     THISFORM.TXTF05A.SETFOCUS
     LOCK()
     IF !RLOCK()
        DO FILE_IMPACT
        RETURN
     ENDIF
  ENDPROC 
************  
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK    
    SELECT  C90_1  
    IF  RLOCK()
	 REPLACE C90_1.F05A WITH THISFORM.TXTF05A.VALUE
	 REPLACE C90_1.F06A WITH THISFORM.TXTF06A.VALUE
         REPLACE C90_1.F07A WITH THISFORM.TXTF07A.VALUE
         REPLACE C90_1.F08A WITH THISFORM.TXTF08A.VALUE
         REPLACE C90_1.F05B WITH THISFORM.TXTF05B.VALUE
         REPLACE C90_1.F06B WITH THISFORM.TXTF06B.VALUE
         REPLACE C90_1.F07B WITH THISFORM.TXTF07B.VALUE
         REPLACE C90_1.F08B WITH THISFORM.TXTF08B.VALUE
         REPLACE C90_1.F05C WITH THISFORM.TXTF05C.VALUE
         REPLACE C90_1.F06C WITH THISFORM.TXTF06C.VALUE
         REPLACE C90_1.F07C WITH THISFORM.TXTF07C.VALUE
         REPLACE C90_1.F08C WITH THISFORM.TXTF08C.VALUE
         REPLACE C90_1.F05D WITH THISFORM.TXTF05D.VALUE
         REPLACE C90_1.F06D WITH THISFORM.TXTF06D.VALUE
         REPLACE C90_1.F07D WITH THISFORM.TXTF07D.VALUE
         REPLACE C90_1.F08D WITH THISFORM.TXTF08D.VALUE
         REPLACE C90_1.F05E WITH THISFORM.TXTF05E.VALUE
         REPLACE C90_1.F06E WITH THISFORM.TXTF06E.VALUE
         REPLACE C90_1.F07E WITH THISFORM.TXTF07E.VALUE
         REPLACE C90_1.F08E WITH THISFORM.TXTF08E.VALUE
         REPLACE C90_1.F14X WITH ALLTRIM(THISFORM.TXTF_NOTE.VALUE)
         REPLACE C90_1.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
         REPLACE C90_1.F10 WITH THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
         REPLACE C90_1.F11 WITH  RIGHT(ALLTRIM(THISFORM.LBLF_LEV.CAPTION),1)
*!*	         SELECT C90_TEMPY
*!*	         GO TOP
*!*	         DO WHILE !EOF()
*!*	       	        IF C90_1.F10<=C90_TEMPY.F12 .AND. C90_1.F10>=C90_TEMPY.F13
*!*		            SELECT C90_1
*!*		            REPLACE C90_1.F11 WITH C90_TEMPY.F11
*!*		        ENDIF
*!*		        SELECT C90_TEMPY
*!*		        SKIP
*!*	         ENDDO             
         FOR I=1 TO 5
               C90_1F05='C90_1.F05'+CHR(64+I)
               C90_1F06='C90_1.F06'+CHR(64+I)
               C90_1F07='C90_1.F07'+CHR(64+I)
               C90_1F08='C90_1.F08'+CHR(64+I)
               NO=ALLTRIM(CHR(64+I))
               SELECT C90
	       SET ORDER TO C903
	       SEEK C90_1.F01+NO+DTOS(CTOD(ALLTRIM(HK+'/01')))
	       IF  FOUND()
	            REPLACE C90.F05 WITH &C90_1F05
	            REPLACE C90.F06 WITH &C90_1F06
	            REPLACE C90.F07 WITH &C90_1F07
	            REPLACE C90.F08 WITH &C90_1F08
	            REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
	       ENDIF     
	ENDFOR  
        SELECT C90
	SET ORDER TO C903
	SEEK C90_1.F01+'X'+DTOS(CTOD(ALLTRIM(HK+'/01')))  
	IF FOUND()
	    REPLACE C90.F14 WITH ALLTRIM(THISFORM.TXTF_NOTE.VALUE)
	    REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')	
	ENDIF    
    ELSE
        DO file_impact
        RETURN   
    ENDIF   
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC
*******************
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK
     SELECT C90_1
     LOCK()
     IF MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	
          SELECT  RECNO() FROM C90 WHERE C90.F01=C90_1.F01 .AND. C90.F03=CTOD(ALLTRIM(THISFORM.MTH_LIST.DISPLAYVALUE)+'/01') .AND.;
                        C90.F04<>'Z'  .AND. C90.F04<>'Y'  INTO ARRAY BK1                                
          JJ1=''                
          IF _TALLY>0   
             FOR I= 1 TO ALEN(BK1)
                 JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
             ENDFOR    
             KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
             RLOCK(KK1,'C90')
             LL1=RLOCK(KK1,'C90')
          ELSE
             LL1=.T.   
          ENDIF   
           IF LL1=.T. .AND. LEN(ALLTRIM(JJ1))>0      
                SELECT C90
                FOR I= 1 TO ALEN(BK1)                      
                        GO BK1(I)  
			DELETE  
                ENDFOR        
           ENDIF   
           RELEASE ALL LIKE BK*
           SELECT C90_1
           IF RLOCK()
                DELETE 
		SKIP -1
                IF BOF()
                    GO TOP
                ENDIF                
           ENDIF
           UNLOCK
      ENDIF              
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC
*************   
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      SELECT C90_1
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.    
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')   
      THISFORM.KEY_LIST.ENABLED=.T.     
      THISFORM.MTH_LIST.ENABLED=.T.   
      THISFORM.COMBOBOX01.VISIBLE=.F.
      THISFORM.TXTF01.VISIBLE=.T.     
      THISFORM.TXTF_NOTE.READONLY=.T.   
      THISFORM.GRID1.ENABLED=.T. 
      THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       
          THISFORM.CMDGROUP.ENABLED=.F.
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
          THISFORM.TXTF01.VALUE=''
	  THISFORM.TXTF05A.VALUE=0
	  THISFORM.TXTF06A.VALUE=0
	  THISFORM.TXTF07A.VALUE=0
	  THISFORM.TXTF08A.VALUE=0
	  THISFORM.TXTF05B.VALUE=0
	  THISFORM.TXTF06B.VALUE=0
	  THISFORM.TXTF07B.VALUE=0
	  THISFORM.TXTF08B.VALUE=0
	  THISFORM.TXTF05C.VALUE=0
	  THISFORM.TXTF06C.VALUE=0
	  THISFORM.TXTF07C.VALUE=0
	  THISFORM.TXTF08C.VALUE=0
	  THISFORM.TXTF05D.VALUE=0
	  THISFORM.TXTF06D.VALUE=0
	  THISFORM.TXTF07D.VALUE=0
	  THISFORM.TXTF08D.VALUE=0
	  THISFORM.TXTF05E.VALUE=0
	  THISFORM.TXTF06E.VALUE=0
	  THISFORM.TXTF07E.VALUE=0
	  THISFORM.TXTF08E.VALUE=0
	  THISFORM.TXTF_NOTE.VALUE=''
	  THISFORM.LBLF011.CAPTION=''
	  THISFORM.LBLF991.CAPTION='' 
          THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
          THISFORM.LBLF_LEV.CAPTION='等        級：'   	  
       ELSE
          THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
          THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
          THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.            
          THISFORM.CMDGROUP.ENABLED=.T. 
          THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)   &&判斷有無修改的權限
          THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
          THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限
          THISFORM.TXTF01.VALUE=C90_1.F01
	  THISFORM.TXTF05A.VALUE=C90_1.F05A
	  THISFORM.TXTF06A.VALUE=C90_1.F06A
	  THISFORM.TXTF07A.VALUE=C90_1.F07A
	  THISFORM.TXTF08A.VALUE=C90_1.F08A
	  THISFORM.TXTF05B.VALUE=C90_1.F05B
	  THISFORM.TXTF06B.VALUE=C90_1.F06B
	  THISFORM.TXTF07B.VALUE=C90_1.F07B
	  THISFORM.TXTF08B.VALUE=C90_1.F08B
	  THISFORM.TXTF05C.VALUE=C90_1.F05C
	  THISFORM.TXTF06C.VALUE=C90_1.F06C
	  THISFORM.TXTF07C.VALUE=C90_1.F07C
	  THISFORM.TXTF08C.VALUE=C90_1.F08C
	  THISFORM.TXTF05D.VALUE=C90_1.F05D
	  THISFORM.TXTF06D.VALUE=C90_1.F06D
	  THISFORM.TXTF07D.VALUE=C90_1.F07D
	  THISFORM.TXTF08D.VALUE=C90_1.F08D
	  THISFORM.TXTF05E.VALUE=C90_1.F05E
	  THISFORM.TXTF06E.VALUE=C90_1.F06E
	  THISFORM.TXTF07E.VALUE=C90_1.F07E
	  THISFORM.TXTF08E.VALUE=C90_1.F08E
	  THISFORM.TXTF_NOTE.VALUE=C90_1.F14X
	  THISFORM.LBLF011.CAPTION=C90_1.F02
	  THISFORM.LBLF991.CAPTION=C90_1.F99          
          THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(C90_1.F10))+' 分'
          THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_1.F11	   
       ENDIF   
       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.)   &&判斷有無確認的權限 
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)  &&判斷有無新增的權限   
       UNLOCK ALL
  ENDPROC
  ********
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK 
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC       
PROCEDURE COMBOBOX01.CLICK	&&人員編號
      THISFORM.COMBOBOX01.CLEAR
       SELECT F01 FROM C90 WHERE ALLTRIM(LEFT(DTOC(F03),5)) = ALLTRIM(HK) GROUP BY F01 ORDER BY F01  INTO CURSOR C90ABC
       SELECT F01,F03 FROM A01  WHERE ALLTRIM(F04)='S000'  OR ALLTRIM(F04)='S001' ORDER BY F01 INTO CURSOR A01_TEMP READWRITE 
       INDE ON F01 TAG A01_TEMP1
       SELECT A01_TEMP
       SET ORDER TO A01_TEMP1
       SELECT C90ABC
       GO TOP
       DO WHILE !EOF()
              SELECT A01_TEMP
              SEEK C90ABC.F01
              IF FOUND()
                  SELECT A01_TEMP
                  DELETE 
              ENDIF
              SELECT C90ABC
              SKIP
       ENDDO
       SELECT C90ABC
       USE
       SELECT A01_TEMP       
       GO TOP  
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(A01_TEMP.F01)+SPACE(5-LEN(ALLTRIM(A01_TEMP.F01))+7)+A01_TEMP.F03)
      	      SELECT  A01_TEMP
      	      SKIP
       ENDDO
       SELECT A01_TEMP
       USE       
  ENDPROC          
*************1.當月銷售金額
   PROCEDURE TXTF05A.INTERACTIVECHANGE
           THISFORM.TXTF07A.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06A.VALUE,100,ROUND((THISFORM.TXTF06A.VALUE/THISFORM.TXTF05A.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
           THISFORM.TXTF08A.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06A.VALUE,C90_2.F10A,ROUND((C90_2.F10A/THISFORM.TXTF05A.VALUE)*THISFORM.TXTF06A.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1
  ENDPROC          
  PROCEDURE TXTF06A.INTERACTIVECHANGE 
           THISFORM.TXTF07A.VALUE=IIF(THISFORM.TXTF05A.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF05A.VALUE)*100,0)) 
           THISFORM.TXTF08A.VALUE=IIF(THISFORM.TXTF05A.VALUE<=THIS.VALUE,C90_2.F10A,ROUND((C90_2.F10A/THISFORM.TXTF05A.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1       
  ENDPROC
  PROCEDURE TXTF08A.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE))+' 分'
ENDPROC 
*************2.應收帳款回收率
   PROCEDURE TXTF05B.INTERACTIVECHANGE
           THISFORM.TXTF07B.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06B.VALUE,100,ROUND((THISFORM.TXTF06B.VALUE/THISFORM.TXTF05B.VALUE)*100,0)) 
           THISFORM.TXTF08B.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06B.VALUE,C90_2.F10B,ROUND((C90_2.F10B/THISFORM.TXTF05B.VALUE)*THISFORM.TXTF06B.VALUE,0)) 
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1               
  ENDPROC          
  PROCEDURE TXTF06B.INTERACTIVECHANGE 
           THISFORM.TXTF07B.VALUE=IIF(THISFORM.TXTF05B.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF05B.VALUE)*100,0)) 
           THISFORM.TXTF08B.VALUE=IIF(THISFORM.TXTF05B.VALUE<=THIS.VALUE,C90_2.F10B,ROUND((C90_2.F10B/THISFORM.TXTF05B.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO 
	   SELECT C90_1               
  ENDPROC     
  PROCEDURE TXTF08B.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE))+' 分'
  ENDPROC    
*************3.當月份進貨金額與進貨已出金額比
   PROCEDURE TXTF05C.INTERACTIVECHANGE
           THISFORM.TXTF07C.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06C.VALUE,100,ROUND((THISFORM.TXTF06C.VALUE/THISFORM.TXTF05C.VALUE)*100,0)) 
           THISFORM.TXTF08C.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06C.VALUE,C90_2.F10C,ROUND((C90_2.F10C/THISFORM.TXTF05C.VALUE)*THISFORM.TXTF06C.VALUE,0))    
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1               
  ENDPROC          
  PROCEDURE TXTF06C.INTERACTIVECHANGE 
           THISFORM.TXTF07C.VALUE=IIF(THISFORM.TXTF05C.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF05C.VALUE)*100,0)) 
           THISFORM.TXTF08C.VALUE=IIF(THISFORM.TXTF05C.VALUE<=THIS.VALUE,C90_2.F10C,ROUND((C90_2.F10C/THISFORM.TXTF05C.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1               
  ENDPROC  
  PROCEDURE TXTF08C.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE))+' 分'
ENDPROC  
*************4.緊急採購、緊急異動及訂購異動率
   PROCEDURE TXTF05D.INTERACTIVECHANGE
           THISFORM.TXTF07D.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06D.VALUE,100,ROUND((THISFORM.TXTF06D.VALUE/THISFORM.TXTF05D.VALUE)*100,0)) 
           THISFORM.TXTF08D.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06D.VALUE,C90_2.F10D,ROUND((C90_2.F10D/THISFORM.TXTF05D.VALUE)*THISFORM.TXTF06D.VALUE,0)) 
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1               
  ENDPROC          
  PROCEDURE TXTF06D.INTERACTIVECHANGE 
           THISFORM.TXTF07D.VALUE=IIF(THISFORM.TXTF05D.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF05D.VALUE)*100,0)) 
           THISFORM.TXTF08D.VALUE=IIF(THISFORM.TXTF05D.VALUE<=THIS.VALUE,C90_2.F10D,ROUND((C90_2.F10D/THISFORM.TXTF05D.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1               
  ENDPROC     
  PROCEDURE TXTF08D.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE))+' 分'
ENDPROC     
*************5.主管評分
   PROCEDURE TXTF05E.INTERACTIVECHANGE
           THISFORM.TXTF07E.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06E.VALUE,100,ROUND((THISFORM.TXTF06E.VALUE/THISFORM.TXTF05E.VALUE)*100,0)) 
           THISFORM.TXTF08E.VALUE=IIF(THIS.VALUE<=THISFORM.TXTF06E.VALUE,C90_2.F10E,ROUND((C90_2.F10E/THISFORM.TXTF05E.VALUE)*THISFORM.TXTF06E.VALUE,0)) 
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1               
  ENDPROC          
  PROCEDURE TXTF06E.INTERACTIVECHANGE 
           THISFORM.TXTF07E.VALUE=IIF(THISFORM.TXTF05E.VALUE<=THIS.VALUE,100,ROUND((THIS.VALUE/THISFORM.TXTF05E.VALUE)*100,0)) 
           THISFORM.TXTF08E.VALUE=IIF(THISFORM.TXTF05E.VALUE<=THIS.VALUE,C90_2.F10E,ROUND((C90_2.F10E/THISFORM.TXTF05E.VALUE)*THIS.VALUE,0)) 
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND. TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +C90_TEMPY.F11
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1               
  ENDPROC     
  PROCEDURE TXTF08E.INTERACTIVECHANGE 
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE))+' 分'
ENDPROC  
**********  
  PROC ANS_BOTT.CLICK     &&參數設定
       SELECT  C90_1
       NO=C90_1.F01
       ANS_SEEK=CREATEOBJECT("ANS_SEEK")  
       ANS_SEEK.SHOW                
       FLG='0'           
       SELECT  C90_1  
       SEEK NO
       THISFORM.GRID1.SETFOCUS
  ENDPROC
ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
   FLG='0'
   SELE C90_1
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW    
   IF FLG<>'1'
       =MESSAGEBOX('無此範圍資料',0+48,'警示')
   ENDIF   
   FLG='0'  
ENDPROC
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*190
  WIDTH=INT_015*360
  FONTSIZE=INT_015*9
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*28,;
      TOP=INT_015*75,;
      CAPTION='起始人員編號',;
      NAME='LABEL1'
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*180,;
      TOP=INT_015*75,;
      CAPTION='截止人員編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      TOP=INT_015*70,;
      LEFT=INT_015*105,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*55,;
      NAME='TEXT1'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      TOP=INT_015*70,;
      LEFT=INT_015*255,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*55,;        
      NAME='TEXT2'    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*75,;    
      HEIGHT=INT_015*25,;   
      TOP=INT_015*144,;  
      WIDTH=INT_015*80,;
      CAPTION='\<Y.執行',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*225,;
      TOP=INT_015*144,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*80,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')         
      THISFORM.TEXT1.VALUE=C90_1.F01
      THISFORM.TEXT2.VALUE=C90_1.F01  
   ENDPROC     
   PROCEDURE CMND1.CLICK   
        SELECT * FROM C90_1 WHERE  ALLTRIM(C90_1.F01)>=ALLTRIM(THISFORM.TEXT1.VALUE) .AND. ALLTRIM(C90_1.F01)<=ALLTRIM(THISFORM.TEXT2.VALUE) ORDER BY C90_1.F01 NOWAIT
        IF _TALLY >0
            REPORT FORM ALLTRIM(INT_116)+'C90' TO PRINT PROMPT PREVIEW
            CLEAR
         ENDIF   
           THISFORM.CMND2.CLICK
   ENDPROC   
   **
  PROCEDURE CMND2.CLICK
      FLG='1'   
      THISFORM.RELEASE
  ENDPROC         
ENDDEFINE              
*************************************************員工編號
DEFINE CLASS COMBOBOX01 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*65
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX01'

   PROCEDURE INTERACTIVECHANGE
       IF THIS.VALUE=1
            THISFORM.TXTF01.VALUE=''
	    THISFORM.TXTF05A.VALUE=0
	    THISFORM.TXTF06A.VALUE=0
	    THISFORM.TXTF07A.VALUE=0
   	    THISFORM.TXTF08A.VALUE=0
	    THISFORM.TXTF05B.VALUE=0
	    THISFORM.TXTF06B.VALUE=0
	    THISFORM.TXTF07B.VALUE=0
	    THISFORM.TXTF08B.VALUE=0
	    THISFORM.TXTF05C.VALUE=0
	    THISFORM.TXTF06C.VALUE=0
	    THISFORM.TXTF07C.VALUE=0
	    THISFORM.TXTF08C.VALUE=0
	    THISFORM.TXTF05D.VALUE=0
	    THISFORM.TXTF06D.VALUE=0
	    THISFORM.TXTF07D.VALUE=0
	    THISFORM.TXTF08D.VALUE=0
	    THISFORM.TXTF05E.VALUE=0
	    THISFORM.TXTF06E.VALUE=0
	    THISFORM.TXTF07E.VALUE=0
	    THISFORM.TXTF08E.VALUE=0
	    THISFORM.LBLF011.CAPTION=''
	    THISFORM.LBLF991.CAPTION='' 
            THISFORM.LBLF_TOL.CAPTION='總  得  分：     分'
            THISFORM.LBLF_LEV.CAPTION='等        級：'   	         
       ELSE
           SELECT C90
           SET ORDER TO C903   && F01+F04+DTOS(F03)
           HK1=''
           DO CASE 
                  CASE  (VAL(RIGHT(HK,2))-1)=0
                             HK1=ALLTRIM(STR(VAL(LEFT(HK,2))-1))+'/12'
                  CASE  (VAL(RIGHT(HK,2))-1)<10    .AND.  (VAL(RIGHT(HK,2))-1)<>0
                             HK1=LEFT(HK,3)+'0'+ALLTRIM(STR(VAL(RIGHT(HK,2))-1))
                  OTHERWISE 
                             HK1=LEFT(HK,3)+ALLTRIM(STR(VAL(RIGHT(HK,2))-1))           
           ENDCASE
           THISFORM.TXTF01.VALUE=LEFT(THIS.DISPLAYVALUE,5)
           THISFORM.LBLF011.CAPTION=RIGHT(ALLTRIM(THIS.DISPLAYVALUE),LEN(ALLTRIM(THIS.DISPLAYVALUE))-10) 
           *****1.當月銷售金額
           SELECT C10
           CALCULATE  SUM(F07*F08) TO TQTY     &&總銷售金額
           SELECT ROUND(SUM(C10.F07*C10.F08),0) FROM C10 WHERE !EMPTY(IIF(ALLTRIM(INT_209)='B',C10.F12,C10.F10)) AND ALLTRIM(IIF(ALLTRIM(INT_209)='B',C10.F12,C10.F10))=ALLTRIM(LEFT(THIS.DISPLAYVALUE,5)) INTO CURSOR C10_TEMP
           THISFORM.TXTF05A.VALUE=IIF(SEEK(LEFT(THIS.DISPLAYVALUE,5)+'A'+DTOS(CTOD(ALLTRIM(HK1+'/01'))),'C90'),C90.F05,0)
           THISFORM.TXTF06A.VALUE=C10_TEMP.EXP_1  &&達成值 = 個人銷售金額 / 總銷售金額
           THISFORM.TXTF07A.VALUE=IIF(THISFORM.TXTF05A.VALUE<=THISFORM.TXTF06A.VALUE,100,ROUND((THISFORM.TXTF06A.VALUE/THISFORM.TXTF05A.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
           THISFORM.TXTF08A.VALUE=IIF(THISFORM.TXTF05A.VALUE<=THISFORM.TXTF06A.VALUE,C90_2.F10A,ROUND((C90_2.F10A/THISFORM.TXTF05A.VALUE)*THISFORM.TXTF06A.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值
           SELECT C10_TEMP
           USE           
	  ******2.應收帳款回收率
           REC_F05=0  &&已收帳款金額
           REC_F06=0  &&應收帳款金額
	   SELECT K5F.F13,SUM(K5F.F04) FROM K5F WHERE K5F.F12=LEFT(THIS.DISPLAYVALUE,5) .AND. K5F.F14='1'  .AND.  LEFT(DTOS(K5F.F10),6)=LEFT(DTOS(CTOD(HK+'/01')),6) ORDER BY K5F.F12 GROUP BY K5F.F12 INTO CURSOR K5FA
	   REC_F05=K5FA.SUM_F04   
	   REC_F06=K5FA.SUM_F04  
	   SELECT K5FA
	   USE
	   SELECT K51.F17,SUM(K51.F10) FROM K51 WHERE K51.F17=LEFT(THIS.DISPLAYVALUE,5)  .AND. K51.F19='1'  .AND.  LEFT(DTOS(K51.F15),6)<=LEFT(DTOS(CTOD(HK+'/01')),6) ORDER BY K51.F17 GROUP BY K51.F17 INTO CURSOR K51A
	   REC_F06=REC_F06+K51A.SUM_F10  
	   SELECT K51A
	   USE	        	   
	   THISFORM.TXTF05B.VALUE=IIF(SEEK(LEFT(THIS.DISPLAYVALUE,5)+'B'+DTOS(CTOD(ALLTRIM(HK1+'/01'))),'C90'),C90.F05,0)
	   THISFORM.TXTF06B.VALUE=IIF(REC_F06 = 0,100,IIF(REC_F06<>0 .AND. REC_F05<>0,ROUND((REC_F05/REC_F06)*100,0),0))
	   THISFORM.TXTF07B.VALUE=IIF(THISFORM.TXTF05B.VALUE<=THISFORM.TXTF06B.VALUE,100,ROUND((THISFORM.TXTF06B.VALUE/THISFORM.TXTF05B.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
	   THISFORM.TXTF08B.VALUE=IIF(THISFORM.TXTF05B.VALUE<=THISFORM.TXTF06B.VALUE,C90_2.F10B,ROUND((C90_2.F10B/THISFORM.TXTF05B.VALUE)*THISFORM.TXTF06B.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值
	  ******3.當月份進貨金額與進貨已出金額比
	   ***當月進貨金額
	   SELECT D11
	   SELECT ROUND(SUM(D11.F07*D11.F08),0) FROM D11 WHERE  !EMPTY(D11.F12) AND ALLTRIM(D11.F12) = ALLTRIM(THISFORM.TXTF01.VALUE) GROUP BY F12 INTO CURSOR D11_TEMP
	   D11A = D11_TEMP.EXP_1
	   SELECT D11_TEMP
	   USE
	   ***當月入貨未出金額
*!*		   SELECT F01 FROM B26 WHERE F02='I000 ' AND (LEFT(ALLTRIM(F07),2)='BC'  OR LEFT(ALLTRIM(F07),2)='BP')  ORDER BY F01 INTO CURSOR B26_TEMP READWRITE 
*!*		   INDE ON F01 TAG B26_TEMP1
 	   SELECT C10.F03 FROM C10 WHERE !EMPTY(C10.F12) AND ALLTRIM(C10.F12) = ALLTRIM(THISFORM.TXTF01.VALUE) GROUP BY F03 ORDER BY F03 INTO CURSOR C10_TEMP READWRITE 
	   INDE ON F03 TAG C10_TEMP1
	   SELECT C10_TEMP 
	   SET ORDER TO C10_TEMP1
	   SELECT D11.F03,SUM(D11.F07*D11.F08) FROM D11 WHERE  !EMPTY(D11.F12) AND ALLTRIM(D11.F12) = ALLTRIM(THISFORM.TXTF01.VALUE) GROUP BY F03 ORDER BY F03 INTO CURSOR D11_TEMP READWRITE 
	   SELECT D11_TEMP
	   GO TOP
	   DO WHILE !EOF()
	          SELECT C10_TEMP
	          SEEK D11_TEMP.F03
	          IF FOUND() 
		       SELECT D11_TEMP
		       DELETE  
		  ENDIF
		  SELECT D11_TEMP
		  SKIP
	   ENDDO
	   SELECT D11_TEMP
	   CALC SUM(SUM_EXP_2) TO D11B
	   SELECT D11_TEMP
	   USE
	   SELECT  C10_TEMP 
	   USE   
*!*	           THISFORM.TXTF05C.VALUE=IIF(SEEK(LEFT(THIS.DISPLAYVALUE,5)+'C'+DTOS(CTOD(ALLTRIM(HK1+'/01'))),'C90'),C90.F05,0)
           THISFORM.TXTF05C.VALUE=D11A
           THISFORM.TXTF06C.VALUE= D11A - D11B
           THISFORM.TXTF07C.VALUE=IIF(THISFORM.TXTF05C.VALUE<=THISFORM.TXTF06C.VALUE,100,ROUND((THISFORM.TXTF06C.VALUE/THISFORM.TXTF05C.VALUE)*100,0))    
           THISFORM.TXTF08C.VALUE=IIF(THISFORM.TXTF05C.VALUE<=THISFORM.TXTF06C.VALUE,C90_2.F10C,ROUND((C90_2.F10C/THISFORM.TXTF05C.VALUE)*THISFORM.TXTF06C.VALUE,0))  	   
           ******4.緊急採購、緊急異動及訂購異動率
	   THISFORM.TXTF05D.VALUE=IIF(SEEK(LEFT(THIS.DISPLAYVALUE,5)+'D'+DTOS(CTOD(ALLTRIM(HK1+'/01'))),'C90'),C90.F05,0)
           THISFORM.TXTF07D.VALUE=IIF(THISFORM.TXTF05D.VALUE<=THISFORM.TXTF06D.VALUE,100,ROUND((THISFORM.TXTF06D.VALUE/THISFORM.TXTF05D.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
           THISFORM.TXTF08D.VALUE=IIF(THISFORM.TXTF05D.VALUE<=THISFORM.TXTF06D.VALUE,C90_2.F10D,ROUND((C90_2.F10D/THISFORM.TXTF05D.VALUE)*THISFORM.TXTF06D.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值      
	   ******5.主管評分
	   THISFORM.TXTF05E.VALUE=IIF(SEEK(LEFT(THIS.DISPLAYVALUE,5)+'E'+DTOS(CTOD(ALLTRIM(HK1+'/01'))),'C90'),C90.F05,0)
           THISFORM.TXTF07E.VALUE=IIF(THISFORM.TXTF05E.VALUE<=THISFORM.TXTF06E.VALUE,100,ROUND((THISFORM.TXTF06E.VALUE/THISFORM.TXTF05E.VALUE)*100,0)) &&達成率 = 達成值 / 目標值
           THISFORM.TXTF08E.VALUE=IIF(THISFORM.TXTF05E.VALUE<=THISFORM.TXTF06E.VALUE,C90_2.F10E,ROUND((C90_2.F10E/THISFORM.TXTF05E.VALUE)*THISFORM.TXTF06E.VALUE,0)) && 得分 = (比重分數 / 目標值) * 達成值	   
           ******
           TOL=THISFORM.TXTF08A.VALUE+THISFORM.TXTF08B.VALUE+THISFORM.TXTF08C.VALUE+THISFORM.TXTF08D.VALUE+THISFORM.TXTF08E.VALUE
           THISFORM.LBLF_TOL.CAPTION='總  得  分：'+ALLTRIM(STR(TOL))+' 分'	 
           SELECT C90_TEMPY
           GO TOP
           DO WHILE !EOF()
                  IF TOL<=C90_TEMPY.F12 .AND.  TOL>=C90_TEMPY.F13
                      THISFORM.LBLF_LEV.CAPTION='等        級：' +ALLTRIM(C90_TEMPY.F11)
                  ENDIF
                  SELECT C90_TEMPY
                  SKIP
           ENDDO
	   SELECT C90_1   	   
	ENDIF   
*!*		  THISFORM.TXTF01.REFRESH 
  ENDPROC 
ENDDEFINE     
************************************************參數設定
DEFINE CLASS ANS_SEEK AS FORM
  AUTOCENTER=.T.
  CAPTION='參數設定'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*395
  WIDTH=INT_015*363
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.  
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_SEEK'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      LEFT=INT_015*3,;
      WIDTH=INT_015*354,;
      HEIGHT=INT_015*391
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      TOP=INT_015*6,;
      LEFT=INT_015*9,;
      WIDTH=INT_015*343,;
      HEIGHT=INT_015*380,;
      FONTSIZE=INT_015*9,;
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='考核內容比重設定',;
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='考核等級範圍設定'   
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      VISIBLE=.F.    
PROCEDURE PAGEFRAME1.PAGE1.INIT           
     THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*18
          .AUTOSIZE=.T.
          .CAPTION='比    重'       
     ENDWITH   
     THIS.ADDOBJECT('LINE04','LINE')
     WITH THIS.LINE04 
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*35
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312       
     ENDWITH      
     THIS.ADDOBJECT('LINEL','LINE')
     WITH THIS.LINEL 
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*35
          .HEIGHT=INT_015*142
          .WIDTH=INT_015*0     
     ENDWITH 
     THIS.ADDOBJECT('LINER','LINE')
     WITH THIS.LINER 
          .VISIBLE=.T.
          .LEFT=INT_015*325
          .TOP=INT_015*35
          .HEIGHT=INT_015*142
          .WIDTH=INT_015*0       
     ENDWITH            
 **************     
     THIS.ADDOBJECT('LBLF04A','LABEL')
     WITH THIS.LBLF04A
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*44
          .AUTOSIZE=.T.
          .CAPTION='1、當月銷售金額                                                                分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10A','TXTF10A')
     WITH THIS.TXTF10A
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*39
     ENDWITH      
     THIS.ADDOBJECT('LINE04A','LINE')
     WITH THIS.LINE04A
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*64
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH              
  ***********
     THIS.ADDOBJECT('LBLF04B','LABEL')
     WITH THIS.LBLF04B
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*72
          .AUTOSIZE=.T.
          .CAPTION='2、應收帳款回收率                                                            分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10B','TXTF10B')
     WITH THIS.TXTF10B
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*67
     ENDWITH      
     THIS.ADDOBJECT('LINE04B','LINE')
     WITH THIS.LINE04B
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*92
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH   
  ***********
     THIS.ADDOBJECT('LBLF04C','LABEL')
     WITH THIS.LBLF04C
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*100 
          .AUTOSIZE=.T.
          .CAPTION='3、當月進貨金額與進貨已出金額比                                  分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10C','TXTF10C')
     WITH THIS.TXTF10C
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*95  
     ENDWITH      
     THIS.ADDOBJECT('LINE04C','LINE')
     WITH THIS.LINE04C
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*120
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH              
  *********** 
     THIS.ADDOBJECT('LBLF04D','LABEL')
     WITH THIS.LBLF04D
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*128
          .AUTOSIZE=.T.
          .CAPTION='4、緊急採購、緊急異動及訂購異動率                              分'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF10D','TXTF10D')
     WITH THIS.TXTF10D
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*123   
     ENDWITH      
     THIS.ADDOBJECT('LINE04D','LINE')
     WITH THIS.LINE04D
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*148
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH              
  ***********      
     THIS.ADDOBJECT('LBLF04E','LABEL')
     WITH THIS.LBLF04E
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*156
          .AUTOSIZE=.T.
          .CAPTION='5、主管評分                                                                       分'  
     ENDWITH 
     THIS.ADDOBJECT('TXTF10E','TXTF10E')
     WITH THIS.TXTF10E
          .VISIBLE=.T.
          .LEFT=INT_015*260
          .TOP=INT_015*151
     ENDWITH      
     THIS.ADDOBJECT('LINE04E','LINE')
     WITH THIS.LINE04E
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*176
          .HEIGHT=INT_015*0
          .WIDTH=INT_015*312    
     ENDWITH                
********
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*300
          .WIDTH=INT_015*50
          .CAPTION='安全資料'       
     ENDWITH 
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*75
          .TOP=INT_015*300
          .AUTOSIZE=.T.
          .CAPTION=''       
     ENDWITH   
     THIS.ADDOBJECT('LBLF_TOA','LABEL')
     WITH THIS.LBLF_TOA
          .VISIBLE=.T.
          .LEFT=INT_015*217
          .TOP=INT_015*300
          .WIDTH=INT_015*50
          .CAPTION='總 比 重'       
     ENDWITH 
     THIS.ADDOBJECT('LBLF_TOA1','LABEL')
     WITH THIS.LBLF_TOA1
          .VISIBLE=.T.
          .LEFT=INT_015*270
          .TOP=INT_015*300
          .AUTOSIZE=.T.
          .CAPTION=''       
     ENDWITH        
 ENDPROC    
 *********
PROCEDURE PAGEFRAME1.PAGE2.INIT  
     THIS.ADDOBJECT('LBLF11A','LABEL')
     WITH THIS.LBLF11A
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*44
          .AUTOSIZE=.T.
          .CAPTION='1、等級A    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF12A','TEXTBOX')
     WITH THIS.TXTF12A
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*39
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF12A'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF13A','TEXTBOX')
     WITH THIS.TXTF13A
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*39
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF13A'     
     ENDWITH       
    ***
     THIS.ADDOBJECT('LBLF11B','LABEL')
     WITH THIS.LBLF11B
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*72
          .AUTOSIZE=.T.
          .CAPTION='2、等級B    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF12B','TEXTBOX')
     WITH THIS.TXTF12B
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*67
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF12B'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF13B','TEXTBOX')
     WITH THIS.TXTF13B
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*67
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF13B'     
     ENDWITH      
   ****
     THIS.ADDOBJECT('LBLF11C','LABEL')
     WITH THIS.LBLF11C
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*100
          .AUTOSIZE=.T.
          .CAPTION='3、等級C    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF12C','TEXTBOX')
     WITH THIS.TXTF12C
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*95
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF12C'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF13C','TEXTBOX')
     WITH THIS.TXTF13C
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*95
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF13C'     
     ENDWITH      
   ****
     THIS.ADDOBJECT('LBLF11D','LABEL')
     WITH THIS.LBLF11D
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*128
          .AUTOSIZE=.T.
          .CAPTION='4、等級D    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF12D','TEXTBOX')
     WITH THIS.TXTF12D
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*123
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF12D'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF13D','TEXTBOX')
     WITH THIS.TXTF13D
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*123
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF13D'     
     ENDWITH      
   ****
    THIS.ADDOBJECT('LBLF11E','LABEL')
     WITH THIS.LBLF11E
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*156
          .AUTOSIZE=.T.
          .CAPTION='5、等級E    分數範圍                 ∼'       
     ENDWITH 
     THIS.ADDOBJECT('TXTF12E','TEXTBOX')
     WITH THIS.TXTF12E
          .VISIBLE=.T.
          .LEFT=INT_015*140
          .TOP=INT_015*151
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF12E'     
     ENDWITH   
     THIS.ADDOBJECT('TXTF13E','TEXTBOX')
     WITH THIS.TXTF13E
          .VISIBLE=.T.
          .LEFT=INT_015*200
          .TOP=INT_015*151
          .HEIGHT=INT_015*22
          .WIDTH=INT_015*35
          .MAXLENGTH=3
          .INPUTMASK='999'
          .NAME='TXTF13E'     
     ENDWITH      
   ****   
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
          .VISIBLE=.T.
          .LEFT=INT_015*20
          .TOP=INT_015*300
          .WIDTH=INT_015*50
          .CAPTION='安全資料'       
     ENDWITH 
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
          .VISIBLE=.T.
          .LEFT=INT_015*75
          .TOP=INT_015*300
          .AUTOSIZE=.T.
          .CAPTION=''       
     ENDWITH   
ENDPROC    
****    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*25,;
      TOP=INT_015*355,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<E.修改',;
      TOOLTIPTEXT='修改此作業內容!快速鍵->ALT+E'
      NAME='CMND1'      
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*68,;
      TOP=INT_015*355,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<X.離開',;
      TOOLTIPTEXT='取消此作業畫面!快速鍵->ALT+X'
      NAME='CMND2'
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*252,;
      TOP=INT_015*355,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<Y.確認',;
      TOOLTIPTEXT='確認此作業內容!快速鍵->ALT+E'
      NAME='CMND3'        
  ADD OBJECT CMND4 AS COMMANDBUTTON WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*355,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<C.結束',;
      TOOLTIPTEXT='結束此作業內容!快速鍵->ALT+E'
      NAME='CMND4'            
   ********   
      PROCEDURE INIT 
          SELECT C90_2
          GO TOP
         THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*9
         THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*9
         THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX') 
         THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')    
         THISFORM.SETALL('HEIGHT',INT_015*22,'TEXTBOX')   
         THISFORM.SETALL('READONLY',.T.,'TEXTBOX')     
         THISFORM.CMND1.ENABLED=.T.               
         THISFORM.CMND2.ENABLED=.T.           
         THISFORM.CMND3.VISIBLE=.F.  
         THISFORM.CMND4.VISIBLE=.F.       
         THISFORM.PAGEFRAME1.PAGE1.TXTF10A.SETFOCUS       
         THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE=C90_2.F10A
         THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE=C90_2.F10B
         THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE=C90_2.F10C
         THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE=C90_2.F10D
         THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE=C90_2.F10E
         THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=C90_2.F99   
         THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(C90_2.F98))+'    分'              
      ENDPROC
   *******   
    PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
         SELECT C90_2
         THISFORM.PAGEFRAME1.PAGE1.TXTF10A.SETFOCUS 
         THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE=C90_2.F10A
         THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE=C90_2.F10B
         THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE=C90_2.F10C
         THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE=C90_2.F10D
         THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE=C90_2.F10E
         THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=C90_2.F99   
         THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(C90_2.F98))+'    分'                       
      ENDPROC      
   *******   
      PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
         SELECT C90_3 
         THISFORM.PAGEFRAME1.PAGE2.TXTF12A.SETFOCUS              
         THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE=C90_3.F12A 
         THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE=C90_3.F13A 
         THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE=C90_3.F12B 
         THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE=C90_3.F13B 
         THISFORM.PAGEFRAME1.PAGE2.TXTF12C.VALUE=C90_3.F12C 
         THISFORM.PAGEFRAME1.PAGE2.TXTF13C.VALUE=C90_3.F13C 
         THISFORM.PAGEFRAME1.PAGE2.TXTF12D.VALUE=C90_3.F12D 
         THISFORM.PAGEFRAME1.PAGE2.TXTF13D.VALUE=C90_3.F13D 
         THISFORM.PAGEFRAME1.PAGE2.TXTF12E.VALUE=C90_3.F12E 
         THISFORM.PAGEFRAME1.PAGE2.TXTF13E.VALUE=C90_3.F13E    
         THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=C90_3.F99
      ENDPROC   
  *******       
      PROC CMND1.CLICK
           THISFORM.CMND1.VISIBLE=.F. 
           THISFORM.CMND2.VISIBLE=.F.  
	   THISFORM.CMND3.VISIBLE=.T.     
	   THISFORM.CMND4.VISIBLE=.T.          
           THISFORM.SETALL('READONLY',.F.,'TEXTBOX')  
            IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
                THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10A.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10B.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10C.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10D.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10E.READONLY=.F.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10A.SETFOCUS 
                THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''  
            ELSE
                THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
                THISFORM.PAGEFRAME1.PAGE2.TXTF12A.SETFOCUS 
                THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''  
            ENDIF    
      ENDPROC
********** 
      PROCEDURE CMND2.CLICK  
          SELECT C90_TEMPY
          USE
          SELECT F11,F12,F13 FROM C90 WHERE F04='Y'  ORDER BY F11 INTO CURSOR C90_TEMPY
          SELECT C90_1 
         THISFORM.RELEASE         
      ENDPROC       
  ********    
    PROC CMND3.CLICK
       IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
           IF (THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE+;
                THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE)<100
                =MESSAGEBOX('總比重分數不得小於100分',0+64,'提示訊息視窗')
                THISFORM.PAGEFRAME1.PAGE1.TXTF10A.SETFOCUS
                RETURN              
           ENDIF       
           IF (THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE+;
                THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE)>100
                =MESSAGEBOX('總比重分數不得大於100分',0+64,'提示訊息視窗')
                THISFORM.PAGEFRAME1.PAGE1.TXTF10A.SETFOCUS
                RETURN              
           ENDIF               
           SELECT  C90_2
           GO TOP
           LOCK()
           IF RLOCK()
               REPLACE  C90_2.F10A WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE
               REPLACE  C90_2.F10B WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE
               REPLACE  C90_2.F10C WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE
               REPLACE  C90_2.F10D WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE
               REPLACE  C90_2.F10E WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE
               REPLACE  C90_2.F98   WITH  THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE+;
						                   THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE
               REPLACE  C90_2.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
               SELECT C90
               SET ORDER TO C901
               SEEK SPACE(5)+'Z'+'A'
               IF FOUND()
	           REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE
	           REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C90
	          APPEND BLANK 
	          REPLACE  C90.F04 WITH 'Z'
	          REPLACE  C90.F09 WITH 'A'
	          REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE
	          REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF   
               SEEK SPACE(5)+'Z'+'B'
               IF FOUND()
	           REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE
	           REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C90
	          APPEND BLANK 
	          REPLACE  C90.F04 WITH 'Z'
	          REPLACE  C90.F09 WITH 'B'
	          REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE
	          REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	
               SEEK SPACE(5)+'Z'+'C'
               IF FOUND()
	           REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE
	           REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C90
	          APPEND BLANK 
	          REPLACE  C90.F04 WITH 'Z'
	          REPLACE  C90.F09 WITH 'C'
	          REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE
	          REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	   
               SEEK SPACE(5)+'Z'+'D'
               IF FOUND()
	           REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE
	           REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C90
	          APPEND BLANK 
	          REPLACE  C90.F04 WITH 'Z'
	          REPLACE  C90.F09 WITH 'D'
	          REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE
	          REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  
               SEEK SPACE(5)+'Z'+'E'
               IF FOUND()
	           REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE
	           REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
	       ELSE
	          SELECT C90
	          APPEND BLANK 
	          REPLACE  C90.F04 WITH 'Z'
	          REPLACE  C90.F09 WITH 'E'
	          REPLACE  C90.F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE
	          REPLACE  C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')    
	       ENDIF  	       	                            	        
           ENDIF   
        ELSE  &&
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE
                  =MESSAGEBOX('等級A之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.SETFOCUS
                  RETURN              
           ENDIF           
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE
                  =MESSAGEBOX('等級B之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.SETFOCUS
                  RETURN              
           ENDIF   
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF12C.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF13C.VALUE
                  =MESSAGEBOX('等級C之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF12C.SETFOCUS
                  RETURN              
           ENDIF   
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF12D.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF13D.VALUE
                  =MESSAGEBOX('等級D之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF12D.SETFOCUS
                  RETURN              
           ENDIF   
            IF  THISFORM.PAGEFRAME1.PAGE2.TXTF12E.VALUE<=THISFORM.PAGEFRAME1.PAGE2.TXTF13E.VALUE
                  =MESSAGEBOX('等級E之分數範圍不正確,請重新輸入!',0+64,'提示訊息視窗')
                  THISFORM.PAGEFRAME1.PAGE2.TXTF12E.SETFOCUS
                  RETURN              
           ENDIF                       
           IF (THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE)+;
               (THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE)+;
               (THISFORM.PAGEFRAME1.PAGE2.TXTF12C.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF13C.VALUE)+;
               (THISFORM.PAGEFRAME1.PAGE2.TXTF12D.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF13D.VALUE)+;
               (THISFORM.PAGEFRAME1.PAGE2.TXTF12E.VALUE-THISFORM.PAGEFRAME1.PAGE2.TXTF13E.VALUE)+4<>100
               =MESSAGEBOX('分數範圍之總合不等於100,請重新輸入!',0+64,'提示訊息視窗')
               THISFORM.PAGEFRAME1.PAGE2.TXTF12A.SETFOCUS
               RETURN   
           ENDIF
           SELECT  C90_3
           GO TOP
           LOCK()
           IF RLOCK()
               REPLACE  C90_3.F12A WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE
               REPLACE  C90_3.F13A WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE
               REPLACE  C90_3.F12B WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE
               REPLACE  C90_3.F13B WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE
               REPLACE  C90_3.F12C WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12C.VALUE
               REPLACE  C90_3.F13C WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13C.VALUE
               REPLACE  C90_3.F12D WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12D.VALUE
               REPLACE  C90_3.F13D WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13D.VALUE
               REPLACE  C90_3.F12E WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12E.VALUE
               REPLACE  C90_3.F13E WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13E.VALUE
               REPLACE  C90_3.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
               SELECT C90
               SET ORDER TO C902
               SEEK 'Y'+'A'
               IF FOUND()
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C90
                   APPEND BLANK
                   REPLACE C90.F04 WITH 'Y'
                   REPLACE C90.F11 WITH 'A'
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF
               SEEK 'Y'+'B'
               IF FOUND()
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C90
                   APPEND BLANK
                   REPLACE C90.F04 WITH 'Y'
                   REPLACE C90.F11 WITH 'B'
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF
               SEEK 'Y'+'C'
               IF FOUND()
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12C.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13C.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C90
                   APPEND BLANK
                   REPLACE C90.F04 WITH 'Y'
                   REPLACE C90.F11 WITH 'C'
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12C.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13C.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF
               SEEK 'Y'+'D'
               IF FOUND()
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12D.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13D.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C90
                   APPEND BLANK
                   REPLACE C90.F04 WITH 'Y'
                   REPLACE C90.F11 WITH 'D'
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12D.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13D.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF
               SEEK 'Y'+'E'
               IF FOUND()
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12E.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13E.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
               ELSE
                   SELECT C90
                   APPEND BLANK
                   REPLACE C90.F04 WITH 'Y'
                   REPLACE C90.F11 WITH 'E'
                   REPLACE C90.F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12E.VALUE
                   REPLACE C90.F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13E.VALUE
                   REPLACE C90.F99 WITH DTOC(DATE())+' '+IIF(SEEK(sys_oper,'A01'),A01.F03,'')                     
               ENDIF   
            ENDIF                                                     
        ENDIF   
           UNLOCK
           THISFORM.CMND4.CLICK    
      ENDPROC             
********
    PROC CMND4.CLICK
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
           THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
           THISFORM.CMND1.VISIBLE=.T. 
           THISFORM.CMND2.VISIBLE=.T.  
	   THISFORM.CMND3.VISIBLE=.F.     
	   THISFORM.CMND4.VISIBLE=.F.          
           THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
           IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
                SELECT C90_2
                THISFORM.PAGEFRAME1.PAGE1.TXTF10A.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10B.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10C.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10D.READONLY=.T.
                THISFORM.PAGEFRAME1.PAGE1.TXTF10E.READONLY=.T.    
                THISFORM.PAGEFRAME1.PAGE1.TXTF10A.SETFOCUS     
	        THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE=C90_2.F10A
                THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE=C90_2.F10B
                THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE=C90_2.F10C
                THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE=C90_2.F10D
                THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE=C90_2.F10E
                THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=C90_2.F99   
                THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(C90_2.F98))+'    分'                               
	   ELSE  
	         SELECT C90_3 
	         THISFORM.PAGEFRAME1.PAGE2.TXTF12A.SETFOCUS           
                 THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE=C90_3.F12A 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE=C90_3.F13A 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE=C90_3.F12B 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE=C90_3.F13B 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF12C.VALUE=C90_3.F12C 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF13C.VALUE=C90_3.F13C 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF12D.VALUE=C90_3.F12D 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF13D.VALUE=C90_3.F13D 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF12E.VALUE=C90_3.F12E 
                 THISFORM.PAGEFRAME1.PAGE2.TXTF13E.VALUE=C90_3.F13E    
                 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=C90_3.F99        
	   ENDIF 
           UNLOCK ALL      
      ENDPROC     
ENDDEFINE    
*************************************************比重1
DEFINE CLASS TXTF10A AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF10A'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF
  ENDPROC       
ENDDEFINE    
*************************************************比重2
DEFINE CLASS TXTF10B AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF10B'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重3
DEFINE CLASS TXTF10C AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF10C'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重4
DEFINE CLASS TXTF10D AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF10D'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10E.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    
*************************************************比重5
DEFINE CLASS TXTF10E AS TEXTBOX 
       VISIBLE=.F.
       READONLY=.T.
       HEIGHT=INT_015*22
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9
       MAXLENGTH=3   
       INPUTMASK='999'
       NAME='TXTF10E'  
   PROCEDURE INTERACTIVECHANGE
           THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION=ALLTRIM(STR(THIS.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10B.VALUE+;     
                               THISFORM.PAGEFRAME1.PAGE1.TXTF10C.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10D.VALUE+THISFORM.PAGEFRAME1.PAGE1.TXTF10A.VALUE))+'    分'
           IF   VAL(ALLTRIM(LEFT(THISFORM.PAGEFRAME1.PAGE1.LBLF_TOA1.CAPTION,3)))>100
                  =MESSAGEBOX('總比重已超過100,請重新調整比重!',0+64,'提示訊息視窗') 
                  THIS.VALUE=0
                  THIS.SETFOCUS 
                  RETURN
           ENDIF                               
  ENDPROC       
ENDDEFINE    