***程式名稱:S05.人事薪資基本檔
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
R=0
AREA1='S05_1'
AREA2='S06'
IF !USED('A01')  &&操作人員資料設定
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')  &&權限設定檔
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'S05'       
IF FOUND()  AND A02.F09='*'   &&判斷是否有權限可處理所有員工
    ALL_CHK=.T.
ELSE
    ALL_CHK=.F.
ENDIF
IF !USED('A14')  &&部門設定檔
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141     
IF !USED('S00')  &&薪資參數設定
   SELE 0
   USE S00
ELSE
   SELE S00
ENDIF
SET ORDER TO S001 
IF !USED('S01')  &&薪資資料設定
   SELE 0
   USE S01 
ELSE
   SELE S01
ENDIF
SET ORDER TO S011
IF !USED('S03')  &&健保費表
   SELE 0
   USE S03 
ELSE
   SELE S03
ENDIF
SET ORDER TO S031
IF !USED('S04')  &&勞保費表
   SELE 0
   USE S04 
ELSE
   SELE S04
ENDIF
SET ORDER TO S042
IF !USED('S06')   &&薪資項目及扣款項目
   SELE 0
   USE S06 
ELSE
   SELE S06
ENDIF
SET ORDER TO S061
IF !USED('S0A')  &&年度缺勤紀錄檔
   SELE 0
   USE S0A
ELSE
   SELE S0A
ENDIF
SET ORDER TO S0A1 
SELECT S0A.F01,SUM(F07) FROM S0A WHERE F05='A1' AND LEFT(DTOS(F08),4)=LEFT(DTOS(DATE()),4)  GROUP BY S0A.F01 INTO CURSOR S0A_TEMP
INDE ON F01 TAG S0A_TEMP1
SET ORDER TO S0A_TEMP1
IF !USED('S05')  &&人事薪資基本檔
   SELE 0
   USE S05 
ELSE
   SELE S05
ENDIF
****建立在職人員編號索引資料
SELECT F01 FROM S05  WHERE F28='A' OR F28='B' OR F28='C' OR F28='2' OR F28='4' OR  F28='9' INTO CURSOR S05A_SEEK READWRITE
INDE ON F01 TAG S05A_SEEK1
SET ORDER TO S05A_SEEK1
****建立離職人員編號索引資料
SELECT F01 FROM S05  WHERE F28='1'  OR F28='3'  OR F28='7' OR F28='8'  INTO CURSOR S05B_SEEK READWRITE
INDE ON F01 TAG S05B_SEEK1
SET ORDER TO S05B_SEEK1
****
CREATE CURSOR S05_1;
(F01 C(4),F02 C(8),F03 C(1),F04 C(15),F05 C(4),F06 C(8),F07 C(30),F08 C(30),F09 D(8),F10 D(8),F11 N(2),F12 N(4,1),F13 C(15),F14 C(60),F15 C(1),;
F16 N(2),F17 N(2),F18 N(6),F19 C(10),F20 D(8),F21 D(8),F22 N(2),F23 N(6),F24 C(10),F25 C(30),F26 C(15),F27 L(1),F28 C(1),F29 C(2),F30 C(1),F34 C(12),F31 C(1),F32 N(6,2),F33 C(50),F99 C(17))
INDE ON F01 TAG S05_11
INDE ON F02 TAG S05_12
SELECT * FROM S05 WHERE IIF(ALL_CHK=.T.,.T.,S05.F27=.T.) AND (S05.F28='A' OR S05.F28='B' OR S05.F28='C' OR S05.F28='2' OR S05.F28='4' OR  S05.F28='5' OR S05.F28='6' OR F28='9');
		  ORDER BY S05.F01 INTO CURSOR S05_TEMP   		
SELECT S05_TEMP
GO TOP
DO WHILE !EOF()
	SELECT S05_1
	APPEND BLANK 
	REPLACE  S05_1.F01 WITH S05_TEMP.F01
	REPLACE  S05_1.F02 WITH S05_TEMP.F02
	REPLACE  S05_1.F03 WITH S05_TEMP.F03
	REPLACE  S05_1.F04 WITH S05_TEMP.F04
	REPLACE  S05_1.F05 WITH S05_TEMP.F05
	REPLACE  S05_1.F06 WITH S05_TEMP.F06
	REPLACE  S05_1.F07 WITH S05_TEMP.F07
	REPLACE  S05_1.F08 WITH S05_TEMP.F08
	REPLACE  S05_1.F09 WITH S05_TEMP.F09
	REPLACE  S05_1.F10 WITH S05_TEMP.F10
	REPLACE  S05_1.F11 WITH S05_TEMP.F11
	*REPLACE  S05_1.F12 WITH S05_TEMP.F12
	REPLACE  S05_1.F12 WITH IIF(SEEK(S05_TEMP.F01,'S0A_TEMP'),S0A_TEMP.SUM_F07,0)
	REPLACE  S05_1.F13 WITH S05_TEMP.F13
	REPLACE  S05_1.F14 WITH S05_TEMP.F14
	REPLACE  S05_1.F15 WITH S05_TEMP.F15
	REPLACE  S05_1.F16 WITH S05_TEMP.F16
	REPLACE  S05_1.F17 WITH S05_TEMP.F17
	REPLACE  S05_1.F18 WITH S05_TEMP.F18
	REPLACE  S05_1.F19 WITH S05_TEMP.F19
	REPLACE  S05_1.F20 WITH S05_TEMP.F20
	REPLACE  S05_1.F21 WITH S05_TEMP.F21
	REPLACE  S05_1.F22 WITH S05_TEMP.F22
	REPLACE  S05_1.F23 WITH S05_TEMP.F23
	REPLACE  S05_1.F24 WITH S05_TEMP.F24
	REPLACE  S05_1.F25 WITH S05_TEMP.F25
	REPLACE  S05_1.F26 WITH S05_TEMP.F26
	REPLACE  S05_1.F27 WITH S05_TEMP.F27
	REPLACE  S05_1.F28 WITH S05_TEMP.F28
	REPLACE  S05_1.F29 WITH S05_TEMP.F29
	REPLACE  S05_1.F30 WITH S05_TEMP.F30
	REPLACE  S05_1.F34 WITH S05_TEMP.F34
	REPLACE  S05_1.F31 WITH S05_TEMP.F31
	REPLACE  S05_1.F32 WITH S05_TEMP.F32
	REPLACE  S05_1.F33 WITH S05_TEMP.F33
	REPLACE  S05_1.F99 WITH S05_TEMP.F99
	SELECT S05_TEMP
	SKIP
ENDDO
SELECT S05_TEMP
USE
SELECT S05_1
GO TOP
SET ORDER TO S05_11
********
S05FORM=CREATEOBJECT("TKS05")
S05FORM.SHOW  
DEFINE CLASS TKS05 AS FORM
  CAPTION='S05.人事薪資基本檔'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKS05'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.     
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*515,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      PAGECOUNT=3,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='基本薪資資料設定',;      
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='薪資所得明細設定',;   
      PAGE3.NAME='PAGE3',;
      PAGE3.VISIBLE=.T.,;
      PAGE3.CAPTION='薪資扣款明細設定'         
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*215
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=3,;            
      RECORDSOURCE='S05_1',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;   
      COLUMN3.NAME='COLUMN3' 
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=4,;            
      RECORDSOURCE='S06',; 
      LINKMASTER='S05_1',;
      RELATIONALEXPR='F01',;
      CHILDORDER='S061',;  
      VISIBLE=.F.,;       
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
	AUTOSIZE=.T. 
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
	AUTOSIZE=.T.             
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*475,;
      LEFT=INT_015*558          
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*65,;      
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<A.重算年假',;
      NAME='ANS_BOTT'      
 ADD OBJECT CHANG_BOTT AS COMMANDBUTTON WITH;
     TOP=INT_015*490,;
      LEFT=INT_015*82,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*65,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<C.人員異動',;
      NAME='CHANG_BOTT'       
  ADD OBJECT TAIPEI_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*338,;
      LEFT=INT_015*665,;
      HEIGHT=INT_015*25,;
      FONTSIZE=INT_015*9,;
      WIDTH=INT_015*90,;      
      CAPTION='\<T.眷口補助清單',;
      NAME='TAIPEI_BOTT'          
  ADD OBJECT COMBOBOX06 AS COMBOBOX061 WITH;  &&薪資項目之薪資類別 
      TOP=INT_015*35,;  
      LEFT=INT_015*301    
**************  基本薪資資料設定          
 PROCEDURE PAGEFRAME1.PAGE1.INIT     
   THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*15
          .WIDTH=INT_015*50
          .CAPTION='員工編號'          
     ENDWITH
  THIS.ADDOBJECT('TXTF01','TEXTBOX')          
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*9
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
     ENDWITH         
   THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*15
          .WIDTH=INT_015*50
          .CAPTION='部門編號' 
     ENDWITH
  THIS.ADDOBJECT('TXTF05','TEXTBOX')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*9
          .WIDTH=INT_015*60
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
     ENDWITH
  THIS.ADDOBJECT('COMBOBOX05','COMBOBOX05') 
     WITH THIS.COMBOBOX05 
          .VISIBLE=.F.
          .LEFT=INT_015*350
          .TOP=INT_015*9
     ENDWITH           
   THIS.ADDOBJECT('LBLF06','LABEL')&&部門名稱
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*415
          .TOP=INT_015*15
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH           
  THIS.ADDOBJECT('LBLF02','LABEL')     
     WITH THIS.LBLF02
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*40
          .WIDTH=INT_015*50  
          .CAPTION='姓        名'
     ENDWITH                
     THIS.ADDOBJECT('TXTF02','TEXTBOX')          
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*34
          .WIDTH=INT_015*75
          .HEIGHT=INT_015*25
          .MAXLENGTH=8
     ENDWITH                
     THIS.ADDOBJECT('LBLF03','LABEL')
     WITH THIS.LBLF03
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*40
         .WIDTH=INT_015*50
         .CAPTION='性        別'
     ENDWITH     
  THIS.ADDOBJECT('OPTIONGROUP03','OPTIONGROUP')
     WITH THIS.OPTIONGROUP03
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*34
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*105
	  .BUTTONCOUNT=2
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP03'
	  .OPTION1.CAPTION='男'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='女'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*60
	  .OPTION2.NAME='OPTION2'         
     ENDWITH           
   THIS.ADDOBJECT('LBLF04','LABEL')
     WITH THIS.LBLF04
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*65
         .WIDTH=INT_015*50
         .CAPTION='身份證號'
     ENDWITH    
   THIS.ADDOBJECT('TXTF04','TEXTBOX')
     WITH THIS.TXTF04
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*59
          .WIDTH=INT_015*100
          .HEIGHT=INT_015*25
          .MAXLENGTH=15
     ENDWITH    
   THIS.ADDOBJECT('LBLF29','LABEL')
     WITH THIS.LBLF29
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*65
          .WIDTH=INT_015*50
          .CAPTION='班        別'          
     ENDWITH    
   THIS.ADDOBJECT('LBLF291','LABEL')
     WITH THIS.LBLF291
          .VISIBLE=.T.
          .LEFT=INT_015*395
          .TOP=INT_015*65
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH        
   THIS.ADDOBJECT('TXTF29','TEXTBOX')
     WITH THIS.TXTF29
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*59
          .WIDTH=INT_015*30
          .HEIGHT=INT_015*25
          .MAXLENGTH=2
     ENDWITH     
  THIS.ADDOBJECT('COMBOBOX29','COMBOBOX29') 
     WITH THIS.COMBOBOX29 
          .VISIBLE=.F.
          .LEFT=INT_015*350
          .TOP=INT_015*59
     ENDWITH                      
   THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*90
         .WIDTH=INT_015*50
         .CAPTION='職        稱'
     ENDWITH    
   THIS.ADDOBJECT('TXTF07','TEXTBOX')
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*84
          .WIDTH=INT_015*135
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX07','COMBOBOX071') 
     WITH THIS.COMBOBOX07 
          .LEFT=INT_015*64
          .TOP=INT_015*84
     ENDWITH         
   THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*90
         .WIDTH=INT_015*50
         .CAPTION='職        等'
     ENDWITH    
   THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*84
          .WIDTH=INT_015*135
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH      
  THIS.ADDOBJECT('COMBOBOX08','COMBOBOX08') 
     WITH THIS.COMBOBOX08 
          .LEFT=INT_015*350
          .TOP=INT_015*84
     ENDWITH         
   THIS.ADDOBJECT('LBLF09','LABEL')
     WITH THIS.LBLF09
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*115
         .WIDTH=INT_015*50
         .CAPTION='到職日期'
     ENDWITH    
   THIS.ADDOBJECT('TXTF09','TXTF09')
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*109
     ENDWITH    
   THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*115
         .WIDTH=INT_015*50
         .CAPTION='異動日期'
     ENDWITH    
   THIS.ADDOBJECT('TXTF10','TEXTBOX')          
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*109
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8
     ENDWITH                 
   THIS.ADDOBJECT('LBLF28','LABEL')
     WITH THIS.LBLF28
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*140
         .WIDTH=INT_015*50
         .CAPTION='任職狀況'
     ENDWITH    
   THIS.ADDOBJECT('TXTF28','TEXTBOX')
     WITH THIS.TXTF28
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*134
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25     
     ENDWITH         
  THIS.ADDOBJECT('COMBOBOX28','COMBOBOX28') 
     WITH THIS.COMBOBOX28 
          .VISIBLE=.F.
          .LEFT=INT_015*64
          .TOP=INT_015*134
      ENDWITH             
   THIS.ADDOBJECT('LBLF30','LABEL')
     WITH THIS.LBLF30
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*140
         .WIDTH=INT_015*50
         .CAPTION='是否刷卡'
     ENDWITH    
 
  THIS.ADDOBJECT('OPTIONGROUP30','OPTIONGROUP')
     WITH THIS.OPTIONGROUP30
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*134
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*105
	  .BUTTONCOUNT=2
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP30'
	  .OPTION1.CAPTION='是'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='否'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*60
	  .OPTION2.NAME='OPTION2'         
     ENDWITH           
   THIS.ADDOBJECT('LBLF13','LABEL')
     WITH THIS.LBLF13
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*165
         .WIDTH=INT_015*50
         .CAPTION='聯絡電話'
     ENDWITH    
   THIS.ADDOBJECT('TXTF13','TEXTBOX')
     WITH THIS.TXTF13
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*159
          .WIDTH=INT_015*105
          .HEIGHT=INT_015*25
     ENDWITH       
       THIS.ADDOBJECT('LBLF34','LABEL')
     WITH THIS.LBLF34
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*165
         .WIDTH=INT_015*50
         .CAPTION='門禁卡號'
     ENDWITH         
 THIS.ADDOBJECT('TXTF34','TEXTBOX')
     WITH THIS.TXTF34
          .VISIBLE=.T.
          .LEFT=INT_015*351
          .TOP=INT_015*159
          .WIDTH=INT_015*105
          .HEIGHT=INT_015*25
          .MAXLENGTH=12
     ENDWITH            
     
   THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*190
         .WIDTH=INT_015*50
         .CAPTION='聯絡地址'
     ENDWITH    
   THIS.ADDOBJECT('TXTF14','TEXTBOX')
     WITH THIS.TXTF14
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*184
          .WIDTH=INT_015*380
          .HEIGHT=INT_015*25
          .MAXLENGTH=60          
     ENDWITH 
 ***********
   THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*215
          .WIDTH=INT_015*50
          .CAPTION='發薪總類'          
     ENDWITH
  THIS.ADDOBJECT('OPTIONGROUP15','OPTIONGROUP')
     WITH THIS.OPTIONGROUP15
         .VISIBLE=.T.
         .LEFT=INT_015*64
         .TOP=INT_015*209
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*170
	  .BUTTONCOUNT=3
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP15'
	  .OPTION1.CAPTION='月薪'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='日薪'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9	  
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*60
	  .OPTION2.NAME='OPTION2'        
	  .OPTION3.CAPTION='時薪'
	  .OPTION3.TOP=INT_015*5
	  .OPTION3.FONTSIZE=INT_015*9	  
	  .OPTION3.AUTOSIZE=.T.
	  .OPTION3.LEFT=INT_015*115
	  .OPTION3.NAME='OPTION3' 	   
     ENDWITH            
   THIS.ADDOBJECT('LBLF11','LABEL')
     WITH THIS.LBLF11
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*217
         .WIDTH=INT_015*50
         .CAPTION='可休年假'
     ENDWITH    
   THIS.ADDOBJECT('TXTF11','TXTF11')
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*209
     ENDWITH      
     THIS.ADDOBJECT('LBLF17','LABEL')
     WITH THIS.LBLF17
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*240
         .WIDTH=INT_015*50
         .CAPTION='撫養人數' 
     ENDWITH     
 THIS.ADDOBJECT('SPINNER17','SPINNER')      
    WITH THIS.SPINNER17
          .VISIBLE=.T.
	  .TOP=INT_015*234 
	  .LEFT=INT_015*64
          .HEIGHT=INT_015*25     
	  .WIDTH=INT_015*45    
	  .KEYBOARDLOWVALUE=0
	  .KEYBOARDHIGHVALUE=99
	  .SPINNERLOWVALUE=0
	  .SPINNERHIGHVALUE=99
	  .INPUTMASK='99'     
     ENDWITH                        
   THIS.ADDOBJECT('LBLF12','LABEL')
     WITH THIS.LBLF12
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*242
         .WIDTH=INT_015*50
         .CAPTION='已休年假'
     ENDWITH    
   THIS.ADDOBJECT('TXTF12','TXTF12')          
     WITH THIS.TXTF12
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*234
          .READONLY=.T.
     ENDWITH  
   THIS.ADDOBJECT('LBLF121','LABEL')
     WITH THIS.LBLF121
         .VISIBLE=.T.
         .LEFT=INT_015*405
         .TOP=INT_015*239
         .WIDTH=INT_015*50
         .BACKCOLOR=RGB(0,255,255)         
         .CAPTION='剩餘年假'
     ENDWITH
   THIS.ADDOBJECT('LBLF122','LABEL')
     WITH THIS.LBLF122
         .VISIBLE=.T.
         .LEFT=INT_015*455
         .TOP=INT_015*239
         .WIDTH=INT_015*50
         .BACKCOLOR=RGB(0,255,255)
         .CAPTION=''
     ENDWITH         
   THIS.ADDOBJECT('LBLF18','LABEL')
     WITH THIS.LBLF18
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*265
         .WIDTH=INT_015*50
         .CAPTION='勞保金額'
     ENDWITH    
   THIS.ADDOBJECT('TXTF18','TEXTBOX')
     WITH THIS.TXTF18
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*259
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=7
	  .INPUTMASK='9999999'           
     ENDWITH
  THIS.ADDOBJECT('COMBOBOX18','COMBOBOX18') 
     WITH THIS.COMBOBOX18 
          .LEFT=INT_015*64
          .TOP=INT_015*259
     ENDWITH       
   THIS.ADDOBJECT('LBLF19','LABEL')
     WITH THIS.LBLF19
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*265
         .WIDTH=INT_015*50
         .CAPTION='勞保卡號'
     ENDWITH    
   THIS.ADDOBJECT('TXTF19','TEXTBOX')
     WITH THIS.TXTF19
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*259
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=10       
     ENDWITH         
   THIS.ADDOBJECT('LBLF20','LABEL')
     WITH THIS.LBLF20
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*290
         .WIDTH=INT_015*50
         .CAPTION='加保日期'
     ENDWITH    
   THIS.ADDOBJECT('TXTF20','TEXTBOX')
     WITH THIS.TXTF20
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*284
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8      
     ENDWITH    
   THIS.ADDOBJECT('LBLF21','LABEL')
     WITH THIS.LBLF21
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*290
         .WIDTH=INT_015*50
         .CAPTION='退保日期'
     ENDWITH    
   THIS.ADDOBJECT('TXTF21','TEXTBOX')
     WITH THIS.TXTF21
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*284
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8      
     ENDWITH        
   THIS.ADDOBJECT('LBLF22','LABEL')
     WITH THIS.LBLF22
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*315
         .WIDTH=INT_015*50
         .CAPTION='健保等級'
     ENDWITH    
   THIS.ADDOBJECT('TXTF22','TEXTBOX')
     WITH THIS.TXTF22
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*309
          .WIDTH=INT_015*25
          .HEIGHT=INT_015*25
          .MAXLENGTH=2         
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX22','COMBOBOX22') 
     WITH THIS.COMBOBOX22 
          .LEFT=INT_015*64
          .TOP=INT_015*309
     ENDWITH         
  THIS.ADDOBJECT('LBLF16','LABEL')     
     WITH THIS.LBLF16
          .VISIBLE=.T.
          .LEFT=INT_015*300
          .TOP=INT_015*315
          .WIDTH=INT_015*50  
          .CAPTION='眷口人數'
     ENDWITH                
   THIS.ADDOBJECT('TXTF16','TEXTBOX')
     WITH THIS.TXTF16
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*309
          .WIDTH=INT_015*45
          .HEIGHT=INT_015*25
          .MAXLENGTH=2
	  .INPUTMASK='99'           
     ENDWITH        
*!*	 THIS.ADDOBJECT('SPINNER16','SPINNER')      
*!*	    WITH THIS.SPINNER16
*!*	          .VISIBLE=.T.
*!*		  .TOP=INT_015*309
*!*		  .LEFT=INT_015*350
*!*	          .HEIGHT=INT_015*25     
*!*		  .WIDTH=INT_015*45    
*!*		  .KEYBOARDLOWVALUE=0
*!*		  .KEYBOARDHIGHVALUE=99
*!*		  .SPINNERLOWVALUE=0
*!*		  .SPINNERHIGHVALUE=99
*!*		  .INPUTMASK='99'     
*!*	     ENDWITH     
   THIS.ADDOBJECT('LBLF23','LABEL')
     WITH THIS.LBLF23
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*340
         .WIDTH=INT_015*50
         .CAPTION='健保金額'
     ENDWITH         
   THIS.ADDOBJECT('TXTF23','TEXTBOX')
     WITH THIS.TXTF23
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*334
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=7
	  .INPUTMASK='9999999'           
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX23','COMBOBOX23') 
     WITH THIS.COMBOBOX23 
          .LEFT=INT_015*64
          .TOP=INT_015*334
     ENDWITH      
   THIS.ADDOBJECT('LBLF24','LABEL')
     WITH THIS.LBLF24
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*340
         .WIDTH=INT_015*50
         .CAPTION='健保卡號'
     ENDWITH    
   THIS.ADDOBJECT('TXTF24','TEXTBOX')
     WITH THIS.TXTF24
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*334
          .WIDTH=INT_015*75
          .HEIGHT=INT_015*25
          .MAXLENGTH=10      
     ENDWITH                 
   THIS.ADDOBJECT('LBLF25','LABEL')
     WITH THIS.LBLF25
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*365
         .WIDTH=INT_015*50
         .CAPTION='撥款銀行'
     ENDWITH    
   THIS.ADDOBJECT('TXTF25','TEXTBOX')
     WITH THIS.TXTF25
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*359
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30         
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX25','COMBOBOX25') 
     WITH THIS.COMBOBOX25 
          .LEFT=INT_015*64
          .TOP=INT_015*359
     ENDWITH         
   THIS.ADDOBJECT('LBLF26','LABEL')
     WITH THIS.LBLF26
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*365
         .WIDTH=INT_015*50
         .CAPTION='銀行帳號'
     ENDWITH    
   THIS.ADDOBJECT('TXTF26','TEXTBOX')
     WITH THIS.TXTF26
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*359
          .WIDTH=INT_015*110
          .HEIGHT=INT_015*25
          .MAXLENGTH=15       
     ENDWITH
     THIS.ADDOBJECT('LBLF31','LABEL')
     WITH THIS.LBLF31
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*390
         .WIDTH=INT_015*50
         .CAPTION='勞退選擇'
     ENDWITH               
  THIS.ADDOBJECT('OPTIONGROUP31','OPTIONGROUP31')
     WITH THIS.OPTIONGROUP31
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*384   
     ENDWITH       
     THIS.ADDOBJECT('LBLF32','LABEL')
     WITH THIS.LBLF32
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*418
         .WIDTH=INT_015*50
         .CAPTION='自行提撥'
     ENDWITH          
  THIS.ADDOBJECT('OPTIONGROUP32','OPTIONGROUP32')
     WITH THIS.OPTIONGROUP32
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*409   
     ENDWITH    
     THIS.ADDOBJECT('LBLF321','LABEL')
     WITH THIS.LBLF321
         .VISIBLE=.T.
         .LEFT=INT_015*145
         .TOP=INT_015*418
         .AUTOSIZE=.T.
         .CAPTION='提撥比率               ％'
     ENDWITH                 
   THIS.ADDOBJECT('TXTF32','TEXTBOX')
     WITH THIS.TXTF32
          .VISIBLE=.T.
          .LEFT=INT_015*195
          .TOP=INT_015*411
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*25
          .INPUTMASK='999.99'
          .MAXLENGTH=6       
     ENDWITH     
     THIS.ADDOBJECT('LBLF27','LABEL')
     WITH THIS.LBLF27
         .VISIBLE=.T.
         .BACKCOLOR=RGB(255,255,0)
         .LEFT=INT_015*300
         .TOP=INT_015*390
         .WIDTH=INT_015*50
         .CAPTION='作業限制'
     ENDWITH          
  THIS.ADDOBJECT('OPTIONGROUP27','OPTIONGROUP')
     WITH THIS.OPTIONGROUP27
          .VISIBLE=.T.
          .LEFT=INT_015*350
          .TOP=INT_015*384
	  .HEIGHT=INT_015*25
	  .WIDTH=INT_015*141
	  .BUTTONCOUNT=2
	  .VALUE=1
	  .ENABLED=.F.
	  .NAME='OPTIONGROUP27'
	  .OPTION1.CAPTION='共用'
	  .OPTION1.TOP=INT_015*5
	  .OPTION1.FONTSIZE=INT_015*9	  
	  .OPTION1.AUTOSIZE=.T.
	  .OPTION1.LEFT=INT_015*5
	  .OPTION1.NAME='OPTION1'
	  .OPTION2.CAPTION='單獨'
	  .OPTION2.TOP=INT_015*5
	  .OPTION2.FONTSIZE=INT_015*9
	  .OPTION2.AUTOSIZE=.T.
	  .OPTION2.LEFT=INT_015*70
	  .OPTION2.NAME='OPTION2'         
     ENDWITH  
     THIS.ADDOBJECT('LBLF33','LABEL')
     WITH THIS.LBLF33
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*446
         .WIDTH=INT_015*75
         .CAPTION='薪資E-MAIL'
     ENDWITH     
   THIS.ADDOBJECT('TXTF33','TEXTBOX')
     WITH THIS.TXTF33
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*463
          .WIDTH=INT_015*300
          .HEIGHT=INT_015*25
          .MAXLENGTH=50       
     ENDWITH                   
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*300
         .TOP=INT_015*415
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH    
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*350
         .TOP=INT_015*415
         .AUTOSIZE=.T.
         .CAPTION=''         
     ENDWITH                                     
  ENDPROC  
***********薪資所得明細設定
 PROCEDURE PAGEFRAME1.PAGE2.INIT    
   THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*15
          .WIDTH=INT_015*50
          .CAPTION='薪資類別'          
     ENDWITH
  THIS.ADDOBJECT('TXTF06','TEXTBOX')          
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*9
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH     
   THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*40
          .WIDTH=INT_015*50
          .CAPTION='薪資項目'          
     ENDWITH
  THIS.ADDOBJECT('TXTF07','TEXTBOX')          
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*34
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX07','COMBOBOX07') 
     WITH THIS.COMBOBOX07
          .LEFT=INT_015*64
          .TOP=INT_015*34
     ENDWITH
   THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*65
          .WIDTH=INT_015*50
          .CAPTION='薪資所得'          
     ENDWITH
  THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.     
          .ALIGNMENT=1
          .LEFT=INT_015*64
          .TOP=INT_015*59    
	  .WIDTH=INT_015*55
	  .HEIGHT=INT_015*25
	  .MAXLENGTH=7
	  .INPUTMASK='9999999'  
     ENDWITH         
   THIS.ADDOBJECT('LBLF09','LABEL')
     WITH THIS.LBLF09
          .VISIBLE=.F.
          .LEFT=INT_015*240
          .TOP=INT_015*15
          .WIDTH=INT_015*140
          .CAPTION='調薪修改作業之變更日期：'          
     ENDWITH     
   THIS.ADDOBJECT('LBLF091','LABEL')
     WITH THIS.LBLF091
          .VISIBLE=.F.
          .LEFT=INT_015*390
          .TOP=INT_015*15
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH         
   THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
          .VISIBLE=.F.
          .LEFT=INT_015*240
          .TOP=INT_015*40
          .WIDTH=INT_015*140
          .CAPTION='調薪修改作業之變更說明：'          
     ENDWITH     
   THIS.ADDOBJECT('LBLF101','LABEL')
     WITH THIS.LBLF101
          .VISIBLE=.F.
          .LEFT=INT_015*390
          .TOP=INT_015*40
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH         
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*145
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH    
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*64
         .TOP=INT_015*145
         .AUTOSIZE=.T.
         .CAPTION=''         
     ENDWITH                
ENDPROC   
***********  薪資扣款明細設定
 PROCEDURE PAGEFRAME1.PAGE3.INIT    
   THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*15
          .WIDTH=INT_015*50
          .CAPTION='扣款類別'          
     ENDWITH
  THIS.ADDOBJECT('TXTF06','TEXTBOX')          
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*9
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH     
  THIS.ADDOBJECT('COMBOBOX06','COMBOBOX062')          
     WITH THIS.COMBOBOX06
          .LEFT=INT_015*64
          .TOP=INT_015*9
     ENDWITH      
   THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*40
          .WIDTH=INT_015*50
          .CAPTION='扣款項目'          
     ENDWITH
  THIS.ADDOBJECT('TXTF07','TEXTBOX')          
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*64
          .TOP=INT_015*34
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
     ENDWITH    
  THIS.ADDOBJECT('COMBOBOX07','COMBOBOX07') 
     WITH THIS.COMBOBOX07 
          .LEFT=INT_015*64
          .TOP=INT_015*34
     ENDWITH
   THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
          .VISIBLE=.T.
          .LEFT=INT_015*14
          .TOP=INT_015*65
          .WIDTH=INT_015*50
          .CAPTION='扣款金額'          
     ENDWITH
  THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*64
          .TOP=INT_015*59
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=7             
     ENDWITH    
   THIS.ADDOBJECT('LBLF09','LABEL')
     WITH THIS.LBLF09
          .VISIBLE=.F.
          .LEFT=INT_015*240
          .TOP=INT_015*15
          .WIDTH=INT_015*140
          .CAPTION='調薪修改作業之變更日期：'          
     ENDWITH     
   THIS.ADDOBJECT('LBLF091','LABEL')
     WITH THIS.LBLF091
          .VISIBLE=.F.
          .LEFT=INT_015*390
          .TOP=INT_015*15
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH         
   THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
          .VISIBLE=.F.
          .LEFT=INT_015*240
          .TOP=INT_015*40
          .WIDTH=INT_015*140
          .CAPTION='調薪修改作業之變更說明：'          
     ENDWITH     
   THIS.ADDOBJECT('LBLF101','LABEL')
     WITH THIS.LBLF101
          .VISIBLE=.F.
          .LEFT=INT_015*390
          .TOP=INT_015*40
          .AUTOSIZE=.T.
          .CAPTION=''          
     ENDWITH                
     THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*14
         .TOP=INT_015*145
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH    
     THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*64
         .TOP=INT_015*145
         .AUTOSIZE=.T.
         .CAPTION=''         
     ENDWITH                
ENDPROC
********  
  PROC INIT       
       THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
       THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)                   
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*10
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*10   
       THISFORM.PAGEFRAME1.PAGE3.FONTSIZE=INT_015*10       
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')     
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')    
       THISFORM.SETALL('FONTSIZE',INT_015*9,'SPINNER')            
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('READONLY',.T.,'SPINNER')     
       THISFORM.PAGEFRAME1.PAGE1.LBLF27.VISIBLE=IIF(A02.F09<>'*',.F.,.T.)
       THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VISIBLE=IIF(A02.F09<>'*',.F.,.T.)
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.TAIPEI_BOTT.VISIBLE=.T.
       THISFORM.TAIPEI_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)      
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='任職狀況'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05_1.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05_1.F02'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE="BILL_MODE(S05_1.F28)"
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55    
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*55    
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')     
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='薪資類別'    
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='薪資項目名稱'
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='薪資所得'
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='安全資料'
       THISFORM.GRID2.LINKMASTER='S05_1'
       THISFORM.GRID2.RELATIONALEXPR='F01'
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE="SALARY_CLASS(S06.F06)"
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE='S06.F07'
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE='S06.F08'
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE='S06.F99'
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*150       
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*150
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*60
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*100
       THISFORM.GRID1.READONLY=.T.      
       THISFORM.GRID2.READONLY=.T.            
       THISFORM.GRID1.SETFOCUS
       IF THISFORM.GRID1.ACTIVEROW=0
       	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
           THISFORM.ANS_BOTT.ENABLED=.F.         
           THISFORM.CHANG_BOTT.ENABLED=.F.
       ELSE
       	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE3.ENABLED=.T.
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
           THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) &&判斷有無修改的權限
           THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.)&&判斷有無刪除的權限
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限       
           THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED 
           THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.)
       ENDIF          
       JK='員工編號'
       SELE S05_1
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05_1.F01
  ENDPROC           
***********
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
        R=0
	SELECT S05_1
        DO CASE
               CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                          SET ORDER TO S05_11 
               CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
              		  SET ORDER TO S05_12
         ENDCASE      
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)  
        THISFORM.PAGEFRAME1.PAGE3.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE3.FORECOLOR=RGB(0,0,0)           
        THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","","COLUMN")  
	THISFORM.SHRGROUP.TOP=INT_015*475
	THISFORM.SHRGROUP.LEFT=INT_015*558
	THISFORM.ANS_BOTT.VISIBLE=.T.  
	THISFORM.CHANG_BOTT.VISIBLE=.T.
    THISFORM.TAIPEI_BOTT.VISIBLE=.T. 	
	THISFORM.GRID2.VISIBLE=.F.	  
        THISFORM.GRID2.ENABLED=.F.  
        THISFORM.GRID1.ENABLED=.T.      
        THISFORM.GRID1.SETFOCUS
         IF  THISFORM.GRID1.ACTIVEROW=0 AND THISFORM.SHRGROUP.ENABLED=.F.	
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.  &&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.    &&判斷有無列印的權限                              
              THISFORM.ANS_BOTT.ENABLED=.F.
              THISFORM.CHANG_BOTT.ENABLED=.F.
              THISFORM.TAIPEI_BOTT.ENABLED=.F.
              THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS 
         ELSE    
              THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) &&判斷有無修改的權限
              THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) 
              THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限       
              THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED 
              THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.)  	      	
              THISFORM.TAIPEI_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)
         ENDIF
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限 
*!*	        THISFORM.REFRESH    
  ENDPROC     
***********
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
	SELECT S06
	SET FILTER TO F05='1'
	SET ORDER TO S061
	GO TOP
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,255)  
        THISFORM.PAGEFRAME1.PAGE3.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE3.FORECOLOR=RGB(0,0,0)     	
        THISFORM.ANS_BOTT.VISIBLE=.F.  
        THISFORM.CHANG_BOTT.VISIBLE=.F. 
        THISFORM.TAIPEI_BOTT.VISIBLE=.F.
        THISFORM.TAIPEI_BOTT.ENABLED=.F.
	THISFORM.KEY_LIST.ENABLED=.F.   
	THISFORM.GRID2.VISIBLE=.T. 	
	THISFORM.GRID2.ENABLED=.T.
        THISFORM.GRID2.SETFOCUS       
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='薪資類別'     
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='薪資項目名稱'       
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='薪資所得'      
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='安全資料'            
        THISFORM.GRID2.COLUMN1.CONTROLSOURCE="SALARY_CLASS(S06.F06)"
        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='S06.F07'
        THISFORM.GRID2.COLUMN3.CONTROLSOURCE='S06.F08'
        THISFORM.GRID2.COLUMN4.CONTROLSOURCE='S06.F99'
        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*150       
        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*150
        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*60
        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*100           
	THISFORM.SHRGROUP.TOP=INT_015*160
	THISFORM.SHRGROUP.LEFT=INT_015*558
       	THISFORM.PAGEFRAME1.PAGE2.LBLF09.VISIBLE=IIF(EMPTY(S06.F09),.F.,.T.)
       	THISFORM.PAGEFRAME1.PAGE2.LBLF091.VISIBLE=IIF(EMPTY(S06.F09),.F.,.T.)
       	THISFORM.PAGEFRAME1.PAGE2.LBLF10.VISIBLE=IIF(EMPTY(S06.F10),.F.,.T.)
       	THISFORM.PAGEFRAME1.PAGE2.LBLF101.VISIBLE=IIF(EMPTY(S06.F10),.F.,.T.)	
       	THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=SALARY_CLASS(S06.F06)
       	THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S06.F07 
       	THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S06.F08       	
       	THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=DTCX(S06.F09)
       	THISFORM.PAGEFRAME1.PAGE2.LBLF101.CAPTION=S06.F10  
       	THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S06.F99    
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.       	 
	THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.  &&任何修改需至S07.調薪修改作業中執行 
        IF EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	   
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=''	
	      THISFORM.PAGEFRAME1.PAGE2.LBLF101.CAPTION=''		     
	      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''
	 ELSE
	      IF EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE) AND THISFORM.SHRGROUP.ENABLED=.F. 
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	           THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')
	           THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=''	
	           THISFORM.PAGEFRAME1.PAGE2.LBLF101.CAPTION=''		           
	           THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''	           		   
	      ELSE
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) AND S06.F06<>'A'   AND S06.F06<>'B'  AND S06.F06<>'C' AND S06.F06<>'F'  &&判斷有無刪除的權限(A=底薪,B=日薪,C=時薪及F=全勤獎金不得刪除)
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 		      
	      ENDIF 
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)	AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) &&判斷有無新增的權限         
	ENDIF            
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
*!*	       THISFORM.REFRESH   	                    
  ENDPROC     
***********
  PROCEDURE PAGEFRAME1.PAGE3.ACTIVATE
	SELECT S06
	SET FILTER TO F05='2'	
	SET ORDER TO S061
	GO TOP
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)  
        THISFORM.PAGEFRAME1.PAGE3.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE3.FORECOLOR=RGB(0,0,255)     	
	THISFORM.ANS_BOTT.VISIBLE=.F. 
	THISFORM.CHANG_BOTT.VISIBLE=.F. 
        THISFORM.TAIPEI_BOTT.VISIBLE=.F.
        THISFORM.TAIPEI_BOTT.ENABLED=.F.	
	THISFORM.KEY_LIST.ENABLED=.F.   	
	THISFORM.GRID2.VISIBLE=.T.
        THISFORM.GRID2.ENABLED=.T.  
        THISFORM.GRID2.SETFOCUS    	
	THISFORM.SHRGROUP.TOP=INT_015*160
	THISFORM.SHRGROUP.LEFT=INT_015*558	        
        THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='扣款類別'    
        THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='扣款項目名稱'              
        THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='扣款金額'
        THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='安全資料'       
        THISFORM.GRID2.COLUMN1.CONTROLSOURCE="SALARY_CLASS(S06.F06)"
        THISFORM.GRID2.COLUMN2.CONTROLSOURCE='S06.F07'
        THISFORM.GRID2.COLUMN3.CONTROLSOURCE='S06.F08'
        THISFORM.GRID2.COLUMN4.CONTROLSOURCE='S06.F99'
        THISFORM.GRID2.COLUMN1.WIDTH=INT_015*150       
        THISFORM.GRID2.COLUMN2.WIDTH=INT_015*150
        THISFORM.GRID2.COLUMN3.WIDTH=INT_015*60
        THISFORM.GRID2.COLUMN4.WIDTH=INT_015*100  
       	THISFORM.PAGEFRAME1.PAGE3.LBLF09.VISIBLE=IIF(EMPTY(S06.F09),.F.,.T.)
       	THISFORM.PAGEFRAME1.PAGE3.LBLF091.VISIBLE=IIF(EMPTY(S06.F09),.F.,.T.)
       	THISFORM.PAGEFRAME1.PAGE3.LBLF10.VISIBLE=IIF(EMPTY(S06.F10),.F.,.T.)
       	THISFORM.PAGEFRAME1.PAGE3.LBLF101.VISIBLE=IIF(EMPTY(S06.F10),.F.,.T.)	        
   	THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=SALARY_CLASS(S06.F06)
   	THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=S06.F07    
   	THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=S06.F08   	   
       	THISFORM.PAGEFRAME1.PAGE3.LBLF091.CAPTION=DTCX(S06.F09)
       	THISFORM.PAGEFRAME1.PAGE3.LBLF101.CAPTION=S06.F10     				 
   	THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=S06.F99         
	THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.   
*!*		THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. &&任何修改需至S07.調薪修改作業中執行   
        IF EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.	       
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.PAGEFRAME1.PAGE3.SETALL('VALUE','','TEXTBOX')
	      THISFORM.PAGEFRAME1.PAGE3.LBLF091.CAPTION=''	
	      THISFORM.PAGEFRAME1.PAGE3.LBLF101.CAPTION=''		      
	      THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''
	 ELSE
	      IF EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE) AND THISFORM.SHRGROUP.ENABLED=.F. 
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F. 
		   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	           THISFORM.PAGEFRAME1.PAGE3.SETALL('VALUE','','TEXTBOX')
	           THISFORM.PAGEFRAME1.PAGE3.LBLF091.CAPTION=''	
	           THISFORM.PAGEFRAME1.PAGE3.LBLF101.CAPTION=''	
	           THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''	           		   
	      ELSE
		   THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
		   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
		   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
		   THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.)  &&AND S06.F06<>'O'  &&AND S06.F06<>'K'  &&判斷有無修改的權限(J=勞保及K=健保不得修改)   		   
		   THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) && AND S06.F06<>'J'  AND S06.F06<>'K'  &&判斷有無修改的權限(J=勞保及K=健保不得修改)   
	           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 		      
	      ENDIF 
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)	 AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) &&判斷有無新增的權限         
       ENDIF   
       R=RECNO('&AREA1')
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.        
*!*	       THISFORM.REFRESH     
  ENDPROC          
**********    
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依員工編號排列')
           .ADDITEM('依員工姓名排列')
           .VALUE=1
       ENDWITH             
  ENDPROC
********* 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE S05_1 
       DO CASE
          CASE THIS.DISPLAYVALUE='依員工編號排列'
               SET ORDER TO S05_11 
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05_1.F01'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05_1.F02'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55 
          CASE THIS.DISPLAYVALUE='依員工姓名排列'
               SET ORDER TO S05_12
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05_1.F02'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05_1.F01'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50                                                                
       ENDCASE 
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
***********  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       	THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05_1.F01
        THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=S05_1.F02    
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=IIF(S05_1.F03='M',1,2)
       	THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=S05_1.F04
        THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=S05_1.F05
        THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION=S05_1.F06
        THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=S05_1.F07 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=S05_1.F08
        THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE=S05_1.F09
        THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=S05_1.F10        
        THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=S05_1.F11
        THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=S05_1.F12
        THISFORM.PAGEFRAME1.PAGE1.LBLF122.CAPTION=SPACE(5)+TRANSFORM(IIF((S05_1.F11-S05_1.F12)<=0,0,S05_1.F11-S05_1.F12),'999.9')+'天'
        THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE=S05_1.F13
        THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE=S05_1.F14
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=IIF(S05_1.F15='M',1,IIF(S05_1.F15='D',2,3))             
       	THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE=S05_1.F16
        THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE=S05_1.F17    
       	THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=S05_1.F18
        THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE=S05_1.F19 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE=S05_1.F20
        THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE=S05_1.F21 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=S05_1.F22
        THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=S05_1.F23
        THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE=S05_1.F24
        THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=S05_1.F25
        THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE=S05_1.F26
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=IIF(S05_1.F27=.T.,1,2)  
        THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=BILL_MODE(S05_1.F28)        
        THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=S05_1.F29 
        THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE=S05_1.F33 
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE=VAL(S05_1.F30)
        THISFORM.PAGEFRAME1.PAGE1.TXTF34.VALUE=S05_1.F34    
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE=VAL(S05_1.F31)
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = IIF(S05_1.F32 = 0,1,2)
        THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE = IIF(S05_1.F32 = 0 ,0,S05_1.F32)
        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VISIBLE = IIF(S05_1.F31 = '2',.T.,.F.)
        THISFORM.PAGEFRAME1.PAGE1.LBLF32.VISIBLE = IIF(S05_1.F31 = '2',.T.,.F.)
        THISFORM.PAGEFRAME1.PAGE1.LBLF321.VISIBLE = IIF(S05_1.F31 = '2',.T.,.F.)
        THISFORM.PAGEFRAME1.PAGE1.TXTF32.VISIBLE = IIF(S05_1.F31 = '2',.T.,.F.)
        THISFORM.PAGEFRAME1.PAGE1.LBLF291.CAPTION=IIF(INDEXSEEK('I'+S05_1.F29,.T.,'S00','S005'),S00.F50+'∼'+S00.F51,'')
        THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=S05_1.F99
       	THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=SALARY_CLASS(S06.F06)            
       	THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S06.F07
        THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S06.F08  
        THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S06.F99  
       	THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=SALARY_CLASS(S06.F06)        
       	THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=S06.F07
        THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=S06.F08  
        THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=S06.F99                       
        IF THISFORM.GRID1.ACTIVEROW=0 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''       
	       THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION=''           
	       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=''             
	       THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE='' 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=''      
	       THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE='' 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE='' 	
	       THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE=''         	   
	       THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE=''       
	       THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE=''             
	       THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE=''      
	       THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=''   	          
	       THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=''       	 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE=0 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE=1          
	       THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE=1 
	       THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	       THISFORM.ANS_BOTT.ENABLED=.F.  
	       THISFORM.CHANG_BOTT.ENABLED=.F.	
	       THISFORM.TAIPEI_BOTT.ENABLED=.F.	             
 	 ELSE
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 	 	        
	       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) &&判斷有無修改的權限
	       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) &&判斷有無刪除的權限
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 	       
	       THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED 
	       THISFORM.CHANG_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.) AND !THISFORM.SHRGROUP.ENABLED AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.)
	       THISFORM.TAIPEI_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)
         ENDIF	      
         THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)	&&判斷有無新增的權限   
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION  
         IF THIS.ACTIVEROW=0
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
         ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
         ENDIF   
         CHK=''     
*!*	       THISFORM.REFRESH
  ENDPROC     
**********  
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
*!*	       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
       DO CASE
              CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2
	                 THISFORM.PAGEFRAME1.PAGE2.LBLF09.VISIBLE=IIF(EMPTY(S06.F09),.F.,.T.)
	                 THISFORM.PAGEFRAME1.PAGE2.LBLF091.VISIBLE=IIF(EMPTY(S06.F09),.F.,.T.)
       			 THISFORM.PAGEFRAME1.PAGE2.LBLF10.VISIBLE=IIF(EMPTY(S06.F10),.F.,.T.)    
       			 THISFORM.PAGEFRAME1.PAGE2.LBLF101.VISIBLE=IIF(EMPTY(S06.F10),.F.,.T.) 			 
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=SALARY_CLASS(S06.F06)
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S06.F07
       			 THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S06.F08      
       			 THISFORM.PAGEFRAME1.PAGE2.LBLF091.CAPTION=DTCX(S06.F09)
	                 THISFORM.PAGEFRAME1.PAGE2.LBLF101.CAPTION=S06.F10			 
       			 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S06.F99 
       			 THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.   		   
       			 THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) AND S06.F06<>'A'  AND S06.F06<>'B'  AND S06.F06<>'C'  AND S06.F06<>'F'  &&判斷有無刪除的權限(A=底薪,B=日薪,C=時薪及F=全勤獎金不得刪除)
              CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3
	                 THISFORM.PAGEFRAME1.PAGE3.LBLF09.VISIBLE=IIF(EMPTY(S06.F09),.F.,.T.)
	                 THISFORM.PAGEFRAME1.PAGE3.LBLF091.VISIBLE=IIF(EMPTY(S06.F09),.F.,.T.)
       			 THISFORM.PAGEFRAME1.PAGE3.LBLF10.VISIBLE=IIF(EMPTY(S06.F10),.F.,.T.)  
       			 THISFORM.PAGEFRAME1.PAGE3.LBLF101.VISIBLE=IIF(EMPTY(S06.F10),.F.,.T.)      			 
       			 THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=SALARY_CLASS(S06.F06)
       			 THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=S06.F07       	
       			 THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=S06.F08     
       			 THISFORM.PAGEFRAME1.PAGE3.LBLF091.CAPTION=DTCX(S06.F09)
	                 THISFORM.PAGEFRAME1.PAGE3.LBLF101.CAPTION=S06.F10 			 		 
       			 THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=S06.F99    
       			 THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.)  &&AND S06.F06<>'O'  &&AND S06.F06<>'K'  &&判斷有無修改的權限(J=勞保及K=健保不得修改)   		   
       			 THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)  AND IIF(S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8',.F.,.T.) && AND S06.F06<>'J'  AND S06.F06<>'K'  &&判斷有無修改的權限(J=勞保及K=健保不得修改)	 
       ENDCASE       			    			 
       FCH=THISFORM.ACTIVECONTROL.NAME
       JK=THIS.COLUMN1.HEADER1.CAPTION
       CHK=S06.F01
*       CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE 
*       THISFORM.REFRESH
  ENDPROC 
***********
PROCEDURE ORPGROUP.NEW_BOTT.CLICK    
    THISFORM.KEY_LIST.ENABLED=.F. 
    THISFORM.TAIPEI_BOTT.ENABLED=.F.
    THISFORM.GRID1.ENABLED=.F.  
    THISFORM.GRID2.ENABLED=.F.     
    DO CASE
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1    
		    THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
		    THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.	          	     
         	     R=RECNO('&AREA1')
    		     THISFORM.ANS_BOTT.ENABLED=.F.              
		     THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX')   
		     THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'SPINNER')	
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.ENABLED=.T.     		     
		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.ENABLED=.T. 
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.ENABLED=.T.
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.ENABLED=.T.    
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.ENABLED=.T. 
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.ENABLED=.T. 
		     THISFORM.PAGEFRAME1.PAGE1.LBLF32.VISIBLE=.F. 
		     THISFORM.PAGEFRAME1.PAGE1.LBLF321.VISIBLE=.F.       		     
      		     THISFORM.PAGEFRAME1.PAGE1.TXTF05.VISIBLE=.F.		            		     
		     THISFORM.PAGEFRAME1.PAGE1.TXTF07.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF08.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF18.VISIBLE=.F.	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF22.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF23.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF25.VISIBLE=.F.		     
		     THISFORM.PAGEFRAME1.PAGE1.TXTF28.VISIBLE=.F. 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF32.VISIBLE=.F. 
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VISIBLE=.T.	
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VISIBLE=.T.	     
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX08.VISIBLE=.T.	  
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.VISIBLE=.T.     
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.VISIBLE=.T.
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.VISIBLE=.T.
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX25.VISIBLE=.T.
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VISIBLE=.T.				     
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.VISIBLE=.T.	    
		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VISIBLE=.F.	 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF05.READONLY=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF09.READONLY=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF10.READONLY=.T.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF11.READONLY=.F.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF12.READONLY=.T.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF16.READONLY=.T.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF29.READONLY=.T.
		     THISFORM.PAGEFRAME1.PAGE1.TXTF32.READONLY=.T.
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=1	
		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=1	
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE=1	   
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE=1	   
      		     THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE=1	         		        
      		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VALUE=1  		      	     
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VALUE=1	
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX08.VALUE=1			     
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.VALUE=1  		      
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.VALUE=1 
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.VALUE=1 
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX25.VALUE=1	
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=1 		     
		     THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.VALUE=1		     	     	     		     
		     THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''       
		     THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=''  
		     THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=''	     	     
		     THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE='' 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE=CTOD('')
		     THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=CTOD('')
		     THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=0
		     THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=0     
		     THISFORM.PAGEFRAME1.PAGE1.LBLF122.CAPTION='' 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE='' 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE='' 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE=0	
		     THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE=0
		     THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=''	 
		     THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE=CTOD('')
		     THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE=CTOD('')
		     THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE=''		
		     THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=''			     
		     THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE=0
		     THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE=''
		     THISFORM.PAGEFRAME1.PAGE1.LBLF291.CAPTION=''
		     THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''
		     THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2          
		     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.			    
		     THISFORM.PAGEFRAME1.PAGE2.SETALL('READONLY',.F.,'TEXTBOX')      
		     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VISIBLE=.F.
		     THISFORM.COMBOBOX06.VISIBLE=.T.    
		     THISFORM.COMBOBOX06.CLICK          
		     THISFORM.COMBOBOX06.VALUE=1     
		     THISFORM.COMBOBOX06.SETFOCUS		           
		     THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.T.            
		     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VALUE=1    
		     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''			     
		     THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=0		
		     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''    
          CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3    	        
		     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		     THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.			     
		     THISFORM.PAGEFRAME1.PAGE3.SETALL('READONLY',.F.,'TEXTBOX') 
		     THISFORM.PAGEFRAME1.PAGE3.TXTF06.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE3.COMBOBOX06.VISIBLE=.T.            
		     THISFORM.PAGEFRAME1.PAGE3.COMBOBOX06.VALUE=1     
		     THISFORM.PAGEFRAME1.PAGE3.COMBOBOX06.SETFOCUS			                
		     THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.F.
		     THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.T.            
		     THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VALUE=1     		          
		     THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=''	
		     THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=''			     
		     THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=0			     
		     THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''    		           	     
   ENDCASE
  ENDPROC
*************  
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK               &&新增確認
    DO CASE
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1  
    	             SELECT  S05
    	             SET ORDER TO S051 
                     COD=SYS(21)
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
          		  =MESSAGEBOX('員工編號不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF  	
		     IF  LEN(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE))<4
          		  =MESSAGEBOX('員工編號不得少於四碼!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF      	 	      	     
	             IF SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'S05')=.T.  AND S05.F27=.F.
	           	  =MESSAGEBOX('此員工編號已存在作業限制為單獨人員中,請查明後再輸入!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
	          	  SET ORDER TO &COD
	          	  RETURN            
	       	     ENDIF
	             IF SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'S05')=.T.  AND S05.F27=.T.
	           	  =MESSAGEBOX('此員工編號已存在作業限制為共用人員中,請查明後再輸入!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
	          	  SET ORDER TO &COD
	          	  RETURN            
	       	     ENDIF  	
	             IF SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,'S05B_SEEK')=.T.
	           	  =MESSAGEBOX('此員工編號已存在S06.離職人員薪資基本檔中,請查明後再輸入!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.TXTF01.SETFOCUS
	          	  SELECT S05
	          	  SET ORDER TO &COD
	          	  RETURN            
	       	     ENDIF  	       	            	        
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
          		  =MESSAGEBOX('部門編號不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF    	       	    
	             IF SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE,'A14')=.F. 
	           	  =MESSAGEBOX('部門主檔中無此編號請先建立!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.SETFOCUS
	          	  SET ORDER TO &COD
	          	  RETURN            
	       	     ENDIF       	 	        	 	     
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
          		  =MESSAGEBOX('姓名不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF02.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF   	 	     
	    	     IF  THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE = 2  AND THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = 2 AND EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE)
	          	  =MESSAGEBOX('勞退選擇已選新制之自行提撥,故提撥比率不的為零!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.TXTF32.SETFOCUS
	          	  SET ORDER TO &COD
	          	  RETURN      
	    	     ENDIF    	 	     
    	 	     IF THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE<>6  &&若為為外包人員則不需新增S06           	 	         	 	            	 	             	 	      	 	     
			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE)
	          		  =MESSAGEBOX('到職日期不得空白!',0+64,'提示訊息視窗')
	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF09.SETFOCUS
	          		  SET ORDER TO &COD
	          		  RETURN
	    	 	     ENDIF
			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE)
	          		  =MESSAGEBOX('加保日期不得空白!',0+64,'提示訊息視窗')
	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF20.SETFOCUS
	          		  SET ORDER TO &COD
	          		  RETURN        	  
	    	 	     ENDIF  
			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE)
	          		  =MESSAGEBOX('班別不得空白,若尚未建立班別請至S00.薪資參數中設定!',0+64,'提示訊息視窗')
	          		  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.SETFOCUS
	          		  SET ORDER TO &COD
	          		  RETURN        	  
	    	 	 ENDIF  
			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE) <> .T. AND AT('@',THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE) = 0
	          		  =MESSAGEBOX('薪資E-MAIL格式不正確',0+64,'提示訊息視窗')
	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF33.SETFOCUS
	          		  SET ORDER TO &COD
	          		  RETURN        	  
	    	 	 ENDIF	    	 	 	
	    	 	     SELECT A01
	    	 	     LOCATE FOR ALLTRIM(A01.F03)=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE) 
	    	 	     IF FOUND()
	    	 	          REPLACE A01.F12 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
	    	 	     ENDIF
    	 	     ****新增基本薪資所得
    	 	            IF THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1  &&發薪種類為月薪時才有底薪,全勤獎金,伙食費,交通費,所得稅,勞保費,健保費
	    	 	   	 SELECT S06
		    	 	 APPEND BLANK
				 LOCK()
				 IF RLOCK()
				     REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
				     REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
				     REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
				     REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				     REPLACE F05 WITH '1'
				     REPLACE F06 WITH 'A'
				     REPLACE F07 WITH '底薪'
				     REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入底薪金額,最多七位數","請輸入",'0')),7))
				     REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
	*!*				    	IF EMPTY(S06.F08)
	*!*				    	     DELETE 
	*!*				    	ENDIF		    	
				 ENDIF
		    	 	 SELECT S06
		    	 	 APPEND BLANK
				 LOCK()
				 IF RLOCK()
				     REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
				     REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
				     REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
				     REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				     REPLACE F05 WITH '1'
				     REPLACE F06 WITH 'F'
				     REPLACE F07 WITH '全勤獎金'
				     REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入全勤獎金,最多七位數","請輸入",ALLTRIM(STR(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F04,0))))),7))
				     REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
	*!*				    	IF EMPTY(S06.F08)
	*!*				    	     DELETE 
	*!*				    	ENDIF
				 ENDIF	
		    	 	 SELECT S06
		    	 	 APPEND BLANK
				 LOCK()
				 IF RLOCK()
				     REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
				     REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
				     REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
				     REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				     REPLACE F05 WITH '1'
				     REPLACE F06 WITH 'D'
				     REPLACE F07 WITH '伙食費'
				     REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入伙食費金額,最多七位數","請輸入",ALLTRIM(STR(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F60,0))))),7))
				     REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				     IF EMPTY(S06.F08)
				         DELETE 
				    ENDIF
				 ENDIF	
		    	 	 SELECT S06
		    	 	 APPEND BLANK
				 LOCK()
				 IF RLOCK()
				     REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
				     REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
				     REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
				     REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				     REPLACE F05 WITH '1'
				     REPLACE F06 WITH 'E'
				     REPLACE F07 WITH '交通費'
				     REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入交通費金額,最多七位數","請輸入",ALLTRIM(STR(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F61,0))))),7))
				     REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				     IF EMPTY(S06.F08)
				         DELETE 
				    ENDIF
				 ENDIF		
		    	 	 SELECT S06
		    	 	 APPEND BLANK
				 LOCK()
				 IF RLOCK()
				      REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
				      REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
				      REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
				      REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				      REPLACE F05 WITH '1'
				      REPLACE F06 WITH 'G'
				      REPLACE F07 WITH '職務津貼'
				      REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入職務津貼金額,最多七位數","請輸入",'0')),7))
				      REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				      IF EMPTY(S06.F08)
				    	  DELETE 
				      ENDIF
				 ENDIF					    	    		    	   
				 ****新增基本薪資扣款 		     
		    	 	 SELECT S06
		    	 	 APPEND BLANK
				 LOCK()
				 IF RLOCK()
				 ***ROUND(投保金額*(勞工保險普通事故費率+勞工就業保險費率)*勞工負擔比率/30天*30天,0)
*!*					      LOPO=ROUND(VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE))*((IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F02,0)+IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F06,0))/100)*(IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F03,0)/100)/30*30,0) 
				      LOPO = IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE) + '30','S04'),S04.F04,0)
				      REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
				      REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
				      REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
				      REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				      REPLACE F05 WITH '2'
				      REPLACE F06 WITH 'J'
				      REPLACE F07 WITH '勞保費'
				      REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入勞保費金額,最多七位數","請輸入",ALLTRIM(STR(LOPO)))),7))
				      REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				      IF EMPTY(S06.F08)
				    	  DELETE 
				      ENDIF			    	
				 ENDIF	
		    	 SELECT S06
		    	 APPEND BLANK
				 LOCK()
				 IF RLOCK()
				 ****眷口人數大於不扣款之眷口數則為0,否則為 ROUND(投保金額*(全民健康保險費率)*(被保險人及眷屬月負擔金額比率),0)*(眷口人數+本人)
				     PEOP=IIF(THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE>=IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F06,0),S01.F06-1,THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE)
				     SINPO=ROUND(VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE))*(IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F02,0)/100)*(IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F03,0)/100),0)*(PEOP+1)
				     REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
				     REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
				     REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
				     REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				     REPLACE F05 WITH '2'
				     REPLACE F06 WITH 'K'
				     REPLACE F07 WITH '健保費'
				     REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入健保費金額,最多七位數","請輸入",ALLTRIM(STR(SINPO)))),7))
				     REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				     IF EMPTY(S06.F08)
				          DELETE 
				     ENDIF
			      ENDIF
		    	  SELECT S06
		    	  APPEND BLANK
				  LOCK()
				  IF RLOCK()
				      REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
				      REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
				      REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
				      REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				      REPLACE F05 WITH '2'
				      REPLACE F06 WITH 'L'
				      REPLACE F07 WITH '所得稅'
				      REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入所得稅扣款金額,最多七位數","請輸入",'0')),7))
				      REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				      IF EMPTY(S06.F08)
				         DELETE 
				     ENDIF		    	
				  ENDIF	
				  ***勞退新制自行提撥金額	
				  IF 	!EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE)
		    	 	         SELECT S06
		    	 	         APPEND BLANK
				         LOCK()
				         IF RLOCK()
				             REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
				             REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
				             REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
				             REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				             REPLACE F05 WITH '2'
				             REPLACE F06 WITH 'O'
				             REPLACE F07 WITH '勞退自行提撥金額'
				             REPLACE F08 WITH ROUND(VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE)) * (THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE / 100),0)
				             REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				             IF EMPTY(S06.F08)
				                 DELETE 
				             ENDIF	
				         ENDIF    	    	
				  ENDIF				  	          
			      ELSE  	&&日薪及時薪
			          IF THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2  &&日薪
	    	 	   	      SELECT S06
		    	 	      APPEND BLANK
				      LOCK()
				      IF RLOCK()
				          REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
				          REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
				          REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
				          REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				          REPLACE F05 WITH '1'
				          REPLACE F06 WITH 'B'
				          REPLACE F07 WITH '日薪'
				          REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入日薪金額,最多七位數","請輸入",'0')),7))
				          REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
	*!*				    	IF EMPTY(S06.F08)
	*!*				    	     DELETE 
	*!*				    	ENDIF
				      ENDIF	
			    	      SELECT S06
			    	      APPEND BLANK
				      LOCK()
				      IF RLOCK()
					  REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
					  REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
					  REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
					  REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
					  REPLACE F05 WITH '1'
					  REPLACE F06 WITH 'G'
					  REPLACE F07 WITH '職務津貼'
					  REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入職務津貼金額,最多七位數","請輸入",'0')),7))
					  REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
					  IF EMPTY(S06.F08)
					      DELETE 
					 ENDIF
			             ENDIF				      			          
			          ELSE  		&&時薪
	    	 	   	      SELECT S06
		    	 	      APPEND BLANK
				      LOCK()
				      IF RLOCK()
				          REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
				          REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
				          REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
				          REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				          REPLACE F05 WITH '1'
				          REPLACE F06 WITH 'C'
				          REPLACE F07 WITH '時薪'
				          REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入時薪金額,最多七位數","請輸入",'0')),7))
				          REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
	*!*				    	IF EMPTY(S06.F08)
	*!*				    	     DELETE 
	*!*				    	ENDIF
				      ENDIF	
			    	      SELECT S06
			    	      APPEND BLANK
				      LOCK()
				      IF RLOCK()
					  REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
					  REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
					  REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
					  REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
					  REPLACE F05 WITH '1'
					  REPLACE F06 WITH 'G'
					  REPLACE F07 WITH '職務津貼'
					  REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入職務津貼金額,最多七位數","請輸入",'0')),7))
					  REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
					  IF EMPTY(S06.F08)
					      DELETE 
					 ENDIF
			             ENDIF				      				      	
		    	       ENDIF
			  ENDIF		      
	            ENDIF     			    		     
		    SELECT  S05          
		    APPEND BLANK
		    LOCK()
		    IF RLOCK()
		         REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
		         REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		         REPLACE F03 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=1,'M','F')
		         REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
		         REPLACE F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		         REPLACE F06 WITH  ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		         REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
		         REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE
		         REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE
		         REPLACE F11 WITH ABS(THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE)
		         REPLACE F12 WITH ABS(THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE)
		         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE
		         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE		         
		         REPLACE F15 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'M',IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'D','T')) 
*!*			         REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE
		         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE
		         REPLACE F18 WITH VAL(THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE)
		         REPLACE F19 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE
		         REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE
		         REPLACE F21 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE
		         REPLACE F22 WITH VAL(THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE)
		         REPLACE F23 WITH VAL(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE)
		         REPLACE F24 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE
		         REPLACE F25 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE
		         REPLACE F26 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE	
 	                 DO CASE
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=1
 	                        	    REPLACE F28 WITH 'A'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=2
 	                        	    REPLACE F28 WITH 'B'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=3
 	                        	    REPLACE F28 WITH 'C' 	                        
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=4
 	                        	    REPLACE F28 WITH '2' 	        
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=5
 	                        	    REPLACE F28 WITH '4' 	       
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=6
 	                        	    REPLACE F28 WITH '9' 	  	                        	      	                        	     	                        	    	     	                        	    
 	                 ENDCASE		
		         REPLACE F29 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE 	
		         REPLACE F30 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE))
		         REPLACE F34 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF34.VALUE
		         REPLACE F31 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE))
		         REPLACE F32 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = 1 OR THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE <> 2,0,THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE)
		         REPLACE F33 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE
 	             REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	         
		         IF A02.F09<>'*'
		         	REPLACE F27 WITH .T.
		         ELSE	
		         	REPLACE F27 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=1,.T.,.F.)
		         ENDIF    
		    ENDIF  
		    SELECT  S05_1          
		    APPEND BLANK
		    LOCK()
		    IF RLOCK()
		         REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
		         REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		         REPLACE F03 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=1,'M','F')
		         REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
		         REPLACE F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		         REPLACE F06 WITH  ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		         REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
		         REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE
		         REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE
		         REPLACE F11 WITH ABS(THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE)
		         REPLACE F12 WITH ABS(THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE)
		         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE
		         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE		         
		         REPLACE F15 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'M',IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'D','T')) 
*!*			         REPLACE F16 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE
		         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE
		         REPLACE F18 WITH VAL(THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE)
		         REPLACE F19 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE
		         REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE
		         REPLACE F21 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE
		         REPLACE F22 WITH VAL(THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE)
		         REPLACE F23 WITH VAL(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE)
		         REPLACE F24 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE
		         REPLACE F25 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE
		         REPLACE F26 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE	
 	                 DO CASE
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=1
 	                        	    REPLACE F28 WITH 'A'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=2
 	                        	    REPLACE F28 WITH 'B'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=3
 	                        	    REPLACE F28 WITH 'C' 	                        
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=4
 	                        	    REPLACE F28 WITH '2' 	        
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=5
 	                        	    REPLACE F28 WITH '4' 	       
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=6
 	                        	    REPLACE F28 WITH '9' 	  	                        	      	                        	     	                        	    	     	                        	    
 	                 ENDCASE		
		         REPLACE F29 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE 	
		         REPLACE F30 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE))       
		         REPLACE F34 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF34.VALUE
		         REPLACE F31 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE))
		         REPLACE F32 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = 1 OR THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE <> 2,0,THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE)		                   
		         REPLACE F33 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE
 	             REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	         
		         IF A02.F09<>'*'
		         	REPLACE F27 WITH .T.
		         ELSE	
		         	REPLACE F27 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=1,.T.,.F.)
		         ENDIF    
		    ENDIF  		     
		    R=RECNO('&AREA1')
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2  
    	             SELECT  S06 
                     COD=SYS(21)
                     SET ORDER TO S061     	  
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)
          		  =MESSAGEBOX('薪資類別不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF    
    	 	     IF THISFORM.COMBOBOX06.VALUE=6
    	 	          IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE)
          		       =MESSAGEBOX('薪資項目不得空白!',0+64,'提示訊息視窗')
          		       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.SETFOCUS
          		       SET ORDER TO &COD
          		       RETURN        	  
    	 	          ENDIF
		    	  IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'H'+THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE,'S06')=.T.
      		          	=MESSAGEBOX('此薪資項目已存在,請重新輸入!',0+64,'提示訊息視窗')
      		          	THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.SETFOCUS
      		           	SET ORDER TO &COD
      		           	RETURN
      		    	 ENDIF  	 	               	 	          
    	 	    ELSE 	 	    
		    	  IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,'S06')=.T.
      		          	=MESSAGEBOX('此薪資類別已存在,請重新輸入!',0+64,'提示訊息視窗')
      		          	THISFORM.COMBOBOX06.SETFOCUS
      		           	SET ORDER TO &COD
      		           	RETURN
      		    	 ENDIF
      		    ENDIF     
      		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)
          		  =MESSAGEBOX('薪資所得不得為零!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF        		          	        	 	      	  
		    SELE S06          
		    APPEND BLANK
		    LOCK()
		    IF RLOCK()
		         REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
		         REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		         REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		         REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		         REPLACE F05 WITH '1' 
		         REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
		         REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
		         REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		    ENDIF	
    	  CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3 
    	             SELE S06 
                     COD=SYS(21)
                     SET ORDER TO S061     	  
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE)
          		  =MESSAGEBOX('扣款類別不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE3.COMBOBOX06.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF       
    	 	     IF THISFORM.PAGEFRAME1.PAGE3.COMBOBOX06.VALUE=5    
    	 	     	  IF  EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE)
          		       =MESSAGEBOX('扣款項目名稱不得空白!',0+64,'提示訊息視窗')
          		       THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.SETFOCUS
          		       SET ORDER TO &COD
          		       RETURN        	  
    	 	          ENDIF    
		    	  IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'H'+THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE,'S06')=.T.
      		          	=MESSAGEBOX('此扣款項目已存在,請重新輸入!',0+64,'提示訊息視窗')
      		          	THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.SETFOCUS
      		           	SET ORDER TO &COD
      		           	RETURN
      		    	 ENDIF   	               	 	          
    	 	    ELSE 	 	    
		    	  IF  SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE,'S06')=.T.
      		          	=MESSAGEBOX('此扣款類別已存在,請重新輸入!',0+64,'提示訊息視窗')
      		          	THISFORM.PAGEFRAME1.PAGE3.COMBOBOX06.SETFOCUS
      		           	SET ORDER TO &COD
      		           	RETURN
      		    	 ENDIF
      		    ENDIF   
      		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE)
          		  =MESSAGEBOX('扣款金額不得為零!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE3.TXTF08.SETFOCUS
          		  SET ORDER TO &COD
          		  RETURN        	  
    	 	     ENDIF      		    
		    SELE S06
		    APPEND BLANK
		    LOCK()
		    IF RLOCK()
		         REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
		         REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		         REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		         REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		         REPLACE F05 WITH '2' 
		         REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE
		         REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE
		         REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		    
		    ENDIF      		    	    	 	         	 	     	            	         	         		         		         		         		         		         		         	         		         		            	 	     	      		      
    ENDCASE 
    UNLOCK ALL
    SELECT S05_1
    SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
*!*	    THISFORM.ORPGROUP.NEW_BOTT.CLICK    
    THISFORM.REFRESH
    IF S05_1.F16 > 0 
       THISFORM.TAIPEI_BOTT.CLICK
    ENDIF
  ENDPROC  
***********    
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK 
    THISFORM.KEY_LIST.ENABLED=.F.
    THISFORM.TAIPEI_BOTT.ENABLED=.F. 
    THISFORM.GRID1.ENABLED=.F.   
    THISFORM.GRID2.ENABLED=.F.      
     DO CASE
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1
		      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.			      
		      THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")           
		      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'TEXTBOX')   
		      THISFORM.PAGEFRAME1.PAGE1.SETALL('READONLY',.F.,'SPINNER')              	       
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.ENABLED=.T. 
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.ENABLED=.T.    
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.ENABLED=.T.  
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.ENABLED=.T.  	
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.ENABLED=.T.
     		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.ENABLED=.T.	      		      
		      THISFORM.PAGEFRAME1.PAGE1.TXTF01.READONLY=.T. 
		      THISFORM.PAGEFRAME1.PAGE1.TXTF09.READONLY=.F. 
		      THISFORM.PAGEFRAME1.PAGE1.TXTF10.READONLY=.T. 	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF11.READONLY=.F. 
		      THISFORM.PAGEFRAME1.PAGE1.TXTF12.READONLY=.T. 
		      THISFORM.PAGEFRAME1.PAGE1.TXTF16.READONLY=.T.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF28.READONLY=IIF(S05_1.F28='A' OR S05_1.F28='B'  OR S05_1.F28='C' OR  S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.T.,.F.)	     
		      THISFORM.PAGEFRAME1.PAGE1.TXTF32.READONLY=IIF(S05_1.F32 = 0,.T.,.F.) 
		      THISFORM.PAGEFRAME1.PAGE1.TXTF05.VISIBLE=.F.	      		
		      THISFORM.PAGEFRAME1.PAGE1.TXTF07.VISIBLE=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF08.VISIBLE=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF18.VISIBLE=.F.	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF22.VISIBLE=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF23.VISIBLE=.F.
		      THISFORM.PAGEFRAME1.PAGE1.TXTF25.VISIBLE=.F.		      
		      THISFORM.PAGEFRAME1.PAGE1.TXTF28.VISIBLE=IIF(S05_1.F28='A' OR S05_1.F28='B'  OR S05_1.F28='C' OR  S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.F.,.T.)		      	          
		      THISFORM.PAGEFRAME1.PAGE1.TXTF29.VISIBLE=.F.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VISIBLE=.T.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VISIBLE=.T.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX08.VISIBLE=.T.      
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.VISIBLE=.T.     
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.VISIBLE=.T.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.VISIBLE=.T.
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX25.VISIBLE=.T.	 
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VISIBLE=IIF(S05_1.F28='A' OR S05_1.F28='B'  OR S05_1.F28='C' OR S05_1.F28='2' OR S05_1.F28='4' OR S05_1.F28='9',.T.,.F.)		      	          
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.VISIBLE=.T.			      
		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=IIF(S05_1.F03='M',1,2)
		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=IIF(S05_1.F15='M',1,IIF(S05_1.F15='D',2,3))
		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=IIF(S05_1.F27=.T.,1,2)	
		      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE=VAL(S05_1.F30)
		      THISFORM.PAGEFRAME1.PAGE1.TXTF34.VALUE=S05_1.F34
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE+SPACE(5)+ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX08.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE	
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE=STR(THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.DISPLAYVALUE=STR(THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.DISPLAYVALUE=STR(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE)
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX25.DISPLAYVALUE=THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=IIF(S05_1.F28='A',1,IIF(S05_1.F28='B',2,IIF(S05_1.F28='C',3,IIF(S05_1.F28='2',4,IIF(S05_1.F28='4',5,6)))))
		      THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.DISPLAYVALUE=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE)+SPACE(4)+ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF291.CAPTION)
		      THISFORM.PAGEFRAME1.PAGE1.LBLF991.CAPTION=''	
		      THISFORM.PAGEFRAME1.PAGE1.TXTF02.SETFOCUS
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2                  
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.		      
		      THISFORM.PAGEFRAME1.PAGE2.TXTF06.READONLY=.T.    
		      THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.T.  
		      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''	  
		      THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS         
           CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3   	            
		      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
		      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.           	      
           	      THISFORM.PAGEFRAME1.PAGE3.TXTF06.READONLY=.T.   
           	      THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T. 
		      THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=''	 
		      THISFORM.PAGEFRAME1.PAGE3.TXTF08.SETFOCUS                 		      	      
    ENDCASE		      
    LOCK()
    IF !RLOCK()
         DO FILE_IMPACT
         RETURN
    ENDIF   
  ENDPROC    
**************
PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK   &&修改確認                 
  DO CASE    
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=1
 		     THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","RGB(58,186,152)","COLUMN")               
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.DISPLAYVALUE)
          		  =MESSAGEBOX('部門編號不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF   
	             IF SEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE,'A14')=.F. 
	           	  =MESSAGEBOX('部門主檔中無此編號請先建立!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.SETFOCUS
	          	  RETURN            
	       	     ENDIF       	 	        	 	     
		     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
          		  =MESSAGEBOX('姓名不得空白!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE1.TXTF02.SETFOCUS
          		  RETURN        	  
    	 	     ENDIF 
	    	     IF  THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE = 2  AND THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = 2 AND EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE)
	          	  =MESSAGEBOX('勞退選擇已選新制之自行提撥,故提撥比率不的為零!',0+64,'提示訊息視窗')
	          	  THISFORM.PAGEFRAME1.PAGE1.TXTF32.SETFOCUS
	          	  RETURN      
	    	     ENDIF        	 	     
    	             IF THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE<>6  &&判斷是否為外包人員  	 	     
			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE)
	          		  =MESSAGEBOX('到職日期不得空白!',0+64,'提示訊息視窗')
	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF09.SETFOCUS
	          		  RETURN
	    	 	     ENDIF	    	 	     
			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE)
	          		  =MESSAGEBOX('加保日期不得空白!',0+64,'提示訊息視窗')
	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF20.SETFOCUS
	          		  RETURN        	  
	    	 	     ENDIF
			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.DISPLAYVALUE)
	          		  =MESSAGEBOX('班別不得空白,若尚未建立班別請至S00.薪資參數中設定!',0+64,'提示訊息視窗')
	          		  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.SETFOCUS
	          		  RETURN        	  
	    	 	     ENDIF    	 
	    	    ENDIF
			     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE) <> .T. AND AT('@',THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE) = 0
	          		  =MESSAGEBOX('薪資E-MAIL格式不正確',0+64,'提示訊息視窗')
	          		  THISFORM.PAGEFRAME1.PAGE1.TXTF33.SETFOCUS
	          		  RETURN        	  
	    	 	 ENDIF		    	    	     	     
	    	    ***判斷發薪總類是否有變動,若變動則修改S06 薪資明細及扣款項目
    	 	    DO CASE 
    	 	          CASE  S05_1.F15='M' AND THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE<>1  
    	 	                      IF  MESSAGEBOX('是否確定將此人員之發薪種類已由月薪變更成'+IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'日薪','時薪')+',若確定則需修改薪資明細之金額',4+32+256,'請確認')=6 
    	 	                      	   SELECT S06
    	 	                      	   SET ORDER TO S061  && F01+F06+F07
    	 	                      	   SEEK S05_1.F01+'A'
    	 	                      	   IF FOUND()
    	 	                      	        REPLACE S06.F06 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'B','C')
    	 	                      	        REPLACE S06.F07 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'日薪','時薪')
    	 	                      	        REPLACE S06.F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入"+ALLTRIM(S06.F07)+"金額,最多七位數","請輸入",'0')),7))
    	 	                      	        REPLACE S06.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
					   ELSE
	    	 				SELECT S06
		    	 	 		APPEND BLANK
					        REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
					        REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
					        REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
					        REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
					        REPLACE F05 WITH '1'
					        REPLACE F06 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'B','C')
					        REPLACE F07 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'日薪','時薪')
					        REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入"+ALLTRIM(S06.F07)+"金額,最多七位數","請輸入",'0')),7))
					        REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
					   ENDIF    	    						       	 	                      	        
    	 	                      ELSE
    	 	                           THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1
    	 	                      ENDIF
    	 	          CASE  S05_1.F15='D' AND THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE<>2
    	 	                      IF  MESSAGEBOX('是否確定將此人員之發薪種類已由日薪變更成'+IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'底薪','時薪')+',若確定則需修改薪資明細之金額',4+32+256,'請確認')=6 
    	 	                      	   SELECT S06
    	 	                      	   SET ORDER TO S061  && F01+F06+F07
    	 	                      	   SEEK S05_1.F01+'B'
    	 	                      	   IF FOUND()
    	 	                      	        REPLACE S06.F06 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'A','C')
    	 	                      	        REPLACE S06.F07 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'底薪','時薪')
    	 	                      	        REPLACE S06.F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入"+ALLTRIM(S06.F07)+"金額,最多七位數","請輸入",'0')),7))
    	 	                      	        REPLACE S06.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
					   ELSE
	    	 				SELECT S06
		    	 	 		APPEND BLANK
					        REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
					        REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
					        REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
					        REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
					        REPLACE F05 WITH '1'
					        REPLACE F06 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'A','C')
					        REPLACE F07 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'底薪','時薪')
					        REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入"+ALLTRIM(S06.F07)+"金額,最多七位數","請輸入",'0')),7))
					        REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
					   ENDIF    
    	 	                      ELSE
    	 	                           THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2
    	 	                      ENDIF    	 	          
    	 	          CASE  S05_1.F15='T' AND THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE<>3
    	 	                      IF  MESSAGEBOX('是否確定將此人員之發薪種類已由時薪變更成'+IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'底薪','日薪')+',若確定則需修改薪資明細之金額',4+32+256,'請確認')=6 
    	 	                      	   SELECT S06
    	 	                      	   SET ORDER TO S061  && F01+F06+F07
    	 	                      	   SEEK S05_1.F01+'C'
    	 	                      	   IF FOUND()
    	 	                      	        REPLACE S06.F06 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'A','B')
    	 	                      	        REPLACE S06.F07 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'底薪','日薪')
    	 	                      	        REPLACE S06.F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入"+ALLTRIM(S06.F07)+"金額,最多七位數","請輸入",'0')),7))
    	 	                      	        REPLACE S06.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
					   ELSE
	    	 				SELECT S06
		    	 	 		APPEND BLANK
					        REPLACE F01 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE)
					        REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
					        REPLACE F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
					        REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
					        REPLACE F05 WITH '1'
					        REPLACE F06 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'A','B')
					        REPLACE F07 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'底薪','日薪')
					        REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入"+ALLTRIM(S06.F07)+"金額,最多七位數","請輸入",'0')),7))
					        REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
					   ENDIF    
    	 	                      ELSE
    	 	                           THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=3
    	 	                      ENDIF    	 	          
    	 	    ENDCASE

*!*			    *********S10 薪資計算作業           
*!*		            FILE_NAME=ALLTRIM('S10'+LEFT(DTOS(S05_1.F10),6)+'.DBF')
*!*		            S10=ALLTRIM('S10'+LEFT(DTOS(S05_1.F10),6))
*!*			    IF  FILE('&FILE_NAME')=.T.    
*!*		                 IF !USED('&S10')
*!*		                     SELECT  0
*!*		                     USE (S10) ALIA S10
*!*		                 ELSE
*!*		                     SELECT  S10
*!*		                 ENDIF
*!*	                         SELECT  RECNO() FROM S10 WHERE S10.F01=S05_1.F01  AND S10.F98='N' INTO ARRAY BK1             
*!*	                         JJ1=''                
*!*	                         IF _TALLY>0   
*!*	                             FOR I= 1 TO ALEN(BK1)
*!*	                                     JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
*!*	                             ENDFOR    
*!*	                             KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
*!*	                             RLOCK(KK1,'S10')
*!*	                             LL1=RLOCK(KK1,'S10')
*!*	                         ELSE
*!*	                             LL1=.T.   
*!*	                         ENDIF                   
*!*	                         IF LL1=.T. AND LEN(ALLTRIM(JJ1))>0  	 	    
*!*			             SELECT S10
*!*	                             FOR I= 1 TO ALEN(BK1)                      
*!*	                                     GO BK1(I) 		
*!*			                     REPLACE S10.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)  	 	     
*!*				             REPLACE S10.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)       		    	                      
*!*				             REPLACE S10.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)       
*!*				     ENDFOR
*!*				 ENDIF      
*!*				 SELECT S10
*!*				 USE    
*!*			   ENDIF
		   RELEASE ALL LIKE BK* 
		   ********
		   SELECT  S05_1   
		   IF RLOCK()
		   	***中文姓名與部門有變動時
                         IF ALLTRIM(S05_1.F02)<>ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE) OR  ALLTRIM(S05_1.F05)<>ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
				    IF !USED('S50')	&&公司人員基本資料(表頭)
				        SELE 0
				        USE S50 
				    ELSE
				        SELE S50
				    ENDIF    		                   
		                   SELECT  RECNO() FROM S50 WHERE ALLTRIM(S50.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S50.F01) INTO ARRAY BK0              
		                   JJ0=''               
		                   IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK0)
		                             JJ0=JJ0+ALLTRIM(STR(BK0(I)))+','
		                      ENDFOR    
		                      KK0=STUFF(JJ0,RAT(',',JJ0,1),1,'')              
		                      RLOCK(KK0,'S50')
		                      LL0=RLOCK(KK0,'S50')
		                  ELSE
		                      LL0=.T.   
		                  ENDIF                   
		                  IF LL0=.T. .AND. LEN(ALLTRIM(JJ0))>0  	 	    
		                      SELECT S50
		                      FOR I= 1 TO ALEN(BK0)                      
		                             GO BK0(I) 
		                             REPLACE S50.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                             REPLACE S50.F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE) 
		                      ENDFOR       
		                  ENDIF 
		                  SELECT S50
		                  USE
		                  ****                         
				    IF !USED('S51')	&&公司人員基本資料(表身)
				        SELE 0
				        USE S51 
				    ELSE
				        SELE S51
				    ENDIF    		                   
		                   SELECT  RECNO() FROM S51 WHERE ALLTRIM(S51.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S51.F01) INTO ARRAY BK1              
		                   JJ1=''               
		                   IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK1)
		                             JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
		                      ENDFOR    
		                      KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
		                      RLOCK(KK1,'S51')
		                      LL1=RLOCK(KK1,'S51')
		                  ELSE
		                      LL1=.T.   
		                  ENDIF                   
		                  IF LL1=.T. .AND. LEN(ALLTRIM(JJ1))>0  	 	    
		                      SELECT S51
		                      FOR I= 1 TO ALEN(BK1)                      
		                             GO BK1(I) 
		                             REPLACE S51.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                      ENDFOR       
		                  ENDIF 
		                  SELECT S51
		                  USE
		                  ****
				    IF !USED('S52')	&&人事訓練登錄資料
				        SELE 0
				        USE S52 
				    ELSE
				        SELE S52
				    ENDIF		                  
		                  SELECT  RECNO() FROM S52 WHERE ALLTRIM(S52.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S52.F01) INTO ARRAY BK2              
		                  JJ2=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK2)
		                              JJ2=JJ2+ALLTRIM(STR(BK2(I)))+','
		                      ENDFOR    
		                      KK2=STUFF(JJ2,RAT(',',JJ2,1),1,'')              
		                      RLOCK(KK2,'S52')
		                      LL2=RLOCK(KK2,'S52')
		                  ELSE
		                      LL2=.T.   
		                  ENDIF                   
		                  IF LL2=.T. .AND. LEN(ALLTRIM(JJ2))>0  	 	    
		                      SELECT S52
		                      FOR I= 1 TO ALEN(BK2)                      
		                             GO BK2(I) 
		                             REPLACE S52.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                      ENDFOR       
		                  ENDIF   
		                  SELECT S52
		                  USE                        
			     *****
			     IF !USED('S0A')	&&年度缺勤紀錄檔
				  SELE 0
				  USE S0A
			     ELSE
				   SELE S0A
			     ENDIF
		             SELECT  RECNO() FROM S0A WHERE ALLTRIM(S0A.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S0A.F01) INTO ARRAY BKA             
		             JJA=''                
		             IF _TALLY>0   
		                 FOR I= 1 TO ALEN(BKA)
		                         JJA=JJA+ALLTRIM(STR(BKA(I)))+','
		                 ENDFOR    
		                 KKA=STUFF(JJA,RAT(',',JJA,1),1,'')              
		                 RLOCK(KKA,'S0A')
		                 LLA=RLOCK(KKA,'S0A')
		             ELSE
		                 LLA=.T.   
		             ENDIF                   
		             IF LLA=.T. AND LEN(ALLTRIM(JJA))>0  	 	    
				 SELECT S0A
		                 FOR I= 1 TO ALEN(BKA)                      
		                         GO BKA(I) 	
				         REPLACE S0A.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)      		    
				         REPLACE S0A.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)   	 	     
				         REPLACE S0A.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)	
				  ENDFOR
			      ENDIF	       	
			      SELECT S0A
			      USE	    	 
				  ****
				  IF !USED('S0B')	&&年假記錄檔
				        SELECT  0
				        USE S0B
				  ELSE 
				        SELECT  S0B
				  ENDIF
				  SET ORDER TO S0B1 	
		                  SELECT  RECNO() FROM S0B WHERE ALLTRIM(S0B.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S0B.F01) INTO ARRAY BKB              
		                  JJB=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BKB)
		                              JJB=JJB+ALLTRIM(STR(BKB(I)))+','
		                      ENDFOR    
		                      KKB=STUFF(JJB,RAT(',',JJB,1),1,'')              
		                      RLOCK(KKB,'S0B')
		                      LLB=RLOCK(KKB,'S0B')
		                  ELSE
		                      LLB=.T.   
		                  ENDIF                   
		                  IF LLB=.T. .AND. LEN(ALLTRIM(JJB))>0  	 	    
		                      SELECT S0B
		                      FOR I= 1 TO ALEN(BKB)                      
		                             GO BKB(I) 
		                             REPLACE S0B.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                      ENDFOR       
		                  ENDIF   		  
				  SELECT S0B
				  USE			      	    
		    	      *********S06 薪資明細及扣款項目
		                    SELECT  RECNO() FROM S06 WHERE ALLTRIM(S06.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S06.F01) INTO ARRAY BK6              
		                    JJ6=''                
		                    IF _TALLY>0   
		                        FOR I= 1 TO ALEN(BK6)
		                                JJ6=JJ6+ALLTRIM(STR(BK6(I)))+','
		                        ENDFOR    
		                        KK6=STUFF(JJ6,RAT(',',JJ6,1),1,'')              
		                        RLOCK(KK6,'S06')
		                        LL6=RLOCK(KK6,'S06')
		                    ELSE
		                        LL6=.T.   
		                    ENDIF                   
		                    IF LL6=.T. AND LEN(ALLTRIM(JJ6))>0  	 	    
				        SELECT S06
		                        FOR I= 1 TO ALEN(BK6)                      
		                               GO BK6(I) 		         		    		    
				               REPLACE S06.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)      		    
				               REPLACE S06.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE) 	 	     
				               REPLACE S06.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				        ENDFOR 
				    ENDIF     
				    *********S07 調薪修改作業
				    IF !USED('S07')
				        SELE 0
				        USE S07 
				    ELSE
				        SELE S07
				    ENDIF    
		                    SELECT  RECNO() FROM S07 WHERE ALLTRIM(S07.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S07.F01) INTO ARRAY BK7              
		                    JJ7=''                
		                    IF _TALLY>0   
		                        FOR I= 1 TO ALEN(BK7)
		                                JJ7=JJ7+ALLTRIM(STR(BK7(I)))+','
		                        ENDFOR    
		                        KK7=STUFF(JJ7,RAT(',',JJ7,1),1,'')              
		                        RLOCK(KK7,'S07')
		                        LL7=RLOCK(KK7,'S07')
		                    ELSE
		                        LL7=.T.   
		                    ENDIF                   
		                    IF LL7=.T. AND LEN(ALLTRIM(JJ7))>0  	 	    
				        SELECT S07
		                        FOR I= 1 TO ALEN(BK7)                      
		                               GO BK7(I) 		    
					       REPLACE S07.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE) 		    
					       REPLACE S07.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)  	 	     
					       REPLACE S07.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION) 	  
					 ENDFOR
				    ENDIF	         
				    SELECT S07
				    USE
				    *********S08 懲處作業 
				    IF !USED('S08')
				        SELE 0
				        USE S08 
				    ELSE
				        SELE S08
				    ENDIF    		    
		                    SELECT  RECNO() FROM S08 WHERE ALLTRIM(S08.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S08.F01) INTO ARRAY BK8              
		                    JJ8=''                
		                    IF _TALLY>0   
		                        FOR I= 1 TO ALEN(BK8)
		                                JJ8=JJ8+ALLTRIM(STR(BK8(I)))+','
		                        ENDFOR    
		                        KK8=STUFF(JJ8,RAT(',',JJ8,1),1,'')              
		                        RLOCK(KK8,'S08')
		                        LL8=RLOCK(KK8,'S08')
		                    ELSE
		                        LL8=.T.   
		                    ENDIF                   
		                    IF LL8=.T. AND LEN(ALLTRIM(JJ8))>0  	 	    
				        SELECT S08
		                        FOR I= 1 TO ALEN(BK8)                      
		                               GO BK8(I) 	
					       REPLACE S08.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)      		    
					       REPLACE S08.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE) 	 	     
					       REPLACE S08.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION) 	    
					ENDFOR
				    ENDIF	      
				    SELECT S08
				    USE 
				    *********S09 其他所得發放作業
				    IF !USED('S09')
				        SELE 0
				        USE S09 
				    ELSE
				        SELE S09
				    ENDIF    		    
		                    SELECT  RECNO() FROM S09 WHERE ALLTRIM(S09.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S09.F01) INTO ARRAY BK9              
		                    JJ9=''                
		                    IF _TALLY>0   
		                        FOR I= 1 TO ALEN(BK9)
		                                JJ9=JJ9+ALLTRIM(STR(BK9(I)))+','
		                        ENDFOR    
		                        KK9=STUFF(JJ9,RAT(',',JJ9,1),1,'')              
		                        RLOCK(KK9,'S09')
		                        LL9=RLOCK(KK9,'S09')
		                    ELSE
		                        LL9=.T.   
		                    ENDIF                   
		                    IF LL9=.T. AND LEN(ALLTRIM(JJ9))>0  	 	    
				        SELECT S09
		                        FOR I= 1 TO ALEN(BK9)                      
		                               GO BK9(I) 	
					       REPLACE S09.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
					       REPLACE S09.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)      
					       REPLACE S09.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)	
					ENDFOR 
				    ENDIF	      	    
				    SELECT S09
				    USE
				   **** 
				  IF !USED('S11')	&&薪資月報表
				        SELECT  0
				        USE S11
				  ELSE 
				        SELECT  S11
				  ENDIF
				  SET ORDER TO S111                  
		                  SELECT  RECNO() FROM S11 WHERE ALLTRIM(S11.F02)=ALLTRIM(S05_1.F01) AND !EMPTY(S11.F02) INTO ARRAY BK11              
		                  JJ11=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK11)
		                              JJ11=JJ11+ALLTRIM(STR(BK11(I)))+','
		                      ENDFOR    
		                      KK11=STUFF(JJ11,RAT(',',JJ11,1),1,'')              
		                      RLOCK(KK11,'S11')
		                      LL11=RLOCK(KK11,'S11')
		                  ELSE
		                      LL11=.T.   
		                  ENDIF                   
		                  IF LL11=.T. .AND. LEN(ALLTRIM(JJ11))>0  	 	    
		                      SELECT S11
		                      FOR I= 1 TO ALEN(BK11)                      
		                             GO BK11(I) 
		                             REPLACE S11.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                             REPLACE S11.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		                             REPLACE S11.F05 WITH IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)+SPACE(1),'A14'),A14.F02,'')
		                      ENDFOR       
		                  ENDIF   		  
				  SELECT S11
				  USE
				  ***		     
				  IF !USED('S12')	&&特殊其他所得發放作業 
				        SELECT  0
				        USE S12
				  ELSE 
				        SELECT  S12
				  ENDIF
				  SET ORDER TO S121 
		                  SELECT  RECNO() FROM S12 WHERE ALLTRIM(S12.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S12.F01) INTO ARRAY BK12              
		                  JJ12=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK12)
		                              JJ12=JJ12+ALLTRIM(STR(BK12(I)))+','
		                      ENDFOR    
		                      KK12=STUFF(JJ12,RAT(',',JJ12,1),1,'')              
		                      RLOCK(KK12,'S12')
		                      LL12=RLOCK(KK12,'S12')
		                  ELSE
		                      LL12=.T.   
		                  ENDIF                   
		                  IF LL12=.T. .AND. LEN(ALLTRIM(JJ12))>0  	 	    
		                      SELECT S12
		                      FOR I= 1 TO ALEN(BK12)                      
		                             GO BK12(I) 
		                             REPLACE S12.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                             REPLACE S12.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		                             REPLACE S12.F04 WITH IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)+SPACE(1),'A14'),A14.F02,'')
		                      ENDFOR       
		                  ENDIF   		  
				  SELECT S12
				  USE
				  ***			  
				  IF !USED('S13')	&&各項部門作業人員記錄檔
				        SELECT  0
				        USE S13
				  ELSE 
				        SELECT  S13
				  ENDIF
				  SET ORDER TO S131 	
		                  SELECT  RECNO() FROM S13 WHERE ALLTRIM(S13.F04)=ALLTRIM(S05_1.F01) AND !EMPTY(S13.F04) INTO ARRAY BK13
		                  JJ13=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK13)
		                              JJ13=JJ13+ALLTRIM(STR(BK13(I)))+','
		                      ENDFOR    
		                      KK13=STUFF(JJ13,RAT(',',JJ13,1),1,'')              
		                      RLOCK(KK13,'S13')
		                      LL13=RLOCK(KK13,'S13')
		                  ELSE
		                      LL13=.T.   
		                  ENDIF                   
		                  IF LL13=.T. .AND. LEN(ALLTRIM(JJ13))>0  	 	    
		                      SELECT S13
		                      FOR I= 1 TO ALEN(BK13)                      
		                             GO BK13(I) 
		                             REPLACE S13.F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                      ENDFOR       
		                  ENDIF   		  
				  SELECT S13
				  USE
				  ***			  	                      
				  IF !USED('S14')	&&年度出勤紀錄檔
				        SELECT  0
				        USE S14
				  ELSE 
				        SELECT  S14
				  ENDIF
				  SET ORDER TO S141 	
		                  SELECT  RECNO() FROM S14 WHERE ALLTRIM(S14.F01)=ALLTRIM(S05_1.F01) AND !EMPTY(S14.F01)  INTO ARRAY BK14
		                  JJ14=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK14)
		                              JJ14=JJ14+ALLTRIM(STR(BK14(I)))+','
		                      ENDFOR    
		                      KK14=STUFF(JJ14,RAT(',',JJ14,1),1,'')              
		                      RLOCK(KK14,'S14')
		                      LL14=RLOCK(KK14,'S14')
		                  ELSE
		                      LL14=.T.   
		                  ENDIF                   
		                  IF LL14=.T. .AND. LEN(ALLTRIM(JJ14))>0  	 	    
		                      SELECT S14
		                      FOR I= 1 TO ALEN(BK14)                      
		                             GO BK14(I) 
		                             REPLACE S14.F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                             REPLACE S14.F03 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		                             REPLACE S14.F04 WITH IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)+SPACE(1),'A14'),A14.F02,'')
		                      ENDFOR       
		                  ENDIF   		  
				  SELECT S14
				  USE
				  ***	  
				  IF !USED('S17')	&&上下班變更作業
				        SELECT  0
				        USE S17
				  ELSE 
				        SELECT  S17
				  ENDIF
				  SET ORDER TO S171 		
		                  SELECT  RECNO() FROM S17 WHERE ALLTRIM(S17.F03)=ALLTRIM(S05_1.F01) AND !EMPTY(S17.F03)  INTO ARRAY BK17
		                  JJ17=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK17)
		                              JJ17=JJ17+ALLTRIM(STR(BK17(I)))+','
		                      ENDFOR    
		                      KK17=STUFF(JJ17,RAT(',',JJ17,1),1,'')              
		                      RLOCK(KK17,'S17')
		                      LL17=RLOCK(KK17,'S17')
		                  ELSE
		                      LL17=.T.   
		                  ENDIF                   
		                  IF LL17=.T. .AND. LEN(ALLTRIM(JJ17))>0  	 	    
		                      SELECT S17
		                      FOR I= 1 TO ALEN(BK17)                      
		                             GO BK17(I) 
		                             REPLACE S17.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                             REPLACE S17.F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		                             REPLACE S17.F06 WITH IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)+SPACE(1),'A14'),A14.F02,'')
		                      ENDFOR       
		                  ENDIF   		  
				  SELECT S17
				  USE
				  ***			  	   
				  IF !USED('S18')	&&請假作業
				        SELECT  0
				        USE S18
				  ELSE 
				        SELECT  S18
				  ENDIF
				  SET ORDER TO S181 	
		                  SELECT  RECNO() FROM S18 WHERE ALLTRIM(S18.F03)=ALLTRIM(S05_1.F01) AND !EMPTY(S18.F03)  INTO ARRAY BK18
		                  JJ18=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK18)
		                              JJ18=JJ18+ALLTRIM(STR(BK18(I)))+','
		                      ENDFOR    
		                      KK18=STUFF(JJ18,RAT(',',JJ18,1),1,'')              
		                      RLOCK(KK18,'S18')
		                      LL18=RLOCK(KK18,'S18')
		                  ELSE
		                      LL18=.T.   
		                  ENDIF                   
		                  IF LL18=.T. .AND. LEN(ALLTRIM(JJ18))>0  	 	    
		                      SELECT S18
		                      FOR I= 1 TO ALEN(BK18)                      
		                             GO BK18(I) 
		                             REPLACE S18.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                             REPLACE S18.F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		                             REPLACE S18.F06 WITH IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)+SPACE(1),'A14'),A14.F02,'')
		                      ENDFOR       
		                  ENDIF   		  
				  SELECT S18
				  USE
				  ***			  	   
				  IF !USED('S19')	&&加班申請(修改)作業
				        SELECT  0
				        USE S19
				  ELSE 
				        SELECT  S19
				  ENDIF
				  SET ORDER TO S191 	                  
		                  SELECT  RECNO() FROM S19 WHERE ALLTRIM(S19.F03)=ALLTRIM(S05_1.F01) AND !EMPTY(S19.F03) INTO ARRAY BK19
		                  JJ19=''               
		                  IF _TALLY>0   
		                      FOR I= 1 TO ALEN(BK19)
		                              JJ19=JJ19+ALLTRIM(STR(BK19(I)))+','
		                      ENDFOR    
		                      KK19=STUFF(JJ19,RAT(',',JJ19,1),1,'')              
		                      RLOCK(KK19,'S19')
		                      LL19=RLOCK(KK19,'S19')
		                  ELSE
		                      LL19=.T.   
		                  ENDIF                   
		                  IF LL19=.T. .AND. LEN(ALLTRIM(JJ19))>0  	 	    
		                      SELECT S19
		                      FOR I= 1 TO ALEN(BK19)                      
		                             GO BK19(I) 
		                             REPLACE S19.F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		                             REPLACE S19.F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		                             REPLACE S19.F06 WITH IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)+SPACE(1),'A14'),A14.F02,'')
		                      ENDFOR       
		                  ENDIF   		  
				  SELECT S19
				  USE
		                 RELEASE ALL LIKE BK* 
		         ENDIF
		         **
		         SELECT S05_1
		         REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE)
		         REPLACE F03 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.VALUE=1,'M','F')
		         REPLACE F04 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF04.VALUE
		         REPLACE F05 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE)
		         REPLACE F06 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
		         REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE
		         REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE
		         REPLACE F11 WITH ABS(THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE)
		         REPLACE F12 WITH ABS(THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE)
		         REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF13.VALUE
		         REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF14.VALUE	
		         REPLACE F15 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1,'M',IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2,'D','T')) 
		         REPLACE F17 WITH THISFORM.PAGEFRAME1.PAGE1.SPINNER17.VALUE
		         REPLACE F19 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF19.VALUE
		         REPLACE F20 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE
		         REPLACE F21 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF21.VALUE		         
		         REPLACE F24 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF24.VALUE
		         REPLACE F25 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE
		         REPLACE F26 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF26.VALUE	
 	                 DO CASE
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=1
 	                        	    REPLACE F28 WITH 'A'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=2
 	                        	    REPLACE F28 WITH 'B'
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=3
 	                        	    REPLACE F28 WITH 'C' 	 
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=4
 	                        	    REPLACE F28 WITH '2' 	
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=5
 	                        	    REPLACE F28 WITH '4' 	 
 	                        CASE  THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE=6
 	                        	    REPLACE F28 WITH '9'
 	                 ENDCASE			         
		         REPLACE F29 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE     
		         REPLACE F30 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.VALUE))
		         REPLACE F34 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF34.VALUE
		         REPLACE F31 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE))
		         REPLACE F32 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = 1  OR THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE <> 2,0,THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE)		         
		         REPLACE F33 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF33.VALUE
		         REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
		         IF A02.F09<>'*'
		         	REPLACE F27 WITH .T.
		         ELSE	
		         	REPLACE F27 WITH IIF(THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.VALUE=1,.T.,.F.)
		         ENDIF		
		         *******勞退新制自行提撥金額	
			 IF !EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE) OR THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = 2 OR  S05_1.F18 <> VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE)) 
		    	SELECT S06
		    	SET ORDER TO S061
		    	SEEK S05_1.F01 + 'O' + '勞退自行提撥金額' 	&&勞退自行提撥金額
			    IF FOUND()
				   S06_F08 = S06.F08
				   REPLACE F08 WITH ROUND(VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE)) * (THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE / 100),0)
				   REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				   IF EMPTY(S06.F08)
				      DELETE 
				   ENDIF	
	    		ELSE
		    	   S06_F08 = 0
		    	   SELECT S06
		    	   APPEND BLANK
				   REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
				   REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
				   REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
				   REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
				   REPLACE F05 WITH '2'
				   REPLACE F06 WITH 'O'
				   REPLACE F07 WITH '勞退自行提撥金額'
				   REPLACE F08 WITH ROUND(VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE)) * (THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE / 100),0)
				   REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				   IF EMPTY(S06.F08)
				      DELETE 
				   ENDIF	
	    		ENDIF
		        **若金額不相同則加入S07A.調薪修改作業中
		        IF S06_F08<>0 AND S06_F08<>S06.F08
		           IF !USED('S07')	 &&S07 調薪修改作業
				      SELECT  0
			   	      USE S07 
			       ELSE
				      SELE S07
				   ENDIF
				   SELECT S07
				   APPEND BLANK 
				   REPLACE S07.F01 WITH S06.F01
				   REPLACE S07.F02 WITH S06.F02
				   REPLACE S07.F03 WITH S06.F03
				   REPLACE S07.F04 WITH S06.F04
				   REPLACE S07.F05 WITH DATE()
				   REPLACE S07.F06 WITH '2'
				   REPLACE S07.F07 WITH '2'
				   REPLACE S07.F08 WITH '勞退自行提撥金額調整'
				   REPLACE S07.F09 WITH '勞退自行提撥金額'
				   REPLACE S07.F11 WITH S06.F08-S06_F08
				   REPLACE S07.F12 WITH S06_F08
				   REPLACE S07.F13 WITH S06.F08
				   REPLACE S07.F14 WITH 'Y'
				   REPLACE S07.F15 WITH '1'
				   REPLACE S07.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				   SELECT S06
				   REPLACE S06.F09 WITH S07.F05
				   REPLACE S06.F10 WITH S07.F08
				   SELECT S07
				   USE
		         ENDIF	    		       
			 ENDIF	
			 SELECT  S05_1  	          
		         **判斷勞保投保金額是否有變動
			 IF S05_1.F18<>VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE)) 
			    REPLACE S05_1.F18 WITH VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE))
			    ******ROUND(投保金額*(勞工保險普通事故費率+勞工就業保險費率)*勞工負擔比率/30天*30天,0)
*!*			             LOPO=ROUND(S05_1.F18*((IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F02,0)+IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F06,0))/100)*(IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F03,0)/100)/30*30,0)
				LOPO = IIF(SEEK(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.DISPLAYVALUE) + '30','S04'),S04.F04,0)
		        SELECT S06
		        SET ORDER TO S061	&& F01+F06+F07
		        SEEK S05_1.F01+'J'+'勞保費'  &&勞保費		
		        IF FOUND()
		           S06_F08 = S06.F08
		           IF SINPO <> S06.F08	 
			          REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入勞保費金額,最多七位數","請輸入",ALLTRIM(STR(LOPO)))),7))
			          REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		           
			          IF EMPTY(S06.F08)
			    	     DELETE 
			          ENDIF	
			       ENDIF   
			    ELSE
			       S06_F08=0
			       SELECT S06
			       APPEND BLANK
			       REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
			       REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
			       REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
			       REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
			       REPLACE F05 WITH '2'
			       REPLACE F06 WITH 'J'
			       REPLACE F07 WITH '勞保費'
			       REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入勞保費金額,最多七位數","請輸入",ALLTRIM(STR(LOPO)))),7))
			       REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			       IF EMPTY(S06.F08)
			    	  DELETE 
			       ENDIF			           	 		    	        
		        ENDIF
		           **若金額不相同則加入S07A.調薪修改作業中
		           IF SINPO <> 0 AND SINPO <> S06_F08
		              IF !USED('S07')	 &&S07 調薪修改作業
				         SELECT  0
			   	         USE S07 
			          ELSE
				         SELE S07
				      ENDIF
				      SELECT S07
				      APPEND BLANK 
					  REPLACE S07.F01 WITH S06.F01
					  REPLACE S07.F02 WITH S06.F02
					  REPLACE S07.F03 WITH S06.F03
					  REPLACE S07.F04 WITH S06.F04
					  REPLACE S07.F05 WITH DATE()
					  REPLACE S07.F06 WITH '2'
					  REPLACE S07.F07 WITH '2'
					  REPLACE S07.F08 WITH LEFT(ALLTRIM(INPUTBOX("請輸入變更說明,最多15個中文字","請輸入",'勞保費調整')),30)
					  IF EMPTY(ALLTRIM(S07.F08))
					     REPLACE S07.F08 WITH '勞保費調整'
					  ENDIF
					  REPLACE S07.F09 WITH '勞保費'
					  REPLACE S07.F11 WITH S06.F08-S06_F08
					  REPLACE S07.F12 WITH S06_F08
					  REPLACE S07.F13 WITH S06.F08
					  REPLACE S07.F14 WITH 'Y'
					  REPLACE S07.F15 WITH '1'
					  REPLACE S07.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
					  SELECT S06
					  REPLACE S06.F09 WITH S07.F05
					  REPLACE S06.F10 WITH S07.F08
					  SELECT S07
					  USE
		           ENDIF	  		             
			 ENDIF 
			 ***判斷健保投保金額,眷口人數及健保等級是否有變動  S05_1.F16<>THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE OR
			 SELECT  S05_1  
	         IF S05_1.F22<>VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.DISPLAYVALUE)) OR;
	            S05_1.F23<>VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.DISPLAYVALUE))
*!*		            REPLACE S05_1.F16 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE
	            REPLACE S05_1.F22 WITH VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.DISPLAYVALUE))
	            REPLACE S05_1.F23 WITH VAL(ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.DISPLAYVALUE))
	            ***眷口人數大於不扣款之眷口數則為0,否則為 ROUND(投保金額*(全民健康保險費率)*(被保險人及眷屬月負擔金額比率),0)*(眷口人數+本人)
	            PEOP = IIF(S05_1.F16 >= IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F06,0),S01.F06 - 1,S05_1.F16) &&不扣款之眷口數
	            PEOP1 = PEOP
	            SINPO1 = ROUND(S05_1.F23 * (IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F02,0) / 100) * (IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F03,0) / 100),0)
	            SINPO = SINPO1 * (PEOP + 1)
	            IF PEOP > 0
	               DIS = 0
	               SELECT S01.F12,S01.F13,S01.F14,S01.F15,S01.F16,S01.F18,0000 AS PE FROM S01 WHERE S01.F01 ='Z' AND S01.F12 = S05_1.F01 INTO CURSOR S01_A READWRITE 
	               SELECT S01_A
	               INDEX ON S01_A.F18 TAG S01_A1
	               INDEX ON DTOS(S01_A.F16) + S01_A.F14 TAG S01_A2
	               SET ORDER TO S01_A1
	               GO TOP
	               ***先判斷是否為殘障
	               DO WHILE !EOF() AND PEOP1 <> 0
	                  DO CASE
	                     CASE S01_A.F18 = '0'	&&重度殘障 
	                     	  REPLACE S01_A.PE WITH ROUND(SINPO1 * (S01.F09 / 100),0)
	                     CASE S01_A.F18 = '1'	&&中度殘障 
	                     	  REPLACE S01_A.PE WITH ROUND(SINPO1 * (S01.F10 / 100),0)
	                     CASE S01_A.F18 = '2'	&&輕度殘障 
	                          REPLACE S01_A.PE WITH ROUND(SINPO1 * (S01.F11 / 100),0)
	                  ENDCASE
	                  PEOP1 = PEOP1 - 1
	                  SELECT S01_A
	                  SKIP
	               ENDDO
	               **在判斷設籍地是否有補助65歲(含)以上老人,且設籍須滿一年(含)  INT((DATE() - S01_A.F16) / 365) >= 65
	               PEOP1 = PEOP
	               SELECT S01_A
	               SET ORDER TO S01_A2
	               GO TOP
	               DO WHILE !EOF() AND PEOP1 <> 0
	                  IF S01_A.PE = 0 AND S01_A.F15 = 0 AND IIF(SEEK('Y' + S01_A.F14,'S01'),S01.F15,0) = 1 AND (YEAR(DATE()) - YEAR(S01_A.F16)) >= 65 AND MONTH(DATE()) >= MONTH(S01_A.F16) AND DAY(DATE()) >= DAY(S01_A.F16)	&&非殘障+設籍一年+有補助+大於等於65歲以上
	                     REPLACE S01_A.PE WITH IIF(SEEK('B','S01'),S01.F08,0)
	                  ENDIF
	                  PEOP1 = PEOP1 - 1
	                  SELECT S01_A
	                  SKIP
	               ENDDO
	               ***相加每一眷屬可扣繳之保費
	               PEOP1 = PEOP
	               SELECT S01_A
	               GO TOP
	               DO WHILE !EOF() AND PEOP1 <> 0
	                  SINPO = SINPO - S01_A.PE
	                  PEOP1 = PEOP1 - 1
	                  SELECT S01_A
	                  SKIP
	               ENDDO
	               SELECT S01_A
	               USE 
	            ENDIF
	            SELECT S06
	            SET ORDER TO S061	&& F01+F06+F07
	            SEEK S05_1.F01+'K'+'健保費'  &&健保費
	            IF FOUND()
	               S06_F08 = S06.F08
	               IF SINPO <> S06.F08
		    	      REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入健保費金額,最多七位數","請輸入",ALLTRIM(STR(SINPO)))),7))
		    	      REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
   				      IF EMPTY(S06.F08)
		    	         DELETE 
		    	      ENDIF   
		    	   ENDIF	 
			    ELSE
			       S06_F08 = 0
			       SELECT S06
			       APPEND BLANK 
			       REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
			       REPLACE F02 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
			       REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE
			       REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION)
			       REPLACE F05 WITH '2'
			       REPLACE F06 WITH 'K'
			       REPLACE F07 WITH '健保費'
			       REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入健保費金額,最多七位數","請輸入",ALLTRIM(STR(SINPO)))),7))
			       REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		
			       IF EMPTY(S06.F08)
			          DELETE 
			       ENDIF 
		        ENDIF
	            **若金額不相同則加入S07A.調薪修改作業中
	            IF SINPO <> 0 AND SINPO <> S06_F08
	               IF !USED('S07')	 &&S07 調薪修改作業
			    	  SELECT  0
		   	     	  USE S07 
		           ELSE
			          SELECT S07
				   ENDIF
				   SELECT S07
				   APPEND BLANK 
				   REPLACE S07.F01 WITH S06.F01
				   REPLACE S07.F02 WITH S06.F02
				   REPLACE S07.F03 WITH S06.F03
				   REPLACE S07.F04 WITH S06.F04
				   REPLACE S07.F05 WITH DATE()
				   REPLACE S07.F06 WITH '2'
				   REPLACE S07.F07 WITH '2'
				   REPLACE S07.F08 WITH LEFT(ALLTRIM(INPUTBOX("請輸入變更說明,最多15個中文字","請輸入",'健保費調整')),30)
				   IF EMPTY(ALLTRIM(S07.F08))
				      REPLACE S07.F08 WITH '健保費調整'
				   ENDIF				 
				   REPLACE S07.F09 WITH '健保費'
				   REPLACE S07.F11 WITH S06.F08-S06_F08
				   REPLACE S07.F12 WITH S06_F08
				   REPLACE S07.F13 WITH S06.F08
				   REPLACE S07.F14 WITH 'Y'
				   REPLACE S07.F15 WITH '1'
				   REPLACE S07.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
				   SELECT S06
				   REPLACE S06.F09 WITH S07.F05
				   REPLACE S06.F10 WITH S07.F08
				   SELECT S07
				   USE
		        ENDIF
		     ENDIF  		         
		     ****  
		     SELECT S05
	         SET ORDER TO S051
	         SEEK S05_1.F01
	         IF FOUND()
			    REPLACE F02 WITH S05_1.F02
			    REPLACE F03 WITH S05_1.F03
			    REPLACE F04 WITH S05_1.F04
			    REPLACE F05 WITH S05_1.F05
			    REPLACE F06 WITH S05_1.F06
			    REPLACE F07 WITH S05_1.F07
			    REPLACE F08 WITH S05_1.F08
			    REPLACE F09 WITH S05_1.F09
			    REPLACE F10 WITH S05_1.F10
			    REPLACE F11 WITH S05_1.F11
			    REPLACE F12 WITH S05_1.F12
			    REPLACE F13 WITH S05_1.F13
			    REPLACE F14 WITH S05_1.F14
			    REPLACE F15 WITH S05_1.F15
			    REPLACE F16 WITH S05_1.F16
			    REPLACE F17 WITH S05_1.F17
			    REPLACE F18 WITH S05_1.F18
			    REPLACE F19 WITH S05_1.F19
			    REPLACE F20 WITH S05_1.F20
			    REPLACE F21 WITH S05_1.F21
			    REPLACE F22 WITH S05_1.F22
			    REPLACE F23 WITH S05_1.F23
			    REPLACE F24 WITH S05_1.F24
			    REPLACE F25 WITH S05_1.F25
			    REPLACE F26 WITH S05_1.F26
			    REPLACE F27 WITH S05_1.F27
	 	        REPLACE F28 WITH S05_1.F28
			    REPLACE F29 WITH S05_1.F29
			    REPLACE F30 WITH S05_1.F30
			    REPLACE F34 WITH S05_1.F34
			    REPLACE F31 WITH S05_1.F31
			    REPLACE F32 WITH S05_1.F32
			    REPLACE F33 WITH S05_1.F33
			    REPLACE F99 WITH S05_1.F99
	         ENDIF
		  ELSE
		     DO FILE_IMPACT
		     RETURN   
		  ENDIF 
		  SELECT S05_1  
		  THISFORM.GRID1.SETFOCUS 
		  SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE		    
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=2   	  	
    	 	    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE)
          		   =MESSAGEBOX('薪資所得不得為零!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE2.TXTF08.SETFOCUS
          		  RETURN
          	    ENDIF       
		    SELE S06          
		    IF RLOCK()	
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE
		         REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		    	         			    
		    ELSE
		          DO FILE_IMPACT
		          RETURN   
		    ENDIF 
		    THISFORM.GRID2.SETFOCUS 
         CASE  THISFORM.PAGEFRAME1.ACTIVEPAGE=3     
    	 	     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE)
          		   =MESSAGEBOX('扣款金額不得為零!',0+64,'提示訊息視窗')
          		  THISFORM.PAGEFRAME1.PAGE3.TXTF08.SETFOCUS
          		  RETURN
          	    ENDIF            	 	    
		    SELE S06          
		    IF RLOCK()	
		         SELECT S06
		         S06_F08=S06.F08		        
		         REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE
		         REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')			    
		         **若金額不相同則加入S07A.調薪修改作業中
		         IF S06_F08<>S06.F08		
		             IF !USED('S07')	 &&S07 調薪修改作業
				 SELECT  0
			   	 USE S07 
			     ELSE
			         SELE S07
			     ENDIF
			     SELECT S07
			     APPEND BLANK 
			     REPLACE S07.F01 WITH S06.F01
			     REPLACE S07.F02 WITH S06.F02
			     REPLACE S07.F03 WITH S06.F03
			     REPLACE S07.F04 WITH S06.F04
			     REPLACE S07.F05 WITH DATE()
			     REPLACE S07.F06 WITH '2'
			     REPLACE S07.F07 WITH '2'
			     REPLACE S07.F08 WITH LEFT(ALLTRIM(INPUTBOX("請輸入變更說明,最多15個中文字","請輸入",ALLTRIM(S06.F07)+'調整')),30)
			     IF EMPTY(ALLTRIM(S07.F08))
				 REPLACE S07.F08 WITH ALLTRIM(S06.F07)+'調整'
			     ENDIF				     
			     REPLACE S07.F09 WITH ALLTRIM(S06.F07)
			     REPLACE S07.F11 WITH S06.F08-S06_F08
			     REPLACE S07.F12 WITH S06_F08
			     REPLACE S07.F13 WITH S06.F08
			     REPLACE S07.F14 WITH 'Y'
			     REPLACE S07.F15 WITH '1'
			     REPLACE S07.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			     SELECT S06
			     REPLACE S06.F09 WITH S07.F05
			     REPLACE S06.F10 WITH S07.F08
			     SELECT S07
			     USE
		         ENDIF			         
		    ELSE
		          DO FILE_IMPACT
		          RETURN   
		    ENDIF	   
		    THISFORM.GRID2.SETFOCUS 		      		          	    
   ENDCASE		              
   THISFORM.SHRGROUP.ABANDON_BOTT.CLICK      
ENDPROC   
*************
PROC ORPGROUP.DEL_BOTT.CLICK                    &&刪除資料程序
 IF  MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認')=6 
     DO CASE
        CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1
             SELECT RECNO() FROM S06 WHERE S06.F01=S05_1.F01 INTO ARRAY BK6              
             JJ6=''               
             IF _TALLY>0   
                FOR I= 1 TO ALEN(BK6)
                    JJ6=JJ6+ALLTRIM(STR(BK6(I)))+','
                ENDFOR    
                KK6=STUFF(JJ6,RAT(',',JJ6,1),1,'')              
                RLOCK(KK6,'S06')
                LL6=RLOCK(KK6,'S06')
             ELSE
                LL6=.T.   
             ENDIF                 
             IF LL6=.T. AND LEN(ALLTRIM(JJ6))>0  	 	    
                SELECT S06
                FOR I= 1 TO ALEN(BK6)                      
                    GO BK6(I) 	            
	                DELETE 
	            ENDFOR
    		 ENDIF  
    		 **刪除眷口補助清單   
    		 IF S05.F16 > 0
                SELECT RECNO() FROM S01 WHERE S01.F01 = 'Z' AND S01.F12 = S05_1.F01 INTO ARRAY BK1              
                JJ1=''               
                IF _TALLY>0   
                   FOR I= 1 TO ALEN(BK1)
                       JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
                   ENDFOR    
                   KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
                   RLOCK(KK1,'S01')
                   LL1=RLOCK(KK1,'S01')
                ELSE
                   LL1=.T.   
                ENDIF                   
                IF LL1=.T. AND LEN(ALLTRIM(JJ1))>0  	 	    
                   SELECT S01
                   FOR I= 1 TO ALEN(BK1)                      
                       GO BK1(I) 	            
	                   DELETE 
	               ENDFOR
    		    ENDIF   
    		 ENDIF 
    		 **		        
    		 SELECT S05A_SEEK
    		 SEEK S05_1.F01
    		 IF FOUND()
    		    DELETE 
    		 ENDIF    		       
    		 SELECT S05_1
         	 LOCK()
         	 IF RLOCK()
         	    SELECT S05
         	    SET ORDER TO S051
         	    SEEK S05_1.F01
         	    IF FOUND()
         	       DELETE 
         	    ENDIF
         	    SELECT S05_1
         	    DELETE 
         	    UNLOCK
         	    SKIP -1
         	    IF BOF()
         	       GO TOP
         	    ENDIF  
		     ELSE
		        DO FILE_IMPACT
		     ENDIF
		     RELEASE ALL LIKE BK* 
		     THISFORM.GRID1.SETFOCUS   
        CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2
     	     SELECT S06
     	     LOCK()
     	     IF RLOCK()
     	        DO CASE
     	           CASE S06.F06='A'
     	       	        =MESSAGEBOX('底薪不得刪除!',0+64,'提示訊息視窗')
     	       	   CASE S06.F06='B'
     	       	        =MESSAGEBOX('日薪不得刪除!',0+64,'提示訊息視窗')
     	       	   CASE S06.F06='C'
     	       	        =MESSAGEBOX('時薪不得刪除!',0+64,'提示訊息視窗')
     	       	   OTHERWISE         	       	          
         	       	    DELETE 
	         	        UNLOCK
	         	        SKIP -1
	         	        IF BOF()
	         	           GO TOP
	         	        ENDIF  
     	        ENDCASE
		     ELSE
		        DO FILE_IMPACT
		     ENDIF
		     THISFORM.GRID2.SETFOCUS 	
        CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3
     	     SELECT S06
     	     LOCK()
     	     IF RLOCK()
     	        DELETE 
     	        UNLOCK
     	        SKIP -1
     	        IF BOF()
     	           GO TOP
     	        ENDIF  
	         ELSE
		        DO FILE_IMPACT
		     ENDIF	
		     THISFORM.GRID2.SETFOCUS 
     ENDCASE   
  ENDIF
*!*	  THISFORM.REFRESH	       
ENDPROC  
****************
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')   
      THISFORM.SETALL('VISIBLE',.T.,'TEXTBOX')       
      THISFORM.SETALL('READONLY',.T.,'SPINNER')    		          		                            
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.
      THISFORM.PAGEFRAME1.PAGE3.ENABLED=.T.         
       DO CASE 
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=1   
       	          THISFORM.GRID1.ENABLED=.T.
                  THISFORM.GRID2.ENABLED=.T. 
       	     	  THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","","COLUMN")
		        THISFORM.PAGEFRAME1.PAGE1.TXTF05.READONLY=.T.
		        THISFORM.PAGEFRAME1.PAGE1.TXTF09.READONLY=.T.
		        THISFORM.PAGEFRAME1.PAGE1.TXTF11.READONLY=.T.
		        THISFORM.PAGEFRAME1.PAGE1.TXTF12.READONLY=.T.	
		        THISFORM.PAGEFRAME1.PAGE1.TXTF28.READONLY=.T.	    
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP03.ENABLED=.F. 
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.ENABLED=.F.     
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP27.ENABLED=.F.
		        THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP30.ENABLED=.F. 
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX05.VISIBLE=.F.		              
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX07.VISIBLE=.F.	     
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX08.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX18.VISIBLE=.F.     
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX25.VISIBLE=.F. 
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VISIBLE=.F.
		        THISFORM.PAGEFRAME1.PAGE1.COMBOBOX29.VISIBLE=.F.
		        THISFORM.GRID1.SETFOCUS    
      			THISFORM.KEY_LIST.ENABLED=.T.  	
      			IF THISFORM.GRID1.ACTIVEROW=0
      			   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.
	               THISFORM.PAGEFRAME1.PAGE3.ENABLED=.F.
	             ENDIF      	        
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=2
       	     	        THISFORM.GRID2.ENABLED=.T. 
       	     		THISFORM.PAGEFRAME1.PAGE2.TXTF06.VISIBLE=.T.
		        THISFORM.COMBOBOX06.VISIBLE=.F.         	     
       	     		THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.T.
		        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.   
       			THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=SALARY_CLASS(S06.F06)
       			THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S06.F07
			   	THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=S06.F08   		 
			   	THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S06.F99 
				THISFORM.GRID2.SETFOCUS 	
       	     CASE THISFORM.PAGEFRAME1.ACTIVEPAGE=3
       	                THISFORM.GRID2.ENABLED=.T. 	
       	     		THISFORM.PAGEFRAME1.PAGE3.TXTF06.VISIBLE=.T.
		        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX06.VISIBLE=.F.         	     	                     
		        THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.  
		        THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.  
			   	THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=SALARY_CLASS(S06.F06)
			   	THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=S06.F07    
			   	THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=S06.F08   	   			 
			   	THISFORM.PAGEFRAME1.PAGE3.LBLF991.CAPTION=S06.F99
		        THISFORM.GRID2.SETFOCUS   		        
      ENDCASE	       
*!*	      THISFORM.REFRESH   
      UNLOCK ALL          
  ENDPROC
**********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
    SELECT S05_1
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO S05_11
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO S05_12
         ENDCASE   
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
*******眷口補助清單
  PROCEDURE TAIPEI_BOTT.CLICK
     SELECT S01.F12 FROM S01 WHERE S01.F01 ='Z' AND S01.F12 = S05_1.F01 INTO CURSOR A_TEMP
     S05_F16 = RECCOUNT('A_TEMP')	&&健保補助眷口人數
     SELECT A_TEMP
     USE       
 	 SELECT S01.F12,S01.F13,S01.F14,S01.F15,S01.F16,S01.F17,S01.F18,S01.F99 FROM S01 WHERE S01.F01 = 'Z' AND S01.F12 = S05_1.F01 INTO CURSOR S01_TEMP READWRITE 
 	 INDEX ON ALLTRIM(S01_TEMP.F13) + ALLTRIM(S01_TEMP.F14) + DTOS(S01_TEMP.F16) TAG S01_TEMP1
 	 SET ORDER TO S01_TEMP1 	 
 	 SELECT S01_TEMP
 	 GO TOP      
     TAIPEI_LIST = CREATEOBJECT("TAIPEI_LIST")  
     TAIPEI_LIST.SHOW    
     SELECT S05_1       
     REPLACE S05_1.F16 WITH S05_F16          
     THISFORM.GRID1.SETFOCUS     
  ENDPROC    
****************薪資類別
PROC COMBOBOX06.CLICK
    THISFORM.COMBOBOX06.CLEAR
    THIS.ADDITEM('')       
    DO CASE
       CASE THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1 
            THIS.ADDITEM('底薪')
       CASE THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2 
            THIS.ADDITEM('日薪')
       CASE THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=3 
            THIS.ADDITEM('時薪')
    ENDCASE
    THIS.ADDITEM('伙食費')         
    THIS.ADDITEM('交通費')
    THIS.ADDITEM('全勤獎金')
    THIS.ADDITEM('職務津貼')
    THIS.ADDITEM('自訂項目')
 ENDPROC     
***************
PROC ANS_BOTT.CLICK     &&重算年假作業     
     IF MESSAGEBOX('是否要將年假做年度重算,重算後年假將重新計算(重算年度:'+ALLTRIM(STR(YEAR(DATE())-1911))+'年)',4+32+256,'請確認')=6  
        IF !USED('S0B')   &&年假記錄檔
   	       SELECT 0
  	       USE S0B 
	    ELSE
   	       SELECT S0B
	    ENDIF	 
	    SELECT S0A.F01,S0A.F02,SUM(S0A.F07) FROM S0A WHERE S0A.F05='A1' AND YEAR(S0A.F08) = YEAR(DATE()) GROUP BY S0A.F01 INTO CURSOR S0A_TE READWRITE 
	    INDE ON F01 TAG S0A_TE1
	    SELECT S0A.F01,S0A.F02,SUM(S0A.F07) FROM S0A WHERE S0A.F05='A1' AND YEAR(S0A.F08) = (YEAR(DATE()) - 1) GROUP BY S0A.F01 INTO CURSOR S0A_TEMP READWRITE 
	    SELECT S0A_TEMP
	    INDE ON F01 TAG S0A_TEMP1
	    INDE ON F02 TAG S0A_TEMP2
        SELECT S00
	    SET ORDER TO S001
	    SEEK 'F'  &&年假參數
	    IF FOUND()
	       SENIORITY_MAX=S00.F21 &&最大年資
	       SENIORITY_ADD=S00.F22 &&每年增加年假天數
	       VACATION_MAX=S00.F23  &&年假最高之給假天數
	       METHOD1=S00.F24 	 	 &&未滿一年計算方式一:未滿一年之年假給予天數
	       METHOD2=S00.F25 		 &&未滿一年計算方式二:未滿一年年假天數x到職月數
	    ELSE
	       SENIORITY_MAX=0
	       SENIORITY_ADD=0
	       VACATION_MAX=0
	       METHOD1=0
	       METHOD2=0
	    ENDIF    
	    ****把未重算前之年假記錄到S0B
	    SELECT S05_1
	    GO TOP
	    DO WHILE !EOF()
	       SELECT S0B
	       SET ORDER TO S0B1
	       SEEK S05_1.F01 + ALLTRIM(STR(YEAR(DATE())-1))
	       IF FOUND()
	          REPLACE S0B.F04 WITH S05_1.F11
	          SELECT S0A_TEMP
	          SET ORDER TO S0A_TEMP1
	          SEEK S05_1.F01
	          IF FOUND()
	             REPLACE S0B.F05 WITH S0A_TEMP.SUM_F07
	          ELSE
	             SELECT S0A_TEMP
	             SET ORDER TO S0A_TEMP2
	             SEEK S05_1.F02
	             IF FOUND()
	                REPLACE S0B.F05 WITH S0A_TEMP.SUM_F07
	             ENDIF
	          ENDIF   
	       ELSE     
	          SELECT S0B
	          APPEND BLANK 
	          REPLACE S0B.F01 WITH S05_1.F01
	          REPLACE S0B.F02 WITH S05_1.F02
	          REPLACE S0B.F03 WITH ALLTRIM(STR(YEAR(DATE())-1))
	          REPLACE S0B.F04 WITH S05_1.F11    
	          SELECT S0A_TEMP
	          SET ORDER TO S0A_TEMP1
	          SEEK S05_1.F01
	          IF FOUND()
	             REPLACE S0B.F05 WITH S0A_TEMP.SUM_F07
	          ELSE
	             SELECT S0A_TEMP
	             SET ORDER TO S0A_TEMP2
	             SEEK S05_1.F02
	             IF FOUND()
	                REPLACE S0B.F05 WITH S0A_TEMP.SUM_F07
	             ENDIF
	          ENDIF  	                  
	       ENDIF
	       SELECT S05_1
	       SKIP
	    ENDDO         	 
	    SELECT S0B
	    USE
	    ****
        SELECT F18,F19,F20 FROM S00 WHERE F01='E'  ORDER BY F18,F19 INTO CURSOR S00_TEMP  &&起止年資範圍之年假可休天數
        SELECT S05_1
	    GO TOP
	    DO WHILE !EOF()
	       REPLACE S05_1.F12 WITH 0  &&已休年假皆重新開始紀錄
	       IF S05_1.F28='1' OR S05_1.F28='3' OR S05_1.F28='7' OR S05_1.F28='8' OR S05_1.F28='9'  OR EMPTY(S05_1.F09) &&判斷是否1:已離職3:留職停薪7:退休8:資遣9:外包人員,若符合則年假歸零
	          REPLACE S05_1.F11 WITH 0
	       ELSE
	  	      IF YEAR(DATE())-YEAR(S05_1.F09)<=1  &&任職未滿一年之可休年假天數
	  	         IF (DATE()-S05_1.F09)<=0  OR  YEAR(DATE())=YEAR(S05_1.F09) &&判斷是否為目前年度是否小於到職年度,若為真則表示"系統日期有誤"
	  	            REPLACE S05_1.F11 WITH 0
	  	         ELSE
		            DO CASE
			           CASE METHOD1=0 AND  METHOD2=0    &&若未設定未滿一年之計算方式一與計算方式二則歸零
			                REPLACE S05_1.F11 WITH 0	                    
			           CASE METHOD1<>0				    &&未滿一年之計算方式一：直接給予年假天數
			     	        REPLACE S05_1.F11 WITH  METHOD1	             	    	       
			           CASE METHOD2<>0				    &&未滿一年計算方式二：ROUND((給予年假天數/12)*(12-到職月份),0)
			     	        REPLACE S05_1.F11 WITH ROUND((METHOD2/12)*(12-MONTH(S05_1.F09)),0)    
		            ENDCASE
		         ENDIF
		      ELSE 				       &&任職滿一年以上可休年假天數
		         SENIORITY_RANG=YEAR(DATE())-YEAR(S05_1.F09)  &&目前年度-到職年度  
		         SELECT S00_TEMP 
		         GO TOP
		         DO WHILE !EOF()  &&起止年資範圍之年假可休天數
		            F20_TEMP=S00_TEMP.F20  &&最後一筆給假天數
			        IF SENIORITY_RANG>=S00_TEMP.F18 AND SENIORITY_RANG<=S00_TEMP.F19  &&判斷年資範圍以便給予符合之年假天數
			      	   REPLACE S05_1.F11 WITH S00_TEMP.F20              	         
			        ENDIF
			        SELECT S00_TEMP
			        SKIP    
		          ENDDO
		          ****判斷  最大年資若不等於零 AND 是否超過最大年資限制
		          IF !EMPTY(SENIORITY_MAX) AND SENIORITY_RANG>=SENIORITY_MAX &&若是沒有符合的年資範圍則以最後一筆起止年資範圍之年假可休天數給假
			         SELECT S05_1
			         REPLACE S05_1.F11 WITH F20_TEMP+((SENIORITY_RANG-(SENIORITY_MAX-1))*SENIORITY_ADD)  &&最後一筆給假天數+(目前年資-(最大年資-1))*每年增加年假之天數		  
		          ENDIF     
		          ****判斷年假是否已超過最多不可超過之給假天數,若超過則以限定最多年假天數給予
		          IF S05_1.F11>VACATION_MAX  AND VACATION_MAX<>0
			         SELECT S05_1
			         REPLACE S05_1.F11 WITH VACATION_MAX  
		          ENDIF
	 	      ENDIF 
	 	   ENDIF
	 	   REPLACE S05_1.F12 WITH IIF(SEEK(S05_1.F01,'S0A_TEMP'),S0A_TEMP.SUM_F07,0)
	 	   SELECT S05_1
	 	   SKIP
	    ENDDO   
	    SELECT S00_TEMP
	    USE
	    SELECT S0A_TE
	    SET ORDER TO S0A_TE1
	    SELECT S05
	    SET ORDER TO S051
	    SELECT S05_1
	    GO TOP
	    DO WHILE !EOF()
	       SELECT S05
	       SEEK S05_1.F01
	       IF FOUND()
	          REPLACE S05.F11 WITH S05_1.F11
	          REPLACE S05.F12 WITH IIF(SEEK(S05_1.F01,'S0A_TE'),S0A_TE.SUM_F07,0)
	          REPLACE S05_1.F12 WITH S05.F12
	       ENDIF
	       SELECT S05_1
	       SKIP
	    ENDDO
	    SELECT S0A_TE
	    USE
	    SELECT S0A_TEMP
	    USE
	    =MESSAGEBOX('重算作業已完成!',0+64,'提示訊息視窗')   	
     ENDIF   
     SELECT S05_1
     SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
     THISFORM.GRID1.SETFOCUS 
  ENDPROC   
************************人員異動**********
 PROC CHANG_BOTT.CLICK
    SELECT S05_1
    LK=S05_1.F01
    CHANG_CHK=CREATEOBJECT("CHANG_CHK")  
    CHANG_CHK.SHOW
    THISFORM.GRID1.SETFOCUS 
    THISFORM.GRID1.REFRESH 
    THISFORM.GRID1.AFTERROWCOLCHANGE
   ENDPROC   
 ENDDEFINE      
  *************
*********************************************************
DEFINE CLASS CHANG_CHK AS FORM
  CAPTION='請輸入異動內容   員工姓名 '+S05_1.F02
  TOP=INT_015*200
  LEFT=INT_015*300  
  HEIGHT=INT_015*135
  WIDTH=INT_015*230
  FONTSIZE=INT_015*9  
  MOVABLE=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.  
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1  
  NAME='CHANG_CHK'
  ADD OBJECT LABELA AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*20,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.,;
      BACKCOLOR=RGB(255,255,0),;
      CAPTION='異動之人員可以更改新的員工編號'      
  ADD OBJECT LABEL1 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*41,;
      WIDTH=INT_015*50,;
      CAPTION='員工編號'          
  ADD OBJECT TXTF1 AS TEXTBOX WITH;           
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*34,;
       WIDTH=INT_015*75,;
       HEIGHT=INT_015*25,;
       MAXLENGTH=4
  ADD OBJECT LABEL10 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*70,;
      WIDTH=INT_015*50,;
      CAPTION='異動日期'          
  ADD OBJECT TXTF10 AS TEXTBOX WITH;           
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*64,;
       WIDTH=INT_015*75,;
       HEIGHT=INT_015*25          
  ADD OBJECT LABEL7 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*14,;
      TOP=INT_015*99,;
      WIDTH=INT_015*50,;
      CAPTION='異動項目'                
  ADD OBJECT COMBOBOX7 AS COMBOBOX WITH;
       VISIBLE=.T.,;
       LEFT=INT_015*64,;
       TOP=INT_015*93,;       
       HEIGHT=INT_015*25,;
       WIDTH=INT_015*75,;
       FONTSIZE=INT_015*9,;   
       BOUNDCOLUMN=1,;
       ROWSOURCETYPE=1,;
       STYLE=2,;    
       VALUE=1,;
       ROWSOURCE='離        職,留職停薪,職務調整,升        遷,退        休,資        遣',;
       NAME='COMBOBOX7'
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*35,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<Y.確定',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;
      TOP=INT_015*94,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'     
  *****    
 PROC INIT   
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')     
       THISFORM.TXTF1.VALUE=LK
       THISFORM.TXTF10.VALUE=DATE()
       THISFORM.COMBOBOX7.VALUE=1
       THISFORM.TXTF1.SETFOCUS 
 ENDPROC
 *****
   PROC CMND1.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND1.TOP=INT_015*36
             THISFORM.CMND1.LEFT=INT_015*166
  ENDPROC     
  PROC CMND1.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND1.TOP=INT_015*35
             THISFORM.CMND1.LEFT=INT_015*165                  
  ENDPROC     
  PROC CMND2.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND2.TOP=INT_015*95
             THISFORM.CMND2.LEFT=INT_015*166
  ENDPROC     
  PROC CMND2.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND2.TOP=INT_015*94
             THISFORM.CMND2.LEFT=INT_015*165               
  ENDPROC    
 *******   
 PROCEDURE CMND1.CLICK   
     IF  MESSAGEBOX('是否確定要異動此人員資料',4+32+256,'請確認')=6 
 	  IF  EMPTY(THISFORM.TXTF1.VALUE)
  		=MESSAGEBOX('員工編號不得空白!',0+64,'提示訊息視窗')
  		THISFORM.TXTF1.SETFOCUS   
  		RETURN	  
    	  ENDIF    
 	  IF  LEN(ALLTRIM(THISFORM.TXTF1.VALUE))<4
  		=MESSAGEBOX('員工編號不得少於四碼!',0+64,'提示訊息視窗')
  		THISFORM.TXTF1.SETFOCUS   
  		RETURN	  
    	  ENDIF      	  
    	  IF THISFORM.COMBOBOX7.VALUE <>  3 AND THISFORM.COMBOBOX7.VALUE <> 4  
    	       IF ALLTRIM(LK)=ALLTRIM(THISFORM.TXTF1.VALUE) 
  		   =MESSAGEBOX('員工編號不得與原先編號相同!',0+64,'提示訊息視窗')
  		   THISFORM.TXTF1.SETFOCUS   
  		   RETURN	
  	       ENDIF         	      
    	  ENDIF    	  
    	  IF ALLTRIM(LK)<>ALLTRIM(THISFORM.TXTF1.VALUE)
  	      IF INDEXSEEK(THISFORM.TXTF1.VALUE,.F.,'S05A_SEEK','S05A_SEEK1')=.T. 
  	           =MESSAGEBOX('此員工編號已存在S05.人事薪資基本檔中,請查明後在輸入!',0+64,'提示訊息視窗')
  	          THISFORM.TXTF1.SETFOCUS   
  	           RETURN	    	   
  	      ENDIF   
  	      IF INDEXSEEK(THISFORM.TXTF1.VALUE,.F.,'S05B_SEEK','S05B_SEEK1')=.T.	
  	           =MESSAGEBOX('此員工編號已存在S06.離職員工薪資基本檔中,請查明後在輸入!',0+64,'提示訊息視窗')
  	          THISFORM.TXTF1.SETFOCUS   
  	           RETURN	    	   
  	      ENDIF    	      
  	  ENDIF      	  
 	  IF  EMPTY(THISFORM.TXTF10.VALUE)
  		=MESSAGEBOX('異動日期不得空白!',0+64,'提示訊息視窗')
  		THISFORM.TXTF10.SETFOCUS   
  		RETURN	  
    	  ENDIF  
          SELECT S05
          SET ORDER TO S051
          SEEK LK
          IF FOUND()     
              S05_F28 = S05.F28
              REPLACE F01 WITH  ALLTRIM(THISFORM.TXTF1.VALUE)
              REPLACE F10 WITH  THISFORM.TXTF10.VALUE
              IF THISFORM.COMBOBOX7.VALUE<>3 AND THISFORM.COMBOBOX7.VALUE <> 4 
                   REPLACE F11 WITH 0
                   REPLACE F12 WITH 0
              ENDIF
              REPLACE F99 WITH  DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
              DO CASE
                     CASE THISFORM.COMBOBOX7.VALUE=1
                                REPLACE F28 WITH '1'                              
                     CASE THISFORM.COMBOBOX7.VALUE=2
                                REPLACE F28 WITH '3'
                     CASE THISFORM.COMBOBOX7.VALUE=3
                                REPLACE F28 WITH '5'                              
                     CASE THISFORM.COMBOBOX7.VALUE=4
                                REPLACE F28 WITH '6'                                
                     CASE THISFORM.COMBOBOX7.VALUE=5
                                REPLACE F28 WITH '7'       
                     CASE THISFORM.COMBOBOX7.VALUE=6
                                REPLACE F28 WITH '8' 
              ENDCASE      	    
              IF THISFORM.COMBOBOX7.VALUE <>  3 AND THISFORM.COMBOBOX7.VALUE <> 4     	  
                   SELECT S05_1
                   SET ORDER TO S05_11
                   SEEK LK
                   IF FOUND()     
   		       DELETE 
                   ENDIF     
                   SELECT S05B_SEEK
                   APPEND BLANK 
                   REPLACE S05B_SEEK.F01 WITH  ALLTRIM(THISFORM.TXTF1.VALUE)
                   SELECT S05A_SEEK
                   SEEK LK
                   IF FOUND()
                       DELETE 
                   ENDIF    
              ELSE
                   SELECT S05_1
                   SET ORDER TO S05_11
                   SEEK LK
                   IF FOUND()     
                       REPLACE S05_1.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
   		       REPLACE S05_1.F10 WITH S05.F10
   		       REPLACE S05_1.F28 WITH S05.F28
                   ENDIF                         
              ENDIF
              ****員工編號有變更與任職狀況有變更時
              IF ALLTRIM(LK)<>ALLTRIM(THISFORM.TXTF1.VALUE) OR S05_F28 <> S05.F28    
		  IF !USED('S50')	&&公司人員基本資料(表頭) 
		        SELECT  0
		        USE S50
		  ELSE 
		        SELECT  S50
		  ENDIF
		  SET ORDER TO S501 	              
           SELECT  RECNO() FROM S50 WHERE ALLTRIM(S50.F01)=ALLTRIM(LK) AND !EMPTY(S50.F01) INTO ARRAY BK0              
           JJ0=''               
           IF _TALLY>0   
              FOR I= 1 TO ALEN(BK0)
                     JJ0=JJ0+ALLTRIM(STR(BK0(I)))+','
              ENDFOR    
              KK0=STUFF(JJ0,RAT(',',JJ0,1),1,'')              
              RLOCK(KK0,'S50')
              LL0=RLOCK(KK0,'S50')
          ELSE
              LL0=.T.   
          ENDIF                   
          IF LL0=.T. .AND. LEN(ALLTRIM(JJ0))>0  	 	    
              SELECT S50
              FOR I= 1 TO ALEN(BK0)                      
                     GO BK0(I) 
                     REPLACE S50.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
                     REPLACE S50.F07 WITH S05.F28
                     REPLACE S50.F08 WITH S05.F10
              ENDFOR       
          ENDIF 
          SELECT S50
          USE
        ENDIF 
        ****
        ****員工編號有變更時
         IF ALLTRIM(LK)<>ALLTRIM(THISFORM.TXTF1.VALUE)        
		   IF !USED('S51')	&&公司人員基本資料(表身) 
		        SELECT  0
		        USE S51
		   ELSE 
		        SELECT  S51
		   ENDIF
		   SET ORDER TO S511 	                          
           SELECT  RECNO() FROM S51 WHERE ALLTRIM(S51.F01)=ALLTRIM(LK) AND !EMPTY(S51.F01) INTO ARRAY BK1              
           JJ1=''               
           IF _TALLY>0   
              FOR I= 1 TO ALEN(BK1)
                     JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
              ENDFOR    
              KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
              RLOCK(KK1,'S51')
              LL1=RLOCK(KK1,'S51')
          ELSE
              LL1=.T.   
          ENDIF                   
          IF LL1=.T. .AND. LEN(ALLTRIM(JJ1))>0  	 	    
              SELECT S51
              FOR I= 1 TO ALEN(BK1)                      
                     GO BK1(I) 
                     REPLACE S51.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF 
          SELECT S51
          USE
                  ****
		  IF !USED('S52')	&&人事訓練登錄資料
		        SELECT  0
		        USE S52
		  ELSE 
		        SELECT  S52
		  ENDIF
		  SET ORDER TO S521 	                      
          SELECT  RECNO() FROM S52 WHERE ALLTRIM(S52.F01)=ALLTRIM(LK) AND !EMPTY(S52.F01) INTO ARRAY BK2              
          JJ2=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK2)
                      JJ2=JJ2+ALLTRIM(STR(BK2(I)))+','
              ENDFOR    
              KK2=STUFF(JJ2,RAT(',',JJ2,1),1,'')              
              RLOCK(KK2,'S52')
              LL2=RLOCK(KK2,'S52')
          ELSE
              LL2=.T.   
          ENDIF                   
          IF LL2=.T. .AND. LEN(ALLTRIM(JJ2))>0  	 	    
              SELECT S52
              FOR I= 1 TO ALEN(BK2)                      
                     GO BK2(I) 
                     REPLACE S52.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   
          SELECT S52
          USE
                  ***
		  IF !USED('S0A')	&&年度缺勤紀錄檔
		        SELECT  0
		        USE S0A
		  ELSE 
		        SELECT  S0A
		  ENDIF
		  SET ORDER TO S0A1 	
          SELECT  RECNO() FROM S0A WHERE ALLTRIM(S0A.F01)=ALLTRIM(LK) AND !EMPTY(S0A.F01) INTO ARRAY BKA              
          JJA=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BKA)
                      JJA=JJA+ALLTRIM(STR(BKA(I)))+','
              ENDFOR    
              KKA=STUFF(JJA,RAT(',',JJA,1),1,'')              
              RLOCK(KKA,'S0A')
              LLA=RLOCK(KKA,'S0A')
          ELSE
              LLA=.T.   
          ENDIF                   
          IF LLA=.T. .AND. LEN(ALLTRIM(JJA))>0  	 	    
              SELECT S0A
              FOR I= 1 TO ALEN(BKA)                      
                     GO BKA(I) 
                     REPLACE S0A.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S0A
		  USE
		  ****
		  IF !USED('S0B')	&&年假記錄檔
		        SELECT  0
		        USE S0B
		  ELSE 
		        SELECT  S0B
		  ENDIF
		  SET ORDER TO S0B1 	
          SELECT  RECNO() FROM S0B WHERE ALLTRIM(S0B.F01)=ALLTRIM(LK) AND !EMPTY(S0B.F01) INTO ARRAY BKB              
          JJB=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BKB)
                      JJB=JJB+ALLTRIM(STR(BKB(I)))+','
              ENDFOR    
              KKB=STUFF(JJB,RAT(',',JJB,1),1,'')              
              RLOCK(KKB,'S0B')
              LLB=RLOCK(KKB,'S0B')
          ELSE
              LLB=.T.   
          ENDIF                   
          IF LLB=.T. .AND. LEN(ALLTRIM(JJB))>0  	 	    
              SELECT S0B
              FOR I= 1 TO ALEN(BKB)                      
                     GO BKB(I) 
                     REPLACE S0B.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S0B
		  USE	  
		  ****		  
		  IF !USED('S06')	&&薪資項目及扣款項目
		        SELECT  0
		        USE S06
		  ELSE 
		        SELECT  S06
		  ENDIF
		  SET ORDER TO S061
          SELECT  RECNO() FROM S06 WHERE ALLTRIM(S06.F01)=ALLTRIM(LK) AND !EMPTY(S06.F01) INTO ARRAY BK6              
          JJ6=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK6)
                      JJ6=JJ6+ALLTRIM(STR(BK6(I)))+','
              ENDFOR    
              KK6=STUFF(JJ6,RAT(',',JJ6,1),1,'')              
              RLOCK(KK6,'S06')
              LL6=RLOCK(KK6,'S06')
          ELSE
              LL6=.T.   
          ENDIF                   
          IF LL6=.T. .AND. LEN(ALLTRIM(JJ6))>0  	 	    
              SELECT S06
              FOR I= 1 TO ALEN(BK6)                      
                     GO BK6(I) 
                     REPLACE S06.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  ****			                        
		  IF !USED('S07')	&&調薪修改作業
		        SELECT  0
		        USE S07
		  ELSE 
		        SELECT  S07
		  ENDIF
		  SET ORDER TO S071  
          SELECT  RECNO() FROM S07 WHERE ALLTRIM(S07.F01)=ALLTRIM(LK) AND !EMPTY(S07.F01) INTO ARRAY BK7              
          JJ7=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK7)
                      JJ7=JJ7+ALLTRIM(STR(BK7(I)))+','
              ENDFOR    
              KK7=STUFF(JJ7,RAT(',',JJ7,1),1,'')              
              RLOCK(KK7,'S07')
              LL7=RLOCK(KK7,'S07')
          ELSE
              LL7=.T.   
          ENDIF                   
          IF LL7=.T. .AND. LEN(ALLTRIM(JJ7))>0  	 	    
              SELECT S07
              FOR I= 1 TO ALEN(BK7)                      
                     GO BK7(I) 
                     REPLACE S07.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S07
		  USE
		  ***		  
		  IF !USED('S08')	&&懲處作業
		        SELECT  0
		        USE S08
		  ELSE 
		        SELECT  S08
		  ENDIF
		  SET ORDER TO S081  
          SELECT  RECNO() FROM S08 WHERE ALLTRIM(S08.F01)=ALLTRIM(LK) AND !EMPTY(S08.F01) INTO ARRAY BK8              
          JJ8=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK8)
                      JJ8=JJ8+ALLTRIM(STR(BK8(I)))+','
              ENDFOR    
              KK8=STUFF(JJ8,RAT(',',JJ8,1),1,'')              
              RLOCK(KK8,'S08')
              LL8=RLOCK(KK8,'S08')
          ELSE
              LL8=.T.   
          ENDIF                   
          IF LL8=.T. .AND. LEN(ALLTRIM(JJ8))>0  	 	    
              SELECT S08
              FOR I= 1 TO ALEN(BK8)                      
                     GO BK8(I) 
                     REPLACE S08.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S08
		  USE
		  ***			  
		  IF !USED('S09')	&&其他所得發放作業
		        SELECT  0
		        USE S09
		  ELSE 
		        SELECT  S09
		  ENDIF
		  SET ORDER TO S091  	
          SELECT  RECNO() FROM S09 WHERE ALLTRIM(S09.F01)=ALLTRIM(LK) AND !EMPTY(S09.F01) INTO ARRAY BK9              
          JJ9=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK9)
                      JJ9=JJ9+ALLTRIM(STR(BK9(I)))+','
              ENDFOR    
              KK9=STUFF(JJ9,RAT(',',JJ9,1),1,'')              
              RLOCK(KK9,'S09')
              LL9=RLOCK(KK9,'S09')
          ELSE
              LL9=.T.   
          ENDIF                   
          IF LL9=.T. .AND. LEN(ALLTRIM(JJ9))>0  	 	    
              SELECT S09
              FOR I= 1 TO ALEN(BK9)                      
                     GO BK9(I) 
                     REPLACE S09.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S09
		  USE
		  ****		   		                   
		  IF !USED('S11')	&&薪資月報表
		        SELECT  0
		        USE S11
		  ELSE 
		        SELECT  S11
		  ENDIF
		  SET ORDER TO S111                  
          SELECT  RECNO() FROM S11 WHERE ALLTRIM(S11.F02)=ALLTRIM(LK) AND !EMPTY(S11.F02) INTO ARRAY BK11              
          JJ11=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK11)
                      JJ11=JJ11+ALLTRIM(STR(BK11(I)))+','
              ENDFOR    
              KK11=STUFF(JJ11,RAT(',',JJ11,1),1,'')              
              RLOCK(KK11,'S11')
              LL11=RLOCK(KK11,'S11')
          ELSE
              LL11=.T.   
          ENDIF                   
          IF LL11=.T. .AND. LEN(ALLTRIM(JJ11))>0  	 	    
              SELECT S11
              FOR I= 1 TO ALEN(BK11)                      
                     GO BK11(I) 
                     REPLACE S11.F02 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S11
		  USE
		  ***		     
		  IF !USED('S12')	&&特殊其他所得發放作業 
		        SELECT  0
		        USE S12
		  ELSE 
		        SELECT  S12
		  ENDIF
		  SET ORDER TO S121 
          SELECT  RECNO() FROM S12 WHERE ALLTRIM(S12.F01)=ALLTRIM(LK) AND !EMPTY(S12.F01) INTO ARRAY BK12              
          JJ12=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK12)
                      JJ12=JJ12+ALLTRIM(STR(BK12(I)))+','
              ENDFOR    
              KK12=STUFF(JJ12,RAT(',',JJ12,1),1,'')              
              RLOCK(KK12,'S12')
              LL12=RLOCK(KK12,'S12')
          ELSE
              LL12=.T.   
          ENDIF                   
          IF LL12=.T. .AND. LEN(ALLTRIM(JJ12))>0  	 	    
              SELECT S12
              FOR I= 1 TO ALEN(BK12)                      
                     GO BK12(I) 
                     REPLACE S12.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S12
		  USE
		  ***			  
		  IF !USED('S13')	&&各項部門作業人員記錄檔
		        SELECT  0
		        USE S13
		  ELSE 
		        SELECT  S13
		  ENDIF
		  SET ORDER TO S131 	
          SELECT  RECNO() FROM S13 WHERE ALLTRIM(S13.F04)=ALLTRIM(LK) AND !EMPTY(S13.F04) INTO ARRAY BK13
          JJ13=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK13)
                      JJ13=JJ13+ALLTRIM(STR(BK13(I)))+','
              ENDFOR    
              KK13=STUFF(JJ13,RAT(',',JJ13,1),1,'')              
              RLOCK(KK13,'S13')
              LL13=RLOCK(KK13,'S13')
          ELSE
              LL13=.T.   
          ENDIF                   
          IF LL13=.T. .AND. LEN(ALLTRIM(JJ13))>0  	 	    
              SELECT S13
              FOR I= 1 TO ALEN(BK13)                      
                     GO BK13(I) 
                     REPLACE S13.F04 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S13
		  USE
		  ***			  	                      
		  IF !USED('S14')	&&年度出勤紀錄檔
		        SELECT  0
		        USE S14
		  ELSE 
		        SELECT  S14
		  ENDIF
		  SET ORDER TO S141 	
          SELECT  RECNO() FROM S14 WHERE ALLTRIM(S14.F01)=ALLTRIM(LK) AND !EMPTY(S14.F01)  INTO ARRAY BK14
          JJ14=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK14)
                      JJ14=JJ14+ALLTRIM(STR(BK14(I)))+','
              ENDFOR    
              KK14=STUFF(JJ14,RAT(',',JJ14,1),1,'')              
              RLOCK(KK14,'S14')
              LL14=RLOCK(KK14,'S14')
          ELSE
              LL14=.T.   
          ENDIF                   
          IF LL14=.T. .AND. LEN(ALLTRIM(JJ14))>0  	 	    
              SELECT S14
              FOR I= 1 TO ALEN(BK14)                      
                     GO BK14(I) 
                     REPLACE S14.F01 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S14
		  USE
		  ***		  
		  IF !USED('S17')	&&上下班變更作業
		        SELECT  0
		        USE S17
		  ELSE 
		        SELECT  S17
		  ENDIF
		  SET ORDER TO S171 		
          SELECT  RECNO() FROM S17 WHERE ALLTRIM(S17.F03)=ALLTRIM(LK) AND !EMPTY(S17.F03)  INTO ARRAY BK17
          JJ17=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK17)
                      JJ17=JJ17+ALLTRIM(STR(BK17(I)))+','
              ENDFOR    
              KK17=STUFF(JJ17,RAT(',',JJ17,1),1,'')              
              RLOCK(KK17,'S17')
              LL17=RLOCK(KK17,'S17')
          ELSE
              LL17=.T.   
          ENDIF                   
          IF LL17=.T. .AND. LEN(ALLTRIM(JJ17))>0  	 	    
              SELECT S17
              FOR I= 1 TO ALEN(BK17)                      
                     GO BK17(I) 
                     REPLACE S17.F03 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S17
		  USE
		  ***			  	   
		  IF !USED('S18')	&&請假作業
		        SELECT  0
		        USE S18
		  ELSE 
		        SELECT  S18
		  ENDIF
		  SET ORDER TO S181 	
          SELECT  RECNO() FROM S18 WHERE ALLTRIM(S18.F03)=ALLTRIM(LK) AND !EMPTY(S18.F03)  INTO ARRAY BK18
          JJ18=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK18)
                      JJ18=JJ18+ALLTRIM(STR(BK18(I)))+','
              ENDFOR    
              KK18=STUFF(JJ18,RAT(',',JJ18,1),1,'')              
              RLOCK(KK18,'S18')
              LL18=RLOCK(KK18,'S18')
          ELSE
              LL18=.T.   
          ENDIF                   
          IF LL18=.T. .AND. LEN(ALLTRIM(JJ18))>0  	 	    
              SELECT S18
              FOR I= 1 TO ALEN(BK18)                      
                     GO BK18(I) 
                     REPLACE S18.F03 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S18
		  USE
		  ***			  	   
		  IF !USED('S19')	&&加班申請(修改)作業
		        SELECT  0
		        USE S19
		  ELSE 
		        SELECT  S19
		  ENDIF
		  SET ORDER TO S191 	                  
          SELECT  RECNO() FROM S19 WHERE ALLTRIM(S19.F03)=ALLTRIM(LK) AND !EMPTY(S19.F03) INTO ARRAY BK19
          JJ19=''               
          IF _TALLY>0   
              FOR I= 1 TO ALEN(BK19)
                      JJ19=JJ19+ALLTRIM(STR(BK19(I)))+','
              ENDFOR    
              KK19=STUFF(JJ19,RAT(',',JJ19,1),1,'')              
              RLOCK(KK19,'S19')
              LL19=RLOCK(KK19,'S19')
          ELSE
              LL19=.T.   
          ENDIF                   
          IF LL19=.T. .AND. LEN(ALLTRIM(JJ19))>0  	 	    
              SELECT S19
              FOR I= 1 TO ALEN(BK19)                      
                     GO BK19(I) 
                     REPLACE S19.F03 WITH ALLTRIM(THISFORM.TXTF1.VALUE)
              ENDFOR       
          ENDIF   		  
		  SELECT S19
		  USE
		  ***                  
           SELECT A01
           LOCATE FOR A01.F12 = LK
           IF FOUND()
               REPLACE A01.F12 WITH THISFORM.TXTF1.VALUE
           ENDIF
          RELEASE ALL LIKE BK*        		  
		  ***                               
          RELEASE ALL LIKE BK*    
          ENDIF    
              ***
      ENDIF  
          ***
    ENDIF                
   THISFORM.CMND2.CLICK     
  ENDPROC
 ***** 
  PROCEDURE CMND2.CLICK
      SELECT S05_1
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE  
**********************************補助眷口清單
DEFINE CLASS TAIPEI_LIST AS FORM
*!*	  AUTOCENTER=.T.
  TOP=INT_015*145
  LEFT=INT_015*120 
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*270
  WIDTH=INT_015*568
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.  
*!*	  MOVABLE=.F.  
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  CAPTION = '眷口補助人名清單'
  NAME='TAIPEI_LIST'
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOSIZE=.T.           
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*61,;
      LEFT=INT_015*260  
  ADD OBJECT GRID1 AS GRID WITH;          
      AUTOCENTER=.T.,;
      ALLOWCELLSELECTION=.F.,;
      TOP=INT_015*95,;
      WIDTH=INT_015*562,;      
      HEIGHT=INT_015*170,;  
      ROWHEIGHT=INT_015*18,;
      HEADERHEIGHT=INT_015*18,;          
      DELETEMARK=.F.,;
      READONLY=.T.,;
      RECORDSOURCETYPE=1,;
      COLUMNCOUNT=6,;  
      RECORDSOURCE='S01_TEMP',;           
      NAME='GRID1',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;      
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6'
 ADD OBJECT LABEL1 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*5,;
      TOP=INT_015*11,;
      WIDTH=INT_015*50,;
      CAPTION='眷屬姓名'    
 ADD OBJECT TXTF1 AS TEXTBOX  WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*60,;
      TOP=INT_015*7,;
      WIDTH=INT_015*75,;
      HEIGHT=INT_015*25,;  
      MAXLENGTH=10,; 
      NAME='TXTF1'   
 ADD OBJECT LABEL2 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*140,;
      TOP=INT_015*11,;
      WIDTH=INT_015*50,;
      CAPTION='設  籍  地'    
 ADD OBJECT TXTF2 AS TEXTBOX  WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*191,;
      TOP=INT_015*7,;
      WIDTH=INT_015*100,;
      HEIGHT=INT_015*25,;  
      NAME='TXTF2' 
 ADD OBJECT COMBOBOX2 AS COMBOBOX WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*191,;
      TOP=INT_015*7,;
      WIDTH=INT_015*100,;
      HEIGHT=INT_015*25,;      
      MAXLENGTH=10,; 
      ROWSOURCETYPE=1,;
      BOUNDCOLUMN=1,;
	  STYLE=2,;        
      NAME='COMBOBOX2'        
 ADD OBJECT LABEL3 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*295,;
      TOP=INT_015*11,;
      WIDTH=INT_015*50,;
      CAPTION='設籍時間'    
 ADD OBJECT OPTIONGROUP3 AS OPTIONGROUP WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*346,;
      TOP=INT_015*7,;
	  HEIGHT=INT_015*25,;
	  WIDTH=INT_015*218,;
	  BUTTONCOUNT=2,;
	  VALUE=1,;
	  ENABLED=.F.,;
	  NAME='OPTIONGROUP3',;
	  OPTION1.CAPTION='超過一年(含)',;
	  OPTION1.TOP=INT_015*5,;
	  OPTION1.FONTSIZE=INT_015*9,;	  
	  OPTION1.AUTOSIZE=.T.,;
	  OPTION1.LEFT=INT_015*5,;
	  OPTION1.NAME='OPTION1',;
	  OPTION2.CAPTION='未滿一年',;
	  OPTION2.TOP=INT_015*5,;
	  OPTION2.FONTSIZE=INT_015*9,;  
	  OPTION2.AUTOSIZE=.T.,;
	  OPTION2.LEFT=INT_015*145,;
	  OPTION2.NAME='OPTION2'                                               
 ADD OBJECT LABEL4 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*5,;
      TOP=INT_015*38,;
      WIDTH=INT_015*70,;
      CAPTION='出生日期'   
 ADD OBJECT TXTF4 AS TEXTBOX WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*60,;
      TOP=INT_015*33,;
      WIDTH=INT_015*75,;
      HEIGHT=INT_015*25,;  
      NAME='TXTF4'          
 ADD OBJECT LABEL5 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*140,;
      TOP=INT_015*38,;
      WIDTH=INT_015*50,;
      CAPTION='身份字號'     
 ADD OBJECT TXTF5 AS TEXTBOX WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*191,;
      TOP=INT_015*33,;
      WIDTH=INT_015*100,;
      HEIGHT=INT_015*25,;      
      MAXLENGTH=20,;    
      NAME='TXTF5'     
 ADD OBJECT LABEL6 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*295,;
      TOP=INT_015*38,;
      WIDTH=INT_015*50,;
      CAPTION='是否殘障'     
 ADD OBJECT OPTIONGROUP6 AS OPTIONGROUP WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*346,;
      TOP=INT_015*33,;
	  HEIGHT=INT_015*26,;
	  WIDTH=INT_015*218,;
	  BUTTONCOUNT=2,;
	  VALUE=1,;
	  ENABLED=.F.,;
	  NAME='OPTIONGROUP6',;
	  OPTION1.CAPTION='是',;
	  OPTION1.TOP=INT_015*5,;
	  OPTION1.FONTSIZE=INT_015*9,;	  
	  OPTION1.AUTOSIZE=.T.,;
	  OPTION1.LEFT=INT_015*5,;
	  OPTION1.NAME='OPTION1',;
	  OPTION2.CAPTION='否',;
	  OPTION2.TOP=INT_015*5,;
	  OPTION2.FONTSIZE=INT_015*9,;  
	  OPTION2.AUTOSIZE=.T.,;
	  OPTION2.LEFT=INT_015*145,;
	  OPTION2.NAME='OPTION2'        
 ADD OBJECT COMBOBOX6 AS COMBOBOX WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*389,;
      TOP=INT_015*35,;
      WIDTH=INT_015*80,;
      HEIGHT=INT_015*23,;      
      MAXLENGTH=10,; 
      ROWSOURCETYPE=1,;
      BOUNDCOLUMN=1,;
	  STYLE=2,;        
      NAME='COMBOBOX6'    	              
 ADD OBJECT LABEL99 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*5,;
      TOP=INT_015*70,;
      WIDTH=INT_015*50,;
      CAPTION='安全資料'  
 ADD OBJECT LABEL991 AS LABEL WITH;
      VISIBLE=.T.,;
      LEFT=INT_015*60,;
      TOP=INT_015*70,;
      AUTOSIZE=.T.,;
      CAPTION=''        
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*397,;
      TOP=INT_015*65,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<N.新增',;
      TOOLTIPTEXT='新增資料!快速鍵->ALT+N' 
      NAME='CMND1'  
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*439,;
      TOP=INT_015*65,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<E.修改',;
      TOOLTIPTEXT='修改此筆資料!快速鍵->ALT+E' 
      NAME='CMND2'  
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*481,;
      TOP=INT_015*65,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<D.刪除',;
      TOOLTIPTEXT='刪除此筆資料!快速鍵->ALT+D' 
      NAME='CMND3'                                                          
  ADD OBJECT CMND4 AS COMMANDBUTTON WITH;
      LEFT=INT_015*523,;
      TOP=INT_015*65,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*40,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<X.離開',;
      TOOLTIPTEXT='離開此畫面!快速鍵->ALT+X' 
      NAME='CMND4'  
  PROC COMBOBOX2.INIT   
  	 WITH THIS 
  	   SELECT S01.F07 FROM S01 WHERE S01.F01 = 'Y' AND !EMPTY(S01.F07) ORDER BY S01.F07 INTO CURSOR S01_CITY
  	   SELECT S01_CITY
  	   GO TOP
  	   DO WHILE !EOF()
  	      .ADDITEM(ALLTRIM(S01_CITY.F07))
  	      SELECT S01_CITY
  	      SKIP
  	   ENDDO
  	   SELECT S01_CITY
  	   USE     	   
  	   .VALUE = 1
  	 ENDWITH
  ENDPROC      
  PROC COMBOBOX6.INIT   
  	 WITH THIS 
  	   .ADDITEM('重度殘障')
  	   .ADDITEM('中度殘障')
  	   .ADDITEM('輕度殘障')
  	   .VALUE = 1
  	 ENDWITH
  ENDPROC        
 PROCEDURE INIT  
      SELECT S01_TEMP
      SET ORDER TO S01_TEMP1
 	  THISFORM.KEY_LIST.VISIBLE=.F.
  	  THISFORM.SHRGROUP.VISIBLE=.F.
  	  THISFORM.COMBOBOX2.VISIBLE=.F.
  	  THISFORM.COMBOBOX6.VISIBLE=.F.
      THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
      THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')    
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMBOBOX')   
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
      THISFORM.SETALL('MOUSEPOINTER',99,'COMMANDBUTTON')
      THISFORM.SETALL('MOUSEICON','BMPS\harrow.cur','COMMANDBUTTON') 
      THISFORM.SETALL('MOVABLE',.F.,'COLUMN')        
      THISFORM.GRID1.READONLY=.T.       
      THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
      THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')
      THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='眷屬姓名'
      THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S01_TEMP.F13'
      THISFORM.GRID1.COLUMN1.WIDTH=INT_015*85
      THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='設籍地'
      THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S01_TEMP.F14'
      THISFORM.GRID1.COLUMN2.WIDTH=INT_015*90
      THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='設籍時間'
      THISFORM.GRID1.COLUMN3.CONTROLSOURCE="IIF(S01_TEMP.F15 = 0,'超過一年(含)','未滿一年')"
      THISFORM.GRID1.COLUMN3.WIDTH=INT_015*90      
      THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='出生日期'
      THISFORM.GRID1.COLUMN4.CONTROLSOURCE='S01_TEMP.F16'
      THISFORM.GRID1.COLUMN4.WIDTH=INT_015*90
      THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='身份字號'
      THISFORM.GRID1.COLUMN5.CONTROLSOURCE='S01_TEMP.F17'
      THISFORM.GRID1.COLUMN5.WIDTH=INT_015*90      
      THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='殘障等級'
      THISFORM.GRID1.COLUMN6.CONTROLSOURCE="IIF(EMPTY(S01_TEMP.F18),'無殘障',ICASE(S01_TEMP.F18 = '0','重度殘障',S01_TEMP.F18 = '1','中度殘障',S01_TEMP.F18 = '2','輕度殘障',''))"
      THISFORM.GRID1.COLUMN6.WIDTH=INT_015*85          
      THISFORM.GRID1.SETFOCUS
	  IF THISFORM.GRID1.ACTIVEROW<>0
	     THISFORM.GRID1.AFTERROWCOLCHANGE  
	  ENDIF  
	  THISFORM.TXTF1.VALUE = S01_TEMP.F13
      THISFORM.TXTF2.VALUE = S01_TEMP.F14
      THISFORM.OPTIONGROUP3.VALUE = IIF(S01_TEMP.F15 = 0,1,2)
      THISFORM.TXTF4.VALUE = S01_TEMP.F16
      THISFORM.TXTF5.VALUE = S01_TEMP.F17  
      THISFORM.OPTIONGROUP6.VALUE = IIF(EMPTY(S01_TEMP.F17),2,1)
      THISFORM.COMBOBOX6.VALUE = ICASE(S01_TEMP.F18 = '0',1,S01_TEMP.F18 = '0',2,S01_TEMP.F18 = '0',3,1)
      THISFORM.LABEL991.CAPTION = S01_TEMP.F99
      THISFORM.CMND2.ENABLED = IIF(EMPTY(THISFORM.TXTF1.VALUE),.F.,.T.)
      THISFORM.CMND3.ENABLED = IIF(EMPTY(THISFORM.TXTF1.VALUE),.F.,.T.)	  
  ENDPROC	        
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       SELECT S01_TEMP
	   THISFORM.TXTF1.VALUE = S01_TEMP.F13
       THISFORM.TXTF2.VALUE = S01_TEMP.F14
       THISFORM.COMBOBOX2.DISPLAYVALUE = ALLTRIM(S01_TEMP.F14) + SPACE(10 - LEN(ALLTRIM(S01_TEMP.F14)))
       THISFORM.OPTIONGROUP3.VALUE = IIF(S01_TEMP.F15 = 0,1,2)
       THISFORM.TXTF4.VALUE = S01_TEMP.F16
       THISFORM.TXTF5.VALUE = S01_TEMP.F17  
       THISFORM.OPTIONGROUP6.VALUE = IIF(EMPTY(S01_TEMP.F18),2,1)
       THISFORM.COMBOBOX6.VALUE = ICASE(S01_TEMP.F18 = '0',1,S01_TEMP.F18 = '1',2,S01_TEMP.F18 = '2',3,1)
       THISFORM.LABEL991.CAPTION = S01_TEMP.F99   
       THISFORM.CMND2.ENABLED = IIF(EMPTY(THISFORM.TXTF1.VALUE),.F.,.T.)
       THISFORM.CMND3.ENABLED = IIF(EMPTY(THISFORM.TXTF1.VALUE),.F.,.T.)
  ENDPROC
PROCEDURE OPTIONGROUP6.CLICK   
  IF THIS.VALUE = 1
     THISFORM.COMBOBOX6.VISIBLE = .T.
     THISFORM.COMBOBOX6.VALUE = 1 
  ELSE
     THISFORM.COMBOBOX6.VISIBLE = .F.
  ENDIF
ENDPROC
**************
  PROCEDURE CMND1.CLICK 
      THISFORM.SHRGROUP.ENABLED=.T.
      THISFORM.SHRGROUP.VISIBLE=.T.
      THISFORM.SHRGROUP.SHURE2_BOTT.ENABLED=.F.
      THISFORM.SHRGROUP.SHURE2_BOTT.VISIBLE=.F.
      THISFORM.SHRGROUP.SHURE1_BOTT.ENABLED=.T.
      THISFORM.SHRGROUP.SHURE1_BOTT.VISIBLE=.T.
      THISFORM.SHRGROUP.ABANDON_BOTT.VISIBLE=.F.
      THISFORM.SHRGROUP.FINISH_BOTT.ENABLED=.T.
      THISFORM.SHRGROUP.FINISH_BOTT.VISIBLE=.T.  
      THISFORM.GRID1.ENABLED=.F.
      THISFORM.CMND1.ENABLED=.F.
      THISFORM.CMND2.ENABLED=.F.
      THISFORM.CMND3.ENABLED=.F.      
      THISFORM.CMND4.ENABLED=.F.
      THISFORM.TXTF2.VISIBLE=.F.
      THISFORM.COMBOBOX2.VISIBLE=.T.
      THISFORM.OPTIONGROUP3.ENABLED=.T.
      THISFORM.OPTIONGROUP6.ENABLED=.T.
      THISFORM.SETALL('READONLY',.F.,'TEXTBOX')
      THISFORM.TXTF1.VALUE=''
      THISFORM.TXTF2.VALUE=''
      THISFORM.TXTF4.VALUE=CTOD('')
      THISFORM.TXTF5.VALUE=''
      THISFORM.COMBOBOX2.VALUE = 1
      THISFORM.OPTIONGROUP3.VALUE = 1
      THISFORM.OPTIONGROUP6.VALUE = 2
      THISFORM.LABEL991.CAPTION=''
      THISFORM.TXTF1.SETFOCUS
  ENDPROC 
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK  
      IF EMPTY(THISFORM.TXTF1.VALUE) = .T.
         =MESSAGEBOX('眷屬姓名不得空白',0+64,'提示訊息視窗')
         THISFORM.TXTF1.SETFOCUS
         RETURN
      ENDIF
      IF EMPTY(THISFORM.TXTF4.VALUE) = .T.
         =MESSAGEBOX('出生日期不得空白',0+64,'提示訊息視窗')
         THISFORM.TXTF4.SETFOCUS
         RETURN
      ENDIF      
      IF SEEK(ALLTRIM(THISFORM.TXTF1.VALUE) + ALLTRIM(THISFORM.COMBOBOX2.DISPLAYVALUE) + DTOS(THISFORM.TXTF4.VALUE),'S01_TEMP') = .T.
         =MESSAGEBOX('此眷屬姓名已存在',0+64,'提示訊息視窗')
         THISFORM.TXTF1.SETFOCUS
         RETURN
      ENDIF      
      SELECT S01_TEMP
      APPEND BLANK 
      LOCK()
      IF RLOCK()
         REPLACE S01_TEMP.F13 WITH THISFORM.TXTF1.VALUE
         REPLACE S01_TEMP.F14 WITH THISFORM.COMBOBOX2.DISPLAYVALUE
         REPLACE S01_TEMP.F15 WITH IIF(THISFORM.OPTIONGROUP3.VALUE = 1,0,1)
         REPLACE S01_TEMP.F16 WITH THISFORM.TXTF4.VALUE
         REPLACE S01_TEMP.F17 WITH THISFORM.TXTF5.VALUE
         REPLACE S01_TEMP.F18 WITH IIF(THISFORM.OPTIONGROUP6.VALUE = 2,'',ICASE(THISFORM.COMBOBOX6.VALUE = 1,'0',THISFORM.COMBOBOX6.VALUE = 2,'1',THISFORM.COMBOBOX6.VALUE = 3,'2',''))
         REPLACE S01_TEMP.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
      ENDIF  
      SELECT S01
      APPEND BLANK 
      REPLACE S01.F01 WITH 'Z'
      REPLACE S01.F12 WITH S05_1.F01
      REPLACE S01.F13 WITH S01_TEMP.F13
      REPLACE S01.F14 WITH S01_TEMP.F14
      REPLACE S01.F15 WITH S01_TEMP.F15
      REPLACE S01.F16 WITH S01_TEMP.F16
      REPLACE S01.F17 WITH S01_TEMP.F17
      REPLACE S01.F18 WITH S01_TEMP.F18
      REPLACE S01.F99 WITH S01_TEMP.F99  
      UNLOCK 
      S05_F16 = S05_F16 + 1
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK   
  ENDPROC  
************ 
  PROCEDURE CMND2.CLICK
      THISFORM.SHRGROUP.ENABLED=.T.
      THISFORM.SHRGROUP.VISIBLE=.T.
      THISFORM.SHRGROUP.SHURE1_BOTT.ENABLED=.F.
      THISFORM.SHRGROUP.SHURE1_BOTT.VISIBLE=.F.
      THISFORM.SHRGROUP.SHURE2_BOTT.ENABLED=.T.
      THISFORM.SHRGROUP.SHURE2_BOTT.VISIBLE=.T.
      THISFORM.SHRGROUP.ABANDON_BOTT.VISIBLE=.T.
      THISFORM.SHRGROUP.FINISH_BOTT.ENABLED=.F.
      THISFORM.SHRGROUP.FINISH_BOTT.VISIBLE=.F.
      THISFORM.SETALL('READONLY',.F.,'TEXTBOX')
      THISFORM.GRID1.ENABLED=.F.
      THISFORM.CMND1.ENABLED=.F.
      THISFORM.CMND2.ENABLED=.F.
      THISFORM.CMND3.ENABLED=.F.
      THISFORM.CMND4.ENABLED=.F.
      THISFORM.TXTF1.READONLY=.T.
      THISFORM.TXTF4.READONLY=.F.
      THISFORM.TXTF5.READONLY=.F.
      THISFORM.TXTF2.VISIBLE=.F.
      THISFORM.COMBOBOX2.VISIBLE=.T.
      THISFORM.COMBOBOX2.DISPLAYVALUE = ALLTRIM(S01_TEMP.F14) + SPACE(10 - LEN(ALLTRIM(S01_TEMP.F14)))
      THISFORM.OPTIONGROUP3.ENABLED=.T.
      THISFORM.OPTIONGROUP6.ENABLED=.T.      
      THISFORM.COMBOBOX6.VISIBLE=IIF(EMPTY(S01_TEMP.F18),.F.,.T.)
      THISFORM.COMBOBOX6.VALUE = ICASE(S01_TEMP.F18 = '0',1,S01_TEMP.F18 = '1',2,S01_TEMP.F18 = '2',3,1)      
      THISFORM.LABEL991.CAPTION=''      
      THISFORM.TXTF4.SETFOCUS  
  ENDPROC
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK  
      IF EMPTY(THISFORM.TXTF4.VALUE) = .T.
         =MESSAGEBOX('出生日期不得空白',0+64,'提示訊息視窗')
         THISFORM.TXTF4.SETFOCUS
         RETURN
      ENDIF         
      SELECT RECNO() FROM S01 WHERE S01.F01 = 'Z' AND S01.F12 = S05_1.F01 AND S01.F13 = S01_TEMP.F13 AND S01.F14 = S01_TEMP.F14 AND S01.F16 = S01_TEMP.F16 INTO ARRAY BK1      
      SELECT S01_TEMP
      LOCK()
      IF RLOCK()
         REPLACE S01_TEMP.F14 WITH THISFORM.COMBOBOX2.DISPLAYVALUE
         REPLACE S01_TEMP.F15 WITH IIF(THISFORM.OPTIONGROUP3.VALUE = 1,0,1)
         REPLACE S01_TEMP.F16 WITH THISFORM.TXTF4.VALUE
         REPLACE S01_TEMP.F17 WITH THISFORM.TXTF5.VALUE
         REPLACE S01_TEMP.F18 WITH IIF(THISFORM.OPTIONGROUP6.VALUE = 2,'',ICASE(THISFORM.COMBOBOX6.VALUE = 1,'0',THISFORM.COMBOBOX6.VALUE = 2,'1',THISFORM.COMBOBOX6.VALUE = 3,'2',''))
         REPLACE S01_TEMP.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
      ELSE
         DO file_impact
         RETURN     
      ENDIF    
      JJ1=''               
      IF _TALLY>0   
         FOR I= 1 TO ALEN(BK1)
             JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
         ENDFOR    
         KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
         RLOCK(KK1,'S01')
         LL1=RLOCK(KK1,'S01')
      ELSE
         LL1=.T.   
      ENDIF                   
      IF LL1=.T. AND LEN(ALLTRIM(JJ1))>0  	 	    
         SELECT S01
         FOR I= 1 TO ALEN(BK1)                      
             GO BK1(I) 	            
	         REPLACE S01.F14 WITH ALLTRIM(THISFORM.COMBOBOX2.DISPLAYVALUE)
	         REPLACE S01.F15 WITH IIF(THISFORM.OPTIONGROUP3.VALUE = 1,0,1)
	         REPLACE S01.F16 WITH THISFORM.TXTF4.VALUE
	         REPLACE S01.F17 WITH THISFORM.TXTF5.VALUE
	         REPLACE S01.F18 WITH IIF(THISFORM.OPTIONGROUP6.VALUE = 2,'',ICASE(THISFORM.COMBOBOX6.VALUE = 1,'0',THISFORM.COMBOBOX6.VALUE = 2,'1',THISFORM.COMBOBOX6.VALUE = 3,'2',''))
	         REPLACE S01.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
         ENDFOR
      ENDIF   
      RELEASE ALL LIKE BK*     
      UNLOCK     
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC
************   
  PROCEDURE CMND3.CLICK
      IF MESSAGEBOX('是否確定要刪除此筆資料',4 + 32 + 256,'請確認') = 6 
         SELECT RECNO() FROM S01 WHERE S01.F01 = 'Z' AND S01.F12 = S05_1.F01 AND S01.F13 = S01_TEMP.F13 AND S01.F14 = S01_TEMP.F14 AND S01.F16 = S01_TEMP.F16 INTO ARRAY BK1
         JJ1=''               
	     IF _TALLY>0   
	        FOR I= 1 TO ALEN(BK1)
	            JJ1=JJ1+ALLTRIM(STR(BK1(I)))+','
	        ENDFOR    
	        KK1=STUFF(JJ1,RAT(',',JJ1,1),1,'')              
	        RLOCK(KK1,'S01')
	        LL1=RLOCK(KK1,'S01')
	     ELSE
	        LL1=.T.   
	     ENDIF                   
	     IF LL1=.T. AND LEN(ALLTRIM(JJ1))>0  	 	    
	        SELECT S01
	        FOR I= 1 TO ALEN(BK1)                      
	            GO BK1(I) 	            
	            DELETE 
	        ENDFOR
	     ENDIF      
         SELECT S01_TEMP
         LOCK()
         IF RLOCK()
            SELECT S01_TEMP
            DELETE         
         ELSE
            DO file_impact
            RETURN 
         ENDIF
         RELEASE ALL LIKE BK*     
         UNLOCK   
         S05_F16 = S05_F16 - 1          
      ENDIF 
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK 
  ENDPROC 
 ********** 
  PROCEDURE CMND4.CLICK  
    ***計算眷口人數
    SELECT S05
    SET ORDER TO S051
    SEEK S05_1.F01
    IF FOUND()
       REPLACE S05.F16 WITH S05_F16
    ENDIF  
    ***計算健保費
	***眷口人數大於不扣款之眷口數則為0,否則為 ROUND(投保金額*(全民健康保險費率)*(被保險人及眷屬月負擔金額比率),0)*(眷口人數+本人)
	PEOP = IIF(S05_F16 >= IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F06,0),S01.F06 - 1,S05_F16)
    PEOP1 = PEOP
    SINPO = ROUND(S05_1.F23 * (IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F02,0) / 100) * (IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F03,0) / 100),0)
*!*	    SINPO = SINPO * (PEOP + 1)
    IF PEOP > 0
       SELECT S01.F12,S01.F13,S01.F14,S01.F15,S01.F16,S01.F18,0000 AS PE FROM S01 WHERE S01.F01 ='Z' AND S01.F12 = S05_1.F01 INTO CURSOR S01_A READWRITE 
	   SELECT S01_A
	   INDEX ON S01_A.F18 TAG S01_A1
	   INDEX ON DTOS(S01_A.F16) + S01_A.F14 TAG S01_A2
	   SET ORDER TO S01_A1
	   GO TOP
       ***先判斷是否為殘障
       DO WHILE !EOF() AND PEOP1 <> 0
          DO CASE
             CASE S01_A.F18 = '0'	&&重度殘障 
             	  REPLACE S01_A.PE WITH SINPO - ROUND(SINPO * (S01.F09 / 100),0)
             CASE S01_A.F18 = '1'	&&中度殘障 
             	  REPLACE S01_A.PE WITH SINPO - CEILING(ROUND(SINPO * (S01.F10 / 100),0))
             CASE S01_A.F18 = '2'	&&輕度殘障 
                  REPLACE S01_A.PE WITH SINPO - CEILING(ROUND(SINPO * (S01.F11 / 100),0))  
             OTHERWISE
                  REPLACE S01_A.PE WITH SINPO          
          ENDCASE
          PEOP1 = PEOP1 - 1
          SELECT S01_A
          SKIP
       ENDDO
       **在判斷設籍地是否有補助65歲(含)以上老人,且設籍須滿一年(含)  INT((DATE() - S01_A.F16) / 365) >= 65
       PEOP1 = PEOP
       SELECT S01_A
       SET ORDER TO S01_A2
       GO TOP
       DO WHILE !EOF() AND PEOP1 <> 0
          IF S01_A.F15 = 0 AND IIF(SEEK('Y' + S01_A.F14,'S01'),S01.F15,0) = 1 AND (YEAR(DATE()) - YEAR(S01_A.F16)) >= 65 AND MONTH(DATE()) >= MONTH(S01_A.F16) AND DAY(DATE()) >= DAY(S01_A.F16)	&&非殘障+設籍一年+有補助+大於等於65歲以上
             REPLACE S01_A.PE WITH IIF(IIF(SEEK('B','S01'),S01.F08,0) >= SINPO,0,SINPO - S01.F08)
          ENDIF
          PEOP1 = PEOP1 - 1
          SELECT S01_A 
          SKIP
       ENDDO
       ***相加每一眷屬可扣繳之保費
       PEOP1 = PEOP
       SELECT S01_A
       GO TOP
       DO WHILE !EOF() AND PEOP1 <> 0
          SINPO = SINPO + S01_A.PE
          PEOP1 = PEOP1 - 1
          SELECT S01_A
          SKIP
       ENDDO
       SELECT S01_A
       USE 
    ENDIF
    SELECT S06
    SET ORDER TO S061	&& F01+F06+F07
    SEEK S05_1.F01+'K'+'健保費'  &&健保費
    IF FOUND()
       S06_F08 = S06.F08
       IF SINPO <> S06.F08
	      REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入健保費金額,最多七位數","請輸入",ALLTRIM(STR(SINPO)))),7))
	      REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')	
   	      IF EMPTY(S06.F08)
	         DELETE 
	      ENDIF   
	   ENDIF	 
    ELSE
       S06_F08 = 0
       SELECT S06
       APPEND BLANK 
       REPLACE F01 WITH S05_1.F01
       REPLACE F02 WITH S05_1.F02
       REPLACE F03 WITH S05_1.F05
       REPLACE F04 WITH S05_1.F06
       REPLACE F05 WITH '2'
       REPLACE F06 WITH 'K'
       REPLACE F07 WITH '健保費'
       REPLACE F08 WITH VAL(LEFT(ALLTRIM(INPUTBOX("請輸入健保費金額,最多七位數","請輸入",ALLTRIM(STR(SINPO)))),7))
       REPLACE F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')		
       IF EMPTY(S06.F08)
          DELETE 
       ENDIF
    ENDIF
    **若金額不相同則加入S07A.調薪修改作業中
    IF SINPO <> 0 AND SINPO <> S06_F08
       IF !USED('S07')	 &&S07 調薪修改作業
    	  SELECT  0
   	  	  USE S07 
       ELSE
          SELECT S07
	   ENDIF
	   SELECT S07
	   APPEND BLANK 
	   REPLACE S07.F01 WITH S06.F01
	   REPLACE S07.F02 WITH S06.F02
	   REPLACE S07.F03 WITH S06.F03
	   REPLACE S07.F04 WITH S06.F04
	   REPLACE S07.F05 WITH DATE()
	   REPLACE S07.F06 WITH '2'
	   REPLACE S07.F07 WITH '2'
	   REPLACE S07.F08 WITH LEFT(ALLTRIM(INPUTBOX("請輸入變更說明,最多15個中文字","請輸入",'健保費調整')),30)
	   IF EMPTY(ALLTRIM(S07.F08))
	      REPLACE S07.F08 WITH '健保費調整'
	   ENDIF				 
	   REPLACE S07.F09 WITH '健保費'
	   REPLACE S07.F11 WITH S06.F08 - SINPO
	   REPLACE S07.F12 WITH S06_F08
	   REPLACE S07.F13 WITH S06.F08
	   REPLACE S07.F14 WITH 'Y'
	   REPLACE S07.F15 WITH '1'
	   REPLACE S07.F99 WITH DTCX(DATE())+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
	   SELECT S06
	   REPLACE S06.F09 WITH S07.F05
	   REPLACE S06.F10 WITH S07.F08
	   SELECT S07
	   USE
    ENDIF 		         
 ****      
    SELECT S01_TEMP
    USE 
  	THISFORM.RELEASE
  ENDPROC
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK  
      SELECT S01_TEMP
      THISFORM.GRID1.ENABLED=.T.
      THISFORM.CMND4.ENABLED=.T.
      THISFORM.TXTF2.VISIBLE=.T.
      THISFORM.COMBOBOX2.VISIBLE=.F.
      THISFORM.COMBOBOX6.VISIBLE=.F.
      THISFORM.OPTIONGROUP3.ENABLED=.F.
      THISFORM.OPTIONGROUP6.ENABLED=.F.
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.       
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX') 
      THISFORM.GRID1.SETFOCUS
      IF THISFORM.GRID1.ACTIVEROW=0
         THISFORM.CMND2.ENABLED=.F.
         THISFORM.CMND3.ENABLED=.F.      
         THISFORM.TXTF1.VALUE=''
         THISFORM.TXTF2.VALUE=''
         THISFORM.TXTF4.VALUE=''
         THISFORM.TXTF5.VALUE=''
         THISFORM.OPTIONGROUP3.VALUE = 1
         THISFORM.OPTIONGROUP6.VALUE = 2
         THISFORM.LABEL991.CAPTION=''
      	 THISFORM.TXTF1.SETFOCUS  
	  ELSE
      	 THISFORM.CMND2.ENABLED=.T.
     	 THISFORM.CMND3.ENABLED=.T.	  
	     THISFORM.TXTF1.VALUE = S01_TEMP.F13
         THISFORM.TXTF2.VALUE = S01_TEMP.F14
         THISFORM.COMBOBOX2.DISPLAYVALUE = ALLTRIM(S01_TEMP.F14) + SPACE(10 - LEN(ALLTRIM(S01_TEMP.F14)))
         THISFORM.OPTIONGROUP3.VALUE = IIF(S01_TEMP.F15 = 0,1,2)
         THISFORM.TXTF4.VALUE = S01_TEMP.F16
         THISFORM.TXTF5.VALUE = S01_TEMP.F17  
         THISFORM.OPTIONGROUP6.VALUE = IIF(EMPTY(S01_TEMP.F18),2,1)
         THISFORM.COMBOBOX6.DISPLAYVALUE = ICASE(S01_TEMP.F18 = '0',1,S01_TEMP.F18 = '0',2,S01_TEMP.F18 = '0',3,1)
         THISFORM.LABEL991.CAPTION = S01_TEMP.F99   
         THISFORM.COMBOBOX2.DISPLAYVALUE = ALLTRIM(S01_TEMP.F14) + SPACE(10 - LEN(ALLTRIM(S01_TEMP.F14)))
         THISFORM.LABEL991.CAPTION = S01_TEMP.F99  	        	    
      ENDIF
      THISFORM.CMND1.ENABLED=.T.
      UNLOCK ALL
  ENDPROC 
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK  
      THISFORM.SHRGROUP.ABANDON_BOTT.CLICK 	
  ENDPROC     
ENDDEFINE   
***********************************************列印程序
PROCEDURE PNT_PRC   
      ANS_CHK=CREATEOBJECT("ANS_CHK")  
      ANS_CHK.SHOW   
ENDPROC
********      
********************************************************
DEFINE CLASS ANS_CHK AS FORM
  CAPTION='請選擇列印內容'
  TOP=INT_015*200
  LEFT=INT_015*300  
  HEIGHT=INT_015*80
  WIDTH=INT_015*225
  FONTSIZE=INT_015*9
  MOVABLE=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.  
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_CHK'
ADD OBJECT DATA_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*17,;
      TOP=INT_015*10,;
      AUTOSIZE=.T.,;
      FONTSIZE=INT_015*12,;
      BUTTONCOUNT=2,;
      VALUE=1,;
      OPTION1.CAPTION='列印薪資明細表',;
      OPTION1.TOP=INT_015*5,;
      OPTION1.FONTSIZE=INT_015*10,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='列印年假一覽表',;
      OPTION2.TOP=INT_015*35,;
      OPTION2.FONTSIZE=INT_015*10,;
      OPTION2.AUTOSIZE=.T.,;      
      NAME='DATA_OPTION'   
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*160,;     
      TOP=INT_015*10,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
       FONTSIZE=INT_015*10,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;           
      CAPTION='\<Y.確定',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*160,;
      TOP=INT_015*40,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
       FONTSIZE=INT_015*10,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;           
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'     
 *****
   PROC CMND1.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND1.TOP=INT_015*11
             THISFORM.CMND1.LEFT=INT_015*161
  ENDPROC     
  PROC CMND1.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND1.TOP=INT_015*10
             THISFORM.CMND1.LEFT=INT_015*160                  
  ENDPROC     
  PROC CMND2.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND2.TOP=INT_015*41
             THISFORM.CMND2.LEFT=INT_015*161
  ENDPROC     
  PROC CMND2.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND2.TOP=INT_015*40
             THISFORM.CMND2.LEFT=INT_015*160            
  ENDPROC         
  *****   
  PROCEDURE CMND1.CLICK   
        DO  CASE
               CASE THISFORM.DATA_OPTION.VALUE=1
			  CREATE CURSOR S06_TEMP (F01 C(4),F02 C(8),F04 C(8),F071 C(20),F081 N(7),F072 C(20),F082 N(7))
			  CREATE CURSOR S06B (F01 C(4),F02 C(8),F04 C(8),F071 C(20),F081 N(7),F072 C(20),F082 N(7))
			  SELECT F01,F02,F06 FROM S05 WHERE  IIF(A02.F09<>'*',S05.F27=.T.,.T.) AND S05.F28='A' OR  S05.F28='B' OR S05.F28='C' OR S05.F28='2' OR S05.F28='4'  ORDER BY S05.F01 INTO CURSOR S05_TEMP
			  SELECT S05_TEMP
			  GO TOP
			  DO WHILE !EOF()
			         I=1
			         SUM_A=0  &&所得金額小計
			         SUM_B=0  &&扣款金額小計
			        **所得明細
			         SELECT S06.F07,S06.F08 FROM S06 WHERE S05_TEMP.F01=S06.F01 AND S06.F05='1' ORDER BY S06.F01,S06.F06 INTO CURSOR S06A      
			         SELECT S06A
			         GO TOP
			         DO WHILE !EOF()            
			                SELECT S06B
			                APPEND BLANK 
			                REPLACE S06B.F01 WITH S05_TEMP.F01
				        REPLACE S06B.F02 WITH IIF(I=1,S05_TEMP.F02,'')
				        REPLACE S06B.F04 WITH IIF(I=1,S05_TEMP.F06,'')
				        REPLACE S06B.F071 WITH S06A.F07
				        REPLACE S06B.F081 WITH S06A.F08  
				        SUM_A=SUM_A+S06A.F08   
				        I=I+1
			      		SELECT S06A
			      		SKIP
			      	  ENDDO
				  	  I=1
			      	  SELECT S06A
			      	  USE
			      	  SELECT S06B
			      	  GO TOP
			      	  **扣款明細
			          SELECT S06.F07,S06.F08 FROM S06 WHERE S05_TEMP.F01=S06.F01 AND S06.F05='2' ORDER BY S06.F01,S06.F06 INTO CURSOR S06A      
			          SELECT S06A
			          GO TOP      	     	     	
			          DO WHILE !EOF() 
			                 SELECT S06B
			                 IF  !EOF()       
			                       SELECT S06B
				               REPLACE S06B.F072 WITH S06A.F07
				               REPLACE S06B.F082 WITH S06A.F08   
			      		 ELSE
			                       SELECT S06B
			                       APPEND BLANK 
				               REPLACE S06B.F01 WITH S05_TEMP.F01
				               REPLACE S06B.F02 WITH IIF(I=1,S05_TEMP.F02,'')
				               REPLACE S06B.F04 WITH IIF(I=1,S05_TEMP.F06,'')
				               REPLACE S06B.F072 WITH S06A.F07
				               REPLACE S06B.F082 WITH S06A.F08         		      
			      		 ENDIF    
			      		 SUM_B=SUM_B+S06A.F08
			      		 I=I+1
				         SELECT S06B
				         SKIP         		       
			      		 SELECT S06A
			      		 SKIP       		      
			      	  ENDDO
			      	  SELECT S06A
			      	  USE
			      	  SELECT S06B
			      	  IF SUM_A<>0 OR SUM_B<>0 
			      	      APPEND BLANK 
			      	      REPLACE F071 WITH '小計'
			      	      REPLACE F072 WITH '小計'
			      	      REPLACE F081 WITH SUM_A
			      	      REPLACE F082 WITH SUM_B
			      	  ENDIF
			      	  GO TOP
			          DO WHILE !EOF()
			                 SELECT S06_TEMP
			                 APPEND BLANK 
			                 REPLACE S06_TEMP.F01 WITH S06B.F01
			                 REPLACE S06_TEMP.F02 WITH S06B.F02
			                 REPLACE S06_TEMP.F04 WITH S06B.F04
			                 REPLACE S06_TEMP.F071 WITH S06B.F071
			                 REPLACE S06_TEMP.F072 WITH S06B.F072
			                 REPLACE S06_TEMP.F081 WITH S06B.F081
			                 REPLACE S06_TEMP.F082 WITH S06B.F082                    
			                 SELECT S06B
			                 SKIP
			          ENDDO   
			          SELECT S06B
				  DELETE ALL          
			          SELECT S05_TEMP
			          SKIP
			  ENDDO      
			  SELECT S06B
			  USE
			  SELECT S05_TEMP
			  USE      
			  SELECT S06_TEMP
			  GO TOP
			  IF  _TALLY>=0
			       REPORT FORM ALLTRIM(INT_116)+'S05A' TO PRINT PROMPT   PREVIEW
			  ELSE
			       =MESSAGEBOX('查無可列印之資料',0+48,'警示')
			       RETURN     
			  ENDIF   
			  SELECT S06_TEMP
			  USE  
			  CLEAR            
               CASE THISFORM.DATA_OPTION.VALUE=2
			   SELECT F01,F02,F05,F06,F09,F11,F12 FROM S05_1 WHERE !EMPTY(F09) AND F28<>'9' ORDER BY F01  NOWAIT
			   IF  _TALLY>0
			        REPORT FORM ALLTRIM(INT_116)+'S05B' TO PRINT PROMPT   PREVIEW
			   ELSE
			        =MESSAGEBOX('查無可列印之資料',0+48,'警示')
			        RETURN     
			  ENDIF  			                                               
        ENDCASE       
        THISFORM.CMND2.CLICK                       
  ENDPROC  
**
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE  
***************************************************部門
DEFINE CLASS COMBOBOX05 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*60
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX05'
 PROCEDURE INIT    
       SELECT F01,F02 FROM A14 WHERE  LEN(ALLTRIM(F01))=4  ORDER BY F01 INTO CURSOR A14_TEMP
       SELECT A14_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(A14_TEMP.F01)+SPACE(5)+ALLTRIM(A14_TEMP.F02))
      	      SELECT  A14_TEMP
      	      SKIP
       ENDDO
       SELECT A14_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.VALUE=LEFT(THIS.DISPLAYVALUE,4)
       THISFORM.PAGEFRAME1.PAGE1.LBLF06.CAPTION=RIGHT(ALLTRIM(THIS.DISPLAYVALUE),LEN(ALLTRIM(THIS.DISPLAYVALUE))-9)
       THISFORM.PAGEFRAME1.PAGE1.TXTF05.REFRESH  
  ENDPROC       
ENDDEFINE
**************************************************職務項目名稱
DEFINE CLASS COMBOBOX071 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX071'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='D' ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.VALUE=THIS.DISPLAYVALUE
       THISFORM.PAGEFRAME1.PAGE1.TXTF07.REFRESH  
  ENDPROC       
ENDDEFINE
***********************************************職等項目名稱
DEFINE CLASS COMBOBOX08 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX08'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='E' ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF08.VALUE=THIS.DISPLAYVALUE
       THISFORM.PAGEFRAME1.PAGE1.TXTF08.REFRESH  
  ENDPROC       
ENDDEFINE
************到職日期
DEFINE CLASS TXTF09 AS TEXTBOX
        VISIBLE=.T.
        READONLY=.T.
        WIDTH=INT_015*70
        HEIGHT=INT_015*25
        FONTSIZE=INT_015*9
        MAXLENGTH=8
  PROCEDURE INTERACTIVECHANGE
    IF THISFORM.PAGEFRAME1.PAGE1.COMBOBOX28.VALUE<>6  &&為外包人員則不需年假
         SELECT S00
	 SET ORDER TO S001 
	 SEEK 'F'  &&年假參數
	 IF  FOUND()
	      SENIORITY_MAX=S00.F21 &&最大年資
	      SENIORITY_ADD=S00.F22 &&每年增加年假天數
	      VACATION_MAX=S00.F23 &&年假最多不可超過天數
	      METHOD1=S00.F24 &&未滿一年計算方式一
	      METHOD2=S00.F25 &&未滿一年計算方式二
	  ELSE
	      SENIORITY_MAX=0
	      SENIORITY_ADD=0
	      VACATION_MAX=0
	      METHOD1=0
	      METHOD2=0
	  ENDIF    
          IF YEAR(DATE())-YEAR(THIS.VALUE)<=1  &&任職未滿一年之可休年假天數
               IF   (DATE()-THIS.VALUE)<=0   OR  YEAR(DATE())=YEAR(THIS.VALUE) &&判斷是否為目前年度是否小於到職年度,若為真則表示系統日期有誤
                     THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=0
  	       ELSE
                     DO CASE
                           CASE METHOD1=0 AND  METHOD2=0        &&若未設定未滿一年之計算方式一與計算方式二則歸零                          
                	              THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=0		                    	
             	           CASE METHOD1<>0   				       &&未滿一年之計算方式一：為直接給予年假天數                 
             	                      THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=METHOD1
             	           CASE METHOD2<>0				              &&未滿一年計算方式二：為ROUND(給予年假天數/12*(12-到職月份),0)                       
             	                      THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=ROUND((METHOD2/12)*(12-MONTH(THIS.VALUE)),0)     	         	             	    	       
                      ENDCASE
               ENDIF
          ELSE     &&任職滿一年以上可休年假天數    
	     SENIORITY_RANG=YEAR(DATE())-YEAR(THIS.VALUE)  &&目前年度-到職年度
	     SELECT F18,F19,F20 FROM S00 WHERE F01='E'   ORDER BY F18 INTO CURSOR S00_TEMP  &&起止年資範圍之年假可休天數
	     SELECT S00_TEMP 
	     GO TOP
	     DO WHILE !EOF()  &&起止年資範圍之年假可休天數
	            F20_TEMP=S00_TEMP.F20  &&最後一筆給假天數
	            IF SENIORITY_RANG>=S00_TEMP.F18 AND SENIORITY_RANG<S00_TEMP.F19  &&判斷年資範圍以便給予符合之年假天數
	                THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=S00_TEMP.F20              	         
	            ENDIF
	            SELECT S00_TEMP
	            SKIP    
	     ENDDO
	     ****判斷  最大年資若不等於零 AND 是否超過最大年資限制
             IF !EMPTY(SENIORITY_MAX)  AND  SENIORITY_RANG>=SENIORITY_MAX  &&若是沒有符合的年資範圍則以最後一筆起止年資範圍之年假可休天數給假
                  THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=F20_TEMP+(SENIORITY_RANG-(SENIORITY_MAX-1))*SENIORITY_ADD  &&最後一筆給假天數+(目前年資-最大年資)*每年增加年假之天數	                         
             ENDIF  
             ****判斷年假是否已超過最多不可超過之給假天數,若超過則以限定最多年假天數給予
	     IF  THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE>=VACATION_MAX  AND VACATION_MAX<>0
	          THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=VACATION_MAX  &&為限定最多年假天數給予
	     ENDIF
	     SELECT S00_TEMP
	     USE
         ENDIF	
    ELSE
         THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=0
         THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=0
    ENDIF    
    THISFORM.PAGEFRAME1.PAGE1.TXTF20.VALUE=THIS.VALUE
    THISFORM.PAGEFRAME1.PAGE1.TXTF11.REFRESH
    THISFORM.PAGEFRAME1.PAGE1.TXTF20.REFRESH
  ENDPROC       
ENDDEFINE
************可休假天數
DEFINE CLASS TXTF11 AS TEXTBOX
        VISIBLE=.T.
        READONLY=.T.
        WIDTH=INT_015*30
        HEIGHT=INT_015*25
        FONTSIZE=INT_015*9
        MAXLENGTH=2          
        INPUTMASK='99'
  PROCEDURE INTERACTIVECHANGE
        THISFORM.PAGEFRAME1.PAGE1.LBLF122.CAPTION=SPACE(5)+TRANSFORM(IIF((THIS.VALUE-THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE)<=0,0,THIS.VALUE-THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE),'999.9')+'天'  
  ENDPROC       
ENDDEFINE
************已休假天數
DEFINE CLASS TXTF12 AS TEXTBOX
        VISIBLE=.T.
        READONLY=.T.
        WIDTH=INT_015*40
        HEIGHT=INT_015*25
        FONTSIZE=INT_015*9
        MAXLENGTH=4          
        INPUTMASK='99.9'
  PROCEDURE INTERACTIVECHANGE
        THISFORM.PAGEFRAME1.PAGE1.LBLF122.CAPTION=SPACE(5)+TRANSFORM(IIF((THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE-THIS.VALUE)<=0,0,THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE-THIS.VALUE),'999.9')+'天'   
  ENDPROC       
ENDDEFINE
***************************************************班別
DEFINE CLASS COMBOBOX29 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*40
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX29'
 PROCEDURE INIT    
       THIS.ADDITEM('') 
       SELECT F48,F50,F51 FROM S00 WHERE  F01='I'  ORDER BY F48,F50,F51 INTO CURSOR S00_TEMP
       SELECT S00_TEMP
       GO TOP  
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S00_TEMP.F48)+SPACE(4)+ALLTRIM(S00_TEMP.F50)+'∼'+ALLTRIM(S00_TEMP.F51))
      	      SELECT  S00_TEMP
      	      SKIP
       ENDDO
       SELECT S00_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF29.VALUE=LEFT(ALLTRIM(THIS.DISPLAYVALUE),2)
       THISFORM.PAGEFRAME1.PAGE1.LBLF291.CAPTION=RIGHT(ALLTRIM(THIS.DISPLAYVALUE),LEN(ALLTRIM(THIS.DISPLAYVALUE))-6)
       THISFORM.PAGEFRAME1.PAGE1.TXTF29.REFRESH  
  ENDPROC       
ENDDEFINE
***************************************************勞保金額
DEFINE CLASS COMBOBOX18 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*70
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX18'
 PROCEDURE INIT    
       SELECT F02 FROM S04  ORDER BY F02 GROUP BY F02 INTO CURSOR S04_TEMP
       SELECT S04_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(STR(S04_TEMP.F02)))
      	      SELECT  S04_TEMP
      	      SKIP
       ENDDO
       SELECT S04_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.TXTF18.REFRESH  
  ENDPROC       
ENDDEFINE
**************************************************健保等級
DEFINE CLASS COMBOBOX22 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*40
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX22'
 PROCEDURE INIT    
       SELECT F01 FROM S03  ORDER BY F01 INTO CURSOR S03_TEMP
       SELECT S03_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(STR(S03_TEMP.F01)))
      	      SELECT  S03_TEMP
      	      SKIP
       ENDDO
       SELECT S03_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.VALUE=THIS.VALUE 
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX23.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.REFRESH       
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.REFRESH   
  ENDPROC       
ENDDEFINE
***************************************************健保金額
DEFINE CLASS COMBOBOX23 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*70
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX23'
 PROCEDURE INIT    
       SELECT F02 FROM S03  ORDER BY F02 INTO CURSOR S03_TEMP
       SELECT S03_TEMP
       GO TOP
       THIS.ADDITEM('')       
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(STR(S03_TEMP.F02)))
      	      SELECT  S03_TEMP
      	      SKIP
       ENDDO
       SELECT S03_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.VALUE=THIS.VALUE 
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.VALUE=ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.COMBOBOX22.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.TXTF22.REFRESH         
       THISFORM.PAGEFRAME1.PAGE1.TXTF23.REFRESH  
  ENDPROC       
ENDDEFINE
*************************************************撥款銀行
DEFINE CLASS COMBOBOX25 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX25'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='H'  ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	      SELECT  S01_TEMP
      	      SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF25.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE1.TXTF25.REFRESH  
  ENDPROC       
ENDDEFINE
****眷口補助清單


***************************************************任職狀況
DEFINE CLASS COMBOBOX28 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*80
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX28'
 PROCEDURE INIT    
       THIS.ADDITEM('新進人員') 
       THIS.ADDITEM('資料補登') 
       THIS.ADDITEM('在        職')  
       THIS.ADDITEM('離職復職') 
       THIS.ADDITEM('留職復職')     
       THIS.ADDITEM('外包人員')        
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=THIS.DISPLAYVALUE
       IF THIS.VALUE=6
           THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=0
           THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=0
           THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP31.VALUE = 3
           THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = 1
 	   THISFORM.PAGEFRAME1.PAGE1.LBLF32.VISIBLE = .F.
 	   THISFORM.PAGEFRAME1.PAGE1.LBLF321.VISIBLE = .F.
 	   THISFORM.PAGEFRAME1.PAGE1.TXTF32.VISIBLE = .F.
 	   THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VISIBLE = .F.           
       ELSE 
           IF  EMPTY(THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE)<>.T.
                SELECT S00
	        SET ORDER TO S001 
	        SEEK 'F'  &&年假參數
	        IF  FOUND()
	             SENIORITY_MAX=S00.F21 &&最大年資
		     SENIORITY_ADD=S00.F22 &&每年增加年假天數
		     VACATION_MAX=S00.F23 &&年假最多不可超過天數
		     METHOD1=S00.F24 &&未滿一年計算方式一
		     METHOD2=S00.F25 &&未滿一年計算方式二
	        ELSE
		     SENIORITY_MAX=0
		     SENIORITY_ADD=0
		     VACATION_MAX=0
		     METHOD1=0
		     METHOD2=0
	        ENDIF    
                IF YEAR(DATE())-YEAR(THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE)<=1  &&任職未滿一年之可休年假天數
                     IF  (DATE()-THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE)<=0   OR  YEAR(DATE())=YEAR(THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE) &&判斷是否為目前年度是否小於到職年度,若為真則表示系統日期有誤
                          THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=0
  	             ELSE
                          DO CASE
                                CASE METHOD1=0 AND  METHOD2=0        &&若未設定未滿一年之計算方式一與計算方式二則歸零                          
                	                   THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=0		                    	
             	                CASE METHOD1<>0   				       &&未滿一年之計算方式一：為直接給予年假天數                 
             	                           THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=METHOD1
             	               CASE METHOD2<>0				              &&未滿一年計算方式二：為ROUND(給予年假天數/12*(12-到職月份),0)                       
             	                           THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=ROUND((METHOD2/12)*(12-MONTH(THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE)),0)     	         	             	    	       
                          ENDCASE
                     ENDIF
                ELSE     &&任職滿一年以上可休年假天數    
		     SENIORITY_RANG=YEAR(DATE())-YEAR(THISFORM.PAGEFRAME1.PAGE1.TXTF09.VALUE)  &&目前年度-到職年度
		     SELECT F18,F19,F20 FROM S00 WHERE F01='E'   ORDER BY F18 INTO CURSOR S00_TEMP  &&起止年資範圍之年假可休天數
		     SELECT S00_TEMP 
		     GO TOP
		     DO WHILE !EOF()  &&起止年資範圍之年假可休天數
		            F20_TEMP=S00_TEMP.F20  &&最後一筆給假天數
		            IF SENIORITY_RANG>=S00_TEMP.F18 AND SENIORITY_RANG<S00_TEMP.F19  &&判斷年資範圍以便給予符合之年假天數
		                THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=S00_TEMP.F20              	         
		            ENDIF
		            SELECT S00_TEMP
		            SKIP    
	    	     ENDDO
	   	    ****判斷  最大年資若不等於零 AND 是否超過最大年資限制
	             IF !EMPTY(SENIORITY_MAX)  AND  SENIORITY_RANG>=SENIORITY_MAX  &&若是沒有符合的年資範圍則以最後一筆起止年資範圍之年假可休天數給假
	                  THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=F20_TEMP+(SENIORITY_RANG-(SENIORITY_MAX-1))*SENIORITY_ADD  &&最後一筆給假天數+(目前年資-最大年資)*每年增加年假之天數	                         
	             ENDIF  
	             ****判斷年假是否已超過最多不可超過之給假天數,若超過則以限定最多年假天數給予
		     IF  THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE>=VACATION_MAX  AND VACATION_MAX<>0
		          THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=VACATION_MAX  &&為限定最多年假天數給予
		     ENDIF
		     SELECT S00_TEMP
		     USE
                ENDIF
            ELSE   
                THISFORM.PAGEFRAME1.PAGE1.TXTF11.VALUE=0
                THISFORM.PAGEFRAME1.PAGE1.TXTF12.VALUE=0            
            ENDIF    	               
        ENDIF
       THISFORM.PAGEFRAME1.PAGE1.TXTF28.REFRESH  
  ENDPROC       
ENDDEFINE
******************************************勞退選擇
DEFINE CLASS OPTIONGROUP31 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*25
   WIDTH=INT_015*141
   BUTTONCOUNT=3
   VALUE=1
   ENABLED=.F.   
   NAME='OPTIONGROUP31'
   OPTION1.CAPTION='舊制'
   OPTION1.FONTSIZE=INT_015*9      
   OPTION1.TOP=INT_015*5
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5 
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='新制'
   OPTION2.FONTSIZE=INT_015*9    
   OPTION2.TOP=INT_015*5
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*50
   OPTION2.NAME='OPTION2'   	   
   OPTION3.CAPTION='無'
   OPTION3.FONTSIZE=INT_015*9    
   OPTION3.TOP=INT_015*5
   OPTION3.AUTOSIZE=.T.
   OPTION3.LEFT=INT_015*95
   OPTION3.NAME='OPTION3'   	   	 
   PROCEDURE INTERACTIVECHANGE
 	 THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VALUE = 1
 	 THISFORM.PAGEFRAME1.PAGE1.TXTF32.READONLY = .T.
 	 IF  THIS.Value = 1 OR THIS.Value = 3
 	      THISFORM.PAGEFRAME1.PAGE1.LBLF32.VISIBLE = .F.
 	      THISFORM.PAGEFRAME1.PAGE1.LBLF321.VISIBLE = .F.
 	      THISFORM.PAGEFRAME1.PAGE1.TXTF32.VISIBLE = .F.
 	      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VISIBLE = .F.
 	 ELSE
 	      THISFORM.PAGEFRAME1.PAGE1.LBLF32.VISIBLE = .T.
 	      THISFORM.PAGEFRAME1.PAGE1.LBLF321.VISIBLE = .T.
 	      THISFORM.PAGEFRAME1.PAGE1.TXTF32.VISIBLE = .T.
 	      THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP32.VISIBLE = .T. 	 
         ENDIF
  ENDPROC       
ENDDEFINE
******************************************自行提撥
DEFINE CLASS OPTIONGROUP32 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*30
   WIDTH=INT_015*191
   BUTTONCOUNT=2
   VALUE=1
   ENABLED=.F.   
   NAME='OPTIONGROUP32'
   OPTION1.CAPTION='否'
   OPTION1.FONTSIZE=INT_015*9      
   OPTION1.TOP=INT_015*8
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5 
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='是'
   OPTION2.FONTSIZE=INT_015*9    
   OPTION2.TOP=INT_015*8
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*50
   OPTION2.NAME='OPTION2'   	   	 
   PROCEDURE INTERACTIVECHANGE
 	 IF  THIS.Value = 1 
 	      THISFORM.PAGEFRAME1.PAGE1.TXTF32.READONLY = .T.
	      THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE = 0
 	 ELSE
 	      THISFORM.PAGEFRAME1.PAGE1.TXTF32.READONLY = .F.
	      THISFORM.PAGEFRAME1.PAGE1.TXTF32.VALUE = 0
         ENDIF 
  ENDPROC       
ENDDEFINE
***************************************************薪資/扣款項目名稱
DEFINE CLASS COMBOBOX07 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=0    
       VALUE=1
       NAME='COMBOBOX07'
 PROCEDURE INIT    
       SELECT F07 FROM S01 WHERE F01='F'  ORDER BY F07 INTO CURSOR S01_TEMP
       SELECT S01_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE !EOF()
          THIS.ADDITEM(ALLTRIM(S01_TEMP.F07))
      	  SELECT S01_TEMP
      	  SKIP
       ENDDO
       SELECT S01_TEMP
       USE   
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=ALLTRIM(THIS.DISPLAYVALUE)
       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=ALLTRIM(THIS.DISPLAYVALUE)       
       THISFORM.PAGEFRAME1.PAGE2.TXTF07.REFRESH  
       THISFORM.PAGEFRAME1.PAGE3.TXTF07.REFRESH       
  ENDPROC       
ENDDEFINE
**************************************************薪資類別
DEFINE CLASS COMBOBOX061 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX061'
   PROCEDURE INTERACTIVECHANGE
       DO CASE 
   	     CASE THIS.VALUE=1
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.T.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.T.  	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.   	    	     
   	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''   
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''      	     	        
    	                THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.DISPLAYVALUE=''      
			THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=0     	                	     	        	            
   	     CASE THIS.VALUE=2
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.T.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.T.  	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.   	   	       
		        DO CASE
		              CASE THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=1 
		                 	 THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='A'  
		                         THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE='底薪'   
		              CASE THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=2
		                 	 THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='B'  		              
		                         THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE='日薪'   
		              CASE THISFORM.PAGEFRAME1.PAGE1.OPTIONGROUP15.VALUE=3 
		                 	 THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='C'  		              
		                         THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE='時薪'   		                         
		    ENDCASE   	     	        	
			THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=0     	     	             	        
   	     CASE THIS.VALUE=3
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.T.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.T.  	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.   	      	     
   	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='D'   
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE='伙食費'    
			THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F60,0)	     	          	    	     	        	     
   	     CASE THIS.VALUE=4
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.T.  
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.T.  	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.   	      	     
   	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='E'  
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE='交通費'    
			THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F61,0)  	     	          	    	     	        
   	     CASE THIS.VALUE=5
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.T.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.T.  	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.   	      	     
   	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='F'     	
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE='全勤獎金'      	
			THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F04,0)
   	     CASE THIS.VALUE=6
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.T.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.T.  	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.   	      	     
   	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='G'     	
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE='職務津貼'      	
			THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=0		
   	     CASE THIS.VALUE=7
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.F.        	     
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.F.  	     	        
    	     	        THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.T.   	   	     
   	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE='H'   	     
    	     	        THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''      	     	        
    	                THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.DISPLAYVALUE='' 
			THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=0    	                
       ENDCASE 	
              THISFORM.PAGEFRAME1.PAGE2.TXTF06.REFRESH  
  ENDPROC       
ENDDEFINE
**************************************************扣款類別
DEFINE CLASS COMBOBOX062 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX062'
 PROCEDURE INIT    
          THIS.ADDITEM('')          
          THIS.ADDITEM('勞保費')
          THIS.ADDITEM('健保費') 
          THIS.ADDITEM('所得稅') 
          THIS.ADDITEM('其他扣款')
  ENDPROC  
  PROCEDURE INTERACTIVECHANGE
       DO CASE 
   	      CASE THIS.VALUE=1
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T.        	     
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.  	     	        
    	       THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.   
    	       THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.DISPLAYVALUE=''        	     	        	    	     	        
   	     	   THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE=''   	      	     	         	
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=''       
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=''  	 	     	                     
   	      CASE THIS.VALUE=2
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T.      	     	        
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.   	
   	           THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE='J'    	     	        
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE='勞保費'       	        
    	       THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.
		       THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=ROUND(THISFORM.PAGEFRAME1.PAGE1.TXTF18.VALUE*((IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F02,0)+IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F06,0))/100)*(IIF(INDEXSEEK('C',.T.,'S01','S011'),S01.F03,0)/100)/30*30,0) 
   	      CASE THIS.VALUE=3
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T.        	     
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.   	      
    	       THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.
   	           THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE='K'
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE='健保費'       
			   ***眷口人數大於不扣款之眷口數則為0,否則為 ROUND(投保金額*(全民健康保險費率)*(被保險人及眷屬月負擔金額比率),0)*(眷口人數+本人)
			   PEOP = IIF(THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE >= IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F06,0),S01.F06 - 1,THISFORM.PAGEFRAME1.PAGE1.TXTF16.VALUE)
			   PEOP1 = PEOP
			   SINPO = ROUND(S05_1.F23 * (IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F02,0) / 100) * (IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F03,0) / 100),0)
*!*				   SINPO = SINPO1 * (PEOP + 1)
			   IF PEOP > 0
			      SELECT S01.F12,S01.F13,S01.F14,S01.F15,S01.F16,S01.F18,0000 AS PE FROM S01 WHERE S01.F01 ='Z' AND S01.F12 = S05_1.F01 INTO CURSOR S01_A READWRITE 
				  SELECT S01_A
				  INDEX ON S01_A.F18 TAG S01_A1
				  INDEX ON DTOS(S01_A.F16) + S01_A.F14 TAG S01_A2
				  SET ORDER TO S01_A1
				  GO TOP
			      ***先判斷是否為殘障
			      DO WHILE !EOF() AND PEOP1 <> 0
			         DO CASE
			            CASE S01_A.F18 = '0'	&&重度殘障 
			            	 REPLACE S01_A.PE WITH SINPO - ROUND(SINPO * (S01.F09 / 100),0)
			            CASE S01_A.F18 = '1'	&&中度殘障 
			             	 REPLACE S01_A.PE WITH SINPO - CEILING(ROUND(SINPO * (S01.F10 / 100),0))
			            CASE S01_A.F18 = '2'	&&輕度殘障 
			                 REPLACE S01_A.PE WITH SINPO - CEILING(ROUND(SINPO * (S01.F11 / 100),0))
			           OTHERWISE
			                 REPLACE S01_A.PE WITH SINPO  			                 
			         ENDCASE
			         PEOP1 = PEOP1 - 1
			         SELECT S01_A
			         SKIP
			      ENDDO
			      **在判斷設籍地是否有補助65歲(含)以上老人,且設籍須滿一年(含)  INT((DATE() - S01_A.F16) / 365) >= 65
			      PEOP1 = PEOP
			      SELECT S01_A
			      SET ORDER TO S01_A2
			      GO TOP
			      DO WHILE !EOF() AND PEOP1 <> 0
			         IF S01_A.F15 = 0 AND IIF(SEEK('Y' + S01_A.F14,'S01'),S01.F15,0) = 1 AND (YEAR(DATE()) - YEAR(S01_A.F16)) >= 65 AND MONTH(DATE()) >= MONTH(S01_A.F16) AND DAY(DATE()) >= DAY(S01_A.F16)	&&非殘障+設籍一年+有補助+大於等於65歲以上
			            REPLACE S01_A.PE WITH IIF(IIF(SEEK('B','S01'),S01.F08,0) >= SINPO,0,SINPO - S01.F08)
			         ENDIF
			         PEOP1 = PEOP1 - 1
			         SELECT S01_A
			         SKIP
			      ENDDO
			      ***相加每一眷屬可扣繳之保費
			      PEOP1 = PEOP
			      SELECT S01_A
			      GO TOP
			      DO WHILE !EOF() AND PEOP1 <> 0
			         SINPO = SINPO + S01_A.PE
			         PEOP1 = PEOP1 - 1
			         SELECT S01_A
			         SKIP
			      ENDDO
			      SELECT S01_A
			      USE 
			   ENDIF	
			   THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE =	INT(SINPO)
*!*				   THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=INT(ROUND(THISFORM.PAGEFRAME1.PAGE1.TXTF23.VALUE*(IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F02,0)/100)*(IIF(INDEXSEEK('B',.T.,'S01','S011'),S01.F03,0)/100),0)*(PEOP+1))
          CASE THIS.VALUE=4  		
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.T.        	     
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.T.   	      
    	       THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.F.
   	           THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE='L'
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE='所得稅'         
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=0        	
   	      CASE THIS.VALUE=5
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.READONLY=.F.       	     
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VISIBLE=.F.      	     
    	       THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.VISIBLE=.T.   	
   	           THISFORM.PAGEFRAME1.PAGE3.TXTF06.VALUE='M'   
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF07.VALUE=''  
    	       THISFORM.PAGEFRAME1.PAGE3.TXTF08.VALUE=0
    	       THISFORM.PAGEFRAME1.PAGE3.COMBOBOX07.DISPLAYVALUE=''     	     	        
       ENDCASE 	  
       THISFORM.PAGEFRAME1.PAGE3.TXTF07.REFRESH  
  ENDPROC       
ENDDEFINE