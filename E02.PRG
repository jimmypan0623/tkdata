SET EXCL OFF
CLOSE ALL
CLEAR 
AREA1='E02'
EXBO=''
FLG='0'
FCH=''
CHK=''
IF !USED('A01')
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK sys_oper+'E02'

IF !USED('A0I')
   SELE 0
   USE A0I
ELSE
   SELE A0I
ENDIF
SET ORDER TO 1  
IF !USED('A09')
   SELE 0
   USE A09
ELSE
   SELE A09
ENDIF
SET ORDER TO 1
IF !USED('A14')
   SELE 0
   USE A14
ELSE
   SELE A14
ENDIF
SET ORDER TO 1
IF !USED('B11')
   SELE 0
   USE B11
ELSE
   SELE B11
ENDIF
SET ORDER TO 1      
IF !USED('E10')
   SELE 0
   USE E10
ELSE
   SELE E10
ENDIF
SET ORDER TO 1
IF !USED('E04')
   SELE 0
   USE E04
ELSE
   SELE E04
ENDIF
SET ORDER TO 1
IF !USED('E02')
   SELE 0
   USE E02 INDE E02
ELSE
   SELE E02
ENDIF
SET ORDER TO E021
SET RELA TO F01 INTO E04
E02FORM=CREATEOBJECT("TKE02")
E02FORM.SHOW  
DEFINE CLASS TKE02 AS FORM
  CAPTION='E02.協力廠商基本主檔'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1 
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT LBL_REC AS LBL_REC WITH;
      AUTOCENTER =.T.
  ADD OBJECT REC_COUNT AS REC_COUNT  WITH;
      CAPTION=STR(RECCOUNT())       
  ADD OBJECT EXCEL_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      FONTSIZE=INT_015*9,;
      WIDTH=INT_015*65,;
      CAPTION='\<T.轉EXCEL',;
      NAME='EXCEL_BOTT'              
  ADD OBJECT LBLF01 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*27,;
      WIDTH=INT_015*50,;
      CAPTION='廠商編號'
  ADD OBJECT TXTF01 AS TEXTBOX WITH;      
      LEFT=INT_015*295,;
      TOP=INT_015*23,;
      WIDTH=INT_015*60,;
      MAXLENGTH=5,;
      NAME='TXTF01'        
  ADD OBJECT LBLF02 AS LABEL WITH;      
      LEFT=INT_015*498,;
      TOP=INT_015*27,;
      WIDTH=INT_015*50,;
      CAPTION='索引簡碼'
  ADD OBJECT TXTF02 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*23,;
      WIDTH=INT_015*50,;
      HEIGHT=INT_015*25,;
      MAXLENGTH=4,;
      NAME='TXTF02'           
  ADD OBJECT LBLF03 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*52,;
      WIDTH=INT_015*50,;
      CAPTION='公司名稱'
  ADD OBJECT TXTF03 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*48,;
      WIDTH=INT_015*290,;
      MAXLENGTH=40,;
      NAME='TXTF03'           
  ADD OBJECT LBLF04 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*77,;
      WIDTH=INT_015*50,;
      CAPTION='公司簡稱'
  ADD OBJECT TXTF04 AS TEXTBOX WITH;      
      LEFT=INT_015*295,;
      TOP=INT_015*73,;
      WIDTH=INT_015*74,;
      MAXLENGTH=8,;
      NAME='TXTF04'           
  ADD OBJECT LBLF05 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*102,;
      WIDTH=INT_015*50,;
      CAPTION='公司地址'
  ADD OBJECT TXTF05 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*98,;
      WIDTH=INT_015*358,;
      MAXLENGTH=40,;
      NAME='TXTF05'         
  ADD OBJECT LBLF09 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*127,;
      WIDTH=INT_015*50,;
      CAPTION='備註說明'        
  ADD OBJECT TXTF09 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*123,;
      WIDTH=INT_015*358,;
      MAXLENGTH=40,;
      NAME='TXTF09'          
  ADD OBJECT LBLF08 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*152,;
      WIDTH=INT_015*50,;
      CAPTION='連  絡  人'         
  ADD OBJECT TXTF08 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*295,;
      TOP=INT_015*148,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF08'      
  ADD OBJECT LBLF06 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*177,;
      WIDTH=INT_015*50,;
      CAPTION='聯絡電話'         
  ADD OBJECT TXTF06 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*173,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF06'             
  ADD OBJECT LBLF07 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*202,;
      WIDTH=INT_015*50,;
      CAPTION='傳真號碼'         
  ADD OBJECT TXTF07 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*198,;
      WIDTH=INT_015*150,;
      MAXLENGTH=20,;
      NAME='TXTF07'          
  ADD OBJECT LBLF10 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*227,;
      WIDTH=INT_015*50,;
      CAPTION='結帳方式'            
  ADD OBJECT LBLF101 AS LABEL WITH;
      LEFT=INT_015*340,;
      TOP=INT_015*227,;
      AUTOSIZE=.T.
  ADD OBJECT TXTF10 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*223,;
      WIDTH=INT_015*20,;
      MAXLENGTH=1,;
      INPUTMASK='9',;
      NAME='TXTF10'          
  ADD OBJECT COMBOBOX10 AS COMBOBOX10 WITH;    
      LEFT=INT_015*295,;
      TOP=INT_015*223               
   ADD OBJECT TXTF36 AS TXTF36  WITH;
      LEFT=INT_015*330,;
      TOP=INT_015*223            
  ADD OBJECT LBLF11 AS LABEL WITH;
      LEFT=INT_015*448,;
      TOP=INT_015*227,;
      WIDTH=INT_015*50,;
      CAPTION='入帳日期'         
  ADD OBJECT TXTF11 AS TEXTBOX WITH;
      LEFT=INT_015*499,;
      TOP=INT_015*223,;
      WIDTH=INT_015*30,;
      MAXLENGTH=2,;
      INPUTMASK='99',;
      NAME='TXTF11'                
      ***
  ADD OBJECT LBLF37 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*252,;
      WIDTH=INT_015*50,;
      CAPTION='票期天數'             
  ADD OBJECT TXTF37 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*248,;
      WIDTH=INT_015*36,;
      MAXLENGTH=4,;
      INPUTMASK='9999'
      NAME='TXTF37'           
  ADD OBJECT LBLF38 AS LABEL WITH;
      LEFT=INT_015*350,;
      TOP=INT_015*252,;
      WIDTH=INT_015*45,;
      CAPTION='請款日'          
  ADD OBJECT TXTF38 AS TEXTBOX WITH;
      LEFT=INT_015*400,;
      TOP=INT_015*248,;
      WIDTH=INT_015*30,;
      MAXLENGTH=2,;
      INPUTMASK='99'
      NAME='TXTF38'             
  ADD OBJECT LBLF13 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*277,;
      WIDTH=INT_015*50,;
      CAPTION=INT_051              
  ADD OBJECT TXTF13 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*273,;
      WIDTH=INT_015*76,;
      MAXLENGTH=10,;
      NAME='TXTF13'  
  ADD OBJECT LBLF14 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*277,;
      WIDTH=INT_015*50,;
      CAPTION=INT_052                  
  ADD OBJECT TXTF14 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*273,;
      WIDTH=INT_015*76,;
      MAXLENGTH=10,;
      NAME='TXTF14'  
  ADD OBJECT LBLF15 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*302,;
      WIDTH=INT_015*50,;
      CAPTION=INT_053              
  ADD OBJECT TXTF15 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*298,;
      WIDTH=INT_015*76,;
      NAME='TXTF15'           
  ADD OBJECT LBLF16 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*302,;
      WIDTH=INT_015*50,;
      CAPTION=INT_054            
  ADD OBJECT TXTF16 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*298,;
      WIDTH=INT_015*76,;
      NAME='TXTF16'                   
  ADD OBJECT LBLF17 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*327,;
      WIDTH=INT_015*50,;
      CAPTION=INT_055                   
  ADD OBJECT TXTF17 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*323,;
      WIDTH=INT_015*76,;
      NAME='TXTF17'                
  ADD OBJECT LBLFA142 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*327,; 
      WIDTH=INT_015*50,;    
      CAPTION='隸屬編號'            
  ADD OBJECT TXTFA141 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*323,;
      WIDTH=INT_015*50,;
      MAXLENGTH=5,;
      NAME='TXTFA141'            
  ADD OBJECT LBLFA14 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*352,;
      WIDTH=INT_015*50,;
      CAPTION='對應部門'           
  ADD OBJECT LBLFA141 AS LABEL WITH;
      LEFT=INT_015*350,;
      TOP=INT_015*352,;     
      AUTOSIZE=.T.
  ADD OBJECT TXTFA14 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*348,;
      WIDTH=INT_015*50,;
      MAXLENGTH=5,;
      NAME='TXTFA14'           
  ADD OBJECT LBLF12 AS LABEL WITH;
      LEFT=INT_015*498,;
      TOP=INT_015*352,;
      WIDTH=INT_015*50,;
      CAPTION='最後發包'               
  ADD OBJECT TXTF12 AS TEXTBOX WITH;
      LEFT=INT_015*549,;
      TOP=INT_015*348,;
      WIDTH=INT_015*74,;
      NAME='TXTF12'           
  ADD OBJECT LBLF39 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*377,;
      WIDTH=INT_015*50,;
      CAPTION='發包人員'         
  ADD OBJECT LBLF391 AS LABEL WITH;
      LEFT=INT_015*360,;
      TOP=INT_015*380,;
      AUTOSIZE=.T.,;
      CAPTION=''            
  ADD OBJECT TXTF39 AS TEXTBOX WITH;
      LEFT=INT_015*295,;
      TOP=INT_015*373,;
      WIDTH=INT_015*55,;
      MAXLENGTH=5,;
      NAME='TXTF39'                  
  ADD OBJECT LBLF99 AS LABEL WITH;
      LEFT=INT_015*244,;
      TOP=INT_015*450,;
      WIDTH=INT_015*50,;
      CAPTION='安全資料'   
  ADD OBJECT LBLF991 AS LABEL WITH;
      LEFT=INT_015*300,;
      TOP=INT_015*450,;
      AUTOSIZE=.T.,;
      NAME='LBLF991'                                     
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=3,;            
      RECORDSOURCE='E02',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3' 
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      AUTOSIZE=.T.              
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;      
      AUTOSIZE=.T.              
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*455,;
      LEFT=INT_015*498           
  PROCEDURE INIT
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
       THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.)       
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')       
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='廠商編號'
	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='索引簡碼'
	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='廠商簡稱'	   
	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='E02.F01'
	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='E02.F02'
	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='E02.F04'
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS          
       JK='廠商編號'
  ENDPROC     

  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依廠商編號排列')
           .ADDITEM('依索引簡碼排列')
       ENDWITH      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE E02
       DO CASE
          CASE THIS.DISPLAYVALUE='依廠商編號排列'
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='廠商編號'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='E02.F01'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='E02.F02'       
               SET ORDER TO E021     
          CASE THIS.DISPLAYVALUE='依索引簡碼排列'
               THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='索引簡碼'
               THISFORM.GRID1.COLUMN1.CONTROLSOURCE='E02.F02'
               THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='廠商編號'
               THISFORM.GRID1.COLUMN2.CONTROLSOURCE='E02.F01'   
               SET ORDER TO E022
       ENDCASE 
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC                
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS nColIndex
       THISFORM.TXTF01.VALUE=E02.F01
       THISFORM.TXTF02.VALUE=E02.F02
       THISFORM.TXTF03.VALUE=E02.F03
       THISFORM.TXTF04.VALUE=E02.F04
       THISFORM.TXTF05.VALUE=E02.F05
       THISFORM.TXTF08.VALUE=E02.F08
       THISFORM.TXTF06.VALUE=E02.F06
       THISFORM.TXTF07.VALUE=E02.F07
       THISFORM.TXTF11.VALUE=E02.F11
       THISFORM.TXTF12.VALUE=E02.F12
       THISFORM.TXTF10.VALUE=E02.F10
       
       THISFORM.TXTF11.VALUE=E02.F11
       THISFORM.TXTF09.VALUE=E02.F09
       THISFORM.TXTF13.VALUE=E02.F13
       THISFORM.TXTF14.VALUE=E02.F14
       THISFORM.TXTF15.VALUE=E02.F15
       THISFORM.TXTF16.VALUE=E02.F16
       THISFORM.TXTF17.VALUE=E02.F17
       THISFORM.TXTF36.VALUE=E02.F36
       THISFORM.TXTF37.VALUE=E02.F37
       THISFORM.TXTF38.VALUE=E02.F38          
       THISFORM.TXTF39.VALUE=E02.F39  
       THISFORM.LBLF391.CAPTION=IIF(SEEK(F39,'A01'),A01.F03,'')         
       THISFORM.LBLF101.CAPTION=IIF(E02.F10='0','現結',IIF(E02.F10='1','月結',IIF(E02.F10='2','次月結','T/T  '+ALLTRIM(STR(F36))+'  天')))
       THISFORM.TXTFA14.VALUE=LEFT(E04.F02,4)
       THISFORM.LBLFA141.CAPTION=IIF(SEEK(THISFORM.TXTFA14.VALUE,'A14'),A14.F02,'')
       THISFORM.TXTFA141.VALUE=E04.F02
       THISFORM.LBLF991.CAPTION=E02.F99
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       thisform.refresh
  ENDPROC       
  PROCEDURE TXTF03.INTERACTIVECHANGE
    THISFORM.TXTF04.VALUE=LEFT(THIS.VALUE,8 )
    THISFORM.TXTF04.REFRESH    
  ENDPROC
*!*	  PROCEDURE TXTF10.VALID
*!*	    LPARAMETERS NINDEX
*!*	    IF THIS.VALUE<'2'
*!*	       NINDEX=.T.
*!*	    ELSE
*!*	       =MESSAGEBOX("請輸入'0'代表'現結'或是'1'代表'月結'!",0+64,"提示視窗")
*!*	       NINDEX=.F.
*!*	    ENDIF
*!*	    RETURN NINDEX
*!*	  ENDPROC  
*!*	  PROCEDURE TXTF10.INTERACTIVECHANGE  
*!*	    THISFORM.LBLF101.CAPTION=IIF(THIS.VALUE='0','現結','月結')
*!*	  ENDPROC
  PROCEDURE TXTF11.VALID
    LPARAMETERS NINDEX
    IF ALLTRIM(THIS.VALUE)<'32'
       NINDEX=.T.
    ELSE 
       =messagebox('輸入資料格式不符',0+64,'提示視窗')       
       NINDEX=.F.   
    ENDIF   
    RETURN NINDEX
  ENDPROC   
  PROCEDURE TXTFA14.INTERACTIVECHANGE
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F02 FROM A14 INTO CURSOR DEPART ORDER BY F01 WHERE LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) AND LEN(ALLTRIM(F01))=4 AND F04='*'
       ELSE
          SELECT F01,F02 FROM A14 INTO CURSOR DEPART ORDER BY F01 WHERE LEN(ALLTRIM(F01))=4 AND F04='*'
       ENDIF   
       DEPART_SEEK=createobject("DEPART_SEEK")  
       DEPART_SEEK.SHOW    
       THIS.VALUE=FLG
       THIS.REFRESH
       FLG='0'
    ENDIF   
       THISFORM.LBLFA141.CAPTION=IIF(SEEK(THIS.VALUE,'A14'),A14.F02,'')  
       THISFORM.TXTFA141.VALUE=THIS.VALUE
  ENDPROC  
  PROCEDURE TXTF39.INTERACTIVECHANGE      
    IF AT('?',ALLTRIM(THIS.VALUE))<>0
       IF AT('?',ALLTRIM(THIS.VALUE))>1             
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 WHERE  LEFT(F01,AT('?',THIS.VALUE)-1)=LEFT(THIS.VALUE,AT('?',THIS.VALUE)-1) NOWAIT
       ELSE
          SELECT F01,F03 FROM A01 INTO CURSOR MAN ORDER BY F01 NOWAIT   
       ENDIF   
       MAN_SEEK=CREATEOBJECT("MAN_SEEK")  
       MAN_SEEK.SHOW    
       THIS.VALUE=FLG
       THIS.REFRESH
       FLG='0'
    ENDIF   
       THISFORM.LBLF391.CAPTION=IIF(SEEK(THIS.VALUE,'A01'),A01.F03,'')
  ENDPROC      
  PROCEDURE ORPGROUP.NEW_BOTT.CLICK   
    THISFORM.SETALL('READONLY',.F.,'TEXTBOX')    
    THISFORM.TXTF10.VISIBLE=.F.
    THISFORM.COMBOBOX10.VISIBLE=.T.
    THISFORM.COMBOBOX10.ENABLED=.T.
    THISFORM.TXTF37.READONLY=.T.      
    thisform.txtF12.readonly=.t.
    IF INT_006=.T. 
       H='E000 '    
       SELE A0I   
       SET ORDER TO 1
       SEEK H           
       IF FOUND() 
          PO_NO=F08
          RLOCK()
          DELE 
          UNLOCK
       ELSE
          SELE A09
          SEEK H
          IF FOUND()
             RLOCK()
             PO_NO=RIGHT(ALLTRIM(F08),4)
             HX=VAL(PO_NO)+1
             PO_NO='0000'
             PO_NO=LEFT(F08,1)+STUFF(PO_NO,5-INT(LOG(HX)/LOG(10)+1),INT(LOG(HX)/LOG(10)+1),RIGHT(STR(HX),INT(LOG(HX)/LOG(10)+1)))
             REPL F08 WITH PO_NO
             UNLOCK              
          ENDIF   
       ENDIF
       THISFORM.TXTF01.VALUE=PO_NO
       THISFORM.TXTF01.REFRESH
       thisform.txtf01.readonly=.t.
       THISFORM.TXTF02.SETFOCUS
    ELSE
       THISFORM.TXTF01.VALUE=''
       THISFORM.TXTF01.SETFOCUS           
    ENDIF       
    THISFORM.TXTF02.VALUE=''
    THISFORM.TXTF03.VALUE=''
    THISFORM.TXTF04.VALUE=''
    THISFORM.TXTF05.VALUE=''
    THISFORM.TXTF08.VALUE=''
    THISFORM.TXTF06.VALUE=''
    THISFORM.TXTF07.VALUE=''
    THISFORM.TXTF10.VALUE='0'
    THISFORM.LBLF101.CAPTION='現結'
    THISFORM.COMBOBOX10.VALUE=1      
    THISFORM.TXTF11.VALUE=''
    THISFORM.TXTF12.VALUE=''
    THISFORM.TXTF12.VALUE=CTOD('')
    THISFORM.txtF11.value='31'
    THISFORM.TXTF09.VALUE=''
    THISFORM.TXTF13.VALUE=''
    THISFORM.TXTF14.VALUE=''
    THISFORM.TXTF15.VALUE=''
    THISFORM.TXTF16.VALUE=''
    THISFORM.TXTF17.VALUE=''    
    THISFORM.TXTFA14.VALUE=''
    THISFORM.TXTFA141.VALUE=''  
    THISFORM.LBLFA141.CAPTION=''  
    THISFORM.TXTF36.VALUE=0
    THISFORM.TXTF37.VALUE=0
    THISFORM.TXTF38.VALUE=1       
    THISFORM.TXTF39.VALUE='' 
    THISFORM.LBLF391.CAPTION=''    
    THISFORM.LBLF991.CAPTION=''
    THISFORM.EXCEL_BOTT.ENABLED=.F.
    THISFORM.GRID1.ENABLED=.F.
    FLG='1'
  ENDPROC  
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK
     THISFORM.TXTF01.READONLY=.T.
     THISFORM.TXTF12.READONLY=.T.
     THISFORM.TXTF10.VISIBLE=.F.
     THISFORM.COMBOBOX10.VISIBLE=.T.
     THISFORM.COMBOBOX10.ENABLED=.T.     
     THISFORM.COMBOBOX10.VALUE=IIF(E02.F10='0',1,IIF(E02.F10='1',2,IIF(E02.F10='2',3,4)))
     THISFORM.LBLF101.LEFT=IIF(F10='3',INT_015*375,INT_015*340)     
     THISFORM.TXTF36.READONLY=IIF(F10='3',.F.,.T.)
     THISFORM.TXTF36.VISIBLE=IIF(F10='3',.T.,.F.)
     THISFORM.TXTF37.READONLY=IIF(F10='0' .OR. F10='3',.T.,.F.)     
     THISFORM.EXCEL_BOTT.ENABLED=.F.
     THISFORM.GRID1.ENABLED=.F.
     THISFORM.TXTF03.SETFOCUS
     LOCK()
     IF !RLOCK()
        DO file_impact
        return
     endif
  endproc 
  PROCEDURE ORPGROUP.DEL_BOTT.CLICK
     if messagebox('是否確定要刪除此筆資料',4+32+256,'請確認') = 6	      
        SELE E10   
        SEEK E02.F01
        IF FOUND()
           =MESSAGEBOX('此廠商仍有詢價資料,無法刪除',0+64,'注意')
           sele E02
           RETURN
        ENDIF
        SELE B11
        SEEK E04.F02
        IF FOUND()
           =MESSAGEBOX('此廠商仍有庫存帳,無法刪除',0+48,'注意')
           SELE E02
           RETURN
        ENDIF   
        SELE E02
        LOCK()
        IF RLOCK()
           IF INT_006=.T.
              SELE A0I        
              SET ORDER TO 1
              APPEND BLANK
              LOCK()
              REPL F01 WITH 'E000 '
              REPL F06 WITH '廠商編號'
              REPL F08 WITH E02.F01
              UNLOCK
            ENDIF
            SELE A14
            SEEK E04.F02
            IF FOUND()
               DELE
            ENDIF   
            SELE E04
            DELE
            SELE E02
            DELE
            unlock
            SKIP -1
            IF BOF()
               GO TOP
            ENDIF  
            THISFORM.GRID1.SETFOCUS
            IF THISFORM.GRID1.ACTIVEROW=0
               THISFORM.SETALL('VALUE','','TEXTBOX')
               THISFORM.CMDGROUP.ENABLED=.F.
            ELSE
               THISFORM.CMDGROUP.ENABLED=.T.            
               THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
               THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
               THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限 
               THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.)                
            ENDIF 
        ELSE
           DO file_impact    
        ENDIF       
     ENDIF        
  ENDPROC     
  PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK
    SELE E02
    COD=SYS(21)
    SET ORDER TO E021
    seek ALLTRIM(THISFORM.TXTF01.VALUE)
    if found()
       =messagebox('廠商編號重複!',0+64,'提示視窗')
       SET ORDER TO &COD
       RETURN
    ENDIF
    IF EMPTY(THISFORM.TXTF02.VALUE) .OR. LEN(ALLTRIM(THISFORM.TXTF02.VALUE))<4
       =MESSAGEBOX('索引簡碼不得空白!且不得小於四碼',0+64,'提示視窗')  
       SET ORDER TO &COD 
       THISFORM.TXTF02.SETFOCUS
       RETURN
    ENDIF   
     IF chk_unit(THISFORM.TXTF13.VALUE)=.f. AND !EMPTY(ALLTRIM(thisform.txtf13.value))
       =MESSAGEBOX('統一編號輸入錯誤!',0+48,'提示訊息視窗')
       SET ORDER TO &COD
       THISFORM.TXTF13.SETFOCUS
       RETURN
    ENDIF       
    
    IF EMPTY(THISFORM.TXTFA14.VALUE) .OR. !SEEK(THISFORM.TXTFA14.VALUE,'A14','A141') .OR. LEN(ALLTRIM(THISFORM.TXTFA14.VALUE))<>4
       =MESSAGEBOX('無此內部部門編號!',0+48,'提示訊息視窗')
       SET ORDER TO &COD
       THISFORM.TXTFA14.SETFOCUS
       RETURN
    ENDIF    
    IF LEFT(THISFORM.TXTFA141.VALUE,4)<>LEFT(THISFORM.TXTFA14.VALUE,4)
       =MESSAGEBOX('隸屬部門編號前四碼必需與對應部門編號相同!',0+48,'提示訊息視窗')
       THISFORM.TXTFA141.SETFOCUS
       RETURN
    ENDIF
    IF SEEK(THISFORM.TXTFA141.VALUE,'A14','A141') 
       =MESSAGEBOX('隸屬編號重複!',0+48,'提示訊息視窗')
       SET ORDER TO &COD
       THISFORM.TXTFA141.SETFOCUS
       RETURN       
    ENDIF
     IF EMPTY(THISFORM.TXTF38.VALUE)
        =MESSAGEBOX('請款日不得為零!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF
     IF THISFORM.TXTF38.VALUE>31
        =MESSAGEBOX('請款日不得超過31日!',0+48,'提示訊息視窗')
        SET ORDER TO &COD
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF       
     IF SEEK(THISFORM.TXTF39.VALUE,'A01','A01')=.F. OR EMPTY(THISFORM.TXTF39.VALUE)
         =MESSAGEBOX('發包人員資料輸入錯誤!',0+64,'提示視窗')   
         THISFORM.TXTF39.SETFOCUS
         SET ORDER TO &COD
         RETURN
     ENDIF        
    APPEND BLANK
    LOCK()
    IF RLOCK()
       REPLACE F01 WITH THISFORM.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.TXTF02.VALUE
       REPLACE F03 WITH THISFORM.TXTF03.VALUE
       REPLACE F04 WITH THISFORM.TXTF04.VALUE
       REPLACE F05 WITH THISFORM.TXTF05.VALUE
       REPLACE F08 WITH THISFORM.TXTF08.VALUE
       REPLACE F06 WITH THISFORM.TXTF06.VALUE
       REPLACE F07 WITH THISFORM.TXTF07.VALUE
       REPLACE F11 WITH THISFORM.TXTF11.VALUE
       REPLACE F10 WITH THISFORM.TXTF10.VALUE
       REPLACE F11 WITH THISFORM.TXTF11.VALUE
       REPLACE F09 WITH THISFORM.TXTF09.VALUE
       REPLACE F13 WITH THISFORM.TXTF13.VALUE
       REPLACE F14 WITH THISFORM.TXTF14.VALUE
       REPLACE F15 WITH THISFORM.TXTF15.VALUE
       REPLACE F16 WITH THISFORM.TXTF16.VALUE
       REPLACE F17 WITH THISFORM.TXTF17.VALUE  
       REPLACE F99 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')
       IF THISFORM.COMBOBOX10.VALUE=4
            REPLACE F36 WITH THISFORM.TXTF36.VALUE
       ENDIF       
       REPLACE F37 WITH THISFORM.TXTF37.VALUE
       REPLACE F38 WITH THISFORM.TXTF38.VALUE   
       REPLACE F39 WITH THISFORM.TXTF39.VALUE     
       SELE E04
       APPEND BLANK
       REPL F01 WITH E02.F01
       REPL F02 WITH THISFORM.TXTFA141.VALUE
       SELE A14
       APPEND BLANK
       REPL F01 WITH THISFORM.TXTFA141.VALUE
       REPL F02 WITH E02.F04 
       REPL F04 WITH '*'
       REPL F05 WITH '*'
       REPL F13 WITH '*'
       REPL F06 WITH '廠商編號:'+E02.F01
       SELE E02           
    ENDIF
    UNLOCK    
    SET ORDER TO &COD  
    THISFORM.REC_COUNT.CAPTION=STR(RECCOUNT())
    THISFORM.GRID1.ENABLED=.T.
    THISFORM.REFRESH
    THISFORM.GRID1.SETFOCUS    
    THISFORM.ORPGROUP.NEW_BOTT.CLICK            
  ENDPROC
  PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK
    IF EMPTY(THISFORM.TXTF02.VALUE) .OR. LEN(ALLTRIM(THISFORM.TXTF02.VALUE))<4
       =MESSAGEBOX('索引簡碼不得空白!且不得小於四碼',0+64,'提示視窗')  
       THISFORM.TXTF02.SETFOCUS        
       RETURN
    ENDIF     
    IF chk_unit(THISFORM.TXTF13.VALUE)=.f. AND !EMPTY(ALLTRIM(thisform.txtf13.value))
       =MESSAGEBOX('統一編號輸入錯誤!',0+48,'提示訊息視窗')
       THISFORM.TXTF13.SETFOCUS
       RETURN
    ENDIF           
     IF EMPTY(THISFORM.TXTFA14.VALUE) .OR. !SEEK(THISFORM.TXTFA14.VALUE,'A14','A141') .OR. LEN(ALLTRIM(THISFORM.TXTFA14.VALUE))<>4
       =MESSAGEBOX('無此內部部門編號!',0+48,'提示訊息視窗')
       THISFORM.TXTFA14.SETFOCUS
       RETURN
    ENDIF    
    IF LEFT(THISFORM.TXTFA141.VALUE,4)<>LEFT(THISFORM.TXTFA14.VALUE,4)
       =MESSAGEBOX('隸屬部門編號前四碼必需與對應部門編號相同!',0+48,'提示訊息視窗')
       THISFORM.TXTFA141.SETFOCUS
       RETURN
    ENDIF
*!*	    IF SEEK(THISFORM.TXTFA141.VALUE,'A14','A141') 
*!*	       =MESSAGEBOX('隸屬編號重複!',0+48,'提示訊息視窗')
*!*	       THISFORM.TXTFA141.SETFOCUS
*!*	       RETURN       
*!*	    ENDIF   
     IF EMPTY(THISFORM.TXTF38.VALUE)
        =MESSAGEBOX('請款日不得為零!',0+48,'提示訊息視窗')
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF     
     IF THISFORM.TXTF38.VALUE>31
        =MESSAGEBOX('請款日不得超過31日!',0+48,'提示訊息視窗')
        THISFORM.TXTF38.SETFOCUS
        RETURN
     ENDIF         
    IF SEEK(THISFORM.TXTF39.VALUE,'A01','A01')=.F. .OR. EMPTY(THISFORM.TXTF39.VALUE)
       =MESSAGEBOX('發包人員資料輸入錯誤!',0+64,'提示視窗')   
       THISFORM.TXTF39.SETFOCUS
       RETURN
     ENDIF          
     IF THISFORM.TXTF03.VALUE<>E02.F03
          SELECT A14
          SEEK THISFORM.TXTFA141.VALUE
          IF FOUND()
              REPLACE F02 WITH THISFORM.TXTF03.VALUE
          ENDIF              
     ENDIF
    IF THISFORM.TXTFA141.VALUE<>E04.F02
       SELE A14
       SET FILTER TO F01<>E04.F02
       GO TOP
       IF !SEEK(THISFORM.TXTFA141.VALUE,'A14')
          SELE A14 
          SET FILTER TO          
          SEEK E04.F02
          IF FOUND()
             DELE
          ENDIF
          APPEND BLANK
          REPLACE  F01 WITH THISFORM.TXTFA141.VALUE
          REPLACE  F02 WITH E02.F04 
          REPLACE  F04 WITH '*'      
          REPLACE F05 WITH '*'
          REPLACE  F06 WITH '廠商編號:'+E02.F01       
          REPLACE F13 WITH '*'          
          SELE E04
          REPL F02 WITH THISFORM.TXTFA141.VALUE                       
       ELSE
          =MESSAGEBOX('隸屬編號重複!',0+48,'提示訊息視窗')       
          THISFORM.TXTFA141.SETFOCUS
          RETURN
       ENDIF
    ENDIF
    SELE E02
    IF RLOCK()
       REPLACE F01 WITH THISFORM.TXTF01.VALUE
       REPLACE F02 WITH THISFORM.TXTF02.VALUE
       REPLACE F03 WITH THISFORM.TXTF03.VALUE
       REPLACE F04 WITH THISFORM.TXTF04.VALUE
       REPLACE F05 WITH THISFORM.TXTF05.VALUE
       REPLACE F08 WITH THISFORM.TXTF08.VALUE
       REPLACE F06 WITH THISFORM.TXTF06.VALUE
       REPLACE F07 WITH THISFORM.TXTF07.VALUE
       REPLACE F11 WITH THISFORM.TXTF11.VALUE
       REPLACE F10 WITH THISFORM.TXTF10.VALUE
       REPLACE F11 WITH THISFORM.TXTF11.VALUE
       REPLACE F09 WITH THISFORM.TXTF09.VALUE
       REPLACE F13 WITH THISFORM.TXTF13.VALUE
       REPLACE F14 WITH THISFORM.TXTF14.VALUE
       REPLACE F15 WITH THISFORM.TXTF15.VALUE
       REPLACE F16 WITH THISFORM.TXTF16.VALUE
       REPLACE F17 WITH THISFORM.TXTF17.VALUE  
       REPLACE F99 WITH IIF(INT_012=1,PADL(ALLTRIM(STR(YEAR(DATE())-1911)),3,' ')+RIGHT(DTOC(DATE()),6),dtoc(DATE())+' ')+IIF(SEEK(sys_oper,'A01'),A01.F03,'')  
       IF THISFORM.COMBOBOX10.VALUE=4
            REPLACE F36 WITH THISFORM.TXTF36.VALUE
       ENDIF
       REPLACE F37 WITH THISFORM.TXTF37.VALUE
       REPLACE F38 WITH THISFORM.TXTF38.VALUE 
       REPLACE F39 WITH THISFORM.TXTF39.VALUE                     
    ELSE
      DO file_impact
      return   
    ENDIF   
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
  ENDPROC   
  procedure SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)   &&判斷有無新增的權限
      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.)  &&判斷有無修改的權限
      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.)   &&判斷有無刪除的權限
      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限      
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.KEY_LIST.ENABLED=.T.      
      THISFORM.EXCEL_BOTT.ENABLED=IIF(A02.F10='*',.T.,.F.)  
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.TXTF10.VISIBLE=.T.
      THISFORM.LBLF101.LEFT=INT_015*340
      THISFORM.COMBOBOX10.VISIBLE=.F.
      THISFORM.COMBOBOX10.ENABLED=.F.      
      THISFORM.TXTF36.READONLY=.T.
      THISFORM.TXTF36.VISIBLE=.F.            
      UNLOCK ALL 
      SELE E02
      THISFORM.GRID1.ENABLED=.T.
      THISFORM.GRID1.SETFOCUS    
  ENDPROC
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
       IF INT_006=.T.
          SELE A0I
          SET ORDER TO 1
          APPEND BLANK
          LOCK()
          REPL F01 WITH 'E000 '
          REPL F06 WITH '廠商編號'
          REPL F08 WITH PO_NO
          UNLOCK
       ENDIF   
       SELE E02
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
  PROC EXCEL_BOTT.CLICK
       EXBO='1'
       SELECT E02
       ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
       ANS_RANGE.SHOW 
       EXBO=''
       THISFORM.GRID1.SETFOCUS
  ENDPROC     
ENDDEFINE      

**************************************列印程序 
PROC PNT_PRC
   SELECT E02
   PO_NO=E02.F01
   ANS_CHK=CREATEOBJECT("ANS_CHK")  
   ANS_CHK.SHOW        
ENDPROC
********************************************************
DEFINE CLASS ANS_CHK AS FORM
  AUTOCENTER=.T.
  CAPTION='請選擇列印內容'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*105
  WIDTH=INT_015*230
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_CHK'
ADD OBJECT DATA_OPTION AS OPTIONGROUP WITH;
      LEFT=INT_015*17,;
      TOP=INT_015*20,;
      AUTOSIZE=.T.,;
      FONTSIZE=INT_015*12,;
      BUTTONCOUNT=3,;
      OPTION1.CAPTION='列印信封',;
      OPTION1.TOP=INT_015*0,;
      OPTION1.FONTSIZE=INT_015*9,;
      OPTION1.AUTOSIZE=.T.,;
      OPTION2.CAPTION='列印標籤',;
      OPTION2.TOP=INT_015*20,;
      OPTION2.FONTSIZE=INT_015*9,;
      OPTION2.AUTOSIZE=.T.,;      
      OPTION3.CAPTION='列印協力廠資料明細',;
      OPTION3.TOP=INT_015*40,;
      OPTION3.FONTSIZE=INT_015*9,;
      OPTION3.AUTOSIZE=.T.,;
      NAME='DATA_OPTION'   
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;     
      TOP=INT_015*20,;  
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<Y.確定',;
      TOOLTIPTEXT='確認所選擇的鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*165,;
      TOP=INT_015*60,;
      HEIGHT=INT_015*25,;    
      WIDTH=INT_015*50,;
      FONTSIZE=INT_015*9,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'     
  *****   
  PROCEDURE CMND1.CLICK   
        DO  CASE
               CASE THISFORM.DATA_OPTION.VALUE=1
		          SELE F03,F05,F08 FROM E02 WHERE F01=PO_NO NOWAIT     
		          IF _TALLY>0
		               REPORT FORM ALLTRIM(INT_116)+'E02' TO PRINT PROMPT        
		          ENDIF               
               CASE THISFORM.DATA_OPTION.VALUE=2
      			     LBL_QTY=CREATEOBJECT("LBL_QTY")  
         		    LBL_QTY.SHOW                                      
               CASE THISFORM.DATA_OPTION.VALUE=3    
                  	  ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   			           ANS_RANGE.SHOW                  
        ENDCASE 
        THISFORM.CMND2.CLICK                         
  ENDPROC  
******
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC      
ENDDEFINE  
******************************************LABEL列印張數
DEFINE CLASS LBL_QTY AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印張數'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*190
  WIDTH=INT_015*200
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='LBL_QTY'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*75,;
      FONTSIZE=INT_015*9,;
      NAME='LABEL1'
      ADD OBJECT TEXT1 AS TEXTBOX WITH;
          AUTOSIZE=.T.,;
          TOP=INT_015*70,;
          WIDTH=INT_015*30,;
          LEFT=INT_015*120,;
          HEIGHT=INT_015*25,; 
          FONTSIZE=INT_015*9,;
          INPUTMASK='99'
          NAME='TEXT1'
      ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
          AUTOSIZE=.T.,;
          LEFT=INT_015*25,;    
          HEIGHT=INT_015*25,;   
          TOP=INT_015*144,;  
          WIDTH=INT_015*80,;
          FONTSIZE=INT_015*9,;          
          CAPTION='\<Y.執行',;
          TOOLTIPTEXT='確認欲列印張數!快速鍵->ALT+Y',;
          NAME='CMND1'
      ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
          AUTOSIZE=.T.,;
          LEFT=INT_015*90,;
          TOP=INT_015*144,;
          HEIGHT=INT_015*25,;
          WIDTH=INT_015*80,;
          FONTSIZE=INT_015*9,;
          CAPTION='\<C.取消',;
          TOOLTIPTEXT='取消列印作業!快速鍵->ALT+C',;
          NAME='CMND2'
      PROCEDURE INIT 
          THISFORM.LABEL1.CAPTION='列印張數'
          THISFORM.TEXT1.VALUE=1
      ENDPROC    
      PROCEDURE CMND1.CLICK 
          SELE F03,F05,F06 FROM E02  WHERE F01=PO_NO INTO CURSOR LBL1
          CREATE CURSOR  LBL2 (F03 C(40), F05 C(40),F06 C(20))
          SELE LBL2
          FOR I=1 TO THISFORM.TEXT1.VALUE
              APPEND BLANK
              REPL F03 WITH LBL1.F03
              REPL F05 WITH LBL1.F05
              REPL F06 WITH LBL1.F06
          ENDFOR
            REPORT FORM ALLTRIM(INT_116) + 'E02A' TO PRINT PROMPT 
*!*	              REPORT FORM ALLTRIM(INT_116)+'E02A' TO PRINT PROMPT PREVIEW
              SELE LBL2
              USE
              SELE LBL1
              USE               
          THISFORM.RELEASE                
      ENDPROC
      PROCEDURE CMND2.CLICK
          THISFORM.RELEASE
      ENDPROC      
ENDDEFINE            
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*110
  WIDTH=INT_015*320
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      WIDTH=INT_015*60,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*25,;
      TOP=INT_015*25,;
      CAPTION='起始編號',;
      NAME='LABEL1'
  ADD OBJECT LABEL2 AS LABEL WITH;
      WIDTH=INT_015*60,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*172,;
      TOP=INT_015*25,;
      CAPTION='截止編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      WIDTH=INT_015*70,;
      TOP=INT_015*19,;
      LEFT=INT_015*85,;
      HEIGHT=INT_015*25,; 
      MAXLENGTH=5,; 
      NAME='TEXT1'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      WIDTH=INT_015*70,;
      TOP=INT_015*19,;
      LEFT=INT_015*230,;
      HEIGHT=INT_015*25,;  
      MAXLENGTH=5,;        
      NAME='TEXT2'    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*90,;    
      HEIGHT=INT_015*25,;   
      TOP=INT_015*70,;  
      WIDTH=INT_015*50,;
      CAPTION='\<Y.執行',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*215,;
      TOP=INT_015*70,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*50,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'
  PROCEDURE INIT 
      SELECT E02
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')                                             
      DO CASE
            CASE KEY()='F01'
                      THISFORM.LABEL1.CAPTION='起始編號'
                      THISFORM.LABEL2.CAPTION='截止編號'
                      THISFORM.TEXT1.MAXLENGTH=5
                      THISFORM.TEXT2.MAXLENGTH=5
                      THISFORM.TEXT1.VALUE=E02.F01
                      THISFORM.TEXT2.VALUE=E02.F01     
            CASE KEY()='F02'
                      THISFORM.LABEL1.CAPTION='起始簡碼'
                      THISFORM.LABEL2.CAPTION='截止簡碼'
                      THISFORM.TEXT1.MAXLENGTH=4
                      THISFORM.TEXT2.MAXLENGTH=4            
                      THISFORM.TEXT1.VALUE=E02.F02
                      THISFORM.TEXT2.VALUE=E02.F02 
      ENDCASE
  ENDPROC    
  PROCEDURE CMND1.CLICK     
      DO CASE
            CASE KEY()='F01'
                      SELECT * FROM E02 WHERE  E02.F01>=THISFORM.TEXT1.VALUE .AND. E02.F01<=THISFORM.TEXT2.VALUE ORDER BY E02.F01 INTO CURSOR E02_TEMP  
            CASE KEY()='F02'
                      SELECT * FROM E02 WHERE  E02.F02>=THISFORM.TEXT1.VALUE .AND. E02.F02<=THISFORM.TEXT2.VALUE ORDER BY E02.F02 INTO CURSOR E02_TEMP                             
      ENDCASE
        SELECT E02_TEMP
        GO TOP
	IF _TALLY>0
	     IF EMPTY(EXBO)
	         REPORT FORM ALLTRIM(INT_116)+'E02B' TO PRINT PROMPT PREVIEW 
	     ELSE
	         SELECT F01 協力廠商編號,F02 索引簡碼,F03 名稱,F04 簡稱,F05 地址,F06 電話,F07 傳真機,F08 聯絡人,F09 備註,F10 結帳方式,;
	                F11 入帳日期,F12 最後設定工資日,F13 統一編號,F14 使用者自定,F15 使用者自定,F16 使用者自定,F17 使用者自定,F36 TT之天數,;
	                F37 票期天數,F38 請款日,F39 發包人員 FROM E02_TEMP ORDER BY F01 INTO CURSOR E02AA
	         SELECT E02AA
	         FILENAME='協力廠商資料明細'
		     GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
		 IF !EMPTY(GCDELIMFILE) 
		      ON ERROR DO FILE_IMPACT
		      COPY TO (GCDELIMFILE) TYPE XL5     
		       =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗') 
		  ENDIF     
	     ENDIF
	     THISFORM.CMND2.CLICK
	ELSE
	     =MESSAGEBOX('無此範圍資料',0+48,'警示')
      	 THISFORM.TEXT1.VALUE=''
      	 THISFORM.TEXT2.VALUE=''	     
	     THISFORM.TEXT1.SETFOCUS
	ENDIF         
  ENDPROC
  PROCEDURE CMND2.CLICK
      THISFORM.RELEASE
  ENDPROC        
ENDDEFINE   
**************************************結帳方式
DEFINE CLASS COMBOBOX10 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*35
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2   
       VALUE=1
       NAME='COMBOBOX10'
 PROCEDURE INIT    
       THIS.ADDITEM('0')
       THIS.ADDITEM('1')
       THIS.ADDITEM('2')
       THIS.ADDITEM('3')
  ENDPROC  
   PROCEDURE INTERACTIVECHANGE
   THISFORM.LBLF101.LEFT=INT_015*340
   THISFORM.TXTF36.READONLY=.T.
   THISFORM.TXTF36.VISIBLE=.F. 
   THISFORM.TXTF37.READONLY=.F.
       DO CASE 
             CASE THIS.VALUE=1
                        THISFORM.TXTF10.VALUE='0'
                        THISFORM.LBLF101.CAPTION='現結'
                        THISFORM.TXTF37.READONLY=.T.
             CASE THIS.VALUE=2
                        THISFORM.TXTF10.VALUE='1'
                        THISFORM.LBLF101.CAPTION='月結'         
             CASE THIS.VALUE=3
                        THISFORM.TXTF10.VALUE='2'
                        THISFORM.LBLF101.CAPTION='次月結'      
             CASE THIS.VALUE=4                        
                        THISFORM.TXTF10.VALUE='3'
                        THISFORM.LBLF101.CAPTION='T/T  '+ALLTRIM(STR(THISFORM.TXTF36.VALUE))+'  天'
                        THISFORM.LBLF101.LEFT=INT_015*375
                        THISFORM.TXTF36.VISIBLE=.T. 
                        THISFORM.TXTF36.READONLY=.F.
                        THISFORM.TXTF36.VALUE=0     
                        THISFORM.TXTF37.READONLY=.T.
        ENDCASE
       THISFORM.TXTF10.REFRESH    
       THISFORM.TXTF36.REFRESH 
  ENDPROC       
ENDDEFINE
*********T/T天數
DEFINE CLASS TXTF36 AS TEXTBOX
  VISIBLE=.F.
  READONLY=.T.
  MAXLENGTH=4
  WIDTH=INT_015*35
  HEIGHT=INT_015*25
  INPUTMASK='9999'
  FONTSIZE=INT_015*9  
  PROCEDURE INTERACTIVECHANGE     
       THISFORM.LBLF101.CAPTION='T/T  '+ALLTRIM(STR(THIS.VALUE))+'  天'  
  ENDPROC
ENDDEFINE  
