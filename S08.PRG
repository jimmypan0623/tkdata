***程式名稱:S08.懲處作業
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
CHK_NULL=''	&&判定GRID1資料是否為空
R=0
AREA1='S05'
AREA2='S08'
IF !USED('A01')	&&操作人員資料設定
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')	&&權限設定檔
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021    
SEEK SYS_OPER+'S05'  
IF FOUND()  AND A02.F09='*'   &&判斷是否有權限可處理所有員工
    ALL_CHK=.T.
ELSE
    ALL_CHK=.F.
ENDIF
SELECT A02  
SEEK SYS_OPER+'S08'           
IF !USED('A14')	&&部門設定檔
   SELE 0
   USE A14
ELSE 
   SELE A14
ENDIF
SET ORDER TO A141     
IF !USED('S00')	&&薪資參數設定
   SELE 0
   USE S00 
ELSE
   SELE S00
ENDIF
SET ORDER TO S004
IF !USED('S05')	&&人事薪資基本資料
   SELE 0
   USE S05 
ELSE
   SELE S05
ENDIF
IF  ALL_CHK=.F. 
      SET FILTER TO F27=.T.
ENDIF
SET ORDER TO S051
IF !USED('S08')	&&懲處作業資料
   SELE 0
   USE S08
ELSE
   SELE S08
ENDIF
SET ORDER TO S081
********
S08FORM=CREATEOBJECT("TKS08")
S08FORM.SHOW  
DEFINE CLASS TKS08 AS FORM
  CAPTION='S08.懲處作業'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1 
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKS08'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.  
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*515,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='懲處對象',;      
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='懲處內容'        
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*215
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=3,;            
      RECORDSOURCE='S05',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3' 
  ADD OBJECT GRID2 AS GRID2 WITH;
      COLUMNCOUNT=7,;            
      RECORDSOURCE='S08',; 
      LINKMASTER='S05',;
      RELATIONALEXPR='F01',;
      CHILDORDER='S081',;   
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
	AUTOSIZE=.T. 
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
	AUTOSIZE=.T.             
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*165,;
      LEFT=INT_015*640          
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*45,;      
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<A.確認',;
      TOOLTIPTEXT='確認目前所指紀錄內容!快速鍵->ALT+A',;
      NAME='ANS_BOTT'      
  ADD OBJECT  INVERSE_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*62,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*50,;      
      FONTSIZE=INT_015*9,;
      CAPTION='\<I.反確認',;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      NAME='INVERSE_BOTT'         
**************            
PROCEDURE PAGEFRAME1.PAGE1.INIT  
  THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION='員工編號'
     ENDWITH   
  THIS.ADDOBJECT('LBLF011','LABEL')
     WITH THIS.LBLF011
         .VISIBLE=.T.
         .LEFT=INT_015*120
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION=''
     ENDWITH        
 THIS.ADDOBJECT('TXTF01','TEXTBOX')          
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*14
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
      ENDWITH  
 THIS.ADDOBJECT('LBLF02','LABEL')
     WITH THIS.LBLF02
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION='部門編號'
     ENDWITH 
 THIS.ADDOBJECT('LBLF021','LABEL')
     WITH THIS.LBLF021
         .VISIBLE=.T.
         .LEFT=INT_015*120
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION=''
     ENDWITH          
 THIS.ADDOBJECT('TXTF02','TEXTBOX')          
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*39
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
      ENDWITH        
 THIS.ADDOBJECT('LBLF28','LABEL')
     WITH THIS.LBLF28
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*70
         .WIDTH=INT_015*50
         .CAPTION='任職狀況'
     ENDWITH     
 THIS.ADDOBJECT('TXTF28','TEXTBOX')          
     WITH THIS.TXTF28
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*64
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
      ENDWITH         
 THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*95
         .WIDTH=INT_015*50
         .CAPTION='異動日期'
     ENDWITH     
 THIS.ADDOBJECT('TXTF10','TEXTBOX')          
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*89
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
      ENDWITH                 
 ENDPROC
**************************************      
PROCEDURE PAGEFRAME1.PAGE2.INIT 
  THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION='懲處日期'
     ENDWITH        
 THIS.ADDOBJECT('TXTF05','TXTF05')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*14
      ENDWITH  
  THIS.ADDOBJECT('LBLF11','LABEL')
     WITH THIS.LBLF11
         .VISIBLE=.T.
         .LEFT=INT_015*250
         .TOP=INT_015*20
         .WIDTH=INT_015*65
         .CAPTION='懲處截止日'
     ENDWITH        
 THIS.ADDOBJECT('TXTF11','TEXTBOX')          
     WITH THIS.TXTF11
          .VISIBLE=.T.
          .LEFT=INT_015*310
          .TOP=INT_015*14
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8
      ENDWITH       
 THIS.ADDOBJECT('TXTF06','TEXTBOX')   &&懲處編號       
     WITH THIS.TXTF06
          .VISIBLE=.F.
          .LEFT=INT_015*65
          .TOP=INT_015*45
          .WIDTH=INT_015*25
          .HEIGHT=INT_015*25
          .MAXLENGTH=2
      ENDWITH        
  THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION='懲處項目'
     ENDWITH            
 THIS.ADDOBJECT('TXTF07','TEXTBOX')          
     WITH THIS.TXTF07
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*39
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
      ENDWITH      
 THIS.ADDOBJECT('COMBOBOX07','COMBOBOX07')          
     WITH THIS.COMBOBOX07
          .LEFT=INT_015*65
          .TOP=INT_015*39
      ENDWITH                 
  THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*73
         .WIDTH=INT_015*50
         .CAPTION='扣款方式'
     ENDWITH    
 THIS.ADDOBJECT('OPTIONGROUP08','OPTIONGROUP')
     WITH THIS.OPTIONGROUP08 
   	   .VISIBLE=.T.
      	   .TOP=INT_015*64
   	   .LEFT=INT_015*65  
	   .HEIGHT=INT_015*29
	   .WIDTH=INT_015*410
	   .BUTTONCOUNT=2
	   .VALUE=1
	   .ENABLED=.F.	   
	   .NAME='OPTIONGROUP08'
	   .OPTION1.CAPTION='扣款底數'
	   .OPTION1.FONTSIZE=INT_015*9  
	   .OPTION1.TOP=INT_015*7
	   .OPTION1.AUTOSIZE=.T.
	   .OPTION1.LEFT=INT_015*5
	   .OPTION1.NAME='OPTION1'
	   .OPTION2.CAPTION='扣款金額'
	   .OPTION2.FONTSIZE=INT_015*9 	   
	   .OPTION2.TOP=INT_015*7
	   .OPTION2.AUTOSIZE=.T.
	   .OPTION2.LEFT=INT_015*280
	   .OPTION2.NAME='OPTION2'    	   
     ENDWITH           
 THIS.ADDOBJECT('TXTF08','TEXTBOX')          
     WITH THIS.TXTF08
          .VISIBLE=.T.
          .LEFT=INT_015*137
          .TOP=INT_015*66
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
          .MAXLENGTH=8
      ENDWITH    
 THIS.ADDOBJECT('TXTF081','TEXTBOX')       &&扣款項目編號
     WITH THIS.TXTF081
          .VISIBLE=.F.
          .LEFT=INT_015*137
          .TOP=INT_015*66
          .WIDTH=INT_015*40
          .HEIGHT=INT_015*25
          .MAXLENGTH=1
      ENDWITH      
  THIS.ADDOBJECT('LBLF09','LABEL') 
     WITH THIS.LBLF09
          .VISIBLE=.T.
          .LEFT=INT_015*213
          .TOP=INT_015*73
          .AUTOSIZE=.T.
          .CAPTION='扣款比例                   ％'         
     ENDWITH       
  THIS.ADDOBJECT('TXTF09','TEXTBOX')      
     WITH THIS.TXTF09
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*265
          .TOP=INT_015*66
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=6               
     ENDWITH     
  THIS.ADDOBJECT('TXTF10','TEXTBOX')      
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*412
          .TOP=INT_015*66
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=7               
     ENDWITH               
  THIS.ADDOBJECT('LBLF14','LABEL')
     WITH THIS.LBLF14
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*100
         .WIDTH=INT_015*50
         .CAPTION='備註說明'
     ENDWITH        
 THIS.ADDOBJECT('TXTF14','TEXTBOX')          
     WITH THIS.TXTF14
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*93
          .WIDTH=INT_015*320
          .HEIGHT=INT_015*25
          .MAXLENGTH=50
      ENDWITH        
  THIS.ADDOBJECT('LBLF13','LABEL')
     WITH THIS.LBLF13
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*125
         .WIDTH=INT_015*80       
         .CAPTION='連續扣款月數'
     ENDWITH    
 THIS.ADDOBJECT('TXTF13','TXTF13')          
     WITH THIS.TXTF13
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*90
          .TOP=INT_015*119
      ENDWITH         
  THIS.ADDOBJECT('LBLF12','LABEL')
     WITH THIS.LBLF12
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*150
         .WIDTH=INT_015*80       
         .CAPTION='剩餘扣款月數'
     ENDWITH    
 THIS.ADDOBJECT('TXTF12','TEXTBOX')          
     WITH THIS.TXTF12
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*90
          .TOP=INT_015*144
          .WIDTH=INT_015*30
          .HEIGHT=INT_015*25
          .MAXLENGTH=2      
          .NAME='TXTF12'           
      ENDWITH                 
  THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
         .VISIBLE=.T.
         .LEFT=INT_015*250
         .TOP=INT_015*125
         .WIDTH=INT_015*50
         .CAPTION='狀        態'
     ENDWITH  
  THIS.ADDOBJECT('LBLF151','LABEL')
     WITH THIS.LBLF151
         .VISIBLE=.T.
         .LEFT=INT_015*305
         .TOP=INT_015*125
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH            
  THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*250
         .TOP=INT_015*150
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH  
  THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*305
         .TOP=INT_015*150
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH    
 THIS.ADDOBJECT('TXTF16','TEXTBOX')  &&小計(除實領金額外)        
     WITH THIS.TXTF16
          .VISIBLE=.F.
          .LEFT=INT_015*65
          .TOP=INT_015*93
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=7
      ENDWITH                                                                     
ENDPROC                               
********  
  PROC INIT       
       THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
       THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)           
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*10
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*10  
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')     
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')         
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='任職狀況'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F02'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE="BILL_MODE(S05.F28)"
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55   
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*55
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(INDEXSEEK(S05.F01+'N',.F.,'S08','S082'),RGB(255,0,0),IIF(S05.F28='9',RGB(0,255,255),''))","COLUMN")    	     &&若為有尚未確認之內容則呈現紅色否則為外包人員則秀出天空藍顏色      
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')    
       THISFORM.GRID2.LINKMASTER='S05'
       THISFORM.GRID2.RELATIONALEXPR='F01'        
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='懲處日期'    
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='懲處項目'       
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='扣款底數'
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='扣款比例(％)'
       THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='扣款金額'
       THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='懲處截止日' 
       THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='安全資料'
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='S08.F05'
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE='S08.F07'
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE="BASE_CLASS(S08.F08)"
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE="IIF(EMPTY(S08.F09),'',S08.F09)"
       THISFORM.GRID2.COLUMN5.CONTROLSOURCE="IIF(EMPTY(S08.F10),'',S08.F10)"
       THISFORM.GRID2.COLUMN6.CONTROLSOURCE='S08.F11'
       THISFORM.GRID2.COLUMN7.CONTROLSOURCE='S08.F99'                                          
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*65       
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*120
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*70
       THISFORM.GRID2.COLUMN5.WIDTH=INT_015*65
       THISFORM.GRID2.COLUMN6.WIDTH=INT_015*65
       THISFORM.GRID2.COLUMN7.WIDTH=INT_015*100
       THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF(S08.F15<>'Y',RGB(255,0,0),'')","COLUMN")        
       THISFORM.GRID1.READONLY=.T.      
       THISFORM.GRID2.READONLY=.T.            
       THISFORM.GRID1.SETFOCUS
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.       
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
       THISFORM.ANS_BOTT.ENABLED=.F.       
       THISFORM.INVERSE_BOTT.ENABLED=.F. 
       IF THISFORM.GRID1.ACTIVEROW=0
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F. 
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.		         
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
           CHK_NULL='Y' 
       ELSE
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.     
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.		          
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限
           CHK_NULL='N'        
       ENDIF          
       JK='員工編號'
       SELE S05
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05.F01
  ENDPROC     
  ***********
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
        R=0
        SELECT S05
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO S051
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO S052
         ENDCASE           
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)                
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.      	
       	THISFORM.ANS_BOTT.ENABLED=.F.       
       	THISFORM.INVERSE_BOTT.ENABLED=.F.
         IF THISFORM.SHRGROUP.VISIBLE=.F.
              THISFORM.GRID1.ENABLED=.T. 
              THISFORM.GRID1.SETFOCUS 
              THISFORM.KEY_LIST.ENABLED=.T.
         ELSE
              THISFORM.KEY_LIST.ENABLED=.F. 	      	
         ENDIF                		                 
*!*	        THISFORM.REFRESH    
  ENDPROC     
**********             
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
	SELECT S08	  	
        IF THISFORM.SHRGROUP.ENABLED=.F.
             THISFORM.GRID2.READONLY=.T.     
             THISFORM.GRID2.SETFOCUS   
        ENDIF
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,255)               
	IF THISFORM.GRID2.ACTIVEROW=0 AND THISFORM.SHRGROUP.ENABLED=.F.	
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	          
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.ANS_BOTT.ENABLED=.F.
	      THISFORM.INVERSE_BOTT.ENABLED=.F.	      
	       IF CHK_NULL='Y' AND THISFORM.SHRGROUP.ENABLED=.F.
	           THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
	       ELSE
                   THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.) AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.) &&判斷有無新增的權限 
               ENDIF	      
	      THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')   
	      THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''      
	      THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''  
	      THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=''  
	      THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=''  
	      THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''  
	      THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=''    	 	         	
	      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''       
	ELSE
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.	
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.			   
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.		
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.)AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)&&判斷有無新增的權限    	   
     	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S08.F15<>'Y'  &&判斷有無修改的權限
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S08.F15<>'Y'   &&判斷有無刪除的權限	   
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 		      
	      THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND S08.F15<>'Y'   AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	      THISFORM.INVERSE_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.) AND S08.F15='Y'   AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	      THISFORM.GRID2.AFTERROWCOLCHANGE 	
	ENDIF          	
        R=RECNO('&AREA1') 
        THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
        THISFORM.GRID1.ENABLED=.F.  
        THISFORM.KEY_LIST.ENABLED=.F. 	                 
*!*	        THISFORM.REFRESH    
  ENDPROC   
**********    
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依員工編號排列')
           .ADDITEM('依員工姓名排列')
           .VALUE=1
       ENDWITH             
  ENDPROC
********* 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE S05 
       DO CASE
          CASE THIS.DISPLAYVALUE='依員工編號排列'
               SET ORDER TO S051 
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F01'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F02'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55 
          CASE THIS.DISPLAYVALUE='依員工姓名排列'
               SET ORDER TO S052
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F02'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F01'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50                                                                
       ENDCASE 
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
***********  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
        SELECT S05
        THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(INDEXSEEK(S05.F01+'N',.F.,'S08','S082'),RGB(255,0,0),IIF(S05.F28='9',RGB(0,255,255),''))","COLUMN")    	     &&若為有尚未確認之內容則呈現紅色否則為外包人員則秀出天空藍顏色      
        THISFORM.GRID1.TOOLTIPTEXT=IIF(INDEXSEEK(S05.F01+'N',.F.,'S08','S082'),'尚有資料未確認',IIF(S05.F28='9','此為外包人員',''))    
        THISFORM.PAGEFRAME1.PAGE1.LBLF10.VISIBLE=IIF(EMPTY(S05.F10),.F.,.T.)
        THISFORM.PAGEFRAME1.PAGE1.TXTF10.VISIBLE=IIF(EMPTY(S05.F10),.F.,.T.)            
       	THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05.F01
       	THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=S05.F05 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=IIF(EMPTY(S05.F10),'',S05.F10)
       	THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=BILL_MODE(S05.F28)
        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=S05.F02   
        THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION=S05.F06    
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.     	
       	THISFORM.ANS_BOTT.ENABLED=.F.
       	THISFORM.INVERSE_BOTT.ENABLED=.F.
       	IF THISFORM.GRID1.ACTIVEROW=0 
	       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''
	       THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION=''
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.	             
 	 ELSE
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 	
         ENDIF	      
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION  
         IF THIS.ACTIVEROW=0
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
         ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
         ENDIF   
         CHK=''     
*!*	       THISFORM.REFRESH
  ENDPROC     
**********  
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
         THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF(S08.F15<>'Y',RGB(255,0,0),'')","COLUMN")        
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=S08.F05
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=S08.F07  
   	 THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=IIF(!EMPTY(S08.F09),1,2)
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=BASE_CLASS(S08.F08)  
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE=S08.F08
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=IIF(!EMPTY(S08.F09),S08.F09,'')     
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=IIF(!EMPTY(S08.F10),S08.F10,'')    
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=S08.F11   
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=S08.F12
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=S08.F13
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=S08.F14   	 	    	    	 	    	    	    	 		     			   
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF151.CAPTION=IIF(EMPTY(S08.F15),'',IIF(S08.F15<>'Y','尚未確認','已確認'))
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF151.BACKCOLOR=IIF(S08.F15<>'Y',RGB(255,0,0),RGB(58,186,152))   
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S08.F99    
         IF THISFORM.PAGEFRAME1.ACTIVEPAGE<>2
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.      	 
	     THISFORM.ANS_BOTT.ENABLED=.F.  	 
	     THISFORM.INVERSE_BOTT.ENABLED=.F.
	 ELSE    
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S08.F15<>'Y'   &&判斷有無修改的權限
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S08.F15<>'Y'    &&判斷有無刪除的權限	               	 
	     THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND S08.F15<>'Y'    AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)         
	     THISFORM.INVERSE_BOTT.ENABLED=IIF(A02.F09='*',.T.,.F.) AND S08.F15<>'N'   AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	 ENDIF			    			 
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION
         CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE 
         IF THISFORM.PAGEFRAME1.ACTIVEPAGE=1
             THISFORM. CMDGROUP.SEEK_BOTT.ENABLED=.F.
         ENDIF       
*       THISFORM.REFRESH
  ENDPROC 
***********
PROCEDURE ORPGROUP.NEW_BOTT.CLICK   
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.F.  
     THISFORM.GRID2.ENABLED=.F.  
     THISFORM.ANS_BOTT.ENABLED=.F.     
     THISFORM.INVERSE_BOTT.ENABLED=.F.         
     THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.        
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.F.      
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.READONLY=.F.  	
     THISFORM.PAGEFRAME1.PAGE2.TXTF13.READONLY=.F.   
     THISFORM.PAGEFRAME1.PAGE2.TXTF14.READONLY=.F.       
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.T. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VALUE=1   
     THISFORM.PAGEFRAME1.PAGE2.TXTF081.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=DATE()  
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''               
     THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE='' 
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=''    
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=''            
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=0  
     THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=0 
     THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE='' 
     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''     
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS     
  ENDPROC
*************  
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK               &&新增確認
    SELE S08
    COD=SYS(21)
    SET ORDER TO &COD
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
         =MESSAGEBOX('懲處日期不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN        	   
    ENDIF
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE)
         =MESSAGEBOX('懲處項目不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN        	  
    ENDIF  
    IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)+THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,.F.,'S08','S081')=.T.
         =MESSAGEBOX('在本次懲處日期中已存在此懲處項目,請重新輸入!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN        	  
    ENDIF             
    IF  THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE<THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE
          =MESSAGEBOX('連續扣款月數不得小於剩餘扣款月數,請查明後再輸入!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN   
    ENDIF    
    IF  THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE>THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
          =MESSAGEBOX('剩餘扣款月數不得大於連續扣款月數,請查明後再輸入!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN   
    ENDIF      
    SELECT S08
   APPEND BLANK
    LOCK()
    IF RLOCK()
    	REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    	REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION)
    	REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
    	REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION)
    	REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE  
    	REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
    	REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE   
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=1
    	    REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE    	
    	    REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE
    	ELSE    
    	    REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
    	ENDIF
    	REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
    	REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE
    	REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE    		
    	REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
    	REPLACE F15 WITH  'N'    	
    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ENDIF
    UNLOCK ALL
    SELECT S08
    SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    THISFORM.ORPGROUP.NEW_BOTT.CLICK   
    THISFORM.REFRESH
  ENDPROC  
***********    
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK 
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.ANS_BOTT.ENABLED=.F.     
     THISFORM.INVERSE_BOTT.ENABLED=.F.   
     THISFORM.GRID1.ENABLED=.F.   
     THISFORM.GRID2.ENABLED=.F.                
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.        
     THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.F.      
     THISFORM.PAGEFRAME1.PAGE2.TXTF07.READONLY=.F.      
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.READONLY=.F.
     THISFORM.PAGEFRAME1.PAGE2.TXTF13.READONLY=.F.
     THISFORM.PAGEFRAME1.PAGE2.TXTF07.VISIBLE=.F.	 	      
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.T.  
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.DISPLAYVALUE=ALLTRIM(S08.F06)+SPACE(5)+ALLTRIM(S08.F07)
     THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE=S08.F08
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=IIF(!EMPTY(S08.F08),1,2)        	  
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=IIF(!EMPTY(S08.F09),S08.F09,'')
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=IIF(!EMPTY(S08.F10),S08.F10,'')  
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=S08.F11	            		      	    
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=S08.F12
     THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=S08.F13
     THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=S08.F14     
     THISFORM.PAGEFRAME1.PAGE2.LBLF151.CAPTION=''
     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS      
     LOCK()
     IF !RLOCK()
          DO FILE_IMPACT
          RETURN
     ENDIF   
 ENDPROC    
**************
PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK   &&修改確認        
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
         =MESSAGEBOX('懲處日期不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	  RETURN        	  
    ENDIF
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE)
         =MESSAGEBOX('懲處項目不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.SETFOCUS
  	  RETURN        	  
    ENDIF
    IF S08.F05<>THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE AND S08.F06<>THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
        IF INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)+THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE,.F.,'S08','S081')=.T.
             =MESSAGEBOX('在本次懲處日期中已存在此懲處項目,請重新輸入!',0+64,'提示訊息視窗')
  	     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.SETFOCUS
  	     RETURN        	  
        ENDIF        
    ENDIF
    IF  THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE<THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE
          =MESSAGEBOX('連續扣款月數不得小於剩餘扣款月數,請查明後再輸入!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF13.SETFOCUS
  	 RETURN   
    ENDIF    
    IF  THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE>THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
          =MESSAGEBOX('剩餘扣款月數不得大於連續扣款月數,請查明後再輸入!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF12.SETFOCUS
  	 RETURN   
    ENDIF      
    SELE S08          
    IF RLOCK()
    	REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
    	REPLACE F06 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
    	REPLACE F07 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE  
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=1
    	    REPLACE F08 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE 
    	    REPLACE F09 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE
    	    REPLACE F10 WITH 0
    	ELSE    
    	    REPLACE F08 WITH ''
    	    REPLACE F09 WITH 0
    	    REPLACE F10 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE
    	ENDIF
    	REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
    	REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE  
    	REPLACE F13 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE     	 	
    	REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE
    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ELSE
          DO FILE_IMPACT
          RETURN   
    ENDIF  
    THISFORM.GRID2.SETFOCUS		      		          	    	              
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
ENDPROC   
*************
PROC ORPGROUP.DEL_BOTT.CLICK                    &&刪除資料程序
 IF  MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認')=6 
       SELECT S08
       LOCK()
       IF RLOCK()
 	    IF S08.F15='Y'
 	       	 =MESSAGEBOX('此資料已確認,無法刪除!',0+64,'提示訊息視窗')
 	    ELSE
     	       DELETE 
     	       UNLOCK
     	       SKIP -1
     	       IF BOF()
     	           GO TOP
     	       ENDIF  
 	    ENDIF
       ELSE
           DO FILE_IMPACT
           RETURN 
       ENDIF
       THISFORM.GRID2.SETFOCUS 	
       THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	      
  ENDIF
*!*	  THISFORM.REFRESH	       
ENDPROC  
****************
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.SETALL('VISIBLE',.T.,'TEXTBOX')
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.      
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.      
      THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.T.       
      THISFORM.PAGEFRAME1.PAGE2.TXTF13.READONLY=.T.               
      THISFORM.PAGEFRAME1.PAGE2.TXTF06.VISIBLE=.F.          	      
      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX07.VISIBLE=.F.    
      THISFORM.PAGEFRAME1.PAGE2.TXTF081.VISIBLE=.F.     
      THISFORM.PAGEFRAME1.PAGE2.TXTF16.VISIBLE=.F. 
      THISFORM.GRID2.ENABLED=.T.       
      THISFORM.GRID2.SETFOCUS   
*!*	      THISFORM.REFRESH   
      UNLOCK ALL          
  ENDPROC
**********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
  SELECT S05
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO S051
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO S052
         ENDCASE   
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
***************
 PROC ANS_BOTT.CLICK     &&確認作業     
    IF  MESSAGEBOX('您是否要確認此筆資料!',4+32+256,'請確認')=6
         SELECT S08
         LOCK()
         IF RLOCK()
             IF S08.F15<>'N'
                =MESSAGEBOX('此筆資料已確認過,請查明後再作確認!',0+64,'提示訊息視窗')
             ELSE
                 REPLACE S08.F15 WITH 'Y' 
     	         REPLACE S08.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'') 
     	         =MESSAGEBOX('此懲處作業已確認成功,請至S10 薪資計算作業中新增此筆資料',0+64,'提示訊息視窗') 
             ENDIF
         ELSE
              DO FILE_IMPACT
              RETURN   
         ENDIF
   ENDIF   
   UNLOCK   ALL 
   THISFORM.GRID2.SETFOCUS	
   THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	   
 ENDPROC
***************
 PROC INVERSE_BOTT.CLICK     &&反確認作業    
    IF  MESSAGEBOX('您是否要反確認此筆資料!',4+32+256,'請確認')=6
         SELECT S08
         LOCK()
         IF RLOCK()  
             IF S08.F15<>'Y'
                 =MESSAGEBOX('此筆資料尚未確認過,請查明後再作反確認!',0+64,'提示訊息視窗')
             ELSE
                 REPLACE S08.F15 WITH 'N' 
     	         REPLACE S08.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'') 
     	         =MESSAGEBOX('此懲處作業已反確認成功,若S10.薪資計算作業已有此筆資料,請至S10中刪除',0+64,'提示訊息視窗') 
             ENDIF
         ELSE
              DO FILE_IMPACT
              RETURN           
         ENDIF
   ENDIF    
   UNLOCK   ALL 
   THISFORM.GRID2.SETFOCUS	
   THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	   
  ENDPROC     
ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
   SELECT  S08
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW       
ENDPROC 
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
*!*	  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  TOP=INT_015*200
  LEFT=INT_015*250   
  HEIGHT=INT_015*120
  WIDTH=INT_015*280
  FONTSIZE=INT_015*9
  MOVABLE=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*30,;
      CAPTION='起始員工編號',;
      NAME='LABEL1'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      TOP=INT_015*24,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*60,; 
      MAXLENGTH=4,;
      NAME='TEXT1'      
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*61,;
      CAPTION='截止員工編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      TOP=INT_015*55,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,;   
      WIDTH=INT_015*60,;     
      MAXLENGTH=4,;   
      NAME='TEXT2'    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*190,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*70,;    
      TOP=INT_015*14,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<P.列         印',;
      TOOLTIPTEXT='列印所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*190,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*70,;    
      TOP=INT_015*45,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<E.轉EXCEL',;
      TOOLTIPTEXT='將資料轉至EXCEL格式!快速鍵->ALT+Y',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*190,;
      TOP=INT_015*76,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*70,; 
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<C.取        消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*10,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*10,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*10,'COMMANDBUTTON')        
      THISFORM.TEXT1.VALUE=S05.F01
      THISFORM.TEXT2.VALUE=S05.F01         
  ENDPROC    
  PROCEDURE CMND1.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
      SELECT  * FROM S08 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE AND  F15='Y' ORDER BY F01,F05 NOWAIT
      IF  _TALLY >0
           REPORT FORM ALLTRIM(INT_116)+'S08' TO PRINT PROMPT   PREVIEW
      ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.CMND3.CLICK
  ENDPROC
  ******
    PROCEDURE CMND2.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
      SELECT F01 員工編號,F02 員工姓名,F03 部門編號,F04 部門名稱,F05 懲處日期,F07 懲處項目,;
                    IIF(EMPTY(F08),'扣金額：'+ALLTRIM(TRANSFORM(F10,'@R 999,999,999,999'))+' 元','扣 '+BASE_CLASS(F08)+' '+ALLTRIM(TRANSFORM(F09,'@R 999,999'))+' %') 扣款方式,; 
                    F13 連續扣款月數,F12 懲處剩餘次數,F14 備註 FROM S08 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE AND  F15='Y' ORDER BY F01,F05 NOWAIT
      IF  _TALLY >0
           FILENAME='S08 懲處作業資料'
	   GCDELIMFILE=PUTFILE('儲存路徑',FILENAME,'XLS')
	   IF !EMPTY(GCDELIMFILE) 
	       ON ERROR DO FILE_IMPACT
	       COPY TO (GCDELIMFILE) TYPE XL5     
	      =MESSAGEBOX('儲存成功',0+64,'提示訊息視窗')  
	   ELSE
	      THISFORM.TEXT1.SETFOCUS
	      RETURN   
	   ENDIF  
     ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.CMND3.CLICK
  ENDPROC
  *****           
  PROCEDURE CMND3.CLICK
      THISFORM.RELEASE
  ENDPROC      
  PROC CMND1.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND1.TOP=INT_015*15
             THISFORM.CMND1.LEFT=INT_015*191
  ENDPROC     
  PROC CMND1.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND1.TOP=INT_015*14
             THISFORM.CMND1.LEFT=INT_015*190                  
  ENDPROC     
  PROC CMND2.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND2.TOP=INT_015*46
             THISFORM.CMND2.LEFT=INT_015*191
  ENDPROC     
  PROC CMND2.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND2.TOP=INT_015*45
             THISFORM.CMND2.LEFT=INT_015*190                  
  ENDPROC     
  PROC CMND3.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND3.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND3.TOP=INT_015*77
             THISFORM.CMND3.LEFT=INT_015*191
  ENDPROC     
  PROC CMND3.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND3.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND3.TOP=INT_015*76
             THISFORM.CMND3.LEFT=INT_015*190                  
  ENDPROC   
ENDDEFINE     
***************************************************特殊輸入欄位設定----------- 懲處日期
DEFINE CLASS TXTF05 AS TEXTBOX
       READONLY=.T.
       WIDTH=INT_015*70
       HEIGHT=INT_015*25
       MAXLENGTH=8       
       FONTSIZE=INT_015*9   
       NAME='TXTF05' 
  PROCEDURE INTERACTIVECHANGE
       DATE_DAY=VAL(SUBSTR(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),4,2))+THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
       IF DATE_DAY>12	&&判斷連續扣款月數是否有跨年
	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=CTOD(STR(VAL(LEFT(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),2))+1)+'/'+STR(DATE_DAY-12)+'/01')
       ELSE
	   THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=CTOD(LEFT(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),3)+STR(DATE_DAY)+'/01')
       ENDIF    
      THISFORM.PAGEFRAME1.PAGE2.TXTF11.REFRESH
  ENDPROC       
ENDDEFINE        
**************************************************懲處編號+項目
DEFINE CLASS COMBOBOX07 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*140
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX07' 
    PROCEDURE INIT    
       SELECT F39,F40 FROM S00 WHERE F01='H'  ORDER BY F07 INTO CURSOR S00_TEMP
       SELECT S00_TEMP
       GO TOP
       THIS.ADDITEM('')
       DO WHILE  !EOF()
              THIS.ADDITEM(ALLTRIM(S00_TEMP.F39)+SPACE(5)+ALLTRIM(S00_TEMP.F40))
      	      SELECT  S00_TEMP
      	      SKIP
       ENDDO
       SELECT S00_TEMP
       USE   
   ENDPROC         
   PROCEDURE INTERACTIVECHANGE
      IF THIS.VALUE=1
	     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''
	     THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=''
	     THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=''
	     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=''
	     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE='' 
	     THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=CTOD('') 
	     THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=0
	     THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=0          
	     THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=''
      ELSE   
	     NO=LEFT(THIS.DISPLAYVALUE,2)
	     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=ALLTRIM(NO)
	     THISFORM.PAGEFRAME1.PAGE2.TXTF07.VALUE=RIGHT(ALLTRIM(THIS.DISPLAYVALUE),LEN(ALLTRIM(THIS.DISPLAYVALUE))-7)
	     THISFORM.PAGEFRAME1.PAGE2.TXTF08.VALUE=IIF(INDEXSEEK('H'+NO,.T.,'S00','S004'),BASE_CLASS(S00.F42),'')   
	     THISFORM.PAGEFRAME1.PAGE2.TXTF081.VALUE=IIF(INDEXSEEK('H'+NO,.T.,'S00','S004'),S00.F42,'')      
	     THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE=IIF(INDEXSEEK('H'+NO,.T.,'S00','S004'),IIF(EMPTY(S00.F43),'',S00.F43),'')      
	     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=IIF(INDEXSEEK('H'+NO,.T.,'S00','S004'),IIF(EMPTY(S00.F44),'',S00.F44),'')    
	     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=IIF(!EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF09.VALUE),1,2)  
	     THISFORM.PAGEFRAME1.PAGE2.TXTF14.VALUE=IIF(INDEXSEEK('H'+NO,.T.,'S00','S004'),S00.F45,'')    
	     THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE=IIF(INDEXSEEK('H'+NO,.T.,'S00','S004'),S00.F41,0)
	     THISFORM.PAGEFRAME1.PAGE2.TXTF12.VALUE=THISFORM.PAGEFRAME1.PAGE2.TXTF13.VALUE
	     DATE_DAY=VAL(SUBSTR(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),4,2))+IIF(INDEXSEEK('H'+NO,.T.,'S00','S004'),S00.F41,0)  
	     IF DATE_DAY>12	&&判斷連續扣款月數是否有跨年
	         THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=CTOD(STR(VAL(LEFT(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),2))+1)+'/'+STR(DATE_DAY-12)+'/01')
	     ELSE
	         THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=CTOD(LEFT(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),3)+STR(DATE_DAY)+'/01')
	     ENDIF    
     ENDIF	     
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.REFRESH 
     THISFORM.PAGEFRAME1.PAGE2.TXTF07.REFRESH 
     THISFORM.PAGEFRAME1.PAGE2.TXTF08.REFRESH
     THISFORM.PAGEFRAME1.PAGE2.TXTF081.REFRESH                          
     THISFORM.PAGEFRAME1.PAGE2.TXTF09.REFRESH
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.REFRESH
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.REFRESH         
     THISFORM.PAGEFRAME1.PAGE2.TXTF12.REFRESH  
     THISFORM.PAGEFRAME1.PAGE2.TXTF13.REFRESH      
     THISFORM.PAGEFRAME1.PAGE2.TXTF14.REFRESH 
  ENDPROC       
ENDDEFINE
*********連續扣款月數
DEFINE CLASS TXTF13 AS TEXTBOX
       READONLY=.T.
       WIDTH=INT_015*30
       HEIGHT=INT_015*25
       MAXLENGTH=2       
       FONTSIZE=INT_015*9   
       NAME='TXTF13' 
  PROCEDURE INTERACTIVECHANGE
      DATE_DAY=VAL(SUBSTR(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),4,2))+THIS.VALUE
      IF DATE_DAY>12	&&判斷連續扣款月數是否有跨年
	  THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=CTOD(STR(VAL(LEFT(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),2))+1)+'/'+STR(DATE_DAY-12)+'/01') 
      ELSE
	  THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=CTOD(LEFT(DTOC(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE),3)+STR(DATE_DAY)+'/01')
      ENDIF    
      THISFORM.PAGEFRAME1.PAGE2.TXTF11.REFRESH
      THISFORM.PAGEFRAME1.PAGE2.TXTF13.REFRESH
  ENDPROC       
ENDDEFINE   

