***程式名稱:S30A.員工特殊其他所得發放作業
CLOSE ALL
CLEAR 
FLG='0'
FCH=''
CHK=''
CHK_NULL=''		&&判定GRID1資料是否為空
R=0
AREA1='S05'
AREA2='S12'
IF !USED('A01')	&&操作人員資料設定
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')	&&權限設定檔
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'S05'  
IF FOUND()  AND A02.F09='*'   &&判斷是否有權限可處理所有員工
    ALL_CHK=.T.
ELSE
    ALL_CHK=.F.
ENDIF
SELECT A02
SEEK SYS_OPER+'S30'          
IF !USED('S0B')	&&年假記錄檔
   SELE 0
   USE S0B 
ELSE
   SELE S0B
ENDIF
SET ORDER TO S0B1   
IF !USED('S00')	&&薪資參數設定
   SELE 0
   USE S00 
ELSE
   SELE S00
ENDIF
SET ORDER TO S001
IF !USED('S01')	&&S01 薪資資料設定
   SELE 0
   USE S01 
ELSE
   SELE S01
ENDIF
SET ORDER TO S011
IF !USED('S05')	&&人事薪資基本資料
   SELE 0
   USE S05 
ELSE
   SELE S05
ENDIF
IF  ALL_CHK=.F. 
      SET FILTER TO F27=.T.
ENDIF
SET ORDER TO S051
IF !USED('S06')	&&薪資項目及扣款項目
   SELE 0
   USE S06 
ELSE
   SELE S06
ENDIF
SET ORDER TO S061
IF !USED('S12')	&&S12 特殊其他所得發放作業
   SELE 0
   USE S12
ELSE
   SELE S12
ENDIF
SET FILTER TO F20='1' OR F20='3'
SET ORDER TO S121
GO TOP
********
S30AFORM=CREATEOBJECT("TKS30A")
S30AFORM.SHOW  
DEFINE CLASS TKS30A AS FORM
  CAPTION='S30.員工年終與未休年假獎金發放作業'
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1  
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*791
  WINDOWTYPE=1
  NAME='TKS30A'
  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
      AUTOCENTER=.T.  
  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
      AUTOCENTER=.T.
  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
      AUTOCENTER=.T.
  ADD OBJECT PAGEFRAME1 AS PAGEFRAME WITH;
      LEFT=INT_015*236,;
      WIDTH=INT_015*540,;
      HEIGHT=INT_015*515,;
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      PAGECOUNT=2,;
      TABSTRETCH=1,;
      ACTIVEPAGE=1,;
      VISIBLE=.T.,;
      PAGE1.NAME='PAGE1',;
      PAGE1.VISIBLE=.T.,;
      PAGE1.CAPTION='發放對象',;      
      PAGE2.NAME='PAGE2',;
      PAGE2.VISIBLE=.T.,;
      PAGE2.CAPTION='發放內容'        
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.,;
      WIDTH=INT_015*215
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=3,;            
      RECORDSOURCE='S05',;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3'
  ADD OBJECT GRID2 AS GRID2 WITH;
      TOP=INT_015*250,;
      HEIGHT=INT_015*270,;
      COLUMNCOUNT=8,;            
      RECORDSOURCE='S12',; 
      LINKMASTER='S05',;
      RELATIONALEXPR='F01',;
      CHILDORDER='S121',;   
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',;
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',;
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7',;      
      COLUMN8.NAME='COLUMN8'
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
	AUTOSIZE=.T. 
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;    
	AUTOSIZE=.T.             
  ADD OBJECT SHRGROUP AS SHRGROUP WITH;
      TOP=INT_015*197,;
      LEFT=INT_015*670          
  ADD OBJECT ANS_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*15,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*45,;      
      FONTSIZE=INT_015*9,;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      CAPTION='\<A.確認',;
      TOOLTIPTEXT='確認目前所指紀錄內容!快速鍵->ALT+A',;
      NAME='ANS_BOTT'      
  ADD OBJECT  INVERSE_BOTT AS COMMANDBUTTON WITH;
      TOP=INT_015*490,;
      LEFT=INT_015*62,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*50,;      
      FONTSIZE=INT_015*9,;
      CAPTION='\<I.反確認',;
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;        
      NAME='INVERSE_BOTT'            
**************            
PROCEDURE PAGEFRAME1.PAGE1.INIT  
  THIS.ADDOBJECT('LBLF01','LABEL')
     WITH THIS.LBLF01
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION='員工編號'
     ENDWITH   
  THIS.ADDOBJECT('LBLF011','LABEL')
     WITH THIS.LBLF011
         .VISIBLE=.T.
         .LEFT=INT_015*120
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION=''
     ENDWITH        
 THIS.ADDOBJECT('TXTF01','TEXTBOX')          
     WITH THIS.TXTF01
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*14
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
      ENDWITH  
 THIS.ADDOBJECT('LBLF02','LABEL')
     WITH THIS.LBLF02
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION='部門編號'
     ENDWITH 
 THIS.ADDOBJECT('LBLF021','LABEL')
     WITH THIS.LBLF021
         .VISIBLE=.T.
         .LEFT=INT_015*120
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION=''
     ENDWITH          
 THIS.ADDOBJECT('TXTF02','TEXTBOX')          
     WITH THIS.TXTF02
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*39
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25
          .MAXLENGTH=4
      ENDWITH                 
 THIS.ADDOBJECT('LBLF28','LABEL')
     WITH THIS.LBLF28
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*70
         .WIDTH=INT_015*50
         .CAPTION='任職狀況'
     ENDWITH     
 THIS.ADDOBJECT('TXTF28','TEXTBOX')          
     WITH THIS.TXTF28
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*64
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25 
      ENDWITH         
 THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*95
         .WIDTH=INT_015*50
         .CAPTION='發薪種類'
     ENDWITH         
 THIS.ADDOBJECT('TXTF15','TEXTBOX')     
     WITH THIS.TXTF15
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*89
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
      ENDWITH          
 THIS.ADDOBJECT('TXTF151','TEXTBOX')     
     WITH THIS.TXTF151
          .VISIBLE=.F.
          .LEFT=INT_015*65
          .TOP=INT_015*89
          .WIDTH=INT_015*20
          .HEIGHT=INT_015*25
          .MAXLENGTH=1
      ENDWITH        
 THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*120
         .WIDTH=INT_015*50
         .CAPTION='異動日期'
     ENDWITH     
 THIS.ADDOBJECT('TXTF10','TEXTBOX')          
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*114
          .WIDTH=INT_015*70
          .HEIGHT=INT_015*25
      ENDWITH                       
 ENDPROC
**************************************      
PROCEDURE PAGEFRAME1.PAGE2.INIT 
  THIS.ADDOBJECT('LBLF05','LABEL')
     WITH THIS.LBLF05
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*20
         .WIDTH=INT_015*50
         .CAPTION='發放日期'
     ENDWITH        
 THIS.ADDOBJECT('TXTF05','TEXTBOX')          
     WITH THIS.TXTF05
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*14
          .HEIGHT=INT_015*25
          .WIDTH=INT_015*70
      ENDWITH  
  THIS.ADDOBJECT('LBLF06','LABEL')
     WITH THIS.LBLF06
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*45
         .WIDTH=INT_015*50
         .CAPTION='發放項目'
     ENDWITH              
 THIS.ADDOBJECT('TXTF06','TEXTBOX')          
     WITH THIS.TXTF06
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*39
          .WIDTH=INT_015*140
          .HEIGHT=INT_015*25
          .MAXLENGTH=30
      ENDWITH        
 THIS.ADDOBJECT('COMBOBOX06','COMBOBOX06')          
     WITH THIS.COMBOBOX06
          .LEFT=INT_015*65
          .TOP=INT_015*39
          .VISIBLE=.F.
      ENDWITH         
  THIS.ADDOBJECT('LBLF07','LABEL')
     WITH THIS.LBLF07
         .VISIBLE=.T.
         .LEFT=INT_015*220
         .TOP=INT_015*45
         .WIDTH=INT_015*110
         .CAPTION='發放年終之年度'
     ENDWITH              
 THIS.ADDOBJECT('SPINNER07','SPINNER07')      
    WITH THIS.SPINNER07
          .VISIBLE=.T.
	  .TOP=INT_015*39
	  .LEFT=INT_015*305  
     ENDWITH                              
  THIS.ADDOBJECT('LBLF08','LABEL')
     WITH THIS.LBLF08
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*72
         .WIDTH=INT_015*50
         .CAPTION='發放方式'
     ENDWITH            
 THIS.ADDOBJECT('OPTIONGROUP08','OPTIONGROUP08')
    WITH THIS.OPTIONGROUP08
   	   .TOP=INT_015*64
   	   .LEFT=INT_015*65    
     ENDWITH      
 THIS.ADDOBJECT('SPINNER091','SPINNER')      
    WITH THIS.SPINNER091
          .VISIBLE=.T.
	  .TOP=INT_015*66
	  .LEFT=INT_015*332
          .HEIGHT=INT_015*25     
	  .WIDTH=INT_015*47  
	  .KEYBOARDLOWVALUE=0
	  .KEYBOARDHIGHVALUE=999
	  .SPINNERLOWVALUE=0
	  .SPINNERHIGHVALUE=999
	  .INPUTMASK='999'     
     ENDWITH   
  THIS.ADDOBJECT('LBLF090','LABEL')
     WITH THIS.LBLF090
         .VISIBLE=.T.
         .LEFT=INT_015*383
         .TOP=INT_015*72
         . AUTOSIZE=.T.
         .CAPTION='年               月'
     ENDWITH          
 THIS.ADDOBJECT('SPINNER092','SPINNER')      
    WITH THIS.SPINNER092
          .VISIBLE=.T.
	  .TOP=INT_015*66
	  .LEFT=INT_015*397
          .HEIGHT=INT_015*25     
	  .WIDTH=INT_015*40  
	  .KEYBOARDLOWVALUE=0
	  .KEYBOARDHIGHVALUE=12
	  .SPINNERLOWVALUE=0
	  .SPINNERHIGHVALUE=12
	  .INPUTMASK='99'     
     ENDWITH                    
  THIS.ADDOBJECT('LBLF10','LABEL')
     WITH THIS.LBLF10
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*100
         .WIDTH=INT_015*50
         .CAPTION='計算方式'
     ENDWITH          
  THIS.ADDOBJECT('TXTF10','TEXTBOX')      
     WITH THIS.TXTF10
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*93
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25          
     ENDWITH         
 THIS.ADDOBJECT('COMBOBOX10','COMBOBOX10')
    WITH THIS.COMBOBOX10
	   .TOP=INT_015*93
	   .LEFT=INT_015*65
	   .VISIBLE=.F.
   ENDWITH      
   ****年終獎金
  THIS.ADDOBJECT('LBLF12','LABEL')
     WITH THIS.LBLF12
         .VISIBLE=.T.
         .LEFT=INT_015*145
         .TOP=INT_015*100
         .AUTOSIZE=.T.
         .CAPTION='發放基數                 Ｘ 發放底數                   Ｘ（到職月數／12）'
     ENDWITH          
  THIS.ADDOBJECT('TXTF12A','TXTF12')	&&發放基數      
     WITH THIS.TXTF12A
          .VISIBLE=.T.
          .ALIGNMENT=1
          .LEFT=INT_015*195
          .TOP=INT_015*93     
     ENDWITH              
  THIS.ADDOBJECT('TXTF13A','TEXTBOX')	&&發放底數      
     WITH THIS.TXTF13A
          .VISIBLE=.T.
          .LEFT=INT_015*310
          .TOP=INT_015*93
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25               
     ENDWITH             
THIS.ADDOBJECT('COMBOBOX13A','COMBOBOX13')
    WITH THIS.COMBOBOX13A
	   .TOP=INT_015*93
	   .LEFT=INT_015*310
	   .VISIBLE=.F.
   ENDWITH        
  THIS.ADDOBJECT('TXTF14A','TXTF14')	&&發放金額     
     WITH THIS.TXTF14A
          .VISIBLE=.F.
          .ALIGNMENT=1
          .LEFT=INT_015*310
          .TOP=INT_015*93          
     ENDWITH         
   ****未休年假    
  THIS.ADDOBJECT('TXTF11','TXTF11')	&&未休年假      
     WITH THIS.TXTF11
          .VISIBLE=.F.
          .ALIGNMENT=1
          .LEFT=INT_015*217
          .TOP=INT_015*93  
     ENDWITH          
  THIS.ADDOBJECT('TXTF13B','TEXTBOX')	&&發放底數      
     WITH THIS.TXTF13B
          .VISIBLE=.F.
          .LEFT=INT_015*320
          .TOP=INT_015*93
          .WIDTH=INT_015*50
          .HEIGHT=INT_015*25               
     ENDWITH            
THIS.ADDOBJECT('COMBOBOX13B','COMBOBOX13')
    WITH THIS.COMBOBOX13B
	   .VISIBLE=.F.
	   .TOP=INT_015*93
	   .LEFT=INT_015*320
   ENDWITH         
  THIS.ADDOBJECT('TXTF12B','TXTF12')	&&發放比率      
     WITH THIS.TXTF12B
          .VISIBLE=.F.
          .ALIGNMENT=1
          .LEFT=INT_015*440
          .TOP=INT_015*93 
     ENDWITH        
  THIS.ADDOBJECT('TXTF14B','TXTF14')	&&發放金額     
     WITH THIS.TXTF14B
          .VISIBLE=.F.
          .ALIGNMENT=1
          .LEFT=INT_015*320
          .TOP=INT_015*93            
     ENDWITH                        
   ********  
   THIS.ADDOBJECT('LBLF15','LABEL')
     WITH THIS.LBLF15
          .VISIBLE=.T.
          .LEFT=INT_015*15
          .TOP=INT_015*128
          .WIDTH=INT_015*50
          .CAPTION='是否扣稅'          
     ENDWITH     
 THIS.ADDOBJECT('OPTIONGROUP15','OPTIONGROUP15')
     WITH THIS.OPTIONGROUP15
   	   .TOP=INT_015*119
   	   .LEFT=INT_015*65    
     ENDWITH                    
  THIS.ADDOBJECT('TXTF15','TXTF15')          
     WITH THIS.TXTF15
          .ALIGNMENT=1
          .LEFT=INT_015*248
          .TOP=INT_015*121      
     ENDWITH         
   THIS.ADDOBJECT('LBLF151','LABEL')
     WITH THIS.LBLF151
          .VISIBLE=.T.
          .LEFT=INT_015*303
          .TOP=INT_015*128
          .WIDTH=INT_015*20
          .CAPTION='％'          
     ENDWITH                 
  THIS.ADDOBJECT('LBLF16','LABEL')
     WITH THIS.LBLF16
         .VISIBLE=.T.
         .LEFT=INT_015*380
         .TOP=INT_015*127
         .WIDTH=INT_015*50
         .CAPTION='稅前小計'
     ENDWITH           
  THIS.ADDOBJECT('LBLF161','LABEL')
     WITH THIS.LBLF161
         .VISIBLE=.T.
         .LEFT=INT_015*431
         .TOP=INT_015*127
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH        
  THIS.ADDOBJECT('LBLF17','LABEL')
     WITH THIS.LBLF17
         .VISIBLE=.T.
         .LEFT=INT_015*380
         .TOP=INT_015*155
         .WIDTH=INT_015*50
         .CAPTION='稅後小計'
     ENDWITH        
  THIS.ADDOBJECT('LBLF171','LABEL') 
     WITH THIS.LBLF171
         .VISIBLE=.T.
         .LEFT=INT_015*431
         .TOP=INT_015*155
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH        
  THIS.ADDOBJECT('LBLF18','LABEL')
     WITH THIS.LBLF18
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*155
         .WIDTH=INT_015*50
         .CAPTION='備註說明'
     ENDWITH        
 THIS.ADDOBJECT('TXTF18','TEXTBOX')          
     WITH THIS.TXTF18
          .VISIBLE=.T.
          .LEFT=INT_015*65
          .TOP=INT_015*148
          .WIDTH=INT_015*300
          .HEIGHT=INT_015*25
          .MAXLENGTH=40
      ENDWITH     
  THIS.ADDOBJECT('LBLF19','LABEL')
     WITH THIS.LBLF19
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*182
         .WIDTH=INT_015*50
         .CAPTION='狀        態'
     ENDWITH  
  THIS.ADDOBJECT('LBLF191','LABEL')
     WITH THIS.LBLF191
         .VISIBLE=.T.
         .LEFT=INT_015*65
         .TOP=INT_015*182
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH           
  THIS.ADDOBJECT('LBLF99','LABEL')
     WITH THIS.LBLF99
         .VISIBLE=.T.
         .LEFT=INT_015*15
         .TOP=INT_015*205
         .WIDTH=INT_015*50
         .CAPTION='安全資料'
     ENDWITH  
  THIS.ADDOBJECT('LBLF991','LABEL')
     WITH THIS.LBLF991
         .VISIBLE=.T.
         .LEFT=INT_015*65
         .TOP=INT_015*205
         .AUTOSIZE=.T.
         .CAPTION=''
     ENDWITH
ENDPROC                               
********  
  PROC INIT       
       THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
       THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)    
       THISFORM.PAGEFRAME1.PAGE1.FONTSIZE=INT_015*10
       THISFORM.PAGEFRAME1.PAGE2.FONTSIZE=INT_015*10  
       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.FONTSIZE=INT_015*9  
       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.HEIGHT=INT_015*25
       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.READONLY = .T.
       THISFORM.SETALL('HEIGHT',INT_015*25,'TEXTBOX')
       THISFORM.SETALL('HEIGHT',INT_015*17,'LABEL')     
       THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
       THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')    
       THISFORM.SETALL('FONTSIZE',INT_015*9,'SPINNER')             
       THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
       THISFORM.SETALL('READONLY',.T.,'SPINNER')       
       THISFORM.SHRGROUP.VISIBLE=.F.
       THISFORM.SHRGROUP.ENABLED=.F.
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID2.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')         
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='任職狀況'
       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F01'
       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F02'
       THISFORM.GRID1.COLUMN3.CONTROLSOURCE="BILL_MODE(S05.F28)"
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55          
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*55
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(INDEXSEEK(S05.F01+'N',.F.,'S12','S123'),RGB(255,0,0),IIF(S05.F28='9',RGB(0,255,255),''))","COLUMN")    	     &&若為有尚未確認之內容則呈現紅色否則為外包人員則秀出天空藍顏色             
       THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF(S12.F19<>'Y',RGB(255,0,0),IIF(S12.F20='3',RGB(0,255,255),''))","COLUMN") 
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID2.SETALL('FONTSIZE',INT_015*9,'HEADER')     
       THISFORM.GRID2.COLUMN1.HEADER1.CAPTION='發放日期'    
       THISFORM.GRID2.COLUMN2.HEADER1.CAPTION='發放項目'       
       THISFORM.GRID2.COLUMN3.HEADER1.CAPTION='發放方式'
       THISFORM.GRID2.COLUMN4.HEADER1.CAPTION='計算方式'
       THISFORM.GRID2.COLUMN5.HEADER1.CAPTION='扣稅率(％)'
       THISFORM.GRID2.COLUMN6.HEADER1.CAPTION='稅前小計'   
       THISFORM.GRID2.COLUMN7.HEADER1.CAPTION='稅後小計'     
       THISFORM.GRID2.COLUMN8.HEADER1.CAPTION='安全資料'
       THISFORM.GRID2.LINKMASTER='S05'
       THISFORM.GRID2.RELATIONALEXPR='F01'
       THISFORM.GRID2.COLUMN1.CONTROLSOURCE='S12.F05'
       THISFORM.GRID2.COLUMN2.CONTROLSOURCE="IIF(S12.F06='1','年終獎金發放','未休年假獎金發放')"
       THISFORM.GRID2.COLUMN3.CONTROLSOURCE="IIF(S12.F08<>'1','合併薪資發放','單獨發放')"
       THISFORM.GRID2.COLUMN4.CONTROLSOURCE="IIF(S12.F10='1','方式一',IIF(S12.F10='2','方式二','方式三'))"
       THISFORM.GRID2.COLUMN5.CONTROLSOURCE="IIF(EMPTY(S12.F15),'',S12.F15)"
       THISFORM.GRID2.COLUMN6.CONTROLSOURCE='S12.F16'
       THISFORM.GRID2.COLUMN7.CONTROLSOURCE='S12.F17'
       THISFORM.GRID2.COLUMN8.CONTROLSOURCE='S12.F99' 
       THISFORM.GRID2.COLUMN1.WIDTH=INT_015*65
       THISFORM.GRID2.COLUMN2.WIDTH=INT_015*120
       THISFORM.GRID2.COLUMN3.WIDTH=INT_015*80
       THISFORM.GRID2.COLUMN4.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN5.WIDTH=INT_015*60
       THISFORM.GRID2.COLUMN6.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN7.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN8.WIDTH=INT_015*55
       THISFORM.GRID2.COLUMN8.WIDTH=INT_015*100
       THISFORM.GRID1.READONLY=.T.      
       THISFORM.GRID2.READONLY=.T.            
       THISFORM.GRID1.SETFOCUS
       THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.       
       THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
       THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
       THISFORM.ANS_BOTT.ENABLED=.F.     
       THISFORM.INVERSE_BOTT.ENABLED=.F.   
       IF THISFORM.GRID1.ACTIVEROW=0
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.F.       
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	        
	   THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F. 
           CHK_NULL='Y' 
       ELSE
           THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.
	   THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.       
           THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	   THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	   THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.    
	   THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.	     
           THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限       
           CHK_NULL='N' 
       ENDIF          
       JK='員工編號'
       SELE S05
       GO TOP
       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05.F01
  ENDPROC     
 ***********
  PROCEDURE PAGEFRAME1.PAGE1.ACTIVATE
        R=0
        SELECT S05
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO S051
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO S052
         ENDCASE       
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,255)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,0)                    
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.      	
       	THISFORM.ANS_BOTT.ENABLED=.F.     
       	THISFORM.INVERSE_BOTT.ENABLED=.F.    
       	THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE=S05.F15  &&發薪種類
         IF THISFORM.SHRGROUP.VISIBLE=.F.
              THISFORM.GRID1.ENABLED=.T. 
              THISFORM.GRID1.SETFOCUS 
              THISFORM.KEY_LIST.ENABLED=.T.
         ELSE
              THISFORM.KEY_LIST.ENABLED=.F. 	      	
         ENDIF                		                 
*!*	        THISFORM.REFRESH    
  ENDPROC     
**********             
  PROCEDURE PAGEFRAME1.PAGE2.ACTIVATE
	SELECT S12 
        IF THISFORM.SHRGROUP.ENABLED=.F.
             THISFORM.GRID2.READONLY=.T.     
             THISFORM.GRID2.SETFOCUS   
        ENDIF	
        THISFORM.PAGEFRAME1.PAGE1.FONTITALIC=.F.
        THISFORM.PAGEFRAME1.PAGE1.FORECOLOR=RGB(0,0,0)
        THISFORM.PAGEFRAME1.PAGE2.FONTITALIC=.T.
        THISFORM.PAGEFRAME1.PAGE2.FORECOLOR=RGB(0,0,255)               
	IF THISFORM.GRID2.ACTIVEROW=0 AND THISFORM.SHRGROUP.ENABLED=.F.	
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.    
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.	         
	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.
	      THISFORM.ANS_BOTT.ENABLED=.F.
	      THISFORM.INVERSE_BOTT.ENABLED=.F.	      
	       IF CHK_NULL='Y' AND THISFORM.SHRGROUP.ENABLED=.F.
	           THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F.
	       ELSE
                   THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.) AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)&&判斷有無新增的權限  	
               ENDIF	
              THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數                   Ｘ（到職月數／12）'                   
              THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .T.
              THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .T.
              THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .T.        
              THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .F.
              THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
              THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .F.
              THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.     
	      THISFORM.PAGEFRAME1.PAGE2.SETALL('VALUE','','TEXTBOX')   
	      THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=''      
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=''  
      	      THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE=0
      	      THISFORM.PAGEFRAME1.PAGE2.SPINNER091.VALUE=0
      	      THISFORM.PAGEFRAME1.PAGE2.SPINNER092.VALUE=0      	      
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE='' 
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE='' 
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE=''   
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE=''  	      
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE='' 
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE=''  
      	      THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE='' 
      	      THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION=''      	      
	      THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=''   	 
	      THISFORM.PAGEFRAME1.PAGE2.LBLF191.CAPTION=''      
	      THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''       	      
	ELSE
	      THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION=IIF(S12.F16 = 0 ,'',ALLTRIM(STR(S12.F16)))
	      THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION=IIF(S12.F17 = 0 ,'',ALLTRIM(STR(S12.F17)))
	      THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	      THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	      THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.	
	      THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.			   
	      THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.		   
	      THISFORM.ORPGROUP.NEW_BOTT.ENABLED=IIF(A02.F04='*',.T.,.F.) AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.) &&判斷有無新增的權限 
     	      THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S12.F19<>'Y'    &&判斷有無修改的權限
	      THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S12.F19<>'Y'     &&判斷有無刪除的權限	   
	      THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 		      
	      THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND S12.F19<>'Y'   AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	      THISFORM.INVERSE_BOTT.ENABLED=IIF(A02.F11='*',.T.,.F.) AND S12.F19='Y'   AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	      THISFORM.GRID2.AFTERROWCOLCHANGE 	      
	ENDIF          
       R=RECNO('&AREA1') 
       THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(RECNO('&AREA1')=R,RGB(255,255,0),'')","COLUMN")
       THISFORM.GRID1.ENABLED=.F.  
       THISFORM.KEY_LIST.ENABLED=.F.  	                 
*!*	        THISFORM.REFRESH    
  ENDPROC   
**********    
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依員工編號排列')
           .ADDITEM('依員工姓名排列')
           .VALUE=1
       ENDWITH             
  ENDPROC
********* 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE S05 
       DO CASE
          CASE THIS.DISPLAYVALUE='依員工編號排列'
               SET ORDER TO S051 
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F01'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F02'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*50
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*55 
          CASE THIS.DISPLAYVALUE='依員工姓名排列'
               SET ORDER TO S052
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='員工姓名'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='員工編號'
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='S05.F02'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='S05.F01'
	       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*55
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*50
       ENDCASE 
        THISFORM.GRID1.SETFOCUS
  ENDPROC      
***********  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
         SELECT S05
        THISFORM.GRID1.SETALL("DYNAMICBACKCOLOR","IIF(INDEXSEEK(S05.F01+'N',.F.,'S12','S123'),RGB(255,0,0),IIF(S05.F28='9',RGB(0,255,255),''))","COLUMN")    	     &&若為有尚未確認之內容則呈現紅色否則為外包人員則秀出天空藍顏色      
        THISFORM.GRID1.TOOLTIPTEXT=IIF(INDEXSEEK(S05.F01+'N',.F.,'S12','S123'),'尚有資料未確認',IIF(S05.F28='9','此為外包人員',''))        
        THISFORM.PAGEFRAME1.PAGE1.LBLF10.VISIBLE=IIF(EMPTY(S05.F10),.F.,.T.)
        THISFORM.PAGEFRAME1.PAGE1.TXTF10.VISIBLE=IIF(EMPTY(S05.F10),.F.,.T.)          
       	THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=S05.F01
       	THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=S05.F05 
       	THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=IIF(EMPTY(S05.F10),'',S05.F10)
       	THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=BILL_MODE(S05.F28)
       	THISFORM.PAGEFRAME1.PAGE1.TXTF15.VALUE=IIF(S05.F15='M','月薪',IIF(S05.F15='D','日薪','時薪'))
       	THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE=S05.F15  
        THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=S05.F02   
        THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION=S05.F06     
        THISFORM.ORPGROUP.NEW_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F. 
        THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.     	
       	THISFORM.ANS_BOTT.ENABLED=.F.
       	THISFORM.INVERSE_BOTT.ENABLED=.F. 
       	IF THISFORM.GRID1.ACTIVEROW=0 
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.F.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.F.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=.F.	     
	       THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE=''  	
	       THISFORM.PAGEFRAME1.PAGE1.TXTF10.VALUE=''  
	       THISFORM.PAGEFRAME1.PAGE1.TXTF15.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.TXTF28.VALUE=''
	       THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION=''   
	       THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION=''             
 	 ELSE
	       THISFORM.CMDGROUP.TOP_BOTT.ENABLED=.T.      
	       THISFORM.CMDGROUP.UP_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.NEXT_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.END_BOTT.ENABLED=.T.
	       THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T. 
	       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)  &&判斷有無列印的權限 	
         ENDIF	      
         FCH=THISFORM.ACTIVECONTROL.NAME
         JK=THIS.COLUMN1.HEADER1.CAPTION  
         IF THIS.ACTIVEROW=0
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
         ELSE
            THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.T.
         ENDIF   
         CHK=''     
*!*	       THISFORM.REFRESH
  ENDPROC     
**********  
  PROC GRID2.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
         SELECT S12
         THISFORM.GRID2.SETALL("DYNAMICBACKCOLOR","IIF(S12.F19<>'Y',RGB(255,0,0),IIF(S12.F20='3',RGB(0,255,255),''))","COLUMN")
         THISFORM.GRID2.TOOLTIPTEXT=IIF(S12.F19<>'Y','尚未確認',IIF(S12.F20='3','已確認,此筆資料為S30B.部門特殊其他所得發放作業中新增','已確認'))                         
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE=S12.F05
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE=IIF(EMPTY(S12.F06),'',IIF(S12.F06='1','年終獎金發放','未休年假獎金發放'))
   	 THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE=VAL(S12.F07)-1911
   	 THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=VAL(S12.F08)
   	 THISFORM.PAGEFRAME1.PAGE2.SPINNER091.VALUE=IIF(EMPTY(S12.F09),0,VAL(LEFT(DTOS(S12.F09),4))-1911)
   	 THISFORM.PAGEFRAME1.PAGE2.SPINNER092.VALUE=IIF(EMPTY(S12.F09),0,VAL(SUBSTR(DTOS(S12.F09),5,2)))   	 
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF10.VALUE=IIF(EMPTY(S12.F10),'',IIF(S12.F10='1','方式一',IIF(S12.F10='2','方式二','方式三')))
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE=S12.F11
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = S12.F12
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE = S12.F12
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE = IIF(EMPTY(S12.F13),'',IIF(S12.F13='H','時薪',IIF(S12.F13='D','日薪','底薪')))
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE = IIF(EMPTY(S12.F13),'',IIF(S12.F13='H','時薪',IIF(S12.F13='D','日薪','底薪')))
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = S12.F14
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE = S12.F14   
   	 THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=IIF(EMPTY(S12.F15),1,2)
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = S12.F15	 
   	 THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE = S12.F18   	 
	 THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION = ALLTRIM(STR(S12.F16))
	 THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(S12.F17))	 
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF191.CAPTION=IIF(EMPTY(S12.F19),'',IIF(S12.F19<>'Y','尚未確認',IIF(S12.F19='Y' AND S12.F20='3','已確認,此筆資料為S30B.部門特殊其他所得發放作業中新增','已確認')))  	  
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF191.BACKCOLOR=IIF(S12.F19<>'Y',RGB(255,0,0),RGB(58,186,152))
   	 THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=S12.F99  
   	 ***
         THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .F.   	 
         THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .F.
         THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .F.
         THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .F.
         THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
         THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .F.
         THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.    
         THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE=VAL(S12.F06)
         THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE=VAL(S12.F10)
         DO CASE
               CASE S12.F13 = 'H'
                          THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 2
                          THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 2
               CASE S12.F13 = 'D'
                          THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 3
                          THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 3
               CASE S12.F13 = 'B'
                         THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 4     
                         THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 4 
              CASE EMPTY(S12.F13 )
                         THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 1    
                         THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1              
         ENDCASE          	
   	 DO CASE 
   	       CASE S12.F06 = '1'		&&年終獎金
   	                 THISFORM.PAGEFRAME1.PAGE2.LBLF07.CAPTION='發放年終之年度'
   	                 DO CASE
   	                       CASE S12.F10 = '1'
   	                                  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數                   Ｘ（到職月數／12）'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .T.
                               CASE S12.F10 = '2'
                               	          THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .T.
                               CASE S12.F10 = '3'
                            	          THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放金額'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .T.                             
   	                 ENDCASE
   	        CASE S12.F06 = '2'	         &&未休年假
   	                 THISFORM.PAGEFRAME1.PAGE2.LBLF07.CAPTION='未休年假之年度'
   	                 THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .T.                      
   	                 DO CASE
   	                       CASE S12.F10 = '1'   	        
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放底數                   Ｘ 發放比率'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .T.                    
   	        	       CASE S12.F10 = '2'  
   	        	       	          THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放底數'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .T.     	       	          
   	        	       CASE S12.F10 = '3'  
   	        	                  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放金額'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .T.   	        	                  
   	        	 ENDCASE      
   	 ENDCASE           	 
         IF THISFORM.PAGEFRAME1.ACTIVEPAGE<>2
             THISFORM.CMDGROUP.SEEK_BOTT.ENABLED=.F.
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=.F.
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=.F.      	 
	     THISFORM.ANS_BOTT.ENABLED=.F.  	 
	     THISFORM.INVERSE_BOTT.ENABLED=.F.  
	 ELSE    
             THISFORM.ORPGROUP.EDIT_BOTT.ENABLED=IIF(A02.F05='*',.T.,.F.) AND S12.F19<>'Y'    &&判斷有無修改的權限
             THISFORM.ORPGROUP.DEL_BOTT.ENABLED=IIF(A02.F06='*',.T.,.F.) AND S12.F19<>'Y'   &&判斷有無刪除的權限	               	 
	     THISFORM.ANS_BOTT.ENABLED=IIF(A02.F08='*',.T.,.F.) AND S12.F19<>'Y'  AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)         
	     THISFORM.INVERSE_BOTT.ENABLED=IIF(A02.F11='*',.T.,.F.) AND S12.F19='Y'  AND IIF(S05.F28='1' OR S05.F28='3' OR S05.F28='7' OR S05.F28='8',.F.,.T.)
	 ENDIF			    			 
         FCH=THISFORM.ACTIVECONTROL.NAME 
         JK=THIS.COLUMN1.HEADER1.CAPTION
         CHK=THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE  
*       THISFORM.REFRESH
  ENDPROC 
*********** 
PROCEDURE ORPGROUP.NEW_BOTT.CLICK   
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.F.  
     THISFORM.GRID2.ENABLED=.F.  
     THISFORM.ANS_BOTT.ENABLED=.F.    
     THISFORM.INVERSE_BOTT.ENABLED=.F.           
     THISFORM.SETALL('READONLY',.F.,'TEXTBOX')   
     THISFORM.SETALL('READONLY',.F.,'SPINNER') 
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.           
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE =DATE()
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VISIBLE=.T. 
     THISFORM.PAGEFRAME1.PAGE2.LBLF07.CAPTION='發放年終之年度'
     THISFORM.PAGEFRAME1.PAGE2.SPINNER07.READONLY=.F.
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.ENABLED=.T.  
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=1
     THISFORM.PAGEFRAME1.PAGE2.SPINNER091.READONLY=.T. 
     THISFORM.PAGEFRAME1.PAGE2.SPINNER092.READONLY=.T. 
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VISIBLE=.T.   
     ***
      THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.F.  
      THISFORM.PAGEFRAME1.PAGE2.TXTF12A.READONLY=.F.  
      THISFORM.PAGEFRAME1.PAGE2.TXTF12B.READONLY=.F.
      THISFORM.PAGEFRAME1.PAGE2.TXTF14A.READONLY=.F.
      THISFORM.PAGEFRAME1.PAGE2.TXTF14B.READONLY=.F.     
     ***     
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE=.F.    
     THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE=.F.       
     THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE=.F.
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.ENABLED=.T. 
     ***
     SELECT S00
     SET ORDER TO S006
     SEEK 'K'
     IF FOUND()
          THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE=1 
          THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .T.
          THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = S00.F69
          THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE=.T. 
          THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = IIF(S00.F70='H',2,IIF(S00.F70='D',3,4))
          THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = S00.F71
          THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE = IIF(EMPTY(S00.F72),1,2)
          THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY = IIF(EMPTY(S00.F72),.T.,.F.)  
          THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = S00.F72          
          DO CASE 
                 CASE S00.F68 = '1'
                 	    THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE=1 
                 	    THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數                   Ｘ（到職月數／12）'    
                 CASE S00.F68 = '2'
                 	    THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE=2 
                 	    THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數'               	    
                 CASE S00.F68 = '3'
               	            THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE=3 
               	            THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放金額'
               	            THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE=.F. 
               	            THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE=.T.
          ENDCASE
     ELSE
          SELECT S00
          SEEK 'L'
          IF FOUND()
              THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE=2
              THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE = S00.F69
              THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE=.T. 
              THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = IIF(S00.F70='H',2,IIF(S00.F70='D',3,4))              
              THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE = S00.F71    
              THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE = IIF(EMPTY(S00.F72),1,2)   
              THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY = IIF(EMPTY(S00.F72),.T.,.F.)  
              THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = S00.F72
              DO CASE 
                    CASE S00.F68 = '1'
                    	      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE=1 
                 	      THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放底數                   Ｘ 發放比率'  
                 	      THISFORM.PAGEFRAME1.PAGE2.LBLF12B.VISIBLE = .T.
                    CASE S00.F68 = '2'
                 	      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE=2 
                 	       THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放底數'           	    
                    CASE S00.F68 = '3'
               	               THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE=3 
               	               THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放金額'
               	               THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE=.F. 
               	               THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE=.T.
               ENDCASE
          ELSE
              THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE=1 
              THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE=1 
              THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .T.
              THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = 0
              THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數                   Ｘ（到職月數／12）'  
              THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .T. 
              THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 1
              THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = 0
              THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE = 1
              THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY = .T. 
              THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = ''
          ENDIF
     ENDIF  
     THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE = YEAR(DATE()) - 1911
     THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE=''           
     THISFORM.PAGEFRAME1.PAGE2.LBLF191.CAPTION=''   
     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''    
     DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
      ENDCASE     
      THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
      IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
      ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
     ENDIF         
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS     
  ENDPROC
*************  
PROCEDURE SHRGROUP.SHURE1_BOTT.CLICK               &&新增確認
    SELE S12
    SET ORDER TO S121  && F01+DTOS(F05)+F06+F20
    COD=SYS(21)
    IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
         =MESSAGEBOX('發放日期不得空白!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.TXTF05.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN        	  
    ENDIF
    IF  INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE;
         +DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE);
         +ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE)),.F.,'S12','S121')=.T.
         =MESSAGEBOX('此發放日期與發放項目已存在,請重新輸入!',0+64,'提示訊息視窗')
  	 THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.SETFOCUS
  	 SET ORDER TO &COD
  	 RETURN     
    ENDIF
    IF  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=2 
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.SPINNER091.VALUE)
               =MESSAGEBOX('合併薪資發放之合併日期年度不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.SPINNER091.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF          
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.SPINNER092.VALUE)
               =MESSAGEBOX('合併薪資發放之合併日期月份不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.SPINNER092.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF         	    	  
    ENDIF    
    ****
    DO CASE
          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1   
                     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE)
                          =MESSAGEBOX('發放基數不得為零!',0+64,'提示訊息視窗')
  	                  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.SETFOCUS
  	                  SET ORDER TO &COD
  	                  RETURN 
  	             ENDIF                        
                     DO CASE
                            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1 OR THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2
                                       IF  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 1
                                            =MESSAGEBOX('發放底數不得空白!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF                            		  
                            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 3
                                       IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
                                            =MESSAGEBOX('發放金額不得為零!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.TXTF14A.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF                             
          	     ENDCASE
          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2 
                     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
                          =MESSAGEBOX('未休年假不得為零!',0+64,'提示訊息視窗')
  	                  THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
  	                  SET ORDER TO &COD
  	                  RETURN 
  	             ENDIF                        
                     DO CASE
                            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1 
                                       IF  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1
                                            =MESSAGEBOX('發放底數不得空白!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF             
                                       IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE)
                                            =MESSAGEBOX('發放比率不得為零!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.TXTF12B.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF        	                               
  	                    CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2       
                                       IF  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1
                                            =MESSAGEBOX('發放底數不得空白!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF        	                            		  
                            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 3
                                       IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)
                                            =MESSAGEBOX('發放金額不得為零!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.TXTF14B.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF                             
          	     ENDCASE          
    ENDCASE
    IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=2
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE)
               =MESSAGEBOX('扣稅額比例不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF    
    ENDIF      
    SELECT S12
   APPEND BLANK
    LOCK()
    IF RLOCK()
    	REPLACE F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    	REPLACE F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION)
    	REPLACE F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
    	REPLACE F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION)    	
    	REPLACE F05 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
    	REPLACE F06 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE))
    	REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE+1911))
    	REPLACE F08 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE))
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=2
    	     REPLACE F09 WITH CTOD(ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER091.VALUE))+'/'+ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER092.VALUE))+'/01')
    	ENDIF     
    	REPLACE F10 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE))
    	DO CASE
               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1   
               		  REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE
               		  IF THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1 OR THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2
               		       REPLACE F13 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 1,'',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 2,'H',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 3,'D','B')))
               		  ELSE
               		       REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE     
               		  ENDIF 
               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2
               		  REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
               		  DO CASE 
               		         CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1
               		                    REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE
               		                    REPLACE F13 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1,'',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 2,'H',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 3,'D','B')))
               		         CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2
               		                     REPLACE F13 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1,'',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 2,'H',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 3,'D','B')))
               		         CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 3
               		                     REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE 
               		  ENDCASE
        ENDCASE       
    	REPLACE F15 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=2,THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE,0)
    	REPLACE F16 WITH VAL(THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION)
    	REPLACE F17 WITH VAL(THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION)
    	REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE
    	REPLACE F19 WITH  'N'    	
    	REPLACE F20 WITH  '1'  
    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ENDIF
    UNLOCK ALL
    SELECT S12
    SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
    THISFORM.ORPGROUP.NEW_BOTT.CLICK   
    THISFORM.REFRESH
  ENDPROC  
***********    
  PROCEDURE ORPGROUP.EDIT_BOTT.CLICK 
     THISFORM.KEY_LIST.ENABLED=.F. 
     THISFORM.GRID1.ENABLED=.F.   
     THISFORM.GRID2.ENABLED=.F.         
     THISFORM.ANS_BOTT.ENABLED=.F.    
     THISFORM.INVERSE_BOTT.ENABLED=.F.                
     THISFORM.PAGEFRAME1.PAGE1.ENABLED=.F.          
     THISFORM.SETALL('READONLY',.F.,'TEXTBOX')  
     THISFORM.PAGEFRAME1.PAGE2.TXTF05.READONLY=.T. 
     THISFORM.PAGEFRAME1.PAGE2.TXTF06.READONLY=.T. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.SPINNER07.READONLY = .F.
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.ENABLED=.T.  
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=VAL(S12.F08)
     THISFORM.PAGEFRAME1.PAGE2.SPINNER091.READONLY=IIF(S12.F08<>'1',.F.,.T.)
     THISFORM.PAGEFRAME1.PAGE2.SPINNER092.READONLY=IIF(S12.F08<>'1',.F.,.T.)        
     THISFORM.PAGEFRAME1.PAGE2.TXTF10.VISIBLE=.F. 
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VISIBLE=.T.
     ***
      THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.F.  
      THISFORM.PAGEFRAME1.PAGE2.TXTF12A.READONLY=.F.  
      THISFORM.PAGEFRAME1.PAGE2.TXTF12B.READONLY=.F.
      THISFORM.PAGEFRAME1.PAGE2.TXTF14A.READONLY=.F.
      THISFORM.PAGEFRAME1.PAGE2.TXTF14B.READONLY=.F.     
     ***     
     THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE=IIF(S12.F06='2',.T.,.F.)  
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.ENABLED=.T. 
     THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=IIF(EMPTY(S12.F15),1,2)   
     THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY=IIF(EMPTY(S12.F15),.T.,.F.)   
     ***
     DO CASE
            CASE S12.F06 = '1'  
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE=.T. 
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = IIF(S12.F10 = '3' ,.F.,.T.)
                       THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE =  IIF(S12.F10 = '3' ,.T.,.F.)
                       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .F. 
                       THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.                                  
            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2
		       THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE=.F. 
		       THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE=.F.      
		       THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE=.F.
		       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .F.                       
                       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .T.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = IIF(S12.F10 = '1' ,.T.,.F.)
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE=.F. 
                       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = IIF(S12.F10 = '3' ,.F.,.T.)
                       THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE =  IIF(S12.F10 = '3' ,.T.,.F.)
     ENDCASE
     THISFORM.PAGEFRAME1.PAGE2.LBLF191.CAPTION=''   
     THISFORM.PAGEFRAME1.PAGE2.LBLF991.CAPTION=''      
     THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.SETFOCUS              
     SELECT S12
     LOCK()
     IF !RLOCK()
          DO FILE_IMPACT
          RETURN
     ENDIF   
 ENDPROC    
**************
PROCEDURE SHRGROUP.SHURE2_BOTT.CLICK   &&修改確認       
    SELE S12
    SET ORDER TO S121  && F01+DTOS(F05)+F06+F20
    COD=SYS(21)          
    IF  THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=2 
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.SPINNER091.VALUE)
               =MESSAGEBOX('合併薪資發放之合併日期年度不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.SPINNER091.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF          
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.SPINNER092.VALUE)
               =MESSAGEBOX('合併薪資發放之合併日期月份不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.SPINNER092.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF         	    	  
    ENDIF    
    ****
    DO CASE
          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1   
                     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE)
                          =MESSAGEBOX('發放基數不得為零!',0+64,'提示訊息視窗')
  	                  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.SETFOCUS
  	                  SET ORDER TO &COD
  	                  RETURN 
  	             ENDIF                        
                     DO CASE
                            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1 OR THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2
                                       IF  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 1
                                            =MESSAGEBOX('發放底數不得空白!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF                            		  
                            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 3
                                       IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
                                            =MESSAGEBOX('發放金額不得為零!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.TXTF14A.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF                             
          	     ENDCASE
          CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2 
                     IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE)
                          =MESSAGEBOX('未休年假不得為零!',0+64,'提示訊息視窗')
  	                  THISFORM.PAGEFRAME1.PAGE2.TXTF11.SETFOCUS
  	                  SET ORDER TO &COD
  	                  RETURN 
  	             ENDIF                        
                     DO CASE
                            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1 
                                       IF  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1
                                            =MESSAGEBOX('發放底數不得空白!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF             
                                       IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE)
                                            =MESSAGEBOX('發放比率不得為零!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.TXTF12B.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF        	                               
  	                    CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2       
                                       IF  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1
                                            =MESSAGEBOX('發放底數不得空白!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF        	                            		  
                            CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 3
                                       IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)
                                            =MESSAGEBOX('發放金額不得為零!',0+64,'提示訊息視窗')
  	                                    THISFORM.PAGEFRAME1.PAGE2.TXTF14B.SETFOCUS
  	                                    SET ORDER TO &COD
  	                                    RETURN 
  	                               ENDIF                             
          	     ENDCASE          
    ENDCASE
    IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=2
         IF  EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE)
               =MESSAGEBOX('扣稅額比例不得為零!',0+64,'提示訊息視窗')
  	       THISFORM.PAGEFRAME1.PAGE2.TXTF15.SETFOCUS
  	       SET ORDER TO &COD
  	       RETURN 
  	 ENDIF    
    ENDIF   
    SELECT  S12          
    IF RLOCK()
    	REPLACE F06 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE))
    	REPLACE F07 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE+1911))
    	REPLACE F08 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE))
    	IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE=2
    	     REPLACE F09 WITH CTOD(ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER091.VALUE))+'/'+ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER092.VALUE))+'/01')
    	ELSE
    	     REPLACE F09 WITH CTOD('')
    	ENDIF     
    	REPLACE F10 WITH ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE))
    	DO CASE
               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1   
               		  REPLACE F11 WITH 0
               		  REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE
               		  IF THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1 OR THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2
               		       REPLACE F13 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 1,'',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 2,'H',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = 3,'D','B')))
               		       REPLACE F14 WITH 0
               		  ELSE
               		       REPLACE F13 WITH ''
               		       REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE     
               		  ENDIF 
               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2
               		  REPLACE F11 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE
               		  DO CASE 
               		         CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1
               		                    REPLACE F12 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE
               		                    REPLACE F13 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1,'',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 2,'H',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 3,'D','B')))
               		                    REPLACE F14 WITH 0
               		         CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2
               		                     REPLACE F12 WITH 0
               		                     REPLACE F13 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 1,'',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 2,'H',IIF(THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = 3,'D','B')))
               		                     REPLACE F14 WITH 0
               		         CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 3
               		                     REPLACE F12 WITH 0
               		                     REPLACE F13 WITH ''
               		                     REPLACE F14 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE 
               		  ENDCASE
        ENDCASE       
    	REPLACE F15 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=2,THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE,0)
    	REPLACE F16 WITH VAL(THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION)
    	REPLACE F17 WITH VAL(THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION)
    	REPLACE F18 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF18.VALUE
    	REPLACE F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
    ELSE
          DO FILE_IMPACT
          RETURN   
    ENDIF  
    THISFORM.GRID2.SETFOCUS		      		          	    	              
    THISFORM.SHRGROUP.ABANDON_BOTT.CLICK    
ENDPROC   
*************
PROC ORPGROUP.DEL_BOTT.CLICK                    &&刪除資料程序
 IF  MESSAGEBOX('是否確定要刪除此筆資料',4+32+256,'請確認')=6 
       SELECT S12
       LOCK()
       IF RLOCK()
 	    IF S12.F19='Y'
 	       	 =MESSAGEBOX('此資料已確認,無法刪除!',0+64,'提示訊息視窗')
 	    ELSE
     	       DELETE 
     	       UNLOCK
     	       SKIP -1
     	       IF BOF()
     	           GO TOP
     	       ENDIF  
 	    ENDIF
       ELSE
           DO FILE_IMPACT
           RETURN
       ENDIF
       THISFORM.GRID2.SETFOCUS 	
       THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	      
  ENDIF
*!*	  THISFORM.REFRESH	       
ENDPROC  
****************
  PROCEDURE SHRGROUP.ABANDON_BOTT.CLICK
      THISFORM.SHRGROUP.ENABLED=.F.
      THISFORM.SHRGROUP.VISIBLE=.F.      
      THISFORM.ORPGROUP.ENABLED=.T.
      THISFORM.ORPGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.CMDGROUP.ENABLED=.T.
      THISFORM.CMDGROUP.SETALL('ENABLED',.T.,'COMMANDBUTTON')
      THISFORM.CMDGROUP.SETALL('FORECOLOR',RGB(0,0,0),'COMMANDBUTTON')
      THISFORM.SETALL('READONLY',.T.,'TEXTBOX')  
      THISFORM.SETALL('VISIBLE',.T.,'TEXTBOX')
      THISFORM.SETALL('READONLY',.T.,'SPINNER')        
      THISFORM.PAGEFRAME1.PAGE1.ENABLED=.T.      
      THISFORM.PAGEFRAME1.PAGE2.ENABLED=.T.      
      THISFORM.PAGEFRAME1.PAGE2.TXTF11.READONLY=.T.  
      THISFORM.PAGEFRAME1.PAGE2.TXTF12A.READONLY=.T.  
      THISFORM.PAGEFRAME1.PAGE2.TXTF12B.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF14A.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF14B.READONLY=.T.
      THISFORM.PAGEFRAME1.PAGE1.TXTF151.VISIBLE=.F.         
      THISFORM.PAGEFRAME1.PAGE2.SPINNER07.READONLY = .T.
      THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY = .T. 
      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VISIBLE=.F.   
      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VISIBLE=.F.        
      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE=.F.  
      THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE=.F.  
      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.ENABLED=.F.  
      THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.ENABLED=.F. 
      THISFORM.GRID2.ENABLED=.T.        
      THISFORM.GRID2.SETFOCUS   
      THISFORM.PAGEFRAME1.PAGE2.ACTIVATE       
*!*	      THISFORM.REFRESH   
      UNLOCK ALL          
  ENDPROC
**********  
  PROCEDURE SHRGROUP.FINISH_BOTT.CLICK
  SELECT S05
        DO CASE 
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工編號排列'
                 SET ORDER TO S051
            CASE THISFORM.KEY_LIST.DISPLAYVALUE='依員工姓名排列'
                 SET ORDER TO S052
         ENDCASE   
       THISFORM.SHRGROUP.ABANDON_BOTT.CLICK
  ENDPROC     
***************
 PROC ANS_BOTT.CLICK     &&確認作業     
     IF  MESSAGEBOX('您是否確認此筆資料!',4+32+256,'請確認')=6
           IF  S12.F19='Y'   &&判斷是否已確認
                =MESSAGEBOX('此筆資料已確認過,請查明後再作確認!',0+64,'提示訊息視窗')
                THISFORM.GRID2.SETFOCUS
           ELSE           
                IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE<>1  &&判斷是否為合併薪資發放  1.單獨 2.合併
                     S1=LEFT(DTOS(S12.F09),6)
          	     FILE_S10='S10'+ALLTRIM(S1)
		     FIND_S10=ALLTRIM(FILE_S10)+'.DBF'
		     S102='S102'+LEFT(DTOS(S12.F09),6)	&& F01+F97+F18+F19+DTOS(F22)
		     IF  FILE('&FIND_S10')=.T.   
		          IF  !USED('&FIND_S10')
		                SELE 0
			        USE &FIND_S10  
		          ELSE
			        SELE &FILE_S10
		          ENDIF  
		          SELECT &FILE_S10
	       	          SET ORDER TO S102  
	       	          SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A'
	      	          IF  FOUND()  					&&判斷是否已有此人員之薪資計算資料
		                IF  &FILE_S10..F98<>'Y' 		&&判斷薪資計算作業是否已確認
		          	      SELECT &FILE_S10
		           	      SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C'+'I'+IIF(S12.F06='1','年終獎金發放'+SPACE(18),'未休年假獎金發放'+SPACE(14))+DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
		          	      IF  !FOUND() 				&&若尚未確認則判斷改發放項目+日期 是否存在,不存在則新增該發放項目(I:其他所得發放)
		                            SELECT &FILE_S10
			                    APPEND BLANK			                    
			                    REPLACE &FILE_S10..F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
			                    REPLACE &FILE_S10..F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION)
			                    REPLACE &FILE_S10..F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
			                    REPLACE &FILE_S10..F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION)
			                    REPLACE &FILE_S10..F18 WITH 'I'
			                    REPLACE &FILE_S10..F19 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE
			                    REPLACE &FILE_S10..F20 WITH S12.F16	&&稅前小計
			                    REPLACE &FILE_S10..F21 WITH 0
			                    REPLACE &FILE_S10..F22 WITH THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE
				            REPLACE &FILE_S10..F23 WITH IIF(THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=2,THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE,0)	&&扣稅率
				            REPLACE &FILE_S10..F98 WITH 'N'
			                    REPLACE &FILE_S10..F97 WITH 'C'
			              	    REPLACE &FILE_S10..F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			              	    IF  S12.F15<>0	&&零表示不扣稅,若要扣稅則需把扣稅之金額寫入到扣款項目中且扣款類別為N:其他所得發放扣稅額
			                         SELECT &FILE_S10
				                 APPEND BLANK
				                 REPLACE &FILE_S10..F01 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE
				                 REPLACE &FILE_S10..F02 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF011.CAPTION)
				                 REPLACE &FILE_S10..F03 WITH THISFORM.PAGEFRAME1.PAGE1.TXTF02.VALUE
				                 REPLACE &FILE_S10..F04 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE1.LBLF021.CAPTION)
				                 REPLACE &FILE_S10..F24 WITH 'N'
				                 REPLACE &FILE_S10..F25 WITH ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)+'扣稅額'
				                 REPLACE &FILE_S10..F26 WITH S12.F16-S12.F17  &&稅前小計-稅後小計
				                 REPLACE &FILE_S10..F97 WITH 'D'
				                 REPLACE &FILE_S10..F98 WITH 'N'
				              	 REPLACE &FILE_S10..F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')
			              	    ENDIF
		                       ELSE
			                    =MESSAGEBOX('此發放作業已存在薪資計算作業中,請查明後再確認!',0+64,'提示訊息視窗')
		  	 	            SELECT &FILE_S10
			  	            USE
			  	            SELECT S12
			  	            THISFORM.GRID2.SETFOCUS
			  	            RETURN  
			                ENDIF
	             	          ELSE
	         	                =MESSAGEBOX('此人員之'+ALLTRIM(LEFT(DTOC(S12.F09),5))+'薪資計算作業已確認,故此發放作業無法與薪資合併發放!',0+64,'提示訊息視窗')
	  	 	   	        SELECT &FILE_S10
	  	 	   	        USE
		  	 	        SELECT S12
		  	 	        THISFORM.GRID2.SETFOCUS
		  	  	        RETURN  
	  	     	          ENDIF    	  
                            ENDIF  
               	            SELECT &FILE_S10
	  	            USE
                        ENDIF 
                  ENDIF   
                  SELECT S12
                  LOCK()
                  IF  RLOCK()
     	               REPLACE S12.F19 WITH 'Y'  	      
    		       REPLACE S12.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')   
    		       =MESSAGEBOX('此發放作業確認成功!',0+64,'提示訊息視窗') 
    		       THISFORM.GRID2.SETFOCUS
 	          ENDIF          
            ENDIF 
       ENDIF    
       UNLOCK   ALL 	
       THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	   
   ENDPROC
***************
 PROC INVERSE_BOTT.CLICK     &&反確認作業   
     IF  MESSAGEBOX('您是否要反確認此筆資料!',4+32+256,'請確認')=6
           IF  S12.F19<>'Y'   &&判斷是否已確認
                =MESSAGEBOX('此筆資料尚未確認過,請查明後再作反確認!',0+64,'提示訊息視窗')
                THISFORM.GRID2.SETFOCUS         
           ELSE       
                IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP08.VALUE<>1  &&判斷是否為合併薪資發放  1.單獨 2.合併
                     S1=LEFT(DTOS(S12.F09),6)
          	     FILE_S10='S10'+ALLTRIM(S1)
		     FIND_S10=ALLTRIM(FILE_S10)+'.DBF'
		     S102='S102'+LEFT(DTOS(S12.F09),6)	&& F01+F97+F18+F19+DTOS(F22)
		     S103='S103'+LEFT(DTOS(S12.F09),6)	&& F01+F97+F24+F25
		     IF  FILE('&FIND_S10')=.T.   
		          IF  !USED('&FIND_S10')
		                SELE 0
			        USE &FIND_S10 
		          ELSE
			        SELE &FILE_S10
		          ENDIF  
		          SELECT &FILE_S10
	       	          SET ORDER TO S103  
	       	          SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'A'
	      	          IF  FOUND()  					&&判斷是否已有此人員之薪資計算資料
		                IF  &FILE_S10..F98<>'Y' 		&&判斷此人員之薪資計算作業是否已確認
		          	      SELECT &FILE_S10
		           	      SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'D'+'N'+ALLTRIM(THISFORM.PAGEFRAME1.PAGE2.TXTF06.VALUE)+'扣稅額'
		          	      IF  FOUND() 				&&刪除扣款項目中的其他所得發放之扣稅額
		                            SELECT &FILE_S10
					    DELETE 
		                      ENDIF		                	
		          	      SELECT &FILE_S10
		          	      SET ORDER TO S102
		           	      SEEK THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE+'C'+'I'+IIF(S12.F06='1','年終獎金發放'+SPACE(18),'未休年假獎金發放'+SPACE(14))+DTOS(THISFORM.PAGEFRAME1.PAGE2.TXTF05.VALUE)
		          	      IF  FOUND() 				&&刪除薪資所得中之其他所得發放
		                            SELECT &FILE_S10
					    DELETE 
		                      ENDIF
	             	         ELSE
	         	                =MESSAGEBOX('此人員之'+ALLTRIM(LEFT(DTOC(S12.F09),5))+'薪資計算作業已確認,故此發放作業無法進行反確認!',0+64,'提示訊息視窗')
	  	 	   	        SELECT &FILE_S10
	  	 	   	        USE
		  	 	        SELECT S12
		  	 	        THISFORM.GRID2.SETFOCUS
		  	  	        RETURN  
	  	     	         ENDIF    	  
                           ENDIF  
               	           SELECT &FILE_S10
	  	           USE
                       ENDIF 
                  ENDIF   
                  SELECT S12
                  LOCK()
                  IF  RLOCK()
     	               REPLACE S12.F19 WITH 'N'  	      
    		       REPLACE S12.F99 WITH DTOC(DATE())+' '+IIF(SEEK(SYS_OPER,'A01'),A01.F03,'')   
    		       =MESSAGEBOX('此發放作業反確認成功!',0+64,'提示訊息視窗') 
    		       THISFORM.GRID2.SETFOCUS
 	          ENDIF          
            ENDIF 
       ENDIF     
        UNLOCK   ALL 	
       THISFORM.PAGEFRAME1.PAGE2.ACTIVATE 	   
ENDPROC       
ENDDEFINE    
***********************************************列印程序
PROCEDURE PNT_PRC  
   SELECT  S12
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW       
ENDPROC 
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
*!*	  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  TOP=INT_015*200
  LEFT=INT_015*200    
  HEIGHT=INT_015*140
  WIDTH=INT_015*380
  FONTSIZE=INT_015*9
  MOVABLE=.F.
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL5 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*13,;
      CAPTION='發放項目選擇',;
      NAME='LABEL5' 
ADD OBJECT COMBOBOX05 AS COMBOBOX WITH; 
     VISIBLE=.T.,;          
     LEFT=INT_015*110,;     
     TOP=INT_015*7,;
     HEIGHT=INT_015*25,;
     WIDTH=INT_015*130,;
      FONTSIZE=INT_015*9,;        
      BOUNDCOLUMN=1,;
      ROWSOURCE='全部項目,年終獎金發放,未休年假獎金發放',;
      ROWSOURCETYPE=1,;
      STYLE=2,;    
      VALUE=1,;
      NAME='COMBOBOX05'  
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*45,;
      CAPTION='起始員工編號',;
      NAME='LABEL1'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      TOP=INT_015*39,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*60,; 
      MAXLENGTH=4,;
      NAME='TEXT1'      
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*76,;
      CAPTION='截止員工編號',;
      NAME='LABEL2'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      TOP=INT_015*70,;
      LEFT=INT_015*110,;
      HEIGHT=INT_015*25,;   
      WIDTH=INT_015*60,;     
      MAXLENGTH=4,;   
      NAME='TEXT2'    
  ADD OBJECT LABEL3 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*190,;
      TOP=INT_015*45,;
      CAPTION='發放起始日期',;
      NAME='LABEL3'
  ADD OBJECT TEXT3 AS TEXTBOX WITH;
      TOP=INT_015*39,;
      LEFT=INT_015*270,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*70,; 
      NAME='TEXT3'          
  ADD OBJECT LABEL4 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*190,;
      TOP=INT_015*76,;
      CAPTION='發放截止日期',;
      NAME='LABEL4'
  ADD OBJECT TEXT4 AS TEXTBOX WITH;
      TOP=INT_015*70,;
      LEFT=INT_015*270,;
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*70,; 
      NAME='TEXT4'            
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      LEFT=INT_015*30,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*75,;    
      TOP=INT_015*105,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<V.預覽列印',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      LEFT=INT_015*155,;    
      HEIGHT=INT_015*25,; 
      WIDTH=INT_015*85,;    
      TOP=INT_015*105,;  
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<L.列印薪資單',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND2'      
  ADD OBJECT CMND3 AS COMMANDBUTTON WITH;
      LEFT=INT_015*290,;
      TOP=INT_015*105,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*55,; 
      MOUSEPOINTER=99,;
      MOUSEICON='BMPS\harrow.cur',;          
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND3'
  PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*10,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*10,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*10,'COMMANDBUTTON')   
      THISFORM.TEXT1.VALUE=S05.F01
      THISFORM.TEXT2.VALUE=S05.F01   
      THISFORM.TEXT3.VALUE=DATE()    
      THISFORM.TEXT4.VALUE=DATE()
  ENDPROC    
 ********預覽列印 
  PROCEDURE CMND1.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
       IF EMPTY(THISFORM.TEXT3.VALUE)
           =MESSAGEBOX('發放起始日期不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT3.SETFOCUS
  	   RETURN       
       ENDIF        
       IF EMPTY(THISFORM.TEXT4.VALUE)
           =MESSAGEBOX('發放截止日期不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT4.SETFOCUS
  	   RETURN       
       ENDIF            
       SELECT * FROM S12 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE AND;
                     					   F05>=THISFORM.TEXT3.VALUE AND F05<=THISFORM.TEXT4.VALUE AND;
                     					   IIF(THISFORM.COMBOBOX05.VALUE = 1,.T.,F06 = ALLTRIM(STR(THISFORM.COMBOBOX05.VALUE))) AND;
                     					   F20 <> '2' AND F19 = 'Y'  ORDER BY  F01,F05 NOWAIT
      IF  _TALLY >0
           REPORT FORM ALLTRIM(INT_116)+'S30A_1' TO PRINT PROMPT   PREVIEW
      ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.RELEASE
  ENDPROC           
***************列印薪資單
  PROCEDURE CMND2.CLICK 
      IF  EMPTY(THISFORM.TEXT1.VALUE)
           =MESSAGEBOX('起始員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT1.SETFOCUS
  	   RETURN 
      ENDIF
      IF  EMPTY(THISFORM.TEXT2.VALUE)
           =MESSAGEBOX('截止員工編號不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT2.SETFOCUS
  	   RETURN 
      ENDIF      
       IF EMPTY(THISFORM.TEXT3.VALUE)
           =MESSAGEBOX('發放起始日期不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT3.SETFOCUS
  	   RETURN       
       ENDIF        
       IF EMPTY(THISFORM.TEXT4.VALUE)
           =MESSAGEBOX('發放截止日期不得為空白!',0+64,'提示訊息視窗')
           THISFORM.TEXT4.SETFOCUS
  	   RETURN       
       ENDIF              
       SELECT * FROM S12 WHERE F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE AND;
                     				          F05>=THISFORM.TEXT3.VALUE AND F05<=THISFORM.TEXT4.VALUE AND;
                     				          IIF(THISFORM.COMBOBOX05.VALUE = 1,.T.,F06 = ALLTRIM(STR(THISFORM.COMBOBOX05.VALUE))) AND;
                     				          F20 <> '2' AND F19 = 'Y'  ORDER BY  F01,F05 INTO CURSOR S12A
        IF  _TALLY >0    
             CREATE CURSOR S12_TEMP;
      	                     (F01 C(5),F02 C(8),F03 C(5),F04 C(8),F05 D(8),F06 C(30),F15 N(4,1),F16 N(7),F17 N(7),F18 C(40),SUM_F16 N(7),SUM_F17 N(7))      
             CREATE CURSOR S12_1;
      	                     (F01 C(5),F02 C(8),F03 C(5),F04 C(8),F05 D(8),F06 C(30),F15 N(4,1),F16 N(7),F17 N(7),F18 C(40))                     		
             SELECT S12A
             GO TOP
             S12A_RC=S12A.F01
             DO WHILE !EOF()
                    IF  S12A_RC=S12A.F01
                        SELECT S12_1
                        APPEND BLANK 
                        REPLACE F01 WITH S12A.F01
                        REPLACE F02 WITH S12A.F02
                        REPLACE F03 WITH S12A.F03
                        REPLACE F04 WITH S12A.F04
                        REPLACE F05 WITH S12A.F05
	                REPLACE F06 WITH IIF(S12A.F06='1','年終獎金','未休年假獎金')
	                REPLACE F15 WITH S12A.F15
	                REPLACE F16 WITH S12A.F16
	                REPLACE F17 WITH S12A.F17
	                REPLACE F18 WITH S12A.F18
	                S12A_RC=S12A.F01
	                SELECT S12A
	                SKIP	                            
                   ELSE 
                        SUM_16=0
                        SUM_17=0
                        SELECT S12_1
                        GO TOP
                        DO WHILE !EOF()
	                       SELECT S12_TEMP
	                       APPEND BLANK 
	                       REPLACE F01 WITH S12_1.F01
		               REPLACE F02 WITH S12_1.F02
	                       REPLACE F03 WITH S12_1.F03
	                       REPLACE F04 WITH S12_1.F04
	                       REPLACE F05 WITH S12_1.F05
	                       REPLACE F06 WITH S12_1.F06
	                       REPLACE F15 WITH S12_1.F15
	                       REPLACE F16 WITH S12_1.F16
	                       REPLACE F17 WITH S12_1.F17
	                       REPLACE F18 WITH S12_1.F18
	                       SUM_16=SUM_16+S12_1.F16
	                       SUM_17=SUM_17+S12_1.F17
	                       SELECT S12_1
	                       SKIP	                            
                        ENDDO
		   *****滿足一頁只印15各項目
			IF MOD(RECCOUNT('S12_1'),15)=0
			     START_NO=RECCOUNT('S12_1')     
			ELSE
			     IF RECCOUNT('S12_1')<=15
			         START_NO=15
			    ELSE
			         START_NO=RECCOUNT('S12_1')+(15-MOD(RECCOUNT('S12_1'),15))
			    ENDIF        
			ENDIF
			FOR I=1 TO START_NO-RECCOUNT('S12_1')
			        SELECT S12_TEMP
			        APPEND BLANK
			ENDFOR    
			SELECT S12_TEMP
			GO BOTTOM
			REPLACE SUM_F16 WITH SUM_16
			REPLACE SUM_F17 WITH SUM_17
			SELECT S12_1
			USE 
  	                CREATE CURSOR S12_1;
  	                               (F01 C(5),F02 C(8),F03 C(5),F04 C(8),F05 D(8),F06 C(30),F15 N(4,1),F16 N(7),F17 N(7),F18 C(40))        
                        SELECT S12_1
                        APPEND BLANK 
                        REPLACE F01 WITH S12A.F01
                        REPLACE F02 WITH S12A.F02
                        REPLACE F03 WITH S12A.F03
                        REPLACE F04 WITH S12A.F04
                        REPLACE F05 WITH S12A.F05
                        REPLACE F06 WITH S12A.F06
                        REPLACE F15 WITH S12A.F15
                        REPLACE F16 WITH S12A.F16
                        REPLACE F17 WITH S12A.F17
                        REPLACE F18 WITH S12A.F18
                        S12A_RC=S12A.F01
                        SELECT S12A
                        SKIP
                ENDIF     	                          
          ENDDO   
	   ***************      
           SUM_16=0
           SUM_17=0
           SELECT S12_1
           GO TOP
           DO WHILE !EOF()
                  SELECT S12_TEMP
                  APPEND BLANK 
                  REPLACE F01 WITH S12_1.F01
                  REPLACE F02 WITH S12_1.F02
                  REPLACE F03 WITH S12_1.F03
                  REPLACE F04 WITH S12_1.F04
                  REPLACE F05 WITH S12_1.F05
                  REPLACE F06 WITH S12_1.F06
                  REPLACE F15 WITH S12_1.F15
                  REPLACE F16 WITH S12_1.F16
                  REPLACE F17 WITH S12_1.F17
                  REPLACE F18 WITH S12_1.F18
                  SUM_16=SUM_16+S12_1.F16
                  SUM_17=SUM_17+S12_1.F17
                  SELECT S12_1
                  SKIP	                            
             ENDDO
	     ****滿足一頁只印15各項目
	     IF MOD(RECCOUNT('S12_1'),15)=0
	          START_NO=RECCOUNT('S12_1')     
	     ELSE
	          IF RECCOUNT('S12_1')<=15
	               START_NO=15
	          ELSE
	               START_NO=RECCOUNT('S12_1')+(15-MOD(RECCOUNT('S12_1'),15))
	          ENDIF        
	     ENDIF
	     FOR I=1 TO START_NO-RECCOUNT('S12_1')
	             SELECT S12_TEMP
	            APPEND BLANK
	     ENDFOR    
	     SELECT S12_1
	     USE 
	     SELECT S12_TEMP
	     GO BOTTOM
	     REPLACE SUM_F16 WITH SUM_16
	     REPLACE SUM_F17 WITH SUM_17
             SELECT S12_TEMP
             GO TOP
*!*	             REPORT FORM ALLTRIM(INT_116)+'S30A_2' TO PRINT PROMPT   PREVIEW
             REPORT FORM ALLTRIM(INT_116)+'S30A_2' TO PRINT PROMPT 
             SELECT S12_TEMP
             USE
      ELSE
             =MESSAGEBOX('查無此範圍資料',0+48,'警示')
             THISFORM.TEXT1.SETFOCUS
             RETURN     
      ENDIF      
           THISFORM.RELEASE
  ENDPROC           
***************  
  PROCEDURE CMND3.CLICK
      THISFORM.RELEASE
  ENDPROC      
  PROC CMND1.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND1.TOP=INT_015*106
             THISFORM.CMND1.LEFT=INT_015*31
  ENDPROC     
  PROC CMND1.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND1.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND1.TOP=INT_015*105
             THISFORM.CMND1.LEFT=INT_015*30                  
  ENDPROC     
  PROC CMND2.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND2.TOP=INT_015*106
             THISFORM.CMND2.LEFT=INT_015*156
  ENDPROC     
  PROC CMND2.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND2.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND2.TOP=INT_015*105
             THISFORM.CMND2.LEFT=INT_015*155                  
  ENDPROC      
  PROC CMND3.MOUSEENTER      
       LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND3.FORECOLOR=RGB(255,0,0)
             THISFORM.CMND3.TOP=INT_015*106
             THISFORM.CMND3.LEFT=INT_015*291
  ENDPROC     
  PROC CMND3.MOUSELEAVE      
        LPARAMETERS nButton, nShift, nXCoord, nYCoord 
             THISFORM.CMND3.FORECOLOR=RGB(0,0,0)  
             THISFORM.CMND3.TOP=INT_015*105
             THISFORM.CMND3.LEFT=INT_015*290                  
  ENDPROC    
ENDDEFINE        
**********************************************發放項目
DEFINE CLASS COMBOBOX06 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*150
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2   
       VALUE=1
       NAME='COMBOBOX06' 
    PROCEDURE INIT    
      THIS.ADDITEM('年終獎金發放')
      THIS.ADDITEM('未休年假獎金發放')
   ENDPROC         
   PROCEDURE INTERACTIVECHANGE
      IF THISFORM.SHRGROUP.VISIBLE=.T.
      DO CASE
             CASE THIS.Value = 1
                       THISFORM.PAGEFRAME1.PAGE2.LBLF07.CAPTION='發放年終之年度'
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .T.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .F.       
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE = ''                
                       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .F.                       
           	       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = IIF(INDEXSEEK('K',.T.,'S00','S006'),VAL(S00.F68),0)
                       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = IIF(INDEXSEEK('K',.T.,'S00','S006'),S00.F72,'')    
                       THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY = IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),.T.,.F.)
                       THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE = IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),1,2)           	       
                        DO CASE
                               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數                   Ｘ（到職月數／12）'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = IIF(INDEXSEEK('K'+'1',.T.,'S00','S006'),S00.F69,0)
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = IIF(INDEXSEEK('K'+'1',.T.,'S00','S006'),IIF(S00.F70='H',2,IIF(S00.F70='D',3,4)),1)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = ''  
                               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2
                               	          THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = IIF(INDEXSEEK('K'+'2',.T.,'S00','S006'),S00.F69,0)
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = IIF(INDEXSEEK('K'+'2',.T.,'S00','S006'),IIF(S00.F70='H',2,IIF(S00.F70='D',3,4)),1)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = ''  
                               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 3
                            	          THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放金額'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = IIF(INDEXSEEK('K'+'3',.T.,'S00','S006'),S00.F69,0)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = IIF(INDEXSEEK('K'+'3',.T.,'S00','S006'),S00.F71,0)
                        ENDCASE      
             CASE THIS.Value = 2      
                       THISFORM.PAGEFRAME1.PAGE2.LBLF07.CAPTION='未休年假之年度'
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .F.                       
                       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .T.                 
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .F.      
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE = ''
           	       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE =IIF(INDEXSEEK('L',.T.,'S00','S006'),VAL(S00.F68),0)  
                       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = IIF(INDEXSEEK('K',.T.,'S00','S006'),S00.F72,'')    
                       THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY = IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),.T.,.F.)
                       THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE = IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),1,2)   	       
           	       SELECT S0B
           	       SET ORDER TO S0B1
           	       SEEK  THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE +  PADL(ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE + 1911)),4,'0')
           	       IF FOUND()
           	       	  THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE = IIF((S0B.F04 - S0B.F05)<=0,0,S0B.F04 - S0B.F05)
           	       ELSE	  
           	          THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE = IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,.T.,'S05','S051'),IIF((S05.F11-S05.F12)<=0,0,S05.F11-S05.F12),0)                     	       
           	       ENDIF 
                        DO CASE
                               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 1
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放底數                   Ｘ 發放比率'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE = IIF(INDEXSEEK('L'+'1',.T.,'S00','S006'),S00.F69,0)
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = IIF(INDEXSEEK('L'+'1',.T.,'S00','S006'),IIF(S00.F70='H',2,IIF(S00.F70='D',3,4)),1)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE = ''  
                               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 2
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放底數'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE = 0
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = IIF(INDEXSEEK('L'+'2',.T.,'S00','S006'),IIF(S00.F70='H',2,IIF(S00.F70='D',3,4)),1)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE = ''  
                               CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE = 3
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放金額'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE = 0
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE = IIF(INDEXSEEK('L'+'3',.T.,'S00','S006'),S00.F71,0)
                        ENDCASE                                
      ENDCASE	  
      ENDIF    
      ***
      ***
       NO_ACC = 0 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF            
  ENDPROC       
ENDDEFINE
***********發放年終/未休年假 之年度
DEFINE CLASS SPINNER07 AS SPINNER
      VISIBLE=.F.
      WIDTH=INT_015*47  
       KEYBOARDLOWVALUE=0
       KEYBOARDHIGHVALUE=999
       SPINNERLOWVALUE=0
       SPINNERHIGHVALUE=999
       INPUTMASK='999'    
        NAME='SPINNER07'
   PROCEDURE INTERACTIVECHANGE
       IF  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2
              SELECT S0B
              SET ORDER TO S0B1
              SEEK  THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE +  PADL(ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE + 1911)),4,'0')
              IF FOUND()
                  THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE = IIF((S0B.F04 - S0B.F05)<=0,0,S0B.F04 - S0B.F05)
              ELSE	  
                  THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE = IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,.T.,'S05','S051'),IIF((S05.F11-S05.F12)<=0,0,S05.F11-S05.F12),0)                     	       
              ENDIF        
      ENDIF 
   ***
   ***
       NO_ACC = 0 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF     
  ENDPROC
ENDDEFINE
****************發放方式
DEFINE CLASS OPTIONGROUP08 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*29
   WIDTH=INT_015*400
   BUTTONCOUNT=2
   VALUE=1
   ENABLED=.F.	   
   NAME='OPTIONGROUP08'
   OPTION1.CAPTION='單獨發放'
   OPTION1.FONTSIZE=INT_015*9  
   OPTION1.TOP=INT_015*7
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='合併薪資發放,合併日期'
   OPTION2.FONTSIZE=INT_015*9 	   
   OPTION2.TOP=INT_015*7
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*125
   OPTION2.NAME='OPTION2'
   PROCEDURE INTERACTIVECHANGE
      IF THIS.VALUE=1
      	   THISFORM.PAGEFRAME1.PAGE2.SPINNER091.READONLY=.T. 
      	   THISFORM.PAGEFRAME1.PAGE2.SPINNER092.READONLY=.T.  
           THISFORM.PAGEFRAME1.PAGE2.SPINNER091.VALUE=0
           THISFORM.PAGEFRAME1.PAGE2.SPINNER092.VALUE=0  	        	   	      
      ELSE     	         	    
      	   THISFORM.PAGEFRAME1.PAGE2.SPINNER091.READONLY=.F. 
      	   THISFORM.PAGEFRAME1.PAGE2.SPINNER092.READONLY=.F.  
           THISFORM.PAGEFRAME1.PAGE2.SPINNER091.VALUE=VAL(LEFT(DTOS(DATE()),4))-1911
           THISFORM.PAGEFRAME1.PAGE2.SPINNER092.VALUE=VAL(SUBSTR(DTOS(DATE()),5,2))         	      
      ENDIF    
  ENDPROC    
ENDDEFINE 
**********************************************計算方式
DEFINE CLASS COMBOBOX10 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*65
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX10' 
    PROCEDURE INIT    
      THIS.ADDITEM('方式一')
      THIS.ADDITEM('方式二')
      THIS.ADDITEM('方式三')
   ENDPROC         
   PROCEDURE INTERACTIVECHANGE
      IF THISFORM.SHRGROUP.VISIBLE=.T.
      DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1
           	       THISFORM.PAGEFRAME1.PAGE2.LBLF07.CAPTION='發放年終之年度'
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .T.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .F.           	       
                       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .F.      
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VALUE = ''     
                       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = IIF(INDEXSEEK('K',.T.,'S00','S006'),S00.F72,'')    
                       THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY = IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),.T.,.F.)
                       THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE = IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),1,2)
                        DO CASE
                               CASE THIS.VALUE = 1
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數                   Ｘ（到職月數／12）'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = IIF(INDEXSEEK('K'+'1',.T.,'S00','S006'),S00.F69,0)
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = IIF(INDEXSEEK('K'+'1',.T.,'S00','S006'),IIF(S00.F70='H',2,IIF(S00.F70='D',3,4)),1)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = ''  
                               CASE THIS.VALUE = 2
                               	          THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放底數'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = IIF(INDEXSEEK('K'+'2',.T.,'S00','S006'),S00.F69,0)
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE = IIF(INDEXSEEK('K'+'2',.T.,'S00','S006'),IIF(S00.F70='H',2,IIF(S00.F70='D',3,4)),1)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = ''  
                               CASE THIS.VALUE = 3
                            	          THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='發放基數                 Ｘ 發放金額'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE = IIF(INDEXSEEK('K'+'3',.T.,'S00','S006'),S00.F69,0)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE = IIF(INDEXSEEK('K'+'3',.T.,'S00','S006'),S00.F71,0)
                        ENDCASE      
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2
                       THISFORM.PAGEFRAME1.PAGE2.LBLF07.CAPTION='未休年假之年度'
                       THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF13A.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VISIBLE = .F.
                       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VISIBLE = .F.     
           	       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VISIBLE = .T.                          
           	       THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VISIBLE = .F.       
           	       THISFORM.PAGEFRAME1.PAGE2.TXTF13B.VALUE = ''        
           	       SELECT S0B
           	       SET ORDER TO S0B1
           	       SEEK  THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE +  PADL(ALLTRIM(STR(THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE + 1911)),4,'0')
           	       IF FOUND()
           	       	  THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE = IIF((S0B.F04 - S0B.F05)<=0,0,S0B.F04 - S0B.F05)
           	       ELSE	  
           	          THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE = IIF(INDEXSEEK(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,.T.,'S05','S051'),IIF((S05.F11-S05.F12)<=0,0,S05.F11-S05.F12),0)                     	       
           	       ENDIF            	     
                       THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = IIF(INDEXSEEK('L',.T.,'S00','S006'),S00.F72,'')    
                       THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY = IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),.T.,.F.)
                       THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE = IIF(EMPTY(THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE),1,2)           	         
                        DO CASE
                               CASE THIS.VALUE = 1
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放底數                   Ｘ 發放比率'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE = IIF(INDEXSEEK('L'+'1',.T.,'S00','S006'),S00.F69,0)
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = IIF(INDEXSEEK('L'+'1',.T.,'S00','S006'),IIF(S00.F70='H',2,IIF(S00.F70='D',3,4)),1)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE = ''  
                               CASE THIS.VALUE = 2
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放底數'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE = 0
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE = IIF(INDEXSEEK('L'+'2',.T.,'S00','S006'),IIF(S00.F70='H',2,IIF(S00.F70='D',3,4)),1)
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE = ''  
                               CASE THIS.VALUE = 3
                               		  THISFORM.PAGEFRAME1.PAGE2.LBLF12.CAPTION='未休年假天數            Ｘ 發放金額'
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VISIBLE = .T.
                               		  THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VISIBLE = .F.
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE = 0
                               		  THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE = IIF(INDEXSEEK('L'+'3',.T.,'S00','S006'),S00.F71,0)
                        ENDCASE                                
      ENDCASE
      ENDIF
      *****
      **
       NO_ACC = 0 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF            	              
  ENDPROC       
ENDDEFINE
**********************************************未休年假天數
DEFINE CLASS TXTF11 AS TEXTBOX
       READONLY=.T.
       VISIBLE=.T.
       WIDTH=INT_015*35
       HEIGHT=INT_015*25
       FONTSIZE=INT_015*9         
       MAXLENGTH=6        
       INPUTMASK='99.9'       
       NAME='TXTF11' 
  PROCEDURE INTERACTIVECHANGE
       NO_ACC = 0 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF                        
  ENDPROC
ENDDEFINE
**********************************************發放基數 / 發放比率
DEFINE CLASS TXTF12 AS TEXTBOX
       READONLY=.T.
       VISIBLE=.T.
       WIDTH=INT_015*45
       HEIGHT=INT_015*25
       FONTSIZE=INT_015*9         
       MAXLENGTH=6        
       INPUTMASK='999.99'       
       NAME='TXTF12' 
  PROCEDURE INTERACTIVECHANGE
       NO_ACC = 0 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF                     
  ENDPROC
ENDDEFINE
****************發放底數設定
DEFINE CLASS COMBOBOX13 AS COMBOBOX 
       VISIBLE=.F.
       HEIGHT=INT_015*25
       WIDTH=INT_015*50
       FONTSIZE=INT_015*9   
       BOUNDCOLUMN=1
       ROWSOURCETYPE=1
       STYLE=2    
       VALUE=1
       NAME='COMBOBOX13'
 PROCEDURE INIT    
       THIS.ADDITEM('')
       THIS.ADDITEM('時薪')
       THIS.ADDITEM('日薪')
       THIS.ADDITEM('底薪')       
  ENDPROC         
   PROCEDURE INTERACTIVECHANGE
       NO_ACC = 0 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF
  ENDPROC   
ENDDEFINE     
********************************************發放金額
DEFINE CLASS TXTF14 AS TEXTBOX
       READONLY=.T.
       VISIBLE=.T.
       WIDTH=INT_015*50
       HEIGHT=INT_015*25
       FONTSIZE=INT_015*9         
       MAXLENGTH=7       
       INPUTMASK='9999999'       
       NAME='TXTF14' 
  PROCEDURE INTERACTIVECHANGE 
       NO_ACC = 0 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF   
  ENDPROC 
ENDDEFINE   
*************選擇是否扣稅
DEFINE CLASS OPTIONGROUP15 AS OPTIONGROUP
   VISIBLE=.T.
   HEIGHT=INT_015*29
   WIDTH=INT_015*260
   BUTTONCOUNT=2
   VALUE=1
   ENABLED=.F.   
   NAME='OPTIONGROUP15'
   OPTION1.CAPTION='不扣稅'
   OPTION1.TOP=INT_015*7
   OPTION1.AUTOSIZE=.T.
   OPTION1.LEFT=INT_015*5
   OPTION1.FONTSIZE=INT_015*9    
   OPTION1.NAME='OPTION1'
   OPTION2.CAPTION='扣 稅率'
   OPTION2.TOP=INT_015*7
   OPTION2.AUTOSIZE=.T.
   OPTION2.LEFT=INT_015*125
   OPTION2.FONTSIZE=INT_015*9    
   OPTION2.NAME='OPTION2'
  PROCEDURE INTERACTIVECHANGE   
      NO_ACC = 0
       IF THIS.VALUE=1 &&不扣稅
           THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY=.T. 
       	   THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = ''	
       ELSE	   
           THISFORM.PAGEFRAME1.PAGE2.TXTF15.READONLY=.F. 
            DO CASE 
                   CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1    &&年終獎金
                 	      THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = IIF(INDEXSEEK('K',.T.,'S00','S006'),S00.F72,0)  
                   CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                              THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE = IIF(INDEXSEEK('L',.T.,'S00','S006'),S00.F72,0)  
            ENDCASE
       ENDIF 
       ********   
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF
  ENDPROC    
ENDDEFINE       
***********************************************稅額
DEFINE CLASS TXTF15 AS TEXTBOX
       READONLY=.T.
       VISIBLE=.T.
       WIDTH=INT_015*50
       HEIGHT=INT_015*25
       FONTSIZE=INT_015*9         
       MAXLENGTH=4       
       INPUTMASK='99.9'       
       NAME='TXTF15' 
  PROCEDURE INTERACTIVECHANGE   
       NO_ACC = 0 
       DO CASE
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 1 &&年終獎金
                         NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,1,;
                      						THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      						0,THISFORM.PAGEFRAME1.PAGE2.TXTF12A.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13A.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14A.VALUE)
             CASE THISFORM.PAGEFRAME1.PAGE2.COMBOBOX06.VALUE = 2	&&未休年假
                        NO_ACC = SUM_ACC(THISFORM.PAGEFRAME1.PAGE1.TXTF01.VALUE,THISFORM.PAGEFRAME1.PAGE1.TXTF151.VALUE,2,;
                        				       THISFORM.PAGEFRAME1.PAGE2.SPINNER07.VALUE,THISFORM.PAGEFRAME1.PAGE2.COMBOBOX10.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.TXTF11.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF12B.VALUE,;
                      					       THISFORM.PAGEFRAME1.PAGE2.COMBOBOX13B.VALUE,THISFORM.PAGEFRAME1.PAGE2.TXTF14B.VALUE)          
        ENDCASE 
        THISFORM.PAGEFRAME1.PAGE2.LBLF161.CAPTION =ALLTRIM(STR(NO_ACC))
        IF THISFORM.PAGEFRAME1.PAGE2.OPTIONGROUP15.VALUE=1 &&不扣稅
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC))
        ELSE
             THISFORM.PAGEFRAME1.PAGE2.LBLF171.CAPTION = ALLTRIM(STR(NO_ACC - ROUND((NO_ACC * (THISFORM.PAGEFRAME1.PAGE2.TXTF15.VALUE/100)),0))) 
        ENDIF
  ENDPROC
ENDDEFINE  
****
****************************************
FUNC SUM_ACC
     PARA POLK,F15_CLASS,F06NO,F07NO,F10NO,F11NO,F12NO,F13NO,F14NO
      F16_NO = 0
       ********   
       DO CASE
             CASE F15_CLASS='M'   &&發薪種類(M:月薪 D:日薪 T:時薪)
                        MONTH_MONEY=IIF(INDEXSEEK(POLK+'A',.T.,'S06','S061'),S06.F08,0)  &&底薪
	                DAY_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F02,0)<>0,MONTH_MONEY/S00.F02,0)       			    &&日薪
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	    &&時薪
	     CASE F15_CLASS='D'     
	     		MONTH_MONEY=0
	                DAY_MONEY=IIF(INDEXSEEK(POLK+'B',.T.,'S06','S061'),S06.F08,0)     
	                TIME_MONEY=IIF(IIF(INDEXSEEK('Z',.T.,'S00','S001'),S00.F03,0)<>0,DAY_MONEY/S00.F03,0)       			  	   
	     CASE F15_CLASS='T'      
	     		MONTH_MONEY=0
	                DAY_MONEY=0
	                TIME_MONEY=IIF(INDEXSEEK(POLK+'C',.T.,'S06','S061'),S06.F08,0)
       ENDCASE
       **判斷到職是否滿一年
	DO CASE
	       CASE (F07NO + 1911) - YEAR(S05.F09) < 0
	                  JOB_YEAR = 0
	       CASE (F07NO + 1911) - YEAR(S05.F09) = 0
	                  JOB_YEAR = 12 -MONTH(S05.F09) + 1
	       CASE (F07NO + 1911) - YEAR(S05.F09) > 0
	                  JOB_YEAR = 12
       ENDCASE                     
       DO CASE
       	       CASE F06NO = 1 &&年終獎金
       	          	   DO CASE
       	          	            CASE F10NO = 1	&&發放基數 X 發放底數 X (到職月數/12)
       	          	            		DO CASE
       	          	            		       CASE F13NO = 2	&&時薪
       	          	            		       		  F16_NO = ROUND(F12NO * TIME_MONEY * (JOB_YEAR/12),0)
       	          	            		       CASE F13NO = 3	&&日薪
       	          	            		       		  F16_NO = ROUND(F12NO * DAY_MONEY * (JOB_YEAR/12),0)
       	          	            		       CASE F13NO = 4	&&底薪
       	          	            		       		   F16_NO = ROUND(F12NO * MONTH_MONEY * (JOB_YEAR/12),0)
       	          	            		ENDCASE
       	          	            CASE F10NO = 2 &&發放基數 X 發放底數
       	          	            		DO CASE
       	          	            		       CASE F13NO = 2	&&時薪
       	          	            		       		  F16_NO = ROUND(F12NO * TIME_MONEY,0)
       	          	            		       CASE F13NO = 3	&&日薪
       	          	            		       		  F16_NO = ROUND(F12NO * DAY_MONEY,0)
       	          	            		       CASE F13NO = 4	&&底薪
       	          	            		       		  F16_NO = ROUND(F12NO * MONTH_MONEY,0)
       	          	            		ENDCASE       	          	            
       	          	            CASE F10NO = 3 &&發放基數 X 發放金額
       	          	                        F16_NO = ROUND(F12NO * F14NO,0)
       	          	     ENDCASE
       	          CASE F06NO = 2	&&未休年假
       	          	     DO CASE
       	          	            CASE F10NO = 1	&&發放基數 X 發放底數 X 發放比率
       	          	            		DO CASE
       	          	            		       CASE F13NO = 2	&&時薪
       	          	            		       		  F16_NO = ROUND(F11NO * TIME_MONEY * F12NO,0)
       	          	            		       CASE F13NO = 3	&&日薪
       	          	            		                  F16_NO = ROUND(F11NO * DAY_MONEY * F12NO,0)
       	          	            		       CASE F13NO = 4	&&底薪
       	          	            		                  F16_NO = ROUND(F11NO * MONTH_MONEY * F12NO,0)
       	          	            		ENDCASE
       	          	            CASE F10NO = 2 &&發放基數 X 發放底數
       	          	            		DO CASE
       	          	            		       CASE F13NO = 2	&&時薪
       	          	            		       		   F16_NO = ROUND(F11NO * TIME_MONEY,0)
       	          	            		       CASE F13NO = 3	&&日薪
       	          	            		                   F16_NO = ROUND(F11NO * DAY_MONEY,0)
       	          	            		       CASE F13NO = 4	&&底薪
       	          	            		                   F16_NO = ROUND(F11NO * MONTH_MONEY,0)
       	          	            		ENDCASE       	          	            
       	          	            CASE F10NO = 3 &&發放基數 X 發放金額
       	          	                        F16_NO = ROUND(F11NO * F14NO,0)
       	          	     ENDCASE       	 
      ENDCASE
     RETURN F16_NO 

