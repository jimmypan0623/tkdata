****程式名稱 崧騰出貨標籤
CLEAR ALL
SET TALK OFF
SET EXCL OFF
SET DELE ON
SET CENT OFF
SET SAFE OFF
SET DECIMALS TO 6
SET REPROCESS TO 1
_SCREEN.CAPTION=''
_SCREEN.CONTROLBOX=.F.
ZOOM WIND SCREEN MIN
CLEAR ALL
CLOS DATA ALL
CLOS TABL ALL
SET TALK OFF
SET EXCL OFF
SET DELE ON
SET CENT OFF
SET SAFE OFF
SET DECIMALS TO 6
SET ENGINEBEHAVIOR 70 
SET REPORTBEHAVIOR 80
SET REPROCESS TO 1
_SCREEN.CAPTION=''
_SCREEN.CONTROLBOX=.F.
ZOOM WINDOW  SCREEN MAX
HIDE WINDOW SCREEN
DEACTIVATE WIND SCREEN

SET SYSMENU OFF
SET STATUS BAR OFF
SET MULTILOCKS ON
DECLARE _FPRESET IN msvcrt20.dll 
CAPSLOCK(.T.)

CREATE CURSOR TD4 (F01 C(10))
INDEX ON F01 TAG TD4
SET ORDER TO 1
IF !USED('A26')
   SELECT 0
   USE A26
ELSE 
   SELECT A26
ENDIF
SET ORDER TO 1      
SEEK 'INT_012'
IF FOUND()
   INT_012=VAL(F06)
ELSE
  INT_012=2   
ENDIF
IF INT_012=1
   SET DATE TO TAIWAN
ELSE
   SET DATE TO YMD
ENDIF   
SEEK 'INT_015'
IF FOUND()
   INT_015=VAL(F06)
ELSE
   INT_015=1
ENDIF
IF !USED('C20')
   SELECT 0
   USE C20
ELSE
   SELECT C20
ENDIF
SET ORDER TO 1      
IF !USED('C03')
   SELECT 0
   USE C03
ELSE 
   SELECT C03
ENDIF
SET ORDER TO 1 
IF !USED('C04')
   SELECT 0
   USE C04
ELSE 
   SELECT C04
ENDIF
SET ORDER TO 1      
IF !USED('A23')
   SELECT 0
   USE A23
ELSE 
   SELECT A23
ENDIF
SET ORDER TO 1    
B04='B04'+LEFT(DTOS(DATE()),6)
B041='B041'+LEFT(DTOS(DATE()),6)
IF !USED('&B04')
   SELE 0
   USE (B04) ALIA B04
ELSE
   SELE B04
ENDIF
SET ORDER TO 1        
DO FORM songton
************************

******************
DEFINE CLASS SONG5_SEEK AS FORM
*!*	  AUTOCENTER=.T.
  CAPTION='        依料號匯總輸入DATE CODD'
  TOP=INT_015*0
  LEFT=INT_015*0   
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*350
  WIDTH=INT_015*500
  FONTSIZE=INT_015*9
  MAXBUTTON=.F.
  MINBUTTON=.F.    
  CLOSABLE=.F.
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='SONG5_SEEK'
  ADD OBJECT GRID5 AS GRID WITH;          
      TOP=0,;
      HIGHLIGHTROWLINEWIDTH=4,;
      WIDTH=INT_015*500,;      
      HEIGHT=INT_015*264,;      
      ROWHEIGHT=INT_015*25,;
      HEADERHEIGHT=INT_015*19,;
      FONTSIZE=INT_015*16,;
      DELETEMARK=.F.,;
      READONLY=.T.,;
      RECORDSOURCETYPE=1,;
      COLUMNCOUNT=2,;       
      RECORDSOURCE='SONG5',;     
      NAME='GRID5',;
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2'
      
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*20,;    
      HEIGHT=INT_015*25,;   
      TOP=INT_015*280,;        
      WIDTH=INT_015*80,;    
      FONTSIZE=INT_015*16,;
      CAPTION='\<S.確定',;
      TOOLTIPTEXT='選擇游標所指的紀錄!快速鍵->ALT+S'
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*300,;
      TOP=INT_015*280,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*80,;    
      FONTSIZE=INT_015*16,;      
      CAPTION='\<X.取消',;
      TOOLTIPTEXT='取消此搜尋畫面!快速鍵->ALT+X'
      NAME='CMND2'
  
   PROCEDURE INIT 
      
         SELE SONG5
         
         GO TOP
         THISFORM.GRID5.SETALL('FONTSIZE',INT_015*12,'COLUMN')
         THISFORM.GRID5.SETALL('FONTSIZE',INT_015*12,'HEADER')   
         THISFORM.SETALL('MOVABLE',.F.,'COLUMN') 
         THISFORM.SETALL('MOUSEPOINTER',99,'COMMANDBUTTON')
         THISFORM.SETALL('MOUSEICON','BMPS\harrow.cur','COMMANDBUTTON')                           
         THISFORM.SETALL('READONLY',.T.,'TEXTBOX')
 
         
         THISFORM.GRID5.COLUMN1.HEADER1.CAPTION='料號'
         THISFORM.GRID5.COLUMN1.WIDTH=INT_015*370
         THISFORM.GRID5.COLUMN1.CONTROLSOURCE='STK_NO'  
                       
         THISFORM.GRID5.COLUMN2.HEADER1.CAPTION='DATE CODE'
         THISFORM.GRID5.COLUMN2.WIDTH=INT_015*80
         THISFORM.GRID5.COLUMN2.CONTROLSOURCE='DC'               
                                
         THISFORM.GRID5.SETFOCUS
      ENDPROC
      ***
     PROC GRID5.INIT      
	     
	      THISFORM.GRID5.COLUMN1.READONLY=.T.
	      THISFORM.GRID5.COLUMN2.READONLY=.F.
	       
	
      ENDPROC
      ***
      PROC GRID5.AFTERROWCOLCHANGE
           LPARAMETERS XCOLINDEX
 
      ENDPROC 
 PROCEDURE CMND1.CLICK
      SELECT SONG5
      GO TOP 
      DO WHILE !EOF()
         SELECT TMP1
         IF !EMPTY(ALLTRIM(SONG5.DC))
             REPLACE DC WITH SONG5.DC FOR STK_NO=SONG5.STK_NO  
                
         ENDIF    
         SELECT SONG5
         SKIP
      ENDDO
      SELECT SONG5
      USE
      THISFORM.RELEASE     
 ENDPROC
 PROCEDURE CMND2.CLICK
      SELECT SONG5
      USE
      THISFORM.RELEASE
 ENDPROC  
 **
 
ENDDEFINE  