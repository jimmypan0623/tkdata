**程式名稱:P15.外購進貨用途明細
SET EXCL OFF
CLOSE ALL
CLEAR 
AREA1='P15'
FLG='0'
FCH=''
CHK=''
WAIT WINDOW "資料匯入中,請稍後!" AT 0,150 NOWAIT NOCLEAR
IF !USED('A01')
   SELE 0
   USE A01
ELSE 
   SELE A01
ENDIF
SET ORDER TO A01      
IF !USED('A02')
   SELE 0
   USE A02 INDE A02
ELSE
   SELE A02
ENDIF
SET ORDER TO A021      
SEEK SYS_OPER+'P15'   
SET ORDER TO 1
IF !USED('A23')
    SELE 0
    USE A23
ELSE 
   SELE A23
ENDIF
SET ORDER TO 1
GO TOP
STAR_DATE=LEFT(DTOC(A23.F01),5)
IF !USED('B01')
   SELE 0
   USE B01 INDE B01
ELSE
   SELE B01
ENDIF
SET ORDER TO 1
********************** 
CREATE CURSOR P15 (F01 C(10),F02 D(10),F03 C(43),F04 N(11,2),F08 C(20),F09 C(10),F20 C(8))
INDEX ON F03 TAG P15_1
INDEX ON F20 TAG P15_2 &&客戶簡稱
INDEX ON F01 TAG P15_3
INDEX ON F09 TAG P15_4
INDEX ON DTOS(F02) TAG P15_5	
N=RECCOUNT('A23')&&計算A23之月份檔開啟之次數
FOR I=1 TO N
	P12='P12'+LEFT(ALLTRIM(DTOS(A23.F01)),4)+LEFT(RIGHT(ALLTRIM(DTOS(A23.F01)),4),2)&&外購進貨單
	IF  FILE(P12+'.DBF')=.T.
       	      IF !USED('&P12')
          	    SELE 0 
          	    USE (P12) ALIA P12
       	      ELSE
          	    SELE P12
       	      ENDIF
              SET ORDER TO 1
	ELSE
	      CREATE CURSOR P12 (F01 C(10),F02 D(10),F03 C(43),F04 N(11,2),F08 C(20),F09 C(10))       
	ENDIF
**********
SELECT P12
GO TOP
DO  WHILE !EOF()
	SELECT P15
	APPEND BLANK
	REPLACE F01 WITH P12.F01
	REPLACE F02 WITH CTOD(LEFT(ALLTRIM(DTOC(A23.F01)),2)+'/'+LEFT(RIGHT(ALLTRIM(DTOC(A23.F01)),5),2)+'/'+ALLTRIM(P12.F02))
	REPLACE F03 WITH P12.F03
	REPLACE F04 WITH P12.F04
	REPLACE F08 WITH P12.F08
	REPLACE F09 WITH P12.F09
	REPLACE F20 WITH RIGHT(ALLTRIM(P12.F08),8)
	SELECT P12
   	SKIP
ENDDO
SELECT P12
USE
SELECT A23
END_DATE=LEFT(DTOC(A23.F01),5)
SKIP
ENDFOR
SELECT P15
SET ORDER TO 1
SET RELA TO F03 INTO B01
WAIT CLEAR
*****************
P15FORM=CREATEOBJECT("TKP15")
P15FORM.SHOW  
DEFINE CLASS TKP15 AS FORM
  CAPTION='P15.外購進貨用途明細'+SPACE(5)+'資料範圍：'+STAR_DATE+' ~ '+END_DATE
*!*	  AUTOCENTER=.T.
  CONTROLBOX=.F.
  BORDERSTYLE=1 
  MAXBUTTON=.F.
  MINBUTTON=.F.
  MOVABLE=.F.
  CLOSABLE=.F.
  CONTROLCOUNT=57
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*550
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WIDTH=INT_015*789
  WINDOWTYPE=1
*!*	  ADD OBJECT SHAPE1 AS SHAPE1 WITH;
*!*	      AUTOCENTER=.T.
*!*	  ADD OBJECT SHAPE2 AS SHAPE2 WITH;
*!*	      AUTOCENTER=.T.
*!*	  ADD OBJECT SHAPE3 AS SHAPE3 WITH;
*!*	      AUTOCENTER=.T.
  ADD OBJECT LBL_REC AS LBL_REC WITH;
      LEFT=INT_015*660,;
      AUTOCENTER =.T.,;
      CAPTION='資料筆數',;
      TOP=INT_015*9
  ADD OBJECT REC_COUNT AS REC_COUNT  WITH;
      TOP=INT_015*9
  ADD OBJECT KEY_LIST AS KEY_LIST WITH;
      AUTOCENTER=.T.
  ADD OBJECT GRID1 AS GRID1 WITH;
      COLUMNCOUNT=7,;            
      RECORDSOURCE='P15',; 
      HEIGHT=INT_015*500,;     
      WIDTH=INT_015*780,;      
      COLUMN1.NAME='COLUMN1',;
      COLUMN2.NAME='COLUMN2',;
      COLUMN3.NAME='COLUMN3',; 
      COLUMN4.NAME='COLUMN4',;
      COLUMN5.NAME='COLUMN5',; 
      COLUMN6.NAME='COLUMN6',;
      COLUMN7.NAME='COLUMN7'                         
  ADD OBJECT ORPGROUP AS ORPGROUP WITH;      
      TOP=INT_015*0,;
      LEFT=INT_015*435             
  ADD OBJECT CMDGROUP AS CMDGROUP WITH;
      TOP=INT_015*0,;
      LEFT=INT_015*220,;
      ENABLED=.T.,;
      VISIBLE=.T.  
*****************                       
PROCEDURE INIT
  SET DATE  TAIWAN
  	SELECT P15
  	GO TOP
       THISFORM.ORPGROUP.NEW_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.EDIT_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.DEL_BOTT.VISIBLE=.F.
       THISFORM.ORPGROUP.PNT_BOTT.ENABLED=IIF(A02.F07='*',.T.,.F.)   &&判斷有無列印的權限    
       THISFORM.GRID1.BACKCOLOR=IIF(SEEK(sys_oper,'A01'),IIF(A01.F11=0,10009146,A01.F11),10009146)
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'COLUMN')
       THISFORM.GRID1.SETALL('FONTSIZE',INT_015*9,'HEADER')       
       THISFORM.GRID1.COLUMN1.WIDTH=INT_015*120
       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*100
       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*150
       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60     
       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料品編號'
	   THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='品名規格'
	   THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='數    量'	   
  	   THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='進貨單號'
  	   THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='採購單號'
  	   THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='用    途' 
  	   THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='進貨日期'  
	   THISFORM.GRID1.COLUMN1.CONTROLSOURCE='P15.F03'
	   THISFORM.GRID1.COLUMN2.CONTROLSOURCE='B01.F02'
	   THISFORM.GRID1.COLUMN3.CONTROLSOURCE='P15.F04'
	   THISFORM.GRID1.COLUMN4.CONTROLSOURCE='P15.F01'
	   THISFORM.GRID1.COLUMN5.CONTROLSOURCE='P15.F09'
	   THISFORM.GRID1.COLUMN6.CONTROLSOURCE='P15.F08'
	   THISFORM.GRID1.COLUMN7.CONTROLSOURCE='P15.F02'
       THISFORM.GRID1.READONLY=.T.       
       THISFORM.GRID1.SETFOCUS     
       JK='料品編號'
  ENDPROC   
  PROC KEY_LIST.INIT 
       WITH THIS 
           .ADDITEM('依料品編號排列')
           .ADDITEM('依客戶簡稱+用途排列')
           .ADDITEM('依進貨單號排列')           
           .ADDITEM('依採購單號排列')           
           .ADDITEM('依進貨日期排列')           
       ENDWITH      
  ENDPROC 
  PROC KEY_LIST.INTERACTIVECHANGE                 
       SELE P15
       DO CASE
          CASE THIS.DISPLAYVALUE='依料品編號排列'         
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*120
	       THISFORM.GRID1.COLUMN2.WIDTH=INT_015*100
	       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*150
	       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60     
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='料品編號'
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='品名規格'
	       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='數    量'	   
	       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='進貨單號'
	       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='採購單號'
	       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='用    途' 
	       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='進貨日期'  
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='P15.F03'
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='B01.F02'
	       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='P15.F04'
	       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='P15.F01'
	       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='P15.F09'
	       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='P15.F08'
	       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='P15.F02'
	       SET ORDER TO P15_1
	       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION 
	  CASE THIS.DISPLAYVALUE='依客戶簡稱+用途排列'         
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*150
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*120
	       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*100
	       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='用    途'      
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料品編號'
	       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='品名規格'
	       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='數    量'	   
	       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='進貨單號'
	       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='採購單號'
	       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='進貨日期' 
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='P15.F08' 
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='P15.F03'
	       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='B01.F02'
	       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='P15.F04'
	       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='P15.F01'
	       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='P15.F09'
	       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='P15.F02'
	       SET ORDER TO P15_2  
	       JK='客戶簡稱'          
          CASE THIS.DISPLAYVALUE='依進貨單號排列'          
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*120
	       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*100
	       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*150
	       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='進貨單號'     
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料品編號'
	       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='品名規格'
	       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='數    量'	   
	       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='採購單號'
	       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='用    途' 
	       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='進貨日期' 
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='P15.F01' 
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='P15.F03'
	       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='B01.F02'
	       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='P15.F04'
	       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='P15.F09'
	       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='P15.F08'
	       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='P15.F02'
	       SET ORDER TO P15_3
	       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION                              
          CASE THIS.DISPLAYVALUE='依採購單號排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*80
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*120
	       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*100
	       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*150
	       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*60
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='採購單號'     
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料品編號'
	       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='品名規格'
	       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='數    量'	   
	       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='進貨單號'
	       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='用    途' 
	       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='進貨日期' 
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='P15.F09' 
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='P15.F03'
	       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='B01.F02'
	       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='P15.F04'
	       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='P15.F01'
	       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='P15.F08'
	       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='P15.F02' 
	       SET ORDER TO P15_4
	       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION                
          CASE THIS.DISPLAYVALUE='依進貨日期排列'
               THISFORM.GRID1.COLUMN1.WIDTH=INT_015*60
               THISFORM.GRID1.COLUMN2.WIDTH=INT_015*120
	       THISFORM.GRID1.COLUMN3.WIDTH=INT_015*100
	       THISFORM.GRID1.COLUMN4.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN5.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN6.WIDTH=INT_015*80
	       THISFORM.GRID1.COLUMN7.WIDTH=INT_015*150
	       THISFORM.GRID1.COLUMN1.HEADER1.CAPTION='進貨日期'     
	       THISFORM.GRID1.COLUMN2.HEADER1.CAPTION='料品編號'
	       THISFORM.GRID1.COLUMN3.HEADER1.CAPTION='品名規格'
	       THISFORM.GRID1.COLUMN4.HEADER1.CAPTION='數    量'	   
	       THISFORM.GRID1.COLUMN5.HEADER1.CAPTION='進貨單號'
	       THISFORM.GRID1.COLUMN6.HEADER1.CAPTION='採購單號'
	       THISFORM.GRID1.COLUMN7.HEADER1.CAPTION='用    途' 
	       THISFORM.GRID1.COLUMN1.CONTROLSOURCE='P15.F02'  
	       THISFORM.GRID1.COLUMN2.CONTROLSOURCE='P15.F03'
	       THISFORM.GRID1.COLUMN3.CONTROLSOURCE='B01.F02'
	       THISFORM.GRID1.COLUMN4.CONTROLSOURCE='P15.F04'
	       THISFORM.GRID1.COLUMN5.CONTROLSOURCE='P15.F01'
	       THISFORM.GRID1.COLUMN6.CONTROLSOURCE='P15.F09'
	       THISFORM.GRID1.COLUMN7.CONTROLSOURCE='P15.F08' 
	       SET ORDER TO P15_5
	       JK=THISFORM.GRID1.COLUMN1.HEADER1.CAPTION
       ENDCASE 
       THISFORM.GRID1.REFRESH
       THISFORM.GRID1.SETFOCUS
  ENDPROC
*********************************                  
  PROC GRID1.AFTERROWCOLCHANGE
       LPARAMETERS NCOLINDEX
       THISFORM.REC_COUNT.CAPTION=STR(RECCOUNT('P15'))
       FCH=THISFORM.ACTIVECONTROL.NAME
       CHK=''
       THISFORM.REFRESH
  ENDPROC       
ENDDEFINE        
***********************************************列印程序
PROCEDURE PNT_PRC  
   FLG='0'
   SELE P15
   ANS_RANGE=CREATEOBJECT("ANS_RANGE")  
   ANS_RANGE.SHOW    
   IF FLG<>'1'
       =MESSAGEBOX('無此範圍資料',0+48,'警示')
   ENDIF   
   FLG='0'     
ENDPROC
***********************************************列印範圍選定
DEFINE CLASS ANS_RANGE AS FORM
  AUTOCENTER=.T.
  CAPTION='請輸入列印資料範圍'
  FONTSIZE=INT_015*9
  HEIGHT=INT_015*190
  WIDTH=INT_015*480
  FONTSIZE=INT_015*9
  CONTROLBOX=.F.
  BORDERSTYLE=2
  SHOWTIPS=.T.
  SHOWWINDOW=1
  WINDOWTYPE=1
  NAME='ANS_RANGE'
  ADD OBJECT LABEL1 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*30,;
      TOP=INT_015*75,;
      NAME='LABEL1'
  ADD OBJECT LABEL2 AS LABEL WITH;
      AUTOSIZE=.T.,;
      HEIGHT=INT_015*25,;
      LEFT=INT_015*250,;
      TOP=INT_015*75,;
      NAME='LABEL2'
  ADD OBJECT TEXT1 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      TOP=INT_015*70,;
      LEFT=INT_015*80,;
      HEIGHT=INT_015*25,; 
      NAME='TEXT1'
  ADD OBJECT TEXT2 AS TEXTBOX WITH;
      AUTOSIZE=.T.,;
      TOP=INT_015*70,;
      LEFT=INT_015*300,;
      HEIGHT=INT_015*25,;         
      NAME='TEXT2'    
  ADD OBJECT CMND1 AS COMMANDBUTTON WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*120,;    
      HEIGHT=INT_015*25,;   
      TOP=INT_015*144,;  
      WIDTH=INT_015*80,;
      CAPTION='\<Y.執行',;
      TOOLTIPTEXT='確認所輸入的範圍鍵值!快速鍵->ALT+Y',;
      NAME='CMND1'
  ADD OBJECT CMND2 AS COMMANDBUTTON WITH;
      AUTOSIZE=.T.,;
      LEFT=INT_015*260,;
      TOP=INT_015*144,;
      HEIGHT=INT_015*25,;
      WIDTH=INT_015*80,;
      CAPTION='\<C.取消',;
      TOOLTIPTEXT='取消作業!快速鍵->ALT+C',;
      NAME='CMND2'
 PROCEDURE INIT 
      THISFORM.SETALL('FONTSIZE',INT_015*9,'TEXTBOX')
      THISFORM.SETALL('FONTSIZE',INT_015*9,'LABEL')      
      THISFORM.SETALL('FONTSIZE',INT_015*9,'COMMANDBUTTON')            
      DO CASE
         CASE KEY()='F03'    
              THISFORM.LABEL1.CAPTION='起始料號'
              THISFORM.LABEL2.CAPTION='截止料號'
              THISFORM.LABEL1.LEFT=INT_015*30
              THISFORM.LABEL2.LEFT=INT_015*30
              THISFORM.LABEL1.TOP=INT_015*35
              THISFORM.LABEL2.TOP=INT_015*90
              THISFORM.TEXT1.WIDTH=INT_015*261
              THISFORM.TEXT2.WIDTH=INT_015*261
              THISFORM.TEXT1.LEFT=INT_015*80
              THISFORM.TEXT2.LEFT=INT_015*80
              THISFORM.TEXT1.TOP=INT_015*30
              THISFORM.TEXT2.TOP=INT_015*85
              THISFORM.TEXT1.MAXLENGTH=43              
              THISFORM.TEXT2.MAXLENGTH=43                            
              THISFORM.TEXT1.VALUE=P15.F03
              THISFORM.TEXT2.VALUE=P15.F03                
         CASE KEY()='F20'
              THISFORM.LABEL1.CAPTION='起始客戶'
              THISFORM.LABEL2.CAPTION='截止客戶'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80   
              THISFORM.TEXT1.MAXLENGTH=8              
              THISFORM.TEXT2.MAXLENGTH=8                                       
              THISFORM.TEXT1.VALUE=P15.F20
              THISFORM.TEXT2.VALUE=P15.F20                     
         CASE KEY()='F01'       
              THISFORM.LABEL1.CAPTION='起始單號'
              THISFORM.LABEL2.CAPTION='截止單號'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=10              
              THISFORM.TEXT2.MAXLENGTH=10                            
              THISFORM.TEXT1.VALUE=P15.F01
              THISFORM.TEXT2.VALUE=P15.F01                
         CASE KEY()='F09'   
              THISFORM.LABEL1.CAPTION='起始單號'
              THISFORM.LABEL2.CAPTION='截止單號'
              THISFORM.TEXT1.WIDTH=INT_015*80
              THISFORM.TEXT2.WIDTH=INT_015*80              
              THISFORM.TEXT1.MAXLENGTH=10              
              THISFORM.TEXT2.MAXLENGTH=10                            
              THISFORM.TEXT1.VALUE=P15.F09
              THISFORM.TEXT2.VALUE=P15.F09                        
         CASE KEY()='DTOS(F02)'             
              THISFORM.LABEL1.CAPTION='起始日期'
              THISFORM.LABEL2.CAPTION='截止日期'
              THISFORM.TEXT1.WIDTH=INT_015*70
              THISFORM.TEXT2.WIDTH=INT_015*70              
              THISFORM.TEXT1.VALUE=P15.F02
              THISFORM.TEXT2.VALUE=P15.F02                                    
      ENDCASE   
  ENDPROC
  ***********
 PROCEDURE CMND1.CLICK 
 DO CASE
      CASE KEY()='F03'   
           SELECT * FROM P15 WHERE  F03>=THISFORM.TEXT1.VALUE AND F03<=THISFORM.TEXT2.VALUE  ORDER BY F03 NOWAIT
           IF _TALLY >0              
              REPORT FORM ALLTRIM(INT_116)+'P15A' TO PRINT PROMPT PREVIEW     
              FLG='1'
           ENDIF  
      CASE KEY()='F20'   
           SELECT * FROM P15 WHERE  F20>=THISFORM.TEXT1.VALUE AND F20<=THISFORM.TEXT2.VALUE  ORDER BY F20 NOWAIT
           IF _TALLY >0              
              REPORT FORM ALLTRIM(INT_116)+'P15B' TO PRINT PROMPT PREVIEW   
              FLG='1'
           ENDIF
       CASE KEY()='F01'   
           SELECT * FROM P15 WHERE  F01>=THISFORM.TEXT1.VALUE AND F01<=THISFORM.TEXT2.VALUE  ORDER BY F01 NOWAIT
           IF _TALLY >0              
              REPORT FORM ALLTRIM(INT_116)+'P15C' TO PRINT PROMPT PREVIEW 
              FLG='1'
       ENDIF
       CASE KEY()='F09'   
           SELECT * FROM P15 WHERE  F09>=THISFORM.TEXT1.VALUE AND F09<=THISFORM.TEXT2.VALUE  ORDER BY F09 NOWAIT
           IF _TALLY >0              
              REPORT FORM ALLTRIM(INT_116)+'P15D' TO PRINT PROMPT PREVIEW    
              FLG='1'
           ENDIF
       CASE KEY()='DTOS(F02)'  
           SELECT * FROM P15 WHERE  F02>=THISFORM.TEXT1.VALUE AND  F02<=THISFORM.TEXT2.VALUE  ORDER BY F02 NOWAIT
           IF _TALLY >0              
              REPORT FORM ALLTRIM(INT_116)+'P15E' TO PRINT PROMPT PREVIEW      
              FLG='1'
           ENDIF                                                      
       ENDCASE 
       THISFORM.RELEASE                         
  ENDPROC
***********************  
PROCEDURE CMND2.CLICK
  THISFORM.RELEASE
   FLG='1'
ENDPROC 
ENDDEFINE  